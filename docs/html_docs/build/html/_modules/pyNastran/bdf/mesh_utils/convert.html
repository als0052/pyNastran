

<!DOCTYPE html>
<html class="writer-html4" lang="en" >
<head>
  <meta charset="utf-8" />
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
  <title>pyNastran.bdf.mesh_utils.convert &mdash; pyNastran 1.4-dev 1.4-dev documentation</title>
  

  
  <link rel="stylesheet" href="../../../../_static/css/my_theme.css" type="text/css" />
  <link rel="stylesheet" href="../../../../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../../../../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../../../../_static/css/my_theme.css" type="text/css" />
  <link rel="stylesheet" href="../../../../_static/graphviz.css" type="text/css" />

  
  

  
  

  

  
  <!--[if lt IE 9]>
    <script src="../../../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../../../" src="../../../../_static/documentation_options.js"></script>
        <script data-url_root="../../../../" id="documentation_options" src="../../../../_static/documentation_options.js"></script>
        <script src="../../../../_static/jquery.js"></script>
        <script src="../../../../_static/underscore.js"></script>
        <script src="../../../../_static/doctools.js"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    
    <script type="text/javascript" src="../../../../_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="../../../../genindex.html" />
    <link rel="search" title="Search" href="../../../../search.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../../../../index.html" class="icon icon-home"> pyNastran 1.4-dev
          

          
            
            <img src="../../../../_static/logo.png" class="logo" alt="Logo"/>
          
          </a>

          
            
            
              <div class="version">
                1.4-dev
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul>
<li class="toctree-l1"><a class="reference internal" href="../../../../installation/index.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../quick_start/index.html">Quick Start</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../how_to/index.html">How To: pyNastran</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../reference/pyNastran.html">pyNastran Package</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../manual/index.html">pyNastran Manual</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../../index.html">pyNastran 1.4-dev</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          

















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../../../index.html" class="icon icon-home"></a> &raquo;</li>
        
          <li><a href="../../../index.html">Module code</a> &raquo;</li>
        
      <li>pyNastran.bdf.mesh_utils.convert</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <h1>Source code for pyNastran.bdf.mesh_utils.convert</h1><div class="highlight"><pre>
<span></span><span class="c1"># encoding: utf-8</span>
<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">defines:</span>
<span class="sd"> - convert(model, units_to, units=None)</span>

<span class="sd">&quot;&quot;&quot;</span>
<span class="kn">from</span> <span class="nn">__future__</span> <span class="kn">import</span> <span class="n">annotations</span>
<span class="kn">from</span> <span class="nn">typing</span> <span class="kn">import</span> <span class="n">Tuple</span><span class="p">,</span> <span class="n">Optional</span><span class="p">,</span> <span class="n">TYPE_CHECKING</span>

<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">pyNastran.bdf.cards.base_card</span> <span class="kn">import</span> <span class="n">break_word_by_trailing_parentheses_integer_ab</span>
<span class="kn">from</span> <span class="nn">pyNastran.bdf.bdf</span> <span class="kn">import</span> <span class="n">read_bdf</span>
<span class="k">if</span> <span class="n">TYPE_CHECKING</span><span class="p">:</span>  <span class="c1"># pragma: no cover</span>
    <span class="kn">from</span> <span class="nn">cpylog</span> <span class="kn">import</span> <span class="n">SimpleLogger</span>
    <span class="kn">from</span> <span class="nn">pyNastran.bdf.bdf</span> <span class="kn">import</span> <span class="p">(</span><span class="n">BDF</span><span class="p">,</span> <span class="n">DVCREL1</span><span class="p">,</span> <span class="n">DVCREL2</span><span class="p">,</span> <span class="n">DCONSTR</span><span class="p">,</span>
                                   <span class="n">PBAR</span><span class="p">,</span> <span class="n">PBEAM</span><span class="p">,</span> <span class="n">PBEAM3</span><span class="p">,</span> <span class="n">PBUSH</span><span class="p">,</span> <span class="n">PBUSH1D</span><span class="p">)</span>


<div class="viewcode-block" id="convert"><a class="viewcode-back" href="../../../../reference/bdf/mesh_utils/pyNastran.bdf.mesh_utils.split_elements.html#pyNastran.bdf.mesh_utils.convert.convert">[docs]</a><span class="k">def</span> <span class="nf">convert</span><span class="p">(</span><span class="n">model</span><span class="p">:</span> <span class="n">BDF</span><span class="p">,</span> <span class="n">units_to</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="n">units</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Converts a model from a set of defined units</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    model : BDF</span>
<span class="sd">       cross references the model (default=True)</span>
<span class="sd">    units_to : List[str]</span>
<span class="sd">        [length, mass, time]</span>
<span class="sd">        length = {in, ft, m, cm, mm}</span>
<span class="sd">        mass = {g, kg, Mg, lbm, slug, slinch}</span>
<span class="sd">        time = {s}</span>
<span class="sd">    units : List[str]</span>
<span class="sd">        overwrites model.units</span>

<span class="sd">    Note</span>
<span class="sd">    ----</span>
<span class="sd">    mass refers to the elemental mass, which could be a weight</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># units_start = &#39;in&#39;</span>
    <span class="c1"># units_end = &#39;mm&#39;</span>
    <span class="c1"># xyz_scale = in_to_mm</span>
    <span class="c1"># xyz_scale = 25.4</span>
    <span class="k">if</span> <span class="n">units</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">units</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">units</span>
    <span class="n">xyz_scale</span><span class="p">,</span> <span class="n">mass_scale</span><span class="p">,</span> <span class="n">time_scale</span><span class="p">,</span> <span class="n">weight_scale</span><span class="p">,</span> <span class="n">gravity_scale</span> <span class="o">=</span> <span class="n">get_scale_factors</span><span class="p">(</span>
        <span class="n">units</span><span class="p">,</span> <span class="n">units_to</span><span class="p">,</span> <span class="n">model</span><span class="o">.</span><span class="n">log</span><span class="p">)</span>

    <span class="n">scale_model</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">xyz_scale</span><span class="p">,</span> <span class="n">mass_scale</span><span class="p">,</span> <span class="n">time_scale</span><span class="p">,</span> <span class="n">weight_scale</span><span class="p">,</span> <span class="n">gravity_scale</span><span class="p">)</span></div>


<div class="viewcode-block" id="scale_by_terms"><a class="viewcode-back" href="../../../../reference/bdf/mesh_utils/pyNastran.bdf.mesh_utils.split_elements.html#pyNastran.bdf.mesh_utils.convert.scale_by_terms">[docs]</a><span class="k">def</span> <span class="nf">scale_by_terms</span><span class="p">(</span><span class="n">bdf_filename</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">BDF</span><span class="p">,</span> <span class="nb">str</span><span class="p">],</span> <span class="n">terms</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">float</span><span class="p">],</span> <span class="n">scales</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">float</span><span class="p">],</span>
                   <span class="n">bdf_filename_out</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                   <span class="n">encoding</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">log</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">debug</span><span class="p">:</span> <span class="nb">bool</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">BDF</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Scales a BDF based on factors for 3 of the 6 independent terms</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    bdf_filename : str / BDF()</span>
<span class="sd">        a BDF filename</span>
<span class="sd">    terms : List[str]; length=3</span>
<span class="sd">        the names {M, L, T, F, P, V}</span>
<span class="sd">        mass, length, time, force, pressure, velocity</span>
<span class="sd">    scales : List[float]; length=3</span>
<span class="sd">        the scaling factors</span>
<span class="sd">    bdf_filename_out : str; default=None</span>
<span class="sd">        a BDF filename to write</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    model : BDF()</span>
<span class="sd">       the scaled BDF</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">terms</span><span class="p">)</span> <span class="o">==</span> <span class="mi">3</span><span class="p">,</span> <span class="sa">f</span><span class="s1">&#39;terms=</span><span class="si">{</span><span class="n">terms</span><span class="si">}</span><span class="s1"> scales=</span><span class="si">{</span><span class="n">scales</span><span class="si">}</span><span class="s1">&#39;</span>
    <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">scales</span><span class="p">)</span> <span class="o">==</span> <span class="mi">3</span><span class="p">,</span> <span class="sa">f</span><span class="s1">&#39;terms=</span><span class="si">{</span><span class="n">terms</span><span class="si">}</span><span class="s1"> scales=</span><span class="si">{</span><span class="n">scales</span><span class="si">}</span><span class="s1">&#39;</span>
    <span class="n">quiet</span> <span class="o">=</span> <span class="ow">not</span> <span class="n">debug</span>
    <span class="n">mass_scale</span><span class="p">,</span> <span class="n">xyz_scale</span><span class="p">,</span> <span class="n">time_scale</span> <span class="o">=</span> <span class="n">_setup_scale_by_terms</span><span class="p">(</span><span class="n">scales</span><span class="p">,</span> <span class="n">terms</span><span class="p">,</span> <span class="n">quiet</span><span class="o">=</span><span class="n">quiet</span><span class="p">)</span>

    <span class="c1">#-------------------------------------------------</span>
    <span class="n">weight_scale</span> <span class="o">=</span> <span class="n">mass_scale</span> <span class="o">*</span> <span class="n">xyz_scale</span> <span class="o">/</span> <span class="n">time_scale</span> <span class="o">**</span> <span class="mi">2</span>
    <span class="c1">#gravity_scale = xyz_scale / time_scale ** 2</span>
    <span class="n">gravity_scale</span> <span class="o">=</span> <span class="mf">1.0</span>

    <span class="c1">#cards_to_skip = [</span>
        <span class="c1">#&#39;AEFACT&#39;, &#39;CAERO1&#39;, &#39;CAERO2&#39;, &#39;SPLINE1&#39;, &#39;SPLINE2&#39;,</span>
        <span class="c1">#&#39;AERO&#39;, &#39;AEROS&#39;, &#39;PAERO1&#39;, &#39;PAERO2&#39;, &#39;MKAERO1&#39;]</span>
    <span class="n">model</span> <span class="o">=</span> <span class="n">read_bdf</span><span class="p">(</span><span class="n">bdf_filename</span><span class="p">,</span> <span class="n">validate</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">xref</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                     <span class="n">punch</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">save_file_structure</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                     <span class="n">skip_cards</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">read_cards</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                     <span class="n">encoding</span><span class="o">=</span><span class="n">encoding</span><span class="p">,</span> <span class="n">log</span><span class="o">=</span><span class="n">log</span><span class="p">,</span> <span class="n">debug</span><span class="o">=</span><span class="n">debug</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;msc&#39;</span><span class="p">)</span>
    <span class="n">scale_model</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">xyz_scale</span><span class="p">,</span> <span class="n">mass_scale</span><span class="p">,</span> <span class="n">time_scale</span><span class="p">,</span> <span class="n">weight_scale</span><span class="p">,</span> <span class="n">gravity_scale</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">bdf_filename_out</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">model</span><span class="o">.</span><span class="n">write_bdf</span><span class="p">(</span><span class="n">bdf_filename_out</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">model</span></div>

<div class="viewcode-block" id="_setup_scale_by_terms"><a class="viewcode-back" href="../../../../reference/bdf/mesh_utils/pyNastran.bdf.mesh_utils.split_elements.html#pyNastran.bdf.mesh_utils.convert._setup_scale_by_terms">[docs]</a><span class="k">def</span> <span class="nf">_setup_scale_by_terms</span><span class="p">(</span><span class="n">scales</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">float</span><span class="p">],</span>
                          <span class="n">terms</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="n">quiet</span><span class="p">:</span> <span class="nb">bool</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="nb">float</span><span class="p">]:</span>
    <span class="sd">&quot;&quot;&quot;determines the mass, length, time scaling factors&quot;&quot;&quot;</span>
    <span class="n">term_to_mlt_map</span> <span class="o">=</span> <span class="p">{</span>
        <span class="c1">#      M   L   T</span>
        <span class="s1">&#39;M&#39;</span> <span class="p">:</span> <span class="p">[</span><span class="mf">1.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">],</span>
        <span class="s1">&#39;L&#39;</span> <span class="p">:</span> <span class="p">[</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">],</span>
        <span class="s1">&#39;T&#39;</span> <span class="p">:</span> <span class="p">[</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">],</span>

        <span class="s1">&#39;F&#39;</span> <span class="p">:</span> <span class="p">[</span><span class="mf">1.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">,</span> <span class="o">-</span><span class="mf">2.</span><span class="p">],</span>
        <span class="s1">&#39;P&#39;</span> <span class="p">:</span> <span class="p">[</span><span class="mf">1.</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.</span><span class="p">,</span> <span class="o">-</span><span class="mf">2.</span><span class="p">],</span>
        <span class="s1">&#39;V&#39;</span> <span class="p">:</span> <span class="p">[</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.</span><span class="p">],</span>
    <span class="p">}</span>
    <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">terms</span><span class="p">)</span> <span class="o">==</span> <span class="mi">3</span><span class="p">,</span> <span class="n">terms</span>
    <span class="n">A</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="s1">&#39;float64&#39;</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">term</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">terms</span><span class="p">):</span>
        <span class="n">mlt</span> <span class="o">=</span> <span class="n">term_to_mlt_map</span><span class="p">[</span><span class="n">term</span><span class="p">]</span>
        <span class="c1">#print(term, mlt)</span>
        <span class="n">A</span><span class="p">[:,</span> <span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">mlt</span>

    <span class="n">MLT</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;mass&#39;</span><span class="p">,</span> <span class="s1">&#39;length&#39;</span><span class="p">,</span> <span class="s1">&#39;time&#39;</span><span class="p">]</span>
    <span class="k">for</span> <span class="n">mlt</span><span class="p">,</span> <span class="n">Ai</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">MLT</span><span class="p">,</span> <span class="n">A</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">Ai</span><span class="p">)</span><span class="o">.</span><span class="n">max</span><span class="p">(),</span> <span class="mf">0.</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%s</span><span class="s1"> is not solvable from [</span><span class="si">%s</span><span class="s1">]&#39;</span> <span class="o">%</span>  <span class="p">(</span><span class="n">mlt</span><span class="p">,</span> <span class="s1">&#39;, &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">terms</span><span class="p">)))</span>

    <span class="n">detA</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">det</span><span class="p">(</span><span class="n">A</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">detA</span> <span class="o">==</span> <span class="mf">0.0</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s1">&#39;the equations are not independent &#39;</span>
                           <span class="s1">&#39;(e.g., length, time, and velocity) &#39;</span>
                           <span class="s1">&#39;and cannot determine mass, legnth, and time&#39;</span><span class="p">)</span>
    <span class="n">M</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="p">[</span><span class="mf">1.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">])</span>
    <span class="n">L</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="p">[</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">])</span>
    <span class="n">T</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="p">[</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">])</span>
    <span class="n">mass_scale</span><span class="p">,</span> <span class="n">mass_msg</span> <span class="o">=</span> <span class="n">_scale_term</span><span class="p">(</span><span class="s1">&#39;M&#39;</span><span class="p">,</span> <span class="n">M</span><span class="p">,</span> <span class="n">terms</span><span class="p">,</span> <span class="n">scales</span><span class="p">)</span>
    <span class="n">xyz_scale</span><span class="p">,</span> <span class="n">xyz_msg</span> <span class="o">=</span> <span class="n">_scale_term</span><span class="p">(</span><span class="s1">&#39;L&#39;</span><span class="p">,</span> <span class="n">L</span><span class="p">,</span> <span class="n">terms</span><span class="p">,</span> <span class="n">scales</span><span class="p">)</span>
    <span class="n">time_scale</span><span class="p">,</span> <span class="n">time_msg</span> <span class="o">=</span> <span class="n">_scale_term</span><span class="p">(</span><span class="s1">&#39;T&#39;</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">terms</span><span class="p">,</span> <span class="n">scales</span><span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">quiet</span><span class="p">:</span>
        <span class="n">msg</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;MLT:</span><span class="se">\n</span><span class="s1">&#39;</span>
               <span class="s1">&#39;</span><span class="si">%s</span><span class="se">\n</span><span class="s1">&#39;</span>
               <span class="s1">&#39;</span><span class="si">%s</span><span class="se">\n</span><span class="s1">&#39;</span>
               <span class="s1">&#39;</span><span class="si">%s</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">mass_msg</span><span class="p">,</span> <span class="n">xyz_msg</span><span class="p">,</span> <span class="n">time_msg</span><span class="p">))</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">mass_scale</span><span class="p">,</span> <span class="n">xyz_scale</span><span class="p">,</span> <span class="n">time_scale</span></div>

<div class="viewcode-block" id="_scale_term"><a class="viewcode-back" href="../../../../reference/bdf/mesh_utils/pyNastran.bdf.mesh_utils.split_elements.html#pyNastran.bdf.mesh_utils.convert._scale_term">[docs]</a><span class="k">def</span> <span class="nf">_scale_term</span><span class="p">(</span><span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
                <span class="n">coeffs</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">float</span><span class="p">],</span>
                <span class="n">terms</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">float</span><span class="p">],</span>
                <span class="n">scales</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">float</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="nb">str</span><span class="p">]:</span>
    <span class="n">msg</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">%s</span><span class="s1"> = &#39;</span> <span class="o">%</span> <span class="n">name</span>
    <span class="n">value</span> <span class="o">=</span> <span class="mf">1.0</span>
    <span class="k">for</span> <span class="n">coeff</span><span class="p">,</span> <span class="n">term</span><span class="p">,</span> <span class="n">scale</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">coeffs</span><span class="p">,</span> <span class="n">terms</span><span class="p">,</span> <span class="n">scales</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">abs</span><span class="p">(</span><span class="n">coeff</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">msg</span> <span class="o">+=</span> <span class="s1">&#39;</span><span class="si">%s</span><span class="s1">^</span><span class="si">%s</span><span class="s1"> * &#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">term</span><span class="p">,</span> <span class="n">coeff</span><span class="p">)</span>
            <span class="n">value</span> <span class="o">*=</span> <span class="n">scale</span> <span class="o">**</span> <span class="n">coeff</span>
    <span class="n">msg</span> <span class="o">=</span> <span class="n">msg</span><span class="o">.</span><span class="n">strip</span><span class="p">(</span><span class="s1">&#39;* &#39;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">value</span><span class="p">,</span> <span class="n">msg</span></div>

<div class="viewcode-block" id="scale_model"><a class="viewcode-back" href="../../../../reference/bdf/mesh_utils/pyNastran.bdf.mesh_utils.split_elements.html#pyNastran.bdf.mesh_utils.convert.scale_model">[docs]</a><span class="k">def</span> <span class="nf">scale_model</span><span class="p">(</span><span class="n">model</span><span class="p">:</span> <span class="n">BDF</span><span class="p">,</span>
                <span class="n">xyz_scale</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
                <span class="n">mass_scale</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
                <span class="n">time_scale</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
                <span class="n">weight_scale</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
                <span class="n">gravity_scale</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
                <span class="n">convert_nodes</span><span class="p">:</span> <span class="nb">bool</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">convert_elements</span><span class="p">:</span> <span class="nb">bool</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                <span class="n">convert_properties</span><span class="p">:</span> <span class="nb">bool</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">convert_materials</span><span class="p">:</span> <span class="nb">bool</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                <span class="n">convert_aero</span><span class="p">:</span> <span class="nb">bool</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">convert_constraints</span><span class="p">:</span> <span class="nb">bool</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                <span class="n">convert_loads</span><span class="p">:</span> <span class="nb">bool</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">convert_optimization</span><span class="p">:</span> <span class="nb">bool</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Performs the model scaling&quot;&quot;&quot;</span>
    <span class="n">model</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s1">&#39;L, xyz_scale = </span><span class="si">%g</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">xyz_scale</span><span class="p">)</span>
    <span class="n">model</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s1">&#39;M, mass_scale = </span><span class="si">%g</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">mass_scale</span><span class="p">)</span>
    <span class="n">model</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s1">&#39;T, time_scale = </span><span class="si">%g</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">time_scale</span><span class="p">)</span>
    <span class="n">model</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s1">&#39;F, weight_scale = </span><span class="si">%g</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">weight_scale</span><span class="p">)</span>
    <span class="n">model</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s1">&#39;G, gravity_scale = </span><span class="si">%g</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">gravity_scale</span><span class="p">)</span>
    <span class="n">temperature_scale</span> <span class="o">=</span> <span class="mf">1.</span>
    <span class="n">_set_wtmass</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">gravity_scale</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">convert_nodes</span><span class="p">:</span>
        <span class="n">_convert_nodes</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">xyz_scale</span><span class="p">)</span>
        <span class="n">_convert_coordinates</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">xyz_scale</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">convert_elements</span><span class="p">:</span>
        <span class="n">_convert_elements</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">xyz_scale</span><span class="p">,</span> <span class="n">time_scale</span><span class="p">,</span> <span class="n">mass_scale</span><span class="p">,</span> <span class="n">weight_scale</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">convert_properties</span><span class="p">:</span>
        <span class="n">_convert_properties</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">xyz_scale</span><span class="p">,</span> <span class="n">time_scale</span><span class="p">,</span> <span class="n">mass_scale</span><span class="p">,</span> <span class="n">weight_scale</span><span class="p">,</span>
                            <span class="n">temperature_scale</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">convert_materials</span><span class="p">:</span>
        <span class="n">_convert_materials</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">xyz_scale</span><span class="p">,</span> <span class="n">mass_scale</span><span class="p">,</span> <span class="n">weight_scale</span><span class="p">,</span> <span class="n">temperature_scale</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">convert_aero</span><span class="p">:</span>
        <span class="n">_convert_aero</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">xyz_scale</span><span class="p">,</span> <span class="n">time_scale</span><span class="p">,</span> <span class="n">weight_scale</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">convert_constraints</span><span class="p">:</span>
        <span class="n">_convert_constraints</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">xyz_scale</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">convert_loads</span><span class="p">:</span>
        <span class="n">_convert_loads</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">xyz_scale</span><span class="p">,</span> <span class="n">time_scale</span><span class="p">,</span> <span class="n">weight_scale</span><span class="p">,</span> <span class="n">temperature_scale</span><span class="p">)</span>
    <span class="c1">#_convert_sets(model)</span>
    <span class="k">if</span> <span class="n">convert_optimization</span><span class="p">:</span>
        <span class="n">_convert_optimization</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">xyz_scale</span><span class="p">,</span> <span class="n">mass_scale</span><span class="p">,</span> <span class="n">weight_scale</span><span class="p">,</span> <span class="n">time_scale</span><span class="p">)</span></div>


<div class="viewcode-block" id="_set_wtmass"><a class="viewcode-back" href="../../../../reference/bdf/mesh_utils/pyNastran.bdf.mesh_utils.split_elements.html#pyNastran.bdf.mesh_utils.convert._set_wtmass">[docs]</a><span class="k">def</span> <span class="nf">_set_wtmass</span><span class="p">(</span><span class="n">model</span><span class="p">:</span> <span class="n">BDF</span><span class="p">,</span> <span class="n">gravity_scale</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    set the PARAM,WTMASS</span>

<span class="sd">    ft-lbm-s-lbf-psf     : 1. / 32.2</span>
<span class="sd">    in-lbm-s-lbf-psi     : 1. / (32.2*12)</span>
<span class="sd">    m-kg-s-N-Pa          : 1.</span>
<span class="sd">    mm-Mg-s-N-Mpa        : 1.</span>
<span class="sd">    in-slinch-s-lbf-psi  : 1.</span>
<span class="sd">    ft-slug-s-lbf-psf    : 1.</span>
<span class="sd">    in-slug-s-lbf-psi    : 1 / 12.</span>

<span class="sd">    1 slug   * 1 ft/s^2 = 1 lbf</span>
<span class="sd">    1 slinch * 1 in/s^2 = 1 lbf</span>
<span class="sd">    1 slinch = 12 slug</span>

<span class="sd">    F = m*a</span>
<span class="sd">    386 lbf = 1 slinch * 386 * in/s^2</span>
<span class="sd">    32  lbf = 1 slug * 32 * ft/s^2</span>
<span class="sd">    1   N   = 1 kg * 9.8 m/s^2</span>

<span class="sd">    1 lbf = g_scale * 1 slinch  * 1 in/s^2</span>
<span class="sd">    1 lbf = g_scale * 12 slug   * 1 in/s^2</span>
<span class="sd">    --&gt; g_scale = 1/12.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="s1">&#39;WTMASS&#39;</span> <span class="ow">in</span> <span class="n">model</span><span class="o">.</span><span class="n">params</span><span class="p">:</span>
        <span class="n">param</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="s1">&#39;WTMASS&#39;</span><span class="p">]</span>
        <span class="n">value0</span> <span class="o">=</span> <span class="n">param</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">weight_mass</span> <span class="o">=</span> <span class="n">value0</span> <span class="o">/</span> <span class="n">gravity_scale</span>
        <span class="n">param</span><span class="o">.</span><span class="n">values</span> <span class="o">=</span> <span class="p">[</span><span class="n">weight_mass</span><span class="p">]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">weight_mass</span> <span class="o">=</span> <span class="mf">1.</span> <span class="o">/</span> <span class="n">gravity_scale</span>
        <span class="n">card</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;PARAM&#39;</span><span class="p">,</span> <span class="s1">&#39;WTMASS&#39;</span><span class="p">,</span> <span class="n">weight_mass</span><span class="p">]</span>
        <span class="n">model</span><span class="o">.</span><span class="n">add_card</span><span class="p">(</span><span class="n">card</span><span class="p">,</span> <span class="s1">&#39;PARAM&#39;</span><span class="p">)</span>
    <span class="n">model</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s1">&#39;wtmass = </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">weight_mass</span><span class="p">)</span></div>

<div class="viewcode-block" id="_convert_nodes"><a class="viewcode-back" href="../../../../reference/bdf/mesh_utils/pyNastran.bdf.mesh_utils.split_elements.html#pyNastran.bdf.mesh_utils.convert._convert_nodes">[docs]</a><span class="k">def</span> <span class="nf">_convert_nodes</span><span class="p">(</span><span class="n">model</span><span class="p">:</span> <span class="n">BDF</span><span class="p">,</span> <span class="n">xyz_scale</span><span class="p">:</span> <span class="nb">bool</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Converts the nodes</span>

<span class="sd">    Supports: GRID</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">for</span> <span class="n">node</span> <span class="ow">in</span> <span class="n">model</span><span class="o">.</span><span class="n">nodes</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
        <span class="k">if</span> <span class="n">node</span><span class="o">.</span><span class="n">cp</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">node</span><span class="o">.</span><span class="n">xyz</span> <span class="o">*=</span> <span class="n">xyz_scale</span>
        <span class="k">elif</span> <span class="n">node</span><span class="o">.</span><span class="n">cp_ref</span><span class="o">.</span><span class="n">type</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;CORD1R&#39;</span><span class="p">,</span> <span class="s1">&#39;CORD2R&#39;</span><span class="p">]:</span>
            <span class="n">node</span><span class="o">.</span><span class="n">xyz</span> <span class="o">*=</span> <span class="n">xyz_scale</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># only scale R</span>
            <span class="n">node</span><span class="o">.</span><span class="n">xyz</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*=</span> <span class="n">xyz_scale</span></div>

<div class="viewcode-block" id="_convert_coordinates"><a class="viewcode-back" href="../../../../reference/bdf/mesh_utils/pyNastran.bdf.mesh_utils.split_elements.html#pyNastran.bdf.mesh_utils.convert._convert_coordinates">[docs]</a><span class="k">def</span> <span class="nf">_convert_coordinates</span><span class="p">(</span><span class="n">model</span><span class="p">:</span> <span class="n">BDF</span><span class="p">,</span> <span class="n">xyz_scale</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Converts the coordinate systems</span>

<span class="sd">    Supports: CORD1x, CORD2x</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">for</span> <span class="n">cid</span><span class="p">,</span> <span class="n">coord</span> <span class="ow">in</span> <span class="n">model</span><span class="o">.</span><span class="n">coords</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="k">if</span> <span class="n">cid</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">continue</span>

        <span class="k">if</span> <span class="n">coord</span><span class="o">.</span><span class="n">rid</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">coord</span><span class="o">.</span><span class="n">e1</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span> <span class="o">==</span> <span class="mf">0.</span><span class="p">:</span>
                <span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">coord</span><span class="o">.</span><span class="n">origin</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span> <span class="o">==</span> <span class="mf">0.</span><span class="p">,</span> <span class="n">coord</span><span class="o">.</span><span class="n">origin</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">coord</span><span class="o">.</span><span class="n">origin</span> <span class="o">*=</span> <span class="n">xyz_scale</span>
                <span class="n">coord</span><span class="o">.</span><span class="n">e1</span> <span class="o">*=</span> <span class="n">xyz_scale</span>
                <span class="n">coord</span><span class="o">.</span><span class="n">e2</span> <span class="o">*=</span> <span class="n">xyz_scale</span>
                <span class="n">coord</span><span class="o">.</span><span class="n">e3</span> <span class="o">*=</span> <span class="n">xyz_scale</span>
        <span class="k">elif</span> <span class="n">coord</span><span class="o">.</span><span class="n">rid_ref</span><span class="o">.</span><span class="n">type</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;CORD1R&#39;</span><span class="p">,</span> <span class="s1">&#39;CORD2R&#39;</span><span class="p">]:</span>
            <span class="n">coord</span><span class="o">.</span><span class="n">origin</span> <span class="o">*=</span> <span class="n">xyz_scale</span>
            <span class="n">coord</span><span class="o">.</span><span class="n">e1</span> <span class="o">*=</span> <span class="n">xyz_scale</span>
            <span class="n">coord</span><span class="o">.</span><span class="n">e2</span> <span class="o">*=</span> <span class="n">xyz_scale</span>
            <span class="n">coord</span><span class="o">.</span><span class="n">e3</span> <span class="o">*=</span> <span class="n">xyz_scale</span>
        <span class="k">elif</span> <span class="n">coord</span><span class="o">.</span><span class="n">rid_ref</span><span class="o">.</span><span class="n">type</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;CORD1C&#39;</span><span class="p">,</span> <span class="s1">&#39;CORD1S&#39;</span><span class="p">,</span> <span class="s1">&#39;CORD2C&#39;</span><span class="p">,</span> <span class="s1">&#39;CORD2S&#39;</span><span class="p">]:</span>
            <span class="n">coord</span><span class="o">.</span><span class="n">origin</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*=</span> <span class="n">xyz_scale</span>
            <span class="n">coord</span><span class="o">.</span><span class="n">e1</span> <span class="o">*=</span> <span class="n">xyz_scale</span>
            <span class="c1">#raise NotImplementedError(coord)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="n">coord</span><span class="p">)</span></div>
            <span class="c1">#coord.e1 *= xyz_scale</span>
        <span class="c1">#elif coord.type in [&#39;CORD1R&#39;, &#39;CORD2R&#39;]:</span>
            <span class="c1">#coord.origin *= xyz_scale</span>
            <span class="c1">#coord.e1 *= xyz_scale</span>
            <span class="c1">#coord.e2 *= xyz_scale</span>
            <span class="c1">#coord.e3 *= xyz_scale</span>
        <span class="c1">#else:</span>
            <span class="c1">#raise NotImplementedError(coord)</span>

<div class="viewcode-block" id="_convert_elements"><a class="viewcode-back" href="../../../../reference/bdf/mesh_utils/pyNastran.bdf.mesh_utils.split_elements.html#pyNastran.bdf.mesh_utils.convert._convert_elements">[docs]</a><span class="k">def</span> <span class="nf">_convert_elements</span><span class="p">(</span><span class="n">model</span><span class="p">:</span> <span class="n">BDF</span><span class="p">,</span>
                      <span class="n">xyz_scale</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
                      <span class="n">time_scale</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
                      <span class="n">mass_scale</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
                      <span class="n">weight_scale</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Converts the elements</span>

<span class="sd">    Supports:  CTRIA3, CTRIA6, CTRIAR,  CQUAD4, CQUAD8, CQUADR,</span>
<span class="sd">               CELAS2, CELAS4, CDAMP2, CDAMP4, CBUSH,</span>
<span class="sd">               CONROD, CBAR, CBEAM, GENEL, CONM2, CMASS4</span>

<span class="sd">    Skips : CELAS1, CELAS3, CDAMP3, CDAMP5, CCONEAX,</span>
<span class="sd">            CROD, CTUBE, CVISC, CBUSH1D,</span>
<span class="sd">            CQUAD, CSHEAR, CTRIAX, CTRIAX6,</span>
<span class="sd">            CTETRA, CPENTA, CHEXA, CPYRAM,</span>
<span class="sd">            CMASS1, CMASS3,</span>
<span class="sd">    NX Skips: CTRAX3, CTRAX6, CPLSTN3, CPLSTN6, CPLSTN4&#39;, CPLSTN8, CQUADX4, CQUADX8</span>
<span class="sd">    *intentionally</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">force_scale</span> <span class="o">=</span> <span class="n">weight_scale</span>
    <span class="n">area_scale</span> <span class="o">=</span> <span class="n">xyz_scale</span> <span class="o">**</span> <span class="mi">2</span>
    <span class="n">velocity_scale</span> <span class="o">=</span> <span class="n">xyz_scale</span> <span class="o">/</span> <span class="n">time_scale</span>
    <span class="n">area_moi_scale</span> <span class="o">=</span> <span class="n">xyz_scale</span> <span class="o">**</span> <span class="mi">4</span>
    <span class="n">mass_moi_scale</span> <span class="o">=</span> <span class="n">mass_scale</span> <span class="o">*</span> <span class="n">xyz_scale</span> <span class="o">**</span> <span class="mi">2</span>
    <span class="c1">#nsm_scale = mass_scale</span>
    <span class="n">nsm_bar_scale</span> <span class="o">=</span> <span class="n">mass_scale</span> <span class="o">/</span> <span class="n">xyz_scale</span>
    <span class="n">stiffness_scale</span> <span class="o">=</span> <span class="n">force_scale</span> <span class="o">/</span> <span class="n">xyz_scale</span>
    <span class="n">flexibility_scale</span> <span class="o">=</span> <span class="mf">1.</span> <span class="o">/</span> <span class="n">stiffness_scale</span>
    <span class="n">damping_scale</span> <span class="o">=</span> <span class="n">force_scale</span> <span class="o">/</span> <span class="n">velocity_scale</span>

    <span class="c1"># these don&#39;t have any properties</span>
    <span class="n">skip_elements</span> <span class="o">=</span> <span class="p">{</span>
        <span class="c1"># nothing to convert (verified)</span>
        <span class="s1">&#39;CCONEAX&#39;</span><span class="p">,</span>
        <span class="s1">&#39;CELAS1&#39;</span><span class="p">,</span> <span class="s1">&#39;CELAS3&#39;</span><span class="p">,</span>
        <span class="s1">&#39;CDAMP1&#39;</span><span class="p">,</span> <span class="s1">&#39;CDAMP3&#39;</span><span class="p">,</span> <span class="s1">&#39;CDAMP5&#39;</span><span class="p">,</span>
        <span class="s1">&#39;CVISC&#39;</span><span class="p">,</span> <span class="s1">&#39;CBUSH1D&#39;</span><span class="p">,</span>
        <span class="s1">&#39;CROD&#39;</span><span class="p">,</span> <span class="s1">&#39;CTUBE&#39;</span><span class="p">,</span>
        <span class="s1">&#39;CSHEAR&#39;</span><span class="p">,</span> <span class="s1">&#39;CQUAD&#39;</span><span class="p">,</span> <span class="s1">&#39;CQUADX&#39;</span><span class="p">,</span> <span class="s1">&#39;CTRIAX&#39;</span><span class="p">,</span> <span class="s1">&#39;CTRIAX6&#39;</span><span class="p">,</span>
        <span class="s1">&#39;CTETRA&#39;</span><span class="p">,</span> <span class="s1">&#39;CPENTA&#39;</span><span class="p">,</span> <span class="s1">&#39;CHEXA&#39;</span><span class="p">,</span> <span class="s1">&#39;CPYRAM&#39;</span><span class="p">,</span>
        <span class="s1">&#39;CRAC2D&#39;</span><span class="p">,</span> <span class="s1">&#39;CRAC3D&#39;</span><span class="p">,</span>
        <span class="s1">&#39;CHBDYG&#39;</span><span class="p">,</span> <span class="s1">&#39;CHBDYE&#39;</span><span class="p">,</span> <span class="s1">&#39;CHBDYP&#39;</span><span class="p">,</span>

        <span class="c1"># TODO: NX-verify</span>
        <span class="s1">&#39;CTRAX3&#39;</span><span class="p">,</span> <span class="s1">&#39;CTRAX6&#39;</span><span class="p">,</span>
        <span class="s1">&#39;CPLSTN3&#39;</span><span class="p">,</span> <span class="s1">&#39;CPLSTN6&#39;</span><span class="p">,</span> <span class="s1">&#39;CPLSTN4&#39;</span><span class="p">,</span> <span class="s1">&#39;CPLSTN8&#39;</span><span class="p">,</span>
        <span class="s1">&#39;CQUADX4&#39;</span><span class="p">,</span> <span class="s1">&#39;CQUADX8&#39;</span><span class="p">,</span>

        <span class="c1"># acoustic</span>
        <span class="s1">&#39;CHACAB&#39;</span><span class="p">,</span>
    <span class="p">}</span>
    <span class="n">skip_masses</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;CMASS1&#39;</span><span class="p">,</span> <span class="s1">&#39;CMASS3&#39;</span><span class="p">}</span>

    <span class="n">tri_shells</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;CTRIA3&#39;</span><span class="p">,</span> <span class="s1">&#39;CTRIA6&#39;</span><span class="p">,</span> <span class="s1">&#39;CTRIAR&#39;</span><span class="p">}</span>
    <span class="n">quad_shells</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;CQUAD4&#39;</span><span class="p">,</span> <span class="s1">&#39;CQUAD8&#39;</span><span class="p">,</span> <span class="s1">&#39;CQUADR&#39;</span><span class="p">}</span>
    <span class="n">spring_elements</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;CELAS2&#39;</span><span class="p">,</span> <span class="s1">&#39;CELAS4&#39;</span><span class="p">}</span>
    <span class="n">damper_elements</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;CDAMP2&#39;</span><span class="p">,</span> <span class="s1">&#39;CDAMP4&#39;</span><span class="p">}</span>

    <span class="n">model</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s1">&#39;--Element Scales--&#39;</span><span class="p">)</span>
    <span class="n">model</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s1">&#39;nsm_bar_scale (L) = </span><span class="si">%g</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">nsm_bar_scale</span><span class="p">)</span>
    <span class="n">model</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s1">&#39;area_moi_scale = </span><span class="si">%g</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">area_moi_scale</span><span class="p">)</span>
    <span class="n">model</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s1">&#39;area_scale = </span><span class="si">%g</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">area_scale</span><span class="p">)</span>
    <span class="n">model</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s1">&#39;stiffness_scale = </span><span class="si">%g</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">stiffness_scale</span><span class="p">)</span>
    <span class="n">model</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s1">&#39;damping_scale = </span><span class="si">%g</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">damping_scale</span><span class="p">)</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">masses</span><span class="p">):</span>
        <span class="n">model</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s1">&#39;mass_moi_scale = </span><span class="si">%g</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">mass_moi_scale</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">elem</span> <span class="ow">in</span> <span class="n">model</span><span class="o">.</span><span class="n">elements</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
        <span class="n">elem_type</span> <span class="o">=</span> <span class="n">elem</span><span class="o">.</span><span class="n">type</span>
        <span class="k">if</span> <span class="n">elem_type</span> <span class="ow">in</span> <span class="n">skip_elements</span><span class="p">:</span>
            <span class="k">continue</span>

        <span class="k">if</span> <span class="n">elem_type</span> <span class="ow">in</span> <span class="n">spring_elements</span><span class="p">:</span>
            <span class="n">elem</span><span class="o">.</span><span class="n">k</span> <span class="o">*=</span> <span class="n">stiffness_scale</span>
        <span class="k">elif</span> <span class="n">elem_type</span> <span class="ow">in</span> <span class="n">damper_elements</span><span class="p">:</span>
            <span class="n">elem</span><span class="o">.</span><span class="n">b</span> <span class="o">*=</span> <span class="n">damping_scale</span>
        <span class="k">elif</span> <span class="n">elem_type</span> <span class="ow">in</span> <span class="n">tri_shells</span><span class="p">:</span>
            <span class="c1"># thickness</span>
            <span class="n">elem</span><span class="o">.</span><span class="n">zoffset</span> <span class="o">*=</span> <span class="n">xyz_scale</span>
            <span class="k">if</span> <span class="n">elem</span><span class="o">.</span><span class="n">tflag</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">elem</span><span class="o">.</span><span class="n">T1</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="n">elem</span><span class="o">.</span><span class="n">T1</span> <span class="o">*=</span> <span class="n">xyz_scale</span>
                    <span class="n">elem</span><span class="o">.</span><span class="n">T2</span> <span class="o">*=</span> <span class="n">xyz_scale</span>
                    <span class="n">elem</span><span class="o">.</span><span class="n">T3</span> <span class="o">*=</span> <span class="n">xyz_scale</span>
            <span class="c1"># nsm</span>
            <span class="c1">#elem.nsm *= nsm_scale</span>

        <span class="k">elif</span> <span class="n">elem_type</span> <span class="ow">in</span> <span class="n">quad_shells</span><span class="p">:</span>
            <span class="c1"># thickness</span>
            <span class="c1"># tflag=blank/0 - Ti value: Ti is specified thickness</span>
            <span class="c1">#                 Ti blank: Ti is PSHELL value</span>
            <span class="c1"># tflag=0</span>
            <span class="c1"># tflag=1 - thicknesses are relative (Ti default=1.0)</span>
            <span class="c1">#</span>
            <span class="n">elem</span><span class="o">.</span><span class="n">zoffset</span> <span class="o">*=</span> <span class="n">xyz_scale</span>
            <span class="k">if</span> <span class="n">elem</span><span class="o">.</span><span class="n">tflag</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">elem</span><span class="o">.</span><span class="n">T1</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="n">elem</span><span class="o">.</span><span class="n">T1</span> <span class="o">*=</span> <span class="n">xyz_scale</span>
                <span class="k">if</span> <span class="n">elem</span><span class="o">.</span><span class="n">T2</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="n">elem</span><span class="o">.</span><span class="n">T2</span> <span class="o">*=</span> <span class="n">xyz_scale</span>
                <span class="k">if</span> <span class="n">elem</span><span class="o">.</span><span class="n">T3</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="n">elem</span><span class="o">.</span><span class="n">T3</span> <span class="o">*=</span> <span class="n">xyz_scale</span>
                <span class="k">if</span> <span class="n">elem</span><span class="o">.</span><span class="n">T4</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="n">elem</span><span class="o">.</span><span class="n">T4</span> <span class="o">*=</span> <span class="n">xyz_scale</span>
            <span class="c1"># nsm</span>
            <span class="c1">#elem.nsm *= nsm_scale</span>

        <span class="k">elif</span> <span class="n">elem_type</span> <span class="o">==</span> <span class="s1">&#39;CONROD&#39;</span><span class="p">:</span>
            <span class="n">elem</span><span class="o">.</span><span class="n">A</span> <span class="o">*=</span> <span class="n">area_scale</span> <span class="c1"># area</span>
            <span class="n">elem</span><span class="o">.</span><span class="n">nsm</span> <span class="o">*=</span> <span class="n">nsm_bar_scale</span>
        <span class="k">elif</span> <span class="n">elem_type</span> <span class="o">==</span> <span class="s1">&#39;CGAP&#39;</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">elem</span><span class="o">.</span><span class="n">g0</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="kc">None</span> <span class="ow">in</span> <span class="n">elem</span><span class="o">.</span><span class="n">x</span><span class="p">:</span>
                <span class="k">pass</span>
            <span class="k">elif</span> <span class="n">elem</span><span class="o">.</span><span class="n">x</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>  <span class="c1"># vector</span>
                <span class="n">elem</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span><span class="o">*</span><span class="n">xyz_scale</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">elem</span><span class="o">.</span><span class="n">x</span><span class="p">]</span>

            <span class="c1">#g0 = None</span>
            <span class="c1">#x = [None, None, None]</span>
            <span class="c1">#if elem.g0 is None and :  # vector</span>
                <span class="c1">#print(elem.get_stats())</span>
                <span class="c1">#elem.x = [x*xyz_scale for x in elem.x]</span>

        <span class="k">elif</span> <span class="n">elem_type</span> <span class="o">==</span> <span class="s1">&#39;CBAR&#39;</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">elem</span><span class="o">.</span><span class="n">x</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>  <span class="c1"># vector</span>
                <span class="n">elem</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span><span class="o">*</span><span class="n">xyz_scale</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">elem</span><span class="o">.</span><span class="n">x</span><span class="p">]</span>
            <span class="n">elem</span><span class="o">.</span><span class="n">wa</span> <span class="o">*=</span> <span class="n">xyz_scale</span>
            <span class="n">elem</span><span class="o">.</span><span class="n">wb</span> <span class="o">*=</span> <span class="n">xyz_scale</span>
        <span class="k">elif</span> <span class="n">elem_type</span> <span class="o">==</span> <span class="s1">&#39;CBEAM&#39;</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">elem</span><span class="o">.</span><span class="n">x</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>  <span class="c1"># vector</span>
                <span class="n">elem</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span><span class="o">*</span><span class="n">xyz_scale</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">elem</span><span class="o">.</span><span class="n">x</span><span class="p">]</span>
            <span class="n">elem</span><span class="o">.</span><span class="n">wa</span> <span class="o">*=</span> <span class="n">xyz_scale</span>
            <span class="n">elem</span><span class="o">.</span><span class="n">wb</span> <span class="o">*=</span> <span class="n">xyz_scale</span>
        <span class="k">elif</span> <span class="n">elem_type</span> <span class="o">==</span> <span class="s1">&#39;CBEAM3&#39;</span><span class="p">:</span>
            <span class="c1">#print(elem.get_stats())</span>
            <span class="k">if</span> <span class="n">elem</span><span class="o">.</span><span class="n">x</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>  <span class="c1"># vector</span>
                <span class="n">elem</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span><span class="o">*</span><span class="n">xyz_scale</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">elem</span><span class="o">.</span><span class="n">x</span><span class="p">]</span>
            <span class="n">elem</span><span class="o">.</span><span class="n">wa</span> <span class="o">*=</span> <span class="n">xyz_scale</span>
            <span class="n">elem</span><span class="o">.</span><span class="n">wb</span> <span class="o">*=</span> <span class="n">xyz_scale</span>
            <span class="n">elem</span><span class="o">.</span><span class="n">wc</span> <span class="o">*=</span> <span class="n">xyz_scale</span>
            <span class="c1"># s</span>
            <span class="c1"># tw</span>
        <span class="k">elif</span> <span class="n">elem_type</span> <span class="o">==</span> <span class="s1">&#39;CBEND&#39;</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">elem</span><span class="o">.</span><span class="n">x</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>  <span class="c1"># vector</span>
                <span class="n">elem</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span><span class="o">*</span><span class="n">xyz_scale</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">elem</span><span class="o">.</span><span class="n">x</span><span class="p">]</span>
        <span class="k">elif</span> <span class="n">elem_type</span> <span class="o">==</span> <span class="s1">&#39;CBUSH&#39;</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">elem</span><span class="o">.</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>  <span class="c1"># vector</span>
                <span class="n">elem</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span><span class="o">*</span><span class="n">xyz_scale</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">elem</span><span class="o">.</span><span class="n">x</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">elem</span><span class="o">.</span><span class="n">si</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>  <span class="c1"># vector</span>
                <span class="n">elem</span><span class="o">.</span><span class="n">si</span> <span class="o">=</span> <span class="p">[</span><span class="n">sii</span><span class="o">*</span><span class="n">xyz_scale</span> <span class="k">for</span> <span class="n">sii</span> <span class="ow">in</span> <span class="n">elem</span><span class="o">.</span><span class="n">si</span><span class="p">]</span>

        <span class="k">elif</span> <span class="n">elem_type</span> <span class="o">==</span> <span class="s1">&#39;GENEL&#39;</span><span class="p">:</span>
            <span class="c1"># I&#39;m pretty sure [S] this is unitless</span>
            <span class="k">if</span> <span class="n">elem</span><span class="o">.</span><span class="n">k</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">elem</span><span class="o">.</span><span class="n">k</span> <span class="o">*=</span> <span class="n">stiffness_scale</span>
            <span class="k">if</span> <span class="n">elem</span><span class="o">.</span><span class="n">z</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">elem</span><span class="o">.</span><span class="n">z</span> <span class="o">*=</span> <span class="n">flexibility_scale</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="s1">&#39;type=</span><span class="si">%r</span><span class="s1">; elem:</span><span class="se">\n</span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">elem</span><span class="o">.</span><span class="n">type</span><span class="p">,</span> <span class="n">elem</span><span class="p">))</span>

    <span class="k">for</span> <span class="n">elem</span> <span class="ow">in</span> <span class="n">model</span><span class="o">.</span><span class="n">masses</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
        <span class="n">elem_type</span> <span class="o">=</span> <span class="n">elem</span><span class="o">.</span><span class="n">type</span>
        <span class="k">if</span> <span class="n">elem_type</span> <span class="ow">in</span> <span class="n">skip_masses</span><span class="p">:</span>
            <span class="k">continue</span>
        <span class="k">if</span> <span class="n">elem_type</span> <span class="o">==</span> <span class="s1">&#39;CONM2&#39;</span><span class="p">:</span>
            <span class="n">elem</span><span class="o">.</span><span class="n">mass</span> <span class="o">*=</span> <span class="n">mass_scale</span>
            <span class="n">elem</span><span class="o">.</span><span class="n">X</span> <span class="o">*=</span> <span class="n">xyz_scale</span>
            <span class="c1"># I = m * r^2</span>
            <span class="n">elem</span><span class="o">.</span><span class="n">I</span> <span class="o">=</span> <span class="p">[</span><span class="n">moi</span> <span class="o">*</span> <span class="n">mass_moi_scale</span> <span class="k">for</span> <span class="n">moi</span> <span class="ow">in</span> <span class="n">elem</span><span class="o">.</span><span class="n">I</span><span class="p">]</span>
        <span class="k">elif</span> <span class="n">elem</span><span class="o">.</span><span class="n">type</span> <span class="o">==</span> <span class="s1">&#39;CONM1&#39;</span><span class="p">:</span>
            <span class="n">elem</span><span class="o">.</span><span class="n">mass_matrix</span> <span class="o">*=</span> <span class="n">mass_scale</span>
        <span class="k">elif</span> <span class="n">elem</span><span class="o">.</span><span class="n">type</span> <span class="o">==</span> <span class="s1">&#39;CMASS2&#39;</span><span class="p">:</span>
            <span class="n">elem</span><span class="o">.</span><span class="n">mass</span> <span class="o">*=</span> <span class="n">mass_scale</span>
        <span class="k">elif</span> <span class="n">elem</span><span class="o">.</span><span class="n">type</span> <span class="o">==</span> <span class="s1">&#39;CMASS4&#39;</span><span class="p">:</span>
            <span class="n">elem</span><span class="o">.</span><span class="n">mass</span> <span class="o">*=</span> <span class="n">mass_scale</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="n">elem</span><span class="p">)</span></div>

<div class="viewcode-block" id="_convert_properties"><a class="viewcode-back" href="../../../../reference/bdf/mesh_utils/pyNastran.bdf.mesh_utils.split_elements.html#pyNastran.bdf.mesh_utils.convert._convert_properties">[docs]</a><span class="k">def</span> <span class="nf">_convert_properties</span><span class="p">(</span><span class="n">model</span><span class="p">:</span> <span class="n">BDF</span><span class="p">,</span>
                        <span class="n">xyz_scale</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
                        <span class="n">time_scale</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
                        <span class="n">mass_scale</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
                        <span class="n">weight_scale</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
                        <span class="n">temperature_scale</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Converts the properties</span>

<span class="sd">    Supports:  PELAS, PDAMP, PDAMP5, PVISC, PROD, PBAR, PBARL, PBEAM, PBEAML,</span>
<span class="sd">               PSHELL, PSHEAR, PCOMP, PCOMPG, PELAS, PTUBE, PBUSH,</span>
<span class="sd">               PCONEAX, PGAP, PBUSH1D</span>
<span class="sd">    Skips : PSOLID, PLSOLID, PLPLANE, PIHEX</span>

<span class="sd">    Skips are unscaled (intentionally)</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">properties</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">return</span>

    <span class="n">force_scale</span> <span class="o">=</span> <span class="n">weight_scale</span>
    <span class="n">moment_scale</span> <span class="o">=</span> <span class="n">force_scale</span> <span class="o">*</span> <span class="n">xyz_scale</span>
    <span class="n">area_scale</span> <span class="o">=</span> <span class="n">xyz_scale</span> <span class="o">**</span> <span class="mi">2</span>
    <span class="n">area_moi_scale</span> <span class="o">=</span> <span class="n">xyz_scale</span> <span class="o">**</span> <span class="mi">4</span>
    <span class="n">velocity_scale</span> <span class="o">=</span> <span class="n">xyz_scale</span> <span class="o">/</span> <span class="n">time_scale</span>

    <span class="c1"># there are multiple nsm scales (CONM2, bar, plate)</span>
    <span class="n">nsm_bar_scale</span> <span class="o">=</span> <span class="n">mass_scale</span> <span class="o">/</span> <span class="n">xyz_scale</span>
    <span class="n">nsm_plate_scale</span> <span class="o">=</span> <span class="n">mass_scale</span> <span class="o">/</span> <span class="n">xyz_scale</span> <span class="o">**</span> <span class="mi">2</span>
    <span class="n">stiffness_scale</span> <span class="o">=</span> <span class="n">force_scale</span> <span class="o">/</span> <span class="n">xyz_scale</span>
    <span class="n">damping_scale</span> <span class="o">=</span> <span class="n">force_scale</span> <span class="o">/</span> <span class="n">velocity_scale</span>
    <span class="n">stress_scale</span> <span class="o">=</span> <span class="n">force_scale</span> <span class="o">/</span> <span class="n">xyz_scale</span> <span class="o">**</span> <span class="mi">2</span>
    <span class="n">area_moi_length</span> <span class="o">=</span> <span class="n">area_moi_scale</span> <span class="o">/</span> <span class="n">xyz_scale</span>

    <span class="c1"># I, to the bending moment of inertia of a homogeneous shell, T3/12.</span>
    <span class="c1"># t^3 has a factor of L^3, so for a factor of 1</span>
    <span class="c1"># This is always 1.0.</span>
    <span class="c1">#plate_inertia = 1.</span>

    <span class="n">log</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">log</span>
    <span class="n">log</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s1">&#39;--Property Scales--&#39;</span><span class="p">)</span>
    <span class="n">log</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s1">&#39;nsm_bar_scale (M/L) = </span><span class="si">%g</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">nsm_bar_scale</span><span class="p">)</span>
    <span class="n">log</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s1">&#39;nsm_plate_scale (M/L^2) = </span><span class="si">%g</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">nsm_plate_scale</span><span class="p">)</span>
    <span class="n">log</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s1">&#39;stiffness_scale (F/L) = </span><span class="si">%g</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">stiffness_scale</span><span class="p">)</span>
    <span class="n">log</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s1">&#39;damping_scale (F/V) = </span><span class="si">%g</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">damping_scale</span><span class="p">)</span>
    <span class="n">log</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s1">&#39;stress_scale (F/L^2) = </span><span class="si">%g</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">stress_scale</span><span class="p">)</span>

    <span class="n">skip_properties</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s1">&#39;PSOLID&#39;</span><span class="p">,</span> <span class="s1">&#39;PLSOLID&#39;</span><span class="p">,</span> <span class="s1">&#39;PLPLANE&#39;</span><span class="p">,</span> <span class="s1">&#39;PIHEX&#39;</span><span class="p">,</span>

        <span class="c1"># TODO: NX-verify</span>
        <span class="s1">&#39;PPLANE&#39;</span><span class="p">,</span>

        <span class="c1"># acoustic</span>
        <span class="s1">&#39;PACABS&#39;</span><span class="p">,</span>
    <span class="p">}</span>

    <span class="c1"># we don&#39;t need to convert PBUSHT, PELAST, PDAMPT</span>
    <span class="k">for</span> <span class="n">prop</span> <span class="ow">in</span> <span class="n">model</span><span class="o">.</span><span class="n">properties</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
        <span class="n">prop_type</span> <span class="o">=</span> <span class="n">prop</span><span class="o">.</span><span class="n">type</span>
        <span class="k">if</span> <span class="n">prop_type</span> <span class="ow">in</span> <span class="n">skip_properties</span><span class="p">:</span>
            <span class="k">continue</span>
        <span class="k">elif</span> <span class="n">prop_type</span> <span class="o">==</span> <span class="s1">&#39;PELAS&#39;</span><span class="p">:</span>
            <span class="n">prop</span><span class="o">.</span><span class="n">k</span> <span class="o">*=</span> <span class="n">stiffness_scale</span>
        <span class="k">elif</span> <span class="n">prop_type</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;PDAMP&#39;</span><span class="p">,</span> <span class="s1">&#39;PDAMP5&#39;</span><span class="p">]:</span>
            <span class="n">prop</span><span class="o">.</span><span class="n">b</span> <span class="o">*=</span> <span class="n">damping_scale</span> <span class="c1"># force_scale / velocity_scale</span>
        <span class="k">elif</span> <span class="n">prop_type</span> <span class="o">==</span> <span class="s1">&#39;PVISC&#39;</span><span class="p">:</span>
            <span class="n">prop</span><span class="o">.</span><span class="n">ce</span> <span class="o">*=</span> <span class="n">force_scale</span> <span class="o">/</span> <span class="n">velocity_scale</span>
            <span class="n">prop</span><span class="o">.</span><span class="n">cr</span> <span class="o">*=</span> <span class="n">moment_scale</span> <span class="o">/</span> <span class="n">velocity_scale</span>

        <span class="k">elif</span> <span class="n">prop_type</span> <span class="o">==</span> <span class="s1">&#39;PROD&#39;</span><span class="p">:</span>
            <span class="n">prop</span><span class="o">.</span><span class="n">A</span> <span class="o">*=</span> <span class="n">area_scale</span>
            <span class="n">prop</span><span class="o">.</span><span class="n">j</span> <span class="o">*=</span> <span class="n">area_moi_scale</span>
            <span class="c1">#prop.c ???</span>

        <span class="k">elif</span> <span class="n">prop_type</span> <span class="o">==</span> <span class="s1">&#39;PBAR&#39;</span><span class="p">:</span>
            <span class="n">_convert_pbar</span><span class="p">(</span><span class="n">prop</span><span class="p">,</span> <span class="n">xyz_scale</span><span class="p">,</span> <span class="n">area_scale</span><span class="p">,</span> <span class="n">area_moi_scale</span><span class="p">,</span> <span class="n">nsm_bar_scale</span><span class="p">)</span>

        <span class="k">elif</span> <span class="n">prop_type</span> <span class="o">==</span> <span class="s1">&#39;PBARL&#39;</span><span class="p">:</span>
            <span class="n">prop</span><span class="o">.</span><span class="n">dim</span> <span class="o">=</span> <span class="p">[</span><span class="n">d</span> <span class="o">*</span> <span class="n">xyz_scale</span> <span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="n">prop</span><span class="o">.</span><span class="n">dim</span><span class="p">]</span>
            <span class="n">prop</span><span class="o">.</span><span class="n">nsm</span> <span class="o">*=</span> <span class="n">nsm_bar_scale</span>

        <span class="k">elif</span> <span class="n">prop_type</span> <span class="o">==</span> <span class="s1">&#39;PBEAM&#39;</span><span class="p">:</span>
            <span class="n">_convert_pbeam</span><span class="p">(</span><span class="n">prop</span><span class="p">,</span> <span class="n">xyz_scale</span><span class="p">,</span> <span class="n">area_scale</span><span class="p">,</span> <span class="n">area_moi_scale</span><span class="p">,</span> <span class="n">nsm_bar_scale</span><span class="p">)</span>

        <span class="k">elif</span> <span class="n">prop_type</span> <span class="o">==</span> <span class="s1">&#39;PBEAML&#39;</span><span class="p">:</span>
            <span class="n">prop</span><span class="o">.</span><span class="n">dim</span> <span class="o">*=</span> <span class="n">xyz_scale</span>
            <span class="n">prop</span><span class="o">.</span><span class="n">nsm</span> <span class="o">*=</span> <span class="n">nsm_bar_scale</span>
        <span class="k">elif</span> <span class="n">prop_type</span> <span class="o">==</span> <span class="s1">&#39;PBEAM3&#39;</span><span class="p">:</span>
            <span class="n">_convert_pbeam3</span><span class="p">(</span><span class="n">prop</span><span class="p">,</span> <span class="n">xyz_scale</span><span class="p">,</span> <span class="n">area_scale</span><span class="p">,</span> <span class="n">area_moi_scale</span><span class="p">,</span> <span class="n">nsm_bar_scale</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">prop_type</span> <span class="o">==</span> <span class="s1">&#39;PSHELL&#39;</span><span class="p">:</span>
            <span class="n">prop</span><span class="o">.</span><span class="n">t</span> <span class="o">*=</span> <span class="n">xyz_scale</span>
            <span class="n">prop</span><span class="o">.</span><span class="n">nsm</span> <span class="o">*=</span> <span class="n">nsm_plate_scale</span>
            <span class="n">prop</span><span class="o">.</span><span class="n">z1</span> <span class="o">*=</span> <span class="n">xyz_scale</span>
            <span class="n">prop</span><span class="o">.</span><span class="n">z2</span> <span class="o">*=</span> <span class="n">xyz_scale</span>
            <span class="c1"># prop.twelveIt3  # this is unchanged</span>
        <span class="k">elif</span> <span class="n">prop_type</span> <span class="o">==</span> <span class="s1">&#39;PSHEAR&#39;</span><span class="p">:</span>
            <span class="n">prop</span><span class="o">.</span><span class="n">t</span> <span class="o">*=</span> <span class="n">xyz_scale</span>
            <span class="n">prop</span><span class="o">.</span><span class="n">nsm</span> <span class="o">*=</span> <span class="n">nsm_plate_scale</span>

        <span class="k">elif</span> <span class="n">prop_type</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;PCOMP&#39;</span><span class="p">,</span> <span class="s1">&#39;PCOMPG&#39;</span><span class="p">]:</span>
            <span class="n">prop</span><span class="o">.</span><span class="n">thicknesses</span> <span class="o">=</span> <span class="p">[</span><span class="n">t</span> <span class="o">*</span> <span class="n">xyz_scale</span> <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">prop</span><span class="o">.</span><span class="n">thicknesses</span><span class="p">]</span>
            <span class="n">prop</span><span class="o">.</span><span class="n">nsm</span> <span class="o">*=</span> <span class="n">nsm_plate_scale</span>
            <span class="n">prop</span><span class="o">.</span><span class="n">z0</span> <span class="o">*=</span> <span class="n">xyz_scale</span>
            <span class="n">prop</span><span class="o">.</span><span class="n">sb</span> <span class="o">*=</span> <span class="n">stress_scale</span>

        <span class="k">elif</span> <span class="n">prop_type</span> <span class="o">==</span> <span class="s1">&#39;PELAS&#39;</span><span class="p">:</span>
            <span class="n">prop</span><span class="o">.</span><span class="n">k</span> <span class="o">*=</span> <span class="n">stiffness_scale</span>
        <span class="k">elif</span> <span class="n">prop_type</span> <span class="o">==</span> <span class="s1">&#39;PTUBE&#39;</span><span class="p">:</span>
            <span class="n">prop</span><span class="o">.</span><span class="n">OD1</span> <span class="o">*=</span> <span class="n">xyz_scale</span>
            <span class="n">prop</span><span class="o">.</span><span class="n">OD2</span> <span class="o">*=</span> <span class="n">xyz_scale</span>
            <span class="n">prop</span><span class="o">.</span><span class="n">t</span> <span class="o">*=</span> <span class="n">xyz_scale</span>
            <span class="n">prop</span><span class="o">.</span><span class="n">nsm</span> <span class="o">*=</span> <span class="n">nsm_bar_scale</span>

        <span class="k">elif</span> <span class="n">prop_type</span> <span class="o">==</span> <span class="s1">&#39;PBUSH&#39;</span><span class="p">:</span>
            <span class="n">_convert_pbush</span><span class="p">(</span><span class="n">prop</span><span class="p">,</span> <span class="n">velocity_scale</span><span class="p">,</span> <span class="n">mass_scale</span><span class="p">,</span> <span class="n">stiffness_scale</span><span class="p">,</span> <span class="n">log</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">prop</span><span class="o">.</span><span class="n">type</span> <span class="o">==</span> <span class="s1">&#39;PBUSH1D&#39;</span><span class="p">:</span>
            <span class="n">_convert_pbush1d</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">prop</span><span class="p">,</span> <span class="n">xyz_scale</span><span class="p">,</span> <span class="n">area_scale</span><span class="p">,</span>
                             <span class="n">mass_scale</span><span class="p">,</span> <span class="n">damping_scale</span><span class="p">,</span> <span class="n">stiffness_scale</span><span class="p">)</span>

        <span class="c1">#elif prop.type == &#39;PCOMPS&#39;:</span>
            <span class="c1">#pass</span>
        <span class="k">elif</span> <span class="n">prop</span><span class="o">.</span><span class="n">type</span> <span class="o">==</span> <span class="s1">&#39;PCONEAX&#39;</span><span class="p">:</span>
            <span class="c1">#T1 Membrane thickness. (Real &gt; 0.0 if MID1 = 0)</span>
            <span class="c1">#T2 Transverse shear thickness. (Real &gt; 0.0 if MID3 = 0)</span>
            <span class="c1">#I Moment of inertia per unit width. (Real)</span>
            <span class="c1">#NSM Nonstructural mass per unit area. (Real)</span>
            <span class="c1">#Z1, Z2 Fiber distances from the middle surface for stress recovery. (Real)</span>
            <span class="c1">#prop.mid1 = mid1</span>
            <span class="k">if</span> <span class="n">prop</span><span class="o">.</span><span class="n">t1</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">prop</span><span class="o">.</span><span class="n">t1</span> <span class="o">*=</span> <span class="n">xyz_scale</span>
            <span class="k">if</span> <span class="n">prop</span><span class="o">.</span><span class="n">i</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">prop</span><span class="o">.</span><span class="n">i</span> <span class="o">*=</span> <span class="n">area_moi_length</span>
            <span class="k">if</span> <span class="n">prop</span><span class="o">.</span><span class="n">t2</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">prop</span><span class="o">.</span><span class="n">t2</span> <span class="o">*=</span> <span class="n">xyz_scale</span>
            <span class="n">prop</span><span class="o">.</span><span class="n">nsm</span> <span class="o">*=</span> <span class="n">nsm_plate_scale</span>
            <span class="n">prop</span><span class="o">.</span><span class="n">z1</span> <span class="o">*=</span> <span class="n">xyz_scale</span>
            <span class="n">prop</span><span class="o">.</span><span class="n">z2</span> <span class="o">*=</span> <span class="n">xyz_scale</span>

        <span class="c1">#elif prop.type == &#39;PBCOMP&#39;:</span>
            <span class="c1">#pass</span>
        <span class="c1">#elif prop.type == &#39;PPLANE&#39;:</span>
            <span class="c1">#pass</span>
        <span class="c1">#elif prop.type == &#39;PRAC2D&#39;:</span>
            <span class="c1">#pass</span>
        <span class="c1">#elif prop.type == &#39;PRAC3D&#39;:</span>
            <span class="c1">#pass</span>
        <span class="c1">#elif prop.type == &#39;PFAST&#39;:</span>
            <span class="c1">#pass</span>
        <span class="c1">#elif prop.type == &#39;PDAMP&#39;:</span>
            <span class="c1">#pass</span>
        <span class="c1">#elif prop.type == &#39;PELAST&#39;:</span>
            <span class="c1">#pass</span>
        <span class="c1">#elif prop.type == &#39;PBUSHT&#39;:</span>
            <span class="c1">#pass</span>
        <span class="c1">#elif prop.type == &#39;PDAMPT&#39;:</span>
            <span class="c1">#pass</span>
        <span class="c1">#elif prop.type == &#39;PDAMP5&#39;:</span>
            <span class="c1">#pass</span>
        <span class="k">elif</span> <span class="n">prop</span><span class="o">.</span><span class="n">type</span> <span class="o">==</span> <span class="s1">&#39;PGAP&#39;</span><span class="p">:</span>
            <span class="c1">#: initial gap opening</span>
            <span class="n">prop</span><span class="o">.</span><span class="n">u0</span> <span class="o">*=</span> <span class="n">xyz_scale</span>
            <span class="c1">#: preload</span>
            <span class="n">prop</span><span class="o">.</span><span class="n">f0</span> <span class="o">*=</span> <span class="n">force_scale</span>

            <span class="c1">#: axial stiffness of closed/open gap</span>
            <span class="n">prop</span><span class="o">.</span><span class="n">ka</span> <span class="o">*=</span> <span class="n">stiffness_scale</span>
            <span class="n">prop</span><span class="o">.</span><span class="n">kb</span> <span class="o">*=</span> <span class="n">stiffness_scale</span>

            <span class="c1">#: transverse stiffness of closed gap</span>
            <span class="n">prop</span><span class="o">.</span><span class="n">kt</span> <span class="o">*=</span> <span class="n">stiffness_scale</span>

        <span class="k">elif</span> <span class="n">prop_type</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;PBEND&#39;</span><span class="p">,</span> <span class="s1">&#39;PBCOMP&#39;</span><span class="p">,</span> <span class="s1">&#39;PBUSH2D&#39;</span><span class="p">]:</span>
            <span class="n">model</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s1">&#39;skipping </span><span class="si">%s</span><span class="s1"> convert&#39;</span> <span class="o">%</span> <span class="n">prop_type</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">prop_type</span> <span class="o">==</span> <span class="s1">&#39;PCOMPS&#39;</span><span class="p">:</span>
            <span class="n">prop</span><span class="o">.</span><span class="n">thicknesses</span> <span class="o">*=</span> <span class="n">xyz_scale</span>
            <span class="n">prop</span><span class="o">.</span><span class="n">tref</span> <span class="o">*=</span> <span class="n">temperature_scale</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">prop</span><span class="o">.</span><span class="n">get_stats</span><span class="p">()</span><span class="si">}</span><span class="se">\n</span><span class="si">{</span><span class="n">prop</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span></div>

<div class="viewcode-block" id="_convert_pbar"><a class="viewcode-back" href="../../../../reference/bdf/mesh_utils/pyNastran.bdf.mesh_utils.split_elements.html#pyNastran.bdf.mesh_utils.convert._convert_pbar">[docs]</a><span class="k">def</span> <span class="nf">_convert_pbar</span><span class="p">(</span><span class="n">prop</span><span class="p">:</span> <span class="n">PBAR</span><span class="p">,</span>
                  <span class="n">xyz_scale</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
                  <span class="n">area_scale</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
                  <span class="n">area_moi_scale</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
                  <span class="n">nsm_bar_scale</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;converts a PBAR&quot;&quot;&quot;</span>
    <span class="n">prop</span><span class="o">.</span><span class="n">A</span> <span class="o">*=</span> <span class="n">area_scale</span>
    <span class="n">prop</span><span class="o">.</span><span class="n">i1</span> <span class="o">*=</span> <span class="n">area_moi_scale</span>
    <span class="n">prop</span><span class="o">.</span><span class="n">i2</span> <span class="o">*=</span> <span class="n">area_moi_scale</span>
    <span class="n">prop</span><span class="o">.</span><span class="n">i12</span> <span class="o">*=</span> <span class="n">area_moi_scale</span>
    <span class="n">prop</span><span class="o">.</span><span class="n">j</span> <span class="o">*=</span> <span class="n">area_moi_scale</span>
    <span class="n">prop</span><span class="o">.</span><span class="n">nsm</span> <span class="o">*=</span> <span class="n">nsm_bar_scale</span>
    <span class="n">prop</span><span class="o">.</span><span class="n">c1</span> <span class="o">*=</span> <span class="n">xyz_scale</span>
    <span class="n">prop</span><span class="o">.</span><span class="n">c2</span> <span class="o">*=</span> <span class="n">xyz_scale</span>
    <span class="n">prop</span><span class="o">.</span><span class="n">d1</span> <span class="o">*=</span> <span class="n">xyz_scale</span>
    <span class="n">prop</span><span class="o">.</span><span class="n">d2</span> <span class="o">*=</span> <span class="n">xyz_scale</span>
    <span class="n">prop</span><span class="o">.</span><span class="n">e1</span> <span class="o">*=</span> <span class="n">xyz_scale</span>
    <span class="n">prop</span><span class="o">.</span><span class="n">e2</span> <span class="o">*=</span> <span class="n">xyz_scale</span>
    <span class="n">prop</span><span class="o">.</span><span class="n">f1</span> <span class="o">*=</span> <span class="n">xyz_scale</span>
    <span class="n">prop</span><span class="o">.</span><span class="n">f2</span> <span class="o">*=</span> <span class="n">xyz_scale</span></div>

<div class="viewcode-block" id="_convert_pbeam"><a class="viewcode-back" href="../../../../reference/bdf/mesh_utils/pyNastran.bdf.mesh_utils.split_elements.html#pyNastran.bdf.mesh_utils.convert._convert_pbeam">[docs]</a><span class="k">def</span> <span class="nf">_convert_pbeam</span><span class="p">(</span><span class="n">prop</span><span class="p">:</span> <span class="n">PBEAM</span><span class="p">,</span>
                   <span class="n">xyz_scale</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
                   <span class="n">area_scale</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
                   <span class="n">area_moi_scale</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
                   <span class="n">nsm_bar_scale</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;converts a PBEAM&quot;&quot;&quot;</span>
    <span class="n">prop</span><span class="o">.</span><span class="n">A</span> <span class="o">*=</span> <span class="n">area_scale</span>
    <span class="n">prop</span><span class="o">.</span><span class="n">i1</span> <span class="o">*=</span> <span class="n">area_moi_scale</span>
    <span class="n">prop</span><span class="o">.</span><span class="n">i2</span> <span class="o">*=</span> <span class="n">area_moi_scale</span>
    <span class="n">prop</span><span class="o">.</span><span class="n">i12</span> <span class="o">*=</span> <span class="n">area_moi_scale</span>
    <span class="n">prop</span><span class="o">.</span><span class="n">j</span> <span class="o">*=</span> <span class="n">area_moi_scale</span>
    <span class="n">prop</span><span class="o">.</span><span class="n">nsm</span> <span class="o">*=</span> <span class="n">nsm_bar_scale</span>
    <span class="n">prop</span><span class="o">.</span><span class="n">c1</span> <span class="o">*=</span> <span class="n">xyz_scale</span>
    <span class="n">prop</span><span class="o">.</span><span class="n">c2</span> <span class="o">*=</span> <span class="n">xyz_scale</span>
    <span class="n">prop</span><span class="o">.</span><span class="n">d1</span> <span class="o">*=</span> <span class="n">xyz_scale</span>
    <span class="n">prop</span><span class="o">.</span><span class="n">d2</span> <span class="o">*=</span> <span class="n">xyz_scale</span>
    <span class="n">prop</span><span class="o">.</span><span class="n">e1</span> <span class="o">*=</span> <span class="n">xyz_scale</span>
    <span class="n">prop</span><span class="o">.</span><span class="n">e2</span> <span class="o">*=</span> <span class="n">xyz_scale</span>
    <span class="n">prop</span><span class="o">.</span><span class="n">f1</span> <span class="o">*=</span> <span class="n">xyz_scale</span>
    <span class="n">prop</span><span class="o">.</span><span class="n">f2</span> <span class="o">*=</span> <span class="n">xyz_scale</span>

    <span class="n">prop</span><span class="o">.</span><span class="n">m1a</span> <span class="o">*=</span> <span class="n">xyz_scale</span>
    <span class="n">prop</span><span class="o">.</span><span class="n">m2a</span> <span class="o">*=</span> <span class="n">xyz_scale</span>
    <span class="n">prop</span><span class="o">.</span><span class="n">m1b</span> <span class="o">*=</span> <span class="n">xyz_scale</span>
    <span class="n">prop</span><span class="o">.</span><span class="n">m2b</span> <span class="o">*=</span> <span class="n">xyz_scale</span>
    <span class="n">prop</span><span class="o">.</span><span class="n">n1a</span> <span class="o">*=</span> <span class="n">xyz_scale</span>
    <span class="n">prop</span><span class="o">.</span><span class="n">n2a</span> <span class="o">*=</span> <span class="n">xyz_scale</span>
    <span class="n">prop</span><span class="o">.</span><span class="n">n1b</span> <span class="o">*=</span> <span class="n">xyz_scale</span>
    <span class="n">prop</span><span class="o">.</span><span class="n">n2b</span> <span class="o">*=</span> <span class="n">xyz_scale</span></div>

<div class="viewcode-block" id="_convert_pbeam3"><a class="viewcode-back" href="../../../../reference/bdf/mesh_utils/pyNastran.bdf.mesh_utils.split_elements.html#pyNastran.bdf.mesh_utils.convert._convert_pbeam3">[docs]</a><span class="k">def</span> <span class="nf">_convert_pbeam3</span><span class="p">(</span><span class="n">prop</span><span class="p">:</span> <span class="n">PBEAM3</span><span class="p">,</span>
                    <span class="n">xyz_scale</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
                    <span class="n">area_scale</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
                    <span class="n">area_moi_scale</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
                    <span class="n">nsm_bar_scale</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;converts a PBEAM3&quot;&quot;&quot;</span>
    <span class="n">prop</span><span class="o">.</span><span class="n">A</span> <span class="o">=</span> <span class="p">[</span><span class="n">areai</span> <span class="o">*</span> <span class="n">area_scale</span> <span class="k">for</span> <span class="n">areai</span> <span class="ow">in</span> <span class="n">prop</span><span class="o">.</span><span class="n">A</span><span class="p">]</span>
    <span class="c1"># cw</span>

    <span class="n">prop</span><span class="o">.</span><span class="n">cy</span> <span class="o">=</span> <span class="p">[</span><span class="n">ci</span> <span class="o">*</span> <span class="n">xyz_scale</span> <span class="k">for</span> <span class="n">ci</span> <span class="ow">in</span> <span class="n">prop</span><span class="o">.</span><span class="n">cy</span><span class="p">]</span>
    <span class="n">prop</span><span class="o">.</span><span class="n">cz</span> <span class="o">=</span> <span class="p">[</span><span class="n">ci</span> <span class="o">*</span> <span class="n">xyz_scale</span> <span class="k">for</span> <span class="n">ci</span> <span class="ow">in</span> <span class="n">prop</span><span class="o">.</span><span class="n">cz</span><span class="p">]</span>
    <span class="n">prop</span><span class="o">.</span><span class="n">dy</span> <span class="o">=</span> <span class="p">[</span><span class="n">ci</span> <span class="o">*</span> <span class="n">xyz_scale</span> <span class="k">for</span> <span class="n">ci</span> <span class="ow">in</span> <span class="n">prop</span><span class="o">.</span><span class="n">dy</span><span class="p">]</span>
    <span class="n">prop</span><span class="o">.</span><span class="n">dz</span> <span class="o">=</span> <span class="p">[</span><span class="n">ci</span> <span class="o">*</span> <span class="n">xyz_scale</span> <span class="k">for</span> <span class="n">ci</span> <span class="ow">in</span> <span class="n">prop</span><span class="o">.</span><span class="n">dz</span><span class="p">]</span>
    <span class="n">prop</span><span class="o">.</span><span class="n">ey</span> <span class="o">=</span> <span class="p">[</span><span class="n">ci</span> <span class="o">*</span> <span class="n">xyz_scale</span> <span class="k">for</span> <span class="n">ci</span> <span class="ow">in</span> <span class="n">prop</span><span class="o">.</span><span class="n">ey</span><span class="p">]</span>
    <span class="n">prop</span><span class="o">.</span><span class="n">ez</span> <span class="o">=</span> <span class="p">[</span><span class="n">ci</span> <span class="o">*</span> <span class="n">xyz_scale</span> <span class="k">for</span> <span class="n">ci</span> <span class="ow">in</span> <span class="n">prop</span><span class="o">.</span><span class="n">ez</span><span class="p">]</span>
    <span class="n">prop</span><span class="o">.</span><span class="n">fy</span> <span class="o">=</span> <span class="p">[</span><span class="n">ci</span> <span class="o">*</span> <span class="n">xyz_scale</span> <span class="k">for</span> <span class="n">ci</span> <span class="ow">in</span> <span class="n">prop</span><span class="o">.</span><span class="n">fy</span><span class="p">]</span>
    <span class="n">prop</span><span class="o">.</span><span class="n">fz</span> <span class="o">=</span> <span class="p">[</span><span class="n">ci</span> <span class="o">*</span> <span class="n">xyz_scale</span> <span class="k">for</span> <span class="n">ci</span> <span class="ow">in</span> <span class="n">prop</span><span class="o">.</span><span class="n">fz</span><span class="p">]</span>

    <span class="k">if</span> <span class="n">prop</span><span class="o">.</span><span class="n">i1</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">prop</span><span class="o">.</span><span class="n">i1</span> <span class="o">=</span> <span class="p">[</span><span class="n">i1i</span> <span class="o">*</span> <span class="n">area_moi_scale</span> <span class="k">for</span> <span class="n">i1i</span> <span class="ow">in</span> <span class="n">prop</span><span class="o">.</span><span class="n">i1</span><span class="p">]</span>
    <span class="k">if</span> <span class="n">prop</span><span class="o">.</span><span class="n">i2</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">prop</span><span class="o">.</span><span class="n">i2</span> <span class="o">=</span> <span class="p">[</span><span class="n">i2i</span> <span class="o">*</span> <span class="n">area_moi_scale</span> <span class="k">for</span> <span class="n">i2i</span> <span class="ow">in</span> <span class="n">prop</span><span class="o">.</span><span class="n">i2</span><span class="p">]</span>
    <span class="k">if</span> <span class="n">prop</span><span class="o">.</span><span class="n">i12</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">prop</span><span class="o">.</span><span class="n">i12</span> <span class="o">=</span> <span class="p">[</span><span class="n">i12i</span> <span class="o">*</span> <span class="n">area_moi_scale</span> <span class="k">for</span> <span class="n">i12i</span> <span class="ow">in</span> <span class="n">prop</span><span class="o">.</span><span class="n">i12</span><span class="p">]</span>
    <span class="n">prop</span><span class="o">.</span><span class="n">j</span> <span class="o">=</span> <span class="p">[</span><span class="n">ji</span> <span class="o">*</span> <span class="n">area_moi_scale</span> <span class="k">for</span> <span class="n">ji</span> <span class="ow">in</span> <span class="n">prop</span><span class="o">.</span><span class="n">j</span><span class="p">]</span>
    <span class="n">prop</span><span class="o">.</span><span class="n">nsm</span> <span class="o">=</span> <span class="p">[</span><span class="n">nsmi</span> <span class="o">*</span> <span class="n">nsm_bar_scale</span> <span class="k">for</span> <span class="n">nsmi</span> <span class="ow">in</span> <span class="n">prop</span><span class="o">.</span><span class="n">nsm</span><span class="p">]</span></div>

    <span class="c1">#my</span>
    <span class="c1">#mz</span>
    <span class="c1">#nsiy</span>
    <span class="c1">#nsiyz</span>
    <span class="c1">#nsiz</span>
    <span class="c1">#ny</span>
    <span class="c1">#nz</span>
    <span class="c1"># w</span>

<div class="viewcode-block" id="_convert_pbush"><a class="viewcode-back" href="../../../../reference/bdf/mesh_utils/pyNastran.bdf.mesh_utils.split_elements.html#pyNastran.bdf.mesh_utils.convert._convert_pbush">[docs]</a><span class="k">def</span> <span class="nf">_convert_pbush</span><span class="p">(</span><span class="n">prop</span><span class="p">:</span> <span class="n">PBUSH</span><span class="p">,</span>
                   <span class="n">velocity_scale</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
                   <span class="n">mass_scale</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
                   <span class="n">stiffness_scale</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
                   <span class="n">log</span><span class="p">:</span> <span class="n">SimpleLogger</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
    <span class="c1"># can be length=0</span>
    <span class="c1">#assert len(prop.Ki) == 6, prop.Ki</span>
    <span class="c1">#assert len(prop.Bi) == 6, prop.Bi</span>
    <span class="k">for</span> <span class="n">var</span> <span class="ow">in</span> <span class="n">prop</span><span class="o">.</span><span class="n">vars</span><span class="p">:</span>
        <span class="c1"># TODO: I think this needs to consider rotation</span>
        <span class="k">if</span> <span class="n">var</span> <span class="o">==</span> <span class="s1">&#39;K&#39;</span><span class="p">:</span>
            <span class="n">prop</span><span class="o">.</span><span class="n">Ki</span> <span class="o">=</span> <span class="p">[</span><span class="n">ki</span><span class="o">*</span><span class="n">stiffness_scale</span> <span class="k">if</span> <span class="n">ki</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="kc">None</span>
                       <span class="k">for</span> <span class="n">ki</span> <span class="ow">in</span> <span class="n">prop</span><span class="o">.</span><span class="n">Ki</span><span class="p">]</span>
        <span class="k">elif</span> <span class="n">var</span> <span class="o">==</span> <span class="s1">&#39;B&#39;</span><span class="p">:</span>
            <span class="n">prop</span><span class="o">.</span><span class="n">Bi</span> <span class="o">=</span> <span class="p">[</span><span class="n">bi</span><span class="o">*</span><span class="n">velocity_scale</span> <span class="k">if</span> <span class="n">bi</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="kc">None</span>
                       <span class="k">for</span> <span class="n">bi</span> <span class="ow">in</span> <span class="n">prop</span><span class="o">.</span><span class="n">Bi</span><span class="p">]</span>
        <span class="k">elif</span> <span class="n">var</span> <span class="o">==</span> <span class="s1">&#39;RCV&#39;</span><span class="p">:</span>
            <span class="n">log</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s1">&#39;Skipping RCV for PBUSH </span><span class="si">%i</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">prop</span><span class="o">.</span><span class="n">pid</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">var</span> <span class="o">==</span> <span class="s1">&#39;GE&#39;</span><span class="p">:</span>
            <span class="k">pass</span>
        <span class="k">else</span><span class="p">:</span>  <span class="c1"># pragma: no cover</span>
            <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="n">prop</span><span class="p">)</span>

    <span class="c1">#prop.rcv</span>
    <span class="k">if</span> <span class="n">prop</span><span class="o">.</span><span class="n">mass</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">prop</span><span class="o">.</span><span class="n">mass</span> <span class="o">*=</span> <span class="n">mass_scale</span></div>
    <span class="c1">#rcv : List[float]; default=None -&gt; (None, None, None, None)</span>
        <span class="c1">#[sa, st, ea, et] = rcv</span>
        <span class="c1">#length(mass_fields) = 4</span>
    <span class="c1">#mass : float; default=None</span>
        <span class="c1">#lumped mass of the CBUSH</span>
        <span class="c1">#This is an MSC only parameter.</span>

<div class="viewcode-block" id="_convert_pbush1d"><a class="viewcode-back" href="../../../../reference/bdf/mesh_utils/pyNastran.bdf.mesh_utils.split_elements.html#pyNastran.bdf.mesh_utils.convert._convert_pbush1d">[docs]</a><span class="k">def</span> <span class="nf">_convert_pbush1d</span><span class="p">(</span><span class="n">model</span><span class="p">:</span> <span class="n">BDF</span><span class="p">,</span>
                     <span class="n">prop</span><span class="p">:</span> <span class="n">PBUSH1D</span><span class="p">,</span>
                     <span class="n">xyz_scale</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
                     <span class="n">area_scale</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
                     <span class="n">mass_scale</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
                     <span class="n">damping_scale</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
                     <span class="n">stiffness_scale</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
    <span class="n">prop</span><span class="o">.</span><span class="n">c</span> <span class="o">*=</span> <span class="n">damping_scale</span> <span class="c1"># Viscous damping (force/velocity)</span>
    <span class="n">prop</span><span class="o">.</span><span class="n">k</span> <span class="o">*=</span> <span class="n">stiffness_scale</span>
    <span class="n">prop</span><span class="o">.</span><span class="n">m</span> <span class="o">*=</span> <span class="n">mass_scale</span>
    <span class="n">prop</span><span class="o">.</span><span class="n">sa</span> <span class="o">/=</span> <span class="n">area_scale</span>  <span class="c1"># Stress recovery coefficient [1/area]</span>
    <span class="n">prop</span><span class="o">.</span><span class="n">se</span> <span class="o">/=</span> <span class="n">xyz_scale</span>   <span class="c1"># Strain recovery coefficient [1/length]</span>
    <span class="n">spring_tables</span> <span class="o">=</span> <span class="nb">set</span><span class="p">([])</span>
    <span class="n">damper_tables</span> <span class="o">=</span> <span class="nb">set</span><span class="p">([])</span>
    <span class="k">for</span> <span class="n">var</span> <span class="ow">in</span> <span class="n">prop</span><span class="o">.</span><span class="n">vars</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">var</span> <span class="o">==</span> <span class="s1">&#39;SHOCKA&#39;</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">prop</span><span class="o">.</span><span class="n">get_stats</span><span class="p">())</span>
             <span class="c1"># Viscous damping coefficient (force/velocity)</span>
            <span class="n">prop</span><span class="o">.</span><span class="n">shock_cvc</span> <span class="o">=</span> <span class="n">prop</span><span class="o">.</span><span class="n">shock_cvc</span> <span class="o">*</span> <span class="n">damping_scale</span> <span class="k">if</span> <span class="n">prop</span><span class="o">.</span><span class="n">shock_cvc</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="kc">None</span>
            <span class="n">prop</span><span class="o">.</span><span class="n">shock_cvt</span> <span class="o">=</span> <span class="n">prop</span><span class="o">.</span><span class="n">shock_cvt</span> <span class="o">*</span> <span class="n">damping_scale</span> <span class="k">if</span> <span class="n">prop</span><span class="o">.</span><span class="n">shock_cvt</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="kc">None</span>
            <span class="c1">#shock_exp_vc : 1.0</span>
            <span class="c1">#shock_exp_vt : 1.0</span>
            <span class="c1">#shock_idecs : None</span>
            <span class="c1">#shock_idecsd : None</span>
            <span class="c1">#shock_idets : None</span>
            <span class="c1">#shock_idetsd : None</span>
            <span class="c1">#shock_idts : None</span>
            <span class="c1">#shock_type : &#39;TABLE&#39;</span>
        <span class="k">elif</span> <span class="n">var</span> <span class="o">==</span> <span class="s1">&#39;DAMPER&#39;</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">prop</span><span class="o">.</span><span class="n">damper_type</span> <span class="o">==</span> <span class="s1">&#39;TABLE&#39;</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="p">(</span><span class="s1">&#39;damper_idc&#39;</span><span class="p">,</span> <span class="s1">&#39;damper_idcdv&#39;</span><span class="p">,</span> <span class="s1">&#39;damper_idt&#39;</span><span class="p">,</span> <span class="s1">&#39;damper_idtdv&#39;</span><span class="p">):</span>
                    <span class="n">value</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">prop</span><span class="p">,</span> <span class="n">key</span><span class="p">)</span>
                    <span class="k">if</span> <span class="n">value</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                        <span class="k">continue</span>
                    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>
                        <span class="n">damper_tables</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s1">&#39;key=</span><span class="si">%r</span><span class="s1"> value=</span><span class="si">%r</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">value</span><span class="p">))</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="n">prop</span><span class="o">.</span><span class="n">get_stats</span><span class="p">())</span>
                <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="n">prop</span><span class="o">.</span><span class="n">damper_type</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">var</span> <span class="o">==</span> <span class="s1">&#39;SPRING&#39;</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">prop</span><span class="o">.</span><span class="n">spring_type</span> <span class="o">==</span> <span class="s1">&#39;TABLE&#39;</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="p">(</span><span class="s1">&#39;spring_idc&#39;</span><span class="p">,</span> <span class="s1">&#39;spring_idcdu&#39;</span><span class="p">,</span> <span class="s1">&#39;spring_idt&#39;</span><span class="p">,</span> <span class="s1">&#39;spring_idtdu&#39;</span><span class="p">):</span>
                    <span class="n">value</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">prop</span><span class="p">,</span> <span class="n">key</span><span class="p">)</span>
                    <span class="k">if</span> <span class="n">value</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                        <span class="k">continue</span>
                    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>
                        <span class="n">spring_tables</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s1">&#39;key=</span><span class="si">%r</span><span class="s1"> value=</span><span class="si">%r</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">value</span><span class="p">))</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="n">prop</span><span class="o">.</span><span class="n">damper_type</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">prop</span><span class="o">.</span><span class="n">get_stats</span><span class="p">())</span>
            <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s1">&#39;var=</span><span class="si">%r</span><span class="se">\n</span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">var</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">prop</span><span class="p">)))</span>
        <span class="k">if</span> <span class="n">damper_tables</span><span class="p">:</span>
            <span class="n">model</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;scale PBUSH1D damper_tables=</span><span class="si">{</span><span class="n">damper_tables</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">spring_tables</span><span class="p">:</span>
            <span class="n">model</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;scale PBUSH1D spring_tables=</span><span class="si">{</span><span class="n">spring_tables</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span></div>
    <span class="c1">#damper_idc : None</span>
    <span class="c1">#damper_idcdv : None</span>
    <span class="c1">#damper_idt : None</span>
    <span class="c1">#damper_idtdv : None</span>
    <span class="c1">#damper_type : None</span>
    <span class="c1">#type   : &#39;PBUSH1D&#39;</span>

<div class="viewcode-block" id="_convert_materials"><a class="viewcode-back" href="../../../../reference/bdf/mesh_utils/pyNastran.bdf.mesh_utils.split_elements.html#pyNastran.bdf.mesh_utils.convert._convert_materials">[docs]</a><span class="k">def</span> <span class="nf">_convert_materials</span><span class="p">(</span><span class="n">model</span><span class="p">:</span> <span class="n">BDF</span><span class="p">,</span>
                       <span class="n">xyz_scale</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
                       <span class="n">mass_scale</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
                       <span class="n">weight_scale</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
                       <span class="n">temperature_scale</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Converts the materials</span>

<span class="sd">    Supports: MAT1, MAT2, MAT3, MAT8, MAT9, MAT10, MAT11</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">nmaterials</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">materials</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">nmaterials</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">return</span>

    <span class="n">force_scale</span> <span class="o">=</span> <span class="n">weight_scale</span>
    <span class="n">stress_scale</span> <span class="o">=</span> <span class="n">force_scale</span> <span class="o">/</span> <span class="n">xyz_scale</span> <span class="o">**</span> <span class="mi">2</span>
    <span class="n">density_scale</span> <span class="o">=</span> <span class="n">mass_scale</span> <span class="o">/</span> <span class="n">xyz_scale</span> <span class="o">**</span> <span class="mi">3</span>
    <span class="n">a_scale</span> <span class="o">=</span> <span class="mf">1.</span> <span class="o">/</span> <span class="n">temperature_scale</span> <span class="c1"># thermal expansion</span>

    <span class="n">model</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s1">&#39;--Material Scales--&#39;</span><span class="p">)</span>
    <span class="n">model</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s1">&#39;density_scale (M/L^3)= </span><span class="si">%g</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">density_scale</span><span class="p">)</span>
    <span class="n">model</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s1">&#39;stress_scale (F/L^2) = </span><span class="si">%g</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">stress_scale</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">mat</span> <span class="ow">in</span> <span class="n">model</span><span class="o">.</span><span class="n">materials</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
        <span class="n">mat_type</span> <span class="o">=</span> <span class="n">mat</span><span class="o">.</span><span class="n">type</span>
        <span class="k">if</span> <span class="n">mat_type</span> <span class="o">==</span> <span class="s1">&#39;MAT1&#39;</span><span class="p">:</span>
            <span class="n">mat</span><span class="o">.</span><span class="n">e</span> <span class="o">*=</span> <span class="n">stress_scale</span>
            <span class="n">mat</span><span class="o">.</span><span class="n">g</span> <span class="o">*=</span> <span class="n">stress_scale</span>
            <span class="n">mat</span><span class="o">.</span><span class="n">a</span> <span class="o">*=</span> <span class="n">a_scale</span>
            <span class="n">mat</span><span class="o">.</span><span class="n">tref</span> <span class="o">*=</span> <span class="n">temperature_scale</span>
            <span class="n">mat</span><span class="o">.</span><span class="n">rho</span> <span class="o">*=</span> <span class="n">density_scale</span>
            <span class="n">mat</span><span class="o">.</span><span class="n">St</span> <span class="o">*=</span> <span class="n">stress_scale</span>
            <span class="n">mat</span><span class="o">.</span><span class="n">Sc</span> <span class="o">*=</span> <span class="n">stress_scale</span>
            <span class="n">mat</span><span class="o">.</span><span class="n">Ss</span> <span class="o">*=</span> <span class="n">stress_scale</span>

        <span class="k">elif</span> <span class="n">mat_type</span> <span class="o">==</span> <span class="s1">&#39;MAT2&#39;</span><span class="p">:</span>
            <span class="n">mat</span><span class="o">.</span><span class="n">G11</span> <span class="o">*=</span> <span class="n">stress_scale</span>
            <span class="n">mat</span><span class="o">.</span><span class="n">G12</span> <span class="o">*=</span> <span class="n">stress_scale</span>
            <span class="n">mat</span><span class="o">.</span><span class="n">G13</span> <span class="o">*=</span> <span class="n">stress_scale</span>
            <span class="n">mat</span><span class="o">.</span><span class="n">G22</span> <span class="o">*=</span> <span class="n">stress_scale</span>
            <span class="n">mat</span><span class="o">.</span><span class="n">G23</span> <span class="o">*=</span> <span class="n">stress_scale</span>
            <span class="n">mat</span><span class="o">.</span><span class="n">G33</span> <span class="o">*=</span> <span class="n">stress_scale</span>
            <span class="n">mat</span><span class="o">.</span><span class="n">rho</span> <span class="o">*=</span> <span class="n">density_scale</span>
            <span class="c1"># 1/dTemp</span>
            <span class="k">if</span> <span class="n">mat</span><span class="o">.</span><span class="n">a1</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">mat</span><span class="o">.</span><span class="n">a1</span> <span class="o">*=</span> <span class="n">a_scale</span>
            <span class="k">if</span> <span class="n">mat</span><span class="o">.</span><span class="n">a2</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">mat</span><span class="o">.</span><span class="n">a2</span> <span class="o">*=</span> <span class="n">a_scale</span>
            <span class="k">if</span> <span class="n">mat</span><span class="o">.</span><span class="n">a3</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">mat</span><span class="o">.</span><span class="n">a3</span> <span class="o">*=</span> <span class="n">a_scale</span>
            <span class="n">mat</span><span class="o">.</span><span class="n">tref</span> <span class="o">*=</span> <span class="n">temperature_scale</span>
            <span class="k">if</span> <span class="n">mat</span><span class="o">.</span><span class="n">St</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">mat</span><span class="o">.</span><span class="n">St</span> <span class="o">*=</span> <span class="n">stress_scale</span>
            <span class="k">if</span> <span class="n">mat</span><span class="o">.</span><span class="n">Sc</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">mat</span><span class="o">.</span><span class="n">Sc</span> <span class="o">*=</span> <span class="n">stress_scale</span>
            <span class="k">if</span> <span class="n">mat</span><span class="o">.</span><span class="n">Ss</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">mat</span><span class="o">.</span><span class="n">Ss</span> <span class="o">*=</span> <span class="n">stress_scale</span>

        <span class="k">elif</span> <span class="n">mat_type</span> <span class="o">==</span> <span class="s1">&#39;MAT3&#39;</span><span class="p">:</span>
            <span class="n">mat</span><span class="o">.</span><span class="n">ex</span> <span class="o">*=</span> <span class="n">stress_scale</span>
            <span class="n">mat</span><span class="o">.</span><span class="n">eth</span> <span class="o">*=</span> <span class="n">stress_scale</span>
            <span class="n">mat</span><span class="o">.</span><span class="n">ez</span> <span class="o">*=</span> <span class="n">stress_scale</span>
            <span class="n">mat</span><span class="o">.</span><span class="n">rho</span> <span class="o">*=</span> <span class="n">density_scale</span>
            <span class="k">if</span> <span class="n">mat</span><span class="o">.</span><span class="n">gzx</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">mat</span><span class="o">.</span><span class="n">gzx</span> <span class="o">*=</span> <span class="n">stress_scale</span>
            <span class="n">mat</span><span class="o">.</span><span class="n">ax</span> <span class="o">*=</span> <span class="n">a_scale</span>
            <span class="n">mat</span><span class="o">.</span><span class="n">ath</span> <span class="o">*=</span> <span class="n">a_scale</span>
            <span class="n">mat</span><span class="o">.</span><span class="n">az</span> <span class="o">*=</span> <span class="n">a_scale</span>
            <span class="n">mat</span><span class="o">.</span><span class="n">tref</span> <span class="o">*=</span> <span class="n">temperature_scale</span>

        <span class="c1">#elif mat_type == &#39;MAT4&#39;:</span>
            <span class="c1">#mat.k</span>
            <span class="c1">#mat.cp</span>
            <span class="c1">#mat.rho *= density_scale</span>
            <span class="c1">#mat.H</span>
            <span class="c1">#mat.mu</span>
            <span class="c1">#mat.hgen</span>
            <span class="c1">#mat.refEnthalpy</span>
            <span class="c1">#mat.tch</span>
            <span class="c1">#mat.tdelta</span>
            <span class="c1">#mat.qlat</span>

        <span class="k">elif</span> <span class="n">mat_type</span> <span class="o">==</span> <span class="s1">&#39;MAT8&#39;</span><span class="p">:</span>
            <span class="n">mat</span><span class="o">.</span><span class="n">e11</span> <span class="o">*=</span> <span class="n">stress_scale</span>
            <span class="n">mat</span><span class="o">.</span><span class="n">e22</span> <span class="o">*=</span> <span class="n">stress_scale</span>
            <span class="n">mat</span><span class="o">.</span><span class="n">g12</span> <span class="o">*=</span> <span class="n">stress_scale</span>
            <span class="n">mat</span><span class="o">.</span><span class="n">g1z</span> <span class="o">*=</span> <span class="n">stress_scale</span>
            <span class="n">mat</span><span class="o">.</span><span class="n">g2z</span> <span class="o">*=</span> <span class="n">stress_scale</span>
            <span class="n">mat</span><span class="o">.</span><span class="n">rho</span> <span class="o">*=</span> <span class="n">density_scale</span>
            <span class="n">mat</span><span class="o">.</span><span class="n">a1</span> <span class="o">*=</span> <span class="n">a_scale</span>
            <span class="n">mat</span><span class="o">.</span><span class="n">a2</span> <span class="o">*=</span> <span class="n">a_scale</span>
            <span class="n">mat</span><span class="o">.</span><span class="n">Xt</span> <span class="o">*=</span> <span class="n">stress_scale</span>
            <span class="n">mat</span><span class="o">.</span><span class="n">Xc</span> <span class="o">*=</span> <span class="n">stress_scale</span>
            <span class="n">mat</span><span class="o">.</span><span class="n">Yt</span> <span class="o">*=</span> <span class="n">stress_scale</span>
            <span class="n">mat</span><span class="o">.</span><span class="n">Yc</span> <span class="o">*=</span> <span class="n">stress_scale</span>
            <span class="n">mat</span><span class="o">.</span><span class="n">S</span> <span class="o">*=</span> <span class="n">stress_scale</span>
            <span class="n">mat</span><span class="o">.</span><span class="n">tref</span> <span class="o">*=</span> <span class="n">temperature_scale</span>

        <span class="k">elif</span> <span class="n">mat_type</span> <span class="o">==</span> <span class="s1">&#39;MAT9&#39;</span><span class="p">:</span>
            <span class="n">mat</span><span class="o">.</span><span class="n">G11</span> <span class="o">*=</span> <span class="n">stress_scale</span>
            <span class="n">mat</span><span class="o">.</span><span class="n">G12</span> <span class="o">*=</span> <span class="n">stress_scale</span>
            <span class="n">mat</span><span class="o">.</span><span class="n">G13</span> <span class="o">*=</span> <span class="n">stress_scale</span>
            <span class="n">mat</span><span class="o">.</span><span class="n">G14</span> <span class="o">*=</span> <span class="n">stress_scale</span>
            <span class="n">mat</span><span class="o">.</span><span class="n">G15</span> <span class="o">*=</span> <span class="n">stress_scale</span>
            <span class="n">mat</span><span class="o">.</span><span class="n">G16</span> <span class="o">*=</span> <span class="n">stress_scale</span>
            <span class="n">mat</span><span class="o">.</span><span class="n">G22</span> <span class="o">*=</span> <span class="n">stress_scale</span>
            <span class="n">mat</span><span class="o">.</span><span class="n">G23</span> <span class="o">*=</span> <span class="n">stress_scale</span>
            <span class="n">mat</span><span class="o">.</span><span class="n">G24</span> <span class="o">*=</span> <span class="n">stress_scale</span>
            <span class="n">mat</span><span class="o">.</span><span class="n">G25</span> <span class="o">*=</span> <span class="n">stress_scale</span>
            <span class="n">mat</span><span class="o">.</span><span class="n">G26</span> <span class="o">*=</span> <span class="n">stress_scale</span>
            <span class="n">mat</span><span class="o">.</span><span class="n">G33</span> <span class="o">*=</span> <span class="n">stress_scale</span>
            <span class="n">mat</span><span class="o">.</span><span class="n">G34</span> <span class="o">*=</span> <span class="n">stress_scale</span>
            <span class="n">mat</span><span class="o">.</span><span class="n">G35</span> <span class="o">*=</span> <span class="n">stress_scale</span>
            <span class="n">mat</span><span class="o">.</span><span class="n">G36</span> <span class="o">*=</span> <span class="n">stress_scale</span>
            <span class="n">mat</span><span class="o">.</span><span class="n">G44</span> <span class="o">*=</span> <span class="n">stress_scale</span>
            <span class="n">mat</span><span class="o">.</span><span class="n">G45</span> <span class="o">*=</span> <span class="n">stress_scale</span>
            <span class="n">mat</span><span class="o">.</span><span class="n">G46</span> <span class="o">*=</span> <span class="n">stress_scale</span>
            <span class="n">mat</span><span class="o">.</span><span class="n">G55</span> <span class="o">*=</span> <span class="n">stress_scale</span>
            <span class="n">mat</span><span class="o">.</span><span class="n">G56</span> <span class="o">*=</span> <span class="n">stress_scale</span>
            <span class="n">mat</span><span class="o">.</span><span class="n">G66</span> <span class="o">*=</span> <span class="n">stress_scale</span>
            <span class="n">mat</span><span class="o">.</span><span class="n">rho</span> <span class="o">*=</span> <span class="n">density_scale</span>
            <span class="n">mat</span><span class="o">.</span><span class="n">A</span> <span class="o">=</span> <span class="p">[</span><span class="n">ai</span> <span class="o">*</span> <span class="n">a_scale</span> <span class="k">if</span> <span class="n">ai</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="kc">None</span>
                     <span class="k">for</span> <span class="n">ai</span> <span class="ow">in</span> <span class="n">mat</span><span class="o">.</span><span class="n">A</span><span class="p">]</span>
            <span class="n">mat</span><span class="o">.</span><span class="n">tref</span> <span class="o">*=</span> <span class="n">temperature_scale</span>
        <span class="k">elif</span> <span class="n">mat</span><span class="o">.</span><span class="n">type</span> <span class="o">==</span> <span class="s1">&#39;MAT3D&#39;</span><span class="p">:</span>
            <span class="n">mat</span><span class="o">.</span><span class="n">e1</span> <span class="o">*=</span> <span class="n">stress_scale</span>
            <span class="n">mat</span><span class="o">.</span><span class="n">e2</span> <span class="o">*=</span> <span class="n">stress_scale</span>
            <span class="n">mat</span><span class="o">.</span><span class="n">e3</span> <span class="o">*=</span> <span class="n">stress_scale</span>
            <span class="n">mat</span><span class="o">.</span><span class="n">g12</span> <span class="o">*=</span> <span class="n">stress_scale</span>
            <span class="n">mat</span><span class="o">.</span><span class="n">g13</span> <span class="o">*=</span> <span class="n">stress_scale</span>
            <span class="n">mat</span><span class="o">.</span><span class="n">g23</span> <span class="o">*=</span> <span class="n">stress_scale</span>
            <span class="n">mat</span><span class="o">.</span><span class="n">rho</span> <span class="o">=</span> <span class="n">density_scale</span>
        <span class="k">elif</span> <span class="n">mat</span><span class="o">.</span><span class="n">type</span> <span class="o">==</span> <span class="s1">&#39;MAT11&#39;</span><span class="p">:</span>
            <span class="n">mat</span><span class="o">.</span><span class="n">e1</span> <span class="o">*=</span> <span class="n">stress_scale</span>
            <span class="n">mat</span><span class="o">.</span><span class="n">e2</span> <span class="o">*=</span> <span class="n">stress_scale</span>
            <span class="n">mat</span><span class="o">.</span><span class="n">e3</span> <span class="o">*=</span> <span class="n">stress_scale</span>
            <span class="n">mat</span><span class="o">.</span><span class="n">g12</span> <span class="o">*=</span> <span class="n">stress_scale</span>
            <span class="n">mat</span><span class="o">.</span><span class="n">g13</span> <span class="o">*=</span> <span class="n">stress_scale</span>
            <span class="n">mat</span><span class="o">.</span><span class="n">g23</span> <span class="o">*=</span> <span class="n">stress_scale</span>
            <span class="n">mat</span><span class="o">.</span><span class="n">rho</span> <span class="o">=</span> <span class="n">density_scale</span>
            <span class="c1">#mat.a1 = a1</span>
            <span class="c1">#mat.a2 = a2</span>
            <span class="c1">#mat.a3 = a3</span>
            <span class="n">mat</span><span class="o">.</span><span class="n">tref</span> <span class="o">*=</span> <span class="n">temperature_scale</span>
            <span class="c1">#mat.ge = ge</span>
        <span class="k">elif</span> <span class="n">mat</span><span class="o">.</span><span class="n">type</span> <span class="o">==</span> <span class="s1">&#39;MAT10&#39;</span><span class="p">:</span>
            <span class="n">model</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s1">&#39;skipping </span><span class="si">%s</span><span class="s1"> convert&#39;</span> <span class="o">%</span> <span class="n">mat</span><span class="o">.</span><span class="n">type</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="n">mat</span><span class="p">)</span></div>

<div class="viewcode-block" id="_convert_constraints"><a class="viewcode-back" href="../../../../reference/bdf/mesh_utils/pyNastran.bdf.mesh_utils.split_elements.html#pyNastran.bdf.mesh_utils.convert._convert_constraints">[docs]</a><span class="k">def</span> <span class="nf">_convert_constraints</span><span class="p">(</span><span class="n">model</span><span class="p">:</span> <span class="n">BDF</span><span class="p">,</span> <span class="n">xyz_scale</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Converts the spc/mpcs</span>

<span class="sd">    Supports: SPC1, SPC, SPCAX</span>
<span class="sd">    Implicitly supports: MPC, MPCADD, SPCADD</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">for</span> <span class="n">unused_spc_id</span><span class="p">,</span> <span class="n">spcs</span> <span class="ow">in</span> <span class="n">model</span><span class="o">.</span><span class="n">spcs</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="k">for</span> <span class="n">spc</span> <span class="ow">in</span> <span class="n">spcs</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">spc</span><span class="o">.</span><span class="n">type</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;SPCADD&#39;</span><span class="p">,</span> <span class="s1">&#39;SPC1&#39;</span><span class="p">,</span> <span class="s1">&#39;GMSPC&#39;</span><span class="p">]:</span>
                <span class="k">continue</span>
            <span class="k">elif</span> <span class="n">spc</span><span class="o">.</span><span class="n">type</span> <span class="o">==</span> <span class="s1">&#39;SPC&#39;</span><span class="p">:</span>
                <span class="n">spc</span><span class="o">.</span><span class="n">enforced</span> <span class="o">=</span> <span class="p">[</span><span class="n">enforcedi</span><span class="o">*</span><span class="n">xyz_scale</span> <span class="k">for</span> <span class="n">enforcedi</span> <span class="ow">in</span> <span class="n">spc</span><span class="o">.</span><span class="n">enforced</span><span class="p">]</span>
            <span class="k">elif</span> <span class="n">spc</span><span class="o">.</span><span class="n">type</span> <span class="o">==</span> <span class="s1">&#39;SPCAX&#39;</span><span class="p">:</span>
                <span class="n">spc</span><span class="o">.</span><span class="n">enforced</span> <span class="o">=</span> <span class="n">spc</span><span class="o">.</span><span class="n">enforced</span> <span class="o">*</span> <span class="n">xyz_scale</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="n">spc</span><span class="p">)</span></div>

<div class="viewcode-block" id="_get_dload_scale"><a class="viewcode-back" href="../../../../reference/bdf/mesh_utils/pyNastran.bdf.mesh_utils.split_elements.html#pyNastran.bdf.mesh_utils.convert._get_dload_scale">[docs]</a><span class="k">def</span> <span class="nf">_get_dload_scale</span><span class="p">(</span><span class="n">dload</span><span class="p">,</span>
                     <span class="n">xyz_scale</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
                     <span class="n">velocity_scale</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
                     <span class="n">accel_scale</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
                     <span class="n">force_scale</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    LOAD asssumes force</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">dload</span><span class="o">.</span><span class="n">Type</span> <span class="o">==</span> <span class="s1">&#39;LOAD&#39;</span><span class="p">:</span>
        <span class="n">scale</span> <span class="o">=</span> <span class="n">force_scale</span>
    <span class="k">elif</span> <span class="n">dload</span><span class="o">.</span><span class="n">Type</span> <span class="o">==</span> <span class="s1">&#39;DISP&#39;</span><span class="p">:</span>
        <span class="n">scale</span> <span class="o">=</span> <span class="n">xyz_scale</span>
    <span class="k">elif</span> <span class="n">dload</span><span class="o">.</span><span class="n">Type</span> <span class="o">==</span> <span class="s1">&#39;VELO&#39;</span><span class="p">:</span>
        <span class="n">scale</span> <span class="o">=</span> <span class="n">velocity_scale</span>
    <span class="k">elif</span> <span class="n">dload</span><span class="o">.</span><span class="n">Type</span> <span class="o">==</span> <span class="s1">&#39;ACCE&#39;</span><span class="p">:</span>
        <span class="n">scale</span> <span class="o">=</span> <span class="n">accel_scale</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="n">dload</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">scale</span></div>

<div class="viewcode-block" id="_convert_loads"><a class="viewcode-back" href="../../../../reference/bdf/mesh_utils/pyNastran.bdf.mesh_utils.split_elements.html#pyNastran.bdf.mesh_utils.convert._convert_loads">[docs]</a><span class="k">def</span> <span class="nf">_convert_loads</span><span class="p">(</span><span class="n">model</span><span class="p">:</span> <span class="n">BDF</span><span class="p">,</span>
                   <span class="n">xyz_scale</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
                   <span class="n">time_scale</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
                   <span class="n">weight_scale</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
                   <span class="n">temperature_scale</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Converts the loads</span>

<span class="sd">    Supports:</span>
<span class="sd">     - dloads: RLOAD1*, TLOAD1*</span>
<span class="sd">     - loads:  FORCE, FORCE1, FORCE2, MOMENT, MOMENT1, MOMENT2</span>
<span class="sd">               GRAV, ACCEL1, PLOAD, PLOAD1, PLOAD2, PLOAD4, RANDPS</span>
<span class="sd">     - combinations: DLOAD, LOAD</span>

<span class="sd">    * probably not done</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1">#if not model.loads:</span>
        <span class="c1">#return</span>

    <span class="n">frequency_scale</span> <span class="o">=</span> <span class="mf">1.</span> <span class="o">/</span> <span class="n">time_scale</span>
    <span class="n">force_scale</span> <span class="o">=</span> <span class="n">weight_scale</span>
    <span class="n">moment_scale</span> <span class="o">=</span> <span class="n">xyz_scale</span> <span class="o">*</span> <span class="n">force_scale</span>
    <span class="n">pressure_scale</span> <span class="o">=</span> <span class="n">force_scale</span> <span class="o">/</span> <span class="n">xyz_scale</span> <span class="o">**</span> <span class="mi">2</span>
    <span class="n">accel_scale</span> <span class="o">=</span> <span class="n">force_scale</span> <span class="o">/</span> <span class="n">xyz_scale</span>
    <span class="n">velocity_scale</span> <span class="o">=</span> <span class="n">xyz_scale</span> <span class="o">/</span> <span class="n">time_scale</span>

    <span class="n">model</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s1">&#39;--Load Scales--&#39;</span><span class="p">)</span>
    <span class="n">model</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s1">&#39;force_scale = </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">force_scale</span><span class="p">)</span>
    <span class="n">model</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s1">&#39;moment_scale = </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">moment_scale</span><span class="p">)</span>
    <span class="n">model</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s1">&#39;pressure_scale = </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">pressure_scale</span><span class="p">)</span>
    <span class="n">model</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s1">&#39;accel_scale = </span><span class="si">%s</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">accel_scale</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">dloads</span> <span class="ow">in</span> <span class="n">model</span><span class="o">.</span><span class="n">dloads</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
        <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">dloads</span><span class="p">,</span> <span class="nb">str</span><span class="p">),</span> <span class="n">dloads</span>  <span class="c1"># TEMP</span>

    <span class="n">skip_dloads</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;TLOAD2&#39;</span><span class="p">,</span> <span class="s1">&#39;RANDPS&#39;</span><span class="p">,</span> <span class="s1">&#39;RANDT1&#39;</span><span class="p">,</span> <span class="s1">&#39;QVECT&#39;</span><span class="p">}</span>
    <span class="n">tabled_scales</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">dloads</span> <span class="ow">in</span> <span class="n">model</span><span class="o">.</span><span class="n">dload_entries</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
        <span class="k">for</span> <span class="n">dload</span> <span class="ow">in</span> <span class="n">dloads</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">dload</span><span class="o">.</span><span class="n">type</span> <span class="o">==</span> <span class="s1">&#39;RLOAD1&#39;</span><span class="p">:</span>
                <span class="c1">#self.excite_id = excite_id</span>
                <span class="c1">#self.delay = delay</span>
                <span class="c1">#self.dphase = dphase</span>
                <span class="c1">#self.tc = tc</span>
                <span class="c1">#self.td = td</span>
                <span class="c1"># { P(f) }  = {A} [ C(f) + iD(f)] * e^{  i {\theta - 2 pi f tau } }</span>
                <span class="n">scale</span> <span class="o">=</span> <span class="n">_get_dload_scale</span><span class="p">(</span><span class="n">dload</span><span class="p">,</span> <span class="n">xyz_scale</span><span class="p">,</span> <span class="n">velocity_scale</span><span class="p">,</span>
                                         <span class="n">accel_scale</span><span class="p">,</span> <span class="n">force_scale</span><span class="p">)</span>

                <span class="c1">#delay : int/float; default=None</span>
                    <span class="c1">#the delay; if it&#39;s 0/blank there is no delay</span>
                    <span class="c1">#float : delay in units of time</span>
                    <span class="c1">#int : delay id</span>
                <span class="c1">#dphase : int/float; default=None</span>
                    <span class="c1">#the dphase; if it&#39;s 0/blank there is no phase lag</span>
                    <span class="c1">#float : delay in units of time</span>
                    <span class="c1">#int : delay id</span>
                <span class="c1">#tc : int/float; default=0</span>
                    <span class="c1">#TABLEDi id that defines C(f) for all degrees of freedom in</span>
                    <span class="c1">#EXCITEID entry</span>
                <span class="c1">#td : int/float; default=0</span>
                    <span class="c1">#TABLEDi id that defines D(f) for all degrees of freedom in</span>
                    <span class="c1">#EXCITEID entry</span>
                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">dload</span><span class="o">.</span><span class="n">delay</span><span class="p">,</span> <span class="nb">float</span><span class="p">):</span>
                    <span class="n">dload</span><span class="o">.</span><span class="n">delay</span> <span class="o">*=</span> <span class="n">time_scale</span>
                <span class="c1">#{P(f)}  = {A} [ C(f)+iD(f)] e^{i {theta - 2*pi*f*tau} }</span>
                <span class="k">if</span> <span class="n">dload</span><span class="o">.</span><span class="n">tc</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="n">tabled_scales</span><span class="o">.</span><span class="n">add</span><span class="p">((</span><span class="n">dload</span><span class="o">.</span><span class="n">tc</span><span class="p">,</span> <span class="n">scale</span><span class="p">))</span>
                <span class="k">if</span> <span class="n">dload</span><span class="o">.</span><span class="n">td</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="n">tabled_scales</span><span class="o">.</span><span class="n">add</span><span class="p">((</span><span class="n">dload</span><span class="o">.</span><span class="n">td</span><span class="p">,</span> <span class="n">scale</span><span class="p">))</span>

                <span class="c1">#darea = model.dareas[dload.excite_id]</span>
                <span class="c1">#print(darea.get_stats())</span>
            <span class="k">elif</span> <span class="n">dload</span><span class="o">.</span><span class="n">type</span> <span class="o">==</span> <span class="s1">&#39;TLOAD1&#39;</span><span class="p">:</span>
                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">dload</span><span class="o">.</span><span class="n">delay</span><span class="p">,</span> <span class="nb">float</span><span class="p">):</span>
                    <span class="n">dload</span><span class="o">.</span><span class="n">delay</span> <span class="o">*=</span> <span class="n">time_scale</span>
                <span class="n">dload</span><span class="o">.</span><span class="n">us0</span> <span class="o">*=</span> <span class="n">xyz_scale</span>
                <span class="n">dload</span><span class="o">.</span><span class="n">vs0</span> <span class="o">*=</span> <span class="n">velocity_scale</span>
                <span class="c1"># {P(t)} = {A} ⋅F(t – τ)</span>

                <span class="c1">#darea = model.dareas[dload.excite_id]</span>
                <span class="c1">#print(darea.get_stats())</span>
                <span class="n">scale</span> <span class="o">=</span> <span class="n">_get_dload_scale</span><span class="p">(</span><span class="n">dload</span><span class="p">,</span> <span class="n">xyz_scale</span><span class="p">,</span> <span class="n">velocity_scale</span><span class="p">,</span>
                                         <span class="n">accel_scale</span><span class="p">,</span> <span class="n">force_scale</span><span class="p">)</span>
                <span class="n">tabled_scales</span><span class="o">.</span><span class="n">add</span><span class="p">((</span><span class="n">dload</span><span class="o">.</span><span class="n">tid</span><span class="p">,</span> <span class="n">scale</span><span class="p">))</span>
            <span class="k">elif</span> <span class="n">dload</span><span class="o">.</span><span class="n">type</span> <span class="ow">in</span> <span class="n">skip_dloads</span><span class="p">:</span>
                <span class="n">model</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;skipping </span><span class="si">{</span><span class="n">dload</span><span class="o">.</span><span class="n">type</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="n">dload</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">tid</span><span class="p">,</span> <span class="n">scale</span> <span class="ow">in</span> <span class="n">tabled_scales</span><span class="p">:</span>
        <span class="n">tabled</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">TableD</span><span class="p">(</span><span class="n">tid</span><span class="p">)</span>
        <span class="n">tabled</span><span class="o">.</span><span class="n">y</span> <span class="o">*=</span> <span class="n">scale</span>

    <span class="n">skip_cards</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;PLOADX1&#39;</span><span class="p">,</span> <span class="s1">&#39;QVOL&#39;</span><span class="p">,</span> <span class="s1">&#39;QHBDY&#39;</span><span class="p">,</span> <span class="s1">&#39;QBDY1&#39;</span><span class="p">,</span> <span class="s1">&#39;QBDY2&#39;</span><span class="p">,</span> <span class="s1">&#39;QBDY3&#39;</span><span class="p">,</span> <span class="s1">&#39;GMLOAD&#39;</span><span class="p">}</span>
    <span class="k">for</span> <span class="n">loads</span> <span class="ow">in</span> <span class="n">model</span><span class="o">.</span><span class="n">loads</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
        <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">loads</span><span class="p">,</span> <span class="nb">list</span><span class="p">),</span> <span class="n">loads</span>
        <span class="k">for</span> <span class="n">load</span> <span class="ow">in</span> <span class="n">loads</span><span class="p">:</span> <span class="c1"># list</span>
            <span class="n">load_type</span> <span class="o">=</span> <span class="n">load</span><span class="o">.</span><span class="n">type</span>
            <span class="k">if</span> <span class="n">load_type</span> <span class="o">==</span> <span class="s1">&#39;LOAD&#39;</span><span class="p">:</span>
                <span class="k">pass</span>
            <span class="k">elif</span> <span class="n">load_type</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;FORCE&#39;</span><span class="p">,</span> <span class="s1">&#39;FORCE1&#39;</span><span class="p">,</span> <span class="s1">&#39;FORCE2&#39;</span><span class="p">]:</span>
                <span class="n">load</span><span class="o">.</span><span class="n">mag</span> <span class="o">*=</span> <span class="n">force_scale</span>
            <span class="k">elif</span> <span class="n">load_type</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;MOMENT&#39;</span><span class="p">,</span> <span class="s1">&#39;MOMENT1&#39;</span><span class="p">,</span> <span class="s1">&#39;MOMENT2&#39;</span><span class="p">]:</span>
                <span class="n">load</span><span class="o">.</span><span class="n">mag</span> <span class="o">*=</span> <span class="n">moment_scale</span>
            <span class="k">elif</span> <span class="n">load_type</span> <span class="ow">in</span> <span class="p">{</span><span class="s1">&#39;GRAV&#39;</span><span class="p">,</span> <span class="s1">&#39;ACCEL1&#39;</span><span class="p">}:</span>
                <span class="n">load</span><span class="o">.</span><span class="n">scale</span> <span class="o">*=</span> <span class="n">accel_scale</span>
            <span class="k">elif</span> <span class="n">load_type</span> <span class="o">==</span> <span class="s1">&#39;ACCEL&#39;</span><span class="p">:</span>
                <span class="n">load</span><span class="o">.</span><span class="n">vals</span> <span class="o">*=</span> <span class="n">accel_scale</span>
            <span class="k">elif</span> <span class="n">load_type</span> <span class="o">==</span> <span class="s1">&#39;PLOAD&#39;</span><span class="p">:</span>
                <span class="n">load</span><span class="o">.</span><span class="n">pressure</span> <span class="o">*=</span> <span class="n">pressure_scale</span>
            <span class="k">elif</span> <span class="n">load_type</span> <span class="o">==</span> <span class="s1">&#39;PLOAD1&#39;</span><span class="p">:</span>
                <span class="c1"># the errors should never hit</span>
                <span class="k">if</span> <span class="n">load</span><span class="o">.</span><span class="n">scale</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;LE&#39;</span><span class="p">,</span> <span class="s1">&#39;LEPR&#39;</span><span class="p">]:</span>
                    <span class="k">if</span> <span class="n">load</span><span class="o">.</span><span class="n">Type</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;FX&#39;</span><span class="p">,</span> <span class="s1">&#39;FY&#39;</span><span class="p">,</span> <span class="s1">&#39;FZ&#39;</span><span class="p">,</span> <span class="s1">&#39;FXE&#39;</span><span class="p">,</span> <span class="s1">&#39;FYE&#39;</span><span class="p">,</span> <span class="s1">&#39;FZE&#39;</span><span class="p">]:</span>
                        <span class="n">load</span><span class="o">.</span><span class="n">p1</span> <span class="o">*=</span> <span class="n">force_scale</span>
                        <span class="n">load</span><span class="o">.</span><span class="n">p2</span> <span class="o">*=</span> <span class="n">force_scale</span>
                    <span class="k">elif</span> <span class="n">load</span><span class="o">.</span><span class="n">Type</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;MX&#39;</span><span class="p">,</span> <span class="s1">&#39;MY&#39;</span><span class="p">,</span> <span class="s1">&#39;MZ&#39;</span><span class="p">,</span> <span class="s1">&#39;MXE&#39;</span><span class="p">,</span> <span class="s1">&#39;MYE&#39;</span><span class="p">,</span> <span class="s1">&#39;MZE&#39;</span><span class="p">]:</span>
                        <span class="n">load</span><span class="o">.</span><span class="n">p1</span> <span class="o">*=</span> <span class="n">moment_scale</span>
                        <span class="n">load</span><span class="o">.</span><span class="n">p2</span> <span class="o">*=</span> <span class="n">moment_scale</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="n">load</span><span class="p">)</span>
                <span class="k">elif</span> <span class="n">load</span><span class="o">.</span><span class="n">scale</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;FR&#39;</span><span class="p">,</span> <span class="s1">&#39;RFPR&#39;</span><span class="p">]:</span>  <span class="c1"># fractional</span>
                    <span class="k">pass</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="n">load</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">load_type</span> <span class="o">==</span> <span class="s1">&#39;PLOAD2&#39;</span><span class="p">:</span>
                <span class="n">load</span><span class="o">.</span><span class="n">pressure</span> <span class="o">*=</span> <span class="n">pressure_scale</span>
            <span class="k">elif</span> <span class="n">load_type</span> <span class="o">==</span> <span class="s1">&#39;PLOAD4&#39;</span><span class="p">:</span>
                <span class="n">load</span><span class="o">.</span><span class="n">pressures</span> <span class="o">=</span> <span class="p">[</span><span class="n">pressure</span><span class="o">*</span><span class="n">pressure_scale</span> <span class="k">for</span> <span class="n">pressure</span> <span class="ow">in</span> <span class="n">load</span><span class="o">.</span><span class="n">pressures</span><span class="p">]</span>
            <span class="k">elif</span> <span class="n">load_type</span> <span class="o">==</span> <span class="s1">&#39;DEFORM&#39;</span><span class="p">:</span>
                <span class="n">load</span><span class="o">.</span><span class="n">deformation</span> <span class="o">*=</span> <span class="n">xyz_scale</span>
            <span class="k">elif</span> <span class="n">load_type</span> <span class="o">==</span> <span class="s1">&#39;RANDPS&#39;</span><span class="p">:</span>
                <span class="n">table</span> <span class="o">=</span> <span class="n">load</span><span class="o">.</span><span class="n">tid</span> <span class="c1"># defines G(f)</span>
                <span class="k">if</span> <span class="n">table</span><span class="o">.</span><span class="n">type</span> <span class="o">==</span> <span class="s1">&#39;TABRND1&#39;</span><span class="p">:</span>
                    <span class="n">table</span><span class="o">.</span><span class="n">x</span> <span class="o">*=</span> <span class="n">frequency_scale</span> <span class="c1"># freq</span>
                    <span class="n">table</span><span class="o">.</span><span class="n">y</span> <span class="o">*=</span> <span class="n">force_scale</span> <span class="c1"># G</span>
                <span class="c1">#elif table.type == &#39;TABRNDG&#39;:</span>
                    <span class="c1">#: Scale of turbulence divided by velocity (units of time; Real)</span>
                    <span class="c1">#self.LU = LU</span>
                    <span class="c1">#: Root-mean-square gust velocity. (Real)</span>
                    <span class="c1">#table.WG *= velocity_scale</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="n">table</span><span class="p">)</span>
            <span class="c1">#-------------------------------------------------------------</span>
            <span class="c1"># thermal</span>
            <span class="k">elif</span> <span class="n">load_type</span> <span class="o">==</span> <span class="s1">&#39;TEMP&#39;</span><span class="p">:</span>
                <span class="c1">#print(load.get_stats())</span>
                <span class="c1">#temperatures : {1901: 100.0}</span>
                <span class="k">for</span> <span class="n">nid</span> <span class="ow">in</span> <span class="n">load</span><span class="o">.</span><span class="n">temperatures</span><span class="p">:</span>
                    <span class="n">load</span><span class="o">.</span><span class="n">temperatures</span><span class="p">[</span><span class="n">nid</span><span class="p">]</span> <span class="o">*=</span> <span class="n">temperature_scale</span>
            <span class="k">elif</span> <span class="n">load_type</span> <span class="o">==</span> <span class="s1">&#39;FORCEAX&#39;</span><span class="p">:</span>
                <span class="n">load</span><span class="o">.</span><span class="n">f_rtz</span> <span class="o">*=</span> <span class="n">force_scale</span>
            <span class="k">elif</span> <span class="n">load_type</span> <span class="ow">in</span>  <span class="n">skip_cards</span><span class="p">:</span>
                <span class="n">model</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s1">&#39;skipping </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">load</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">load_type</span> <span class="o">==</span> <span class="s1">&#39;TEMPAX&#39;</span><span class="p">:</span>
                <span class="n">load</span><span class="o">.</span><span class="n">temperature</span> <span class="o">*=</span> <span class="n">temperature_scale</span>
            <span class="k">elif</span> <span class="n">load_type</span> <span class="o">==</span> <span class="s1">&#39;PRESAX&#39;</span><span class="p">:</span>
                <span class="n">load</span><span class="o">.</span><span class="n">pressure</span> <span class="o">*=</span> <span class="n">pressure_scale</span>
            <span class="k">elif</span> <span class="n">load_type</span> <span class="o">==</span> <span class="s1">&#39;TEMPRB&#39;</span><span class="p">:</span>
                <span class="n">load</span><span class="o">.</span><span class="n">ta</span> <span class="o">*=</span> <span class="n">temperature_scale</span>
                <span class="n">load</span><span class="o">.</span><span class="n">tb</span> <span class="o">*=</span> <span class="n">temperature_scale</span>
                <span class="n">load</span><span class="o">.</span><span class="n">tbi</span> <span class="o">=</span> <span class="p">[</span><span class="n">tempi</span> <span class="o">*</span> <span class="n">temperature_scale</span> <span class="k">for</span> <span class="n">tempi</span> <span class="ow">in</span> <span class="n">load</span><span class="o">.</span><span class="n">tbi</span><span class="p">]</span>
                <span class="n">load</span><span class="o">.</span><span class="n">tai</span> <span class="o">=</span> <span class="p">[</span><span class="n">tempi</span> <span class="o">*</span> <span class="n">temperature_scale</span> <span class="k">for</span> <span class="n">tempi</span> <span class="ow">in</span> <span class="n">load</span><span class="o">.</span><span class="n">tai</span><span class="p">]</span>
                <span class="n">load</span><span class="o">.</span><span class="n">tp1</span> <span class="o">=</span> <span class="p">[</span><span class="n">tempi</span> <span class="o">*</span> <span class="n">temperature_scale</span> <span class="k">if</span> <span class="n">tempi</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">tempi</span> <span class="k">for</span> <span class="n">tempi</span> <span class="ow">in</span> <span class="n">load</span><span class="o">.</span><span class="n">tp1</span><span class="p">]</span>
                <span class="n">load</span><span class="o">.</span><span class="n">tp2</span> <span class="o">=</span> <span class="p">[</span><span class="n">tempi</span> <span class="o">*</span> <span class="n">temperature_scale</span> <span class="k">if</span> <span class="n">tempi</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">tempi</span> <span class="k">for</span> <span class="n">tempi</span> <span class="ow">in</span> <span class="n">load</span><span class="o">.</span><span class="n">tp2</span><span class="p">]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">load</span><span class="o">.</span><span class="n">get_stats</span><span class="p">()</span><span class="si">}</span><span class="se">\n</span><span class="si">{</span><span class="n">load</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span></div>

<div class="viewcode-block" id="_convert_aero"><a class="viewcode-back" href="../../../../reference/bdf/mesh_utils/pyNastran.bdf.mesh_utils.split_elements.html#pyNastran.bdf.mesh_utils.convert._convert_aero">[docs]</a><span class="k">def</span> <span class="nf">_convert_aero</span><span class="p">(</span><span class="n">model</span><span class="p">:</span> <span class="n">BDF</span><span class="p">,</span>
                  <span class="n">xyz_scale</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
                  <span class="n">time_scale</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
                  <span class="n">weight_scale</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Converts the aero cards</span>
<span class="sd">      - CAEROx, PAEROx, SPLINEx, AECOMP, AELIST, AEPARAM, AESURF</span>

<span class="sd">    Supports: AERO, AEROS, CAERO1, CAERO2, TRIM*, MONPNT1, FLUTTER FLFACT-rho/vel</span>
<span class="sd">              GUST, AESURF, PAERO2</span>
<span class="sd">    Skips: PAERO1, AESTAT, AESURFS, AECOMP, AELIST</span>
<span class="sd">    Doesn&#39;t support:CAERO3-5, PAERO3-5, SPLINEx, AEPARAM,  AELINK, AEPRESS, AEFORCE,</span>
<span class="sd">    *probably not done</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="ow">not</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">aecomps</span> <span class="ow">or</span> <span class="n">model</span><span class="o">.</span><span class="n">aefacts</span> <span class="ow">or</span> <span class="n">model</span><span class="o">.</span><span class="n">aeparams</span> <span class="ow">or</span> <span class="n">model</span><span class="o">.</span><span class="n">aelinks</span> <span class="ow">or</span>
           <span class="n">model</span><span class="o">.</span><span class="n">aelists</span> <span class="ow">or</span> <span class="n">model</span><span class="o">.</span><span class="n">aestats</span> <span class="ow">or</span> <span class="n">model</span><span class="o">.</span><span class="n">aesurf</span> <span class="ow">or</span> <span class="n">model</span><span class="o">.</span><span class="n">aesurfs</span> <span class="ow">or</span>
           <span class="n">model</span><span class="o">.</span><span class="n">caeros</span> <span class="ow">or</span> <span class="n">model</span><span class="o">.</span><span class="n">paeros</span> <span class="ow">or</span> <span class="n">model</span><span class="o">.</span><span class="n">monitor_points</span> <span class="ow">or</span> <span class="n">model</span><span class="o">.</span><span class="n">splines</span> <span class="ow">or</span>
           <span class="n">model</span><span class="o">.</span><span class="n">aeros</span> <span class="ow">or</span> <span class="n">model</span><span class="o">.</span><span class="n">trims</span> <span class="ow">or</span> <span class="n">model</span><span class="o">.</span><span class="n">divergs</span> <span class="ow">or</span> <span class="n">model</span><span class="o">.</span><span class="n">gusts</span><span class="p">):</span>
        <span class="k">return</span>

    <span class="n">area_scale</span> <span class="o">=</span> <span class="n">xyz_scale</span> <span class="o">**</span> <span class="mi">2</span>
    <span class="n">velocity_scale</span> <span class="o">=</span> <span class="n">xyz_scale</span> <span class="o">/</span> <span class="n">time_scale</span>
    <span class="n">acceleration_scale</span> <span class="o">=</span> <span class="n">xyz_scale</span> <span class="o">/</span> <span class="n">time_scale</span> <span class="o">**</span> <span class="mi">2</span>
    <span class="n">force_scale</span> <span class="o">=</span> <span class="n">weight_scale</span>
    <span class="n">moment_scale</span> <span class="o">=</span> <span class="n">force_scale</span> <span class="o">*</span> <span class="n">xyz_scale</span>
    <span class="n">pressure_scale</span> <span class="o">=</span> <span class="n">force_scale</span> <span class="o">/</span> <span class="n">xyz_scale</span> <span class="o">**</span> <span class="mi">2</span>
    <span class="n">density_scale</span> <span class="o">=</span> <span class="n">force_scale</span> <span class="o">/</span> <span class="n">xyz_scale</span> <span class="o">**</span> <span class="mi">3</span>

    <span class="n">angular_acceleration_scale</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">/</span> <span class="n">time_scale</span> <span class="o">**</span> <span class="mi">2</span>  <span class="c1"># rad/s^2</span>
    <span class="n">angular_velocity_scale</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">/</span> <span class="n">time_scale</span>  <span class="c1"># rad/s</span>

    <span class="n">model</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s1">&#39;--Aero Scales--&#39;</span><span class="p">)</span>
    <span class="n">model</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s1">&#39;area_scale (L^2) = </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">area_scale</span><span class="p">)</span>
    <span class="n">model</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s1">&#39;velocity_scale (L/T) = </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">velocity_scale</span><span class="p">)</span>
    <span class="n">model</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s1">&#39;pressure_scale (F/L^2) = </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">pressure_scale</span><span class="p">)</span>
    <span class="n">model</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s1">&#39;density_scale (F/L^3) = </span><span class="si">%s</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">density_scale</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">model</span><span class="o">.</span><span class="n">aero</span><span class="p">:</span>
        <span class="n">model</span><span class="o">.</span><span class="n">aero</span><span class="o">.</span><span class="n">cref</span> <span class="o">*=</span> <span class="n">xyz_scale</span>
        <span class="k">if</span> <span class="n">model</span><span class="o">.</span><span class="n">aero</span><span class="o">.</span><span class="n">velocity</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">model</span><span class="o">.</span><span class="n">aero</span><span class="o">.</span><span class="n">velocity</span> <span class="o">*=</span> <span class="n">velocity_scale</span>

        <span class="c1"># we handle density on FLFACTs</span>
        <span class="c1">#assert np.allclose(model.aero.rho_ref, 1.0), model.aero</span>

    <span class="k">if</span> <span class="n">model</span><span class="o">.</span><span class="n">aeros</span><span class="p">:</span>
        <span class="n">model</span><span class="o">.</span><span class="n">aeros</span><span class="o">.</span><span class="n">cref</span> <span class="o">*=</span> <span class="n">xyz_scale</span>
        <span class="n">model</span><span class="o">.</span><span class="n">aeros</span><span class="o">.</span><span class="n">bref</span> <span class="o">*=</span> <span class="n">xyz_scale</span>
        <span class="n">model</span><span class="o">.</span><span class="n">aeros</span><span class="o">.</span><span class="n">sref</span> <span class="o">*=</span> <span class="n">area_scale</span>

    <span class="n">xyz_aefacts</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">caero</span> <span class="ow">in</span> <span class="n">model</span><span class="o">.</span><span class="n">caeros</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
        <span class="n">_scale_caero</span><span class="p">(</span><span class="n">caero</span><span class="p">,</span> <span class="n">xyz_scale</span><span class="p">,</span> <span class="n">xyz_aefacts</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">paero</span> <span class="ow">in</span> <span class="n">model</span><span class="o">.</span><span class="n">paeros</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
        <span class="k">if</span> <span class="n">paero</span><span class="o">.</span><span class="n">type</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;PAERO1&#39;</span><span class="p">]:</span>
            <span class="k">continue</span>
        <span class="k">if</span> <span class="n">paero</span><span class="o">.</span><span class="n">type</span> <span class="o">==</span> <span class="s1">&#39;PAERO2&#39;</span><span class="p">:</span>
            <span class="c1">#: Reference half-width of body and the width of the constant width</span>
            <span class="c1">#: interference tube. (Real &gt; 0.0)</span>
            <span class="n">paero</span><span class="o">.</span><span class="n">width</span> <span class="o">*=</span> <span class="n">xyz_scale</span>

            <span class="k">if</span> <span class="n">paero</span><span class="o">.</span><span class="n">lrsb</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>  <span class="c1"># half-widths of slender body</span>
                <span class="n">xyz_aefacts</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">paero</span><span class="o">.</span><span class="n">lrsb</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">paero</span><span class="o">.</span><span class="n">lrib</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>  <span class="c1"># hafl-widths of interference elements</span>
                <span class="n">xyz_aefacts</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">paero</span><span class="o">.</span><span class="n">lrib</span><span class="p">)</span>
            <span class="c1">#self.lrsb_ref = None</span>
            <span class="c1">#self.lrib_ref = None</span>
    <span class="k">for</span> <span class="n">aefact_id</span> <span class="ow">in</span> <span class="n">xyz_aefacts</span><span class="p">:</span>
        <span class="n">aefact</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">aefacts</span><span class="p">[</span><span class="n">aefact_id</span><span class="p">]</span>
        <span class="n">aefact</span><span class="o">.</span><span class="n">fractions</span> <span class="o">*=</span> <span class="n">xyz_scale</span>

    <span class="k">for</span> <span class="n">trim</span> <span class="ow">in</span> <span class="n">model</span><span class="o">.</span><span class="n">trims</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
        <span class="n">trim</span><span class="o">.</span><span class="n">q</span> <span class="o">*=</span> <span class="n">pressure_scale</span>
        <span class="n">uxs2</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">label</span><span class="p">,</span> <span class="n">ux</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">trim</span><span class="o">.</span><span class="n">labels</span><span class="p">,</span> <span class="n">trim</span><span class="o">.</span><span class="n">uxs</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">label</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;URDD1&#39;</span><span class="p">,</span> <span class="s1">&#39;URDD2&#39;</span><span class="p">,</span> <span class="s1">&#39;URDD3&#39;</span><span class="p">]:</span>
                <span class="n">ux</span> <span class="o">*=</span> <span class="n">acceleration_scale</span>
            <span class="k">elif</span> <span class="n">label</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;URDD4&#39;</span><span class="p">,</span> <span class="s1">&#39;URDD5&#39;</span><span class="p">,</span> <span class="s1">&#39;URDD6&#39;</span><span class="p">]:</span>
                <span class="n">ux</span> <span class="o">*=</span> <span class="n">angular_acceleration_scale</span>
            <span class="k">elif</span> <span class="n">label</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;PITCH&#39;</span><span class="p">,</span> <span class="s1">&#39;ROLL&#39;</span><span class="p">,</span> <span class="s1">&#39;YAW&#39;</span><span class="p">]:</span>
                <span class="n">ux</span> <span class="o">*=</span> <span class="n">angular_velocity_scale</span>
            <span class="n">uxs2</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ux</span><span class="p">)</span>
        <span class="n">trim</span><span class="o">.</span><span class="n">uxs</span> <span class="o">=</span> <span class="n">uxs2</span>

    <span class="k">for</span> <span class="n">gust</span> <span class="ow">in</span> <span class="n">model</span><span class="o">.</span><span class="n">gusts</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
        <span class="n">gust</span><span class="o">.</span><span class="n">x0</span> <span class="o">*=</span> <span class="n">xyz_scale</span>
        <span class="n">gust</span><span class="o">.</span><span class="n">V</span> <span class="o">*=</span> <span class="n">velocity_scale</span>
    <span class="c1">#for spline in model.splines.values():</span>
        <span class="c1">#spline.convert(model)</span>
    <span class="c1">#for aecomp in model.aecomps.values():</span>
        <span class="c1">#aecomp.cross_reference(model)</span>
    <span class="c1">#for aelist in model.aelists.values():</span>
        <span class="c1">#aelist.cross_reference(model)</span>
    <span class="c1">#for aeparam in model.aeparams.values():</span>
        <span class="c1">#aeparam.cross_reference(model)</span>
    <span class="c1">#for aestat in model.aestats.values():</span>
        <span class="c1">#aestat.cross_reference(model)</span>

    <span class="k">if</span> <span class="s1">&#39;Q&#39;</span> <span class="ow">in</span> <span class="n">model</span><span class="o">.</span><span class="n">params</span><span class="p">:</span>
        <span class="n">model</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="s1">&#39;Q&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">value</span> <span class="o">*=</span> <span class="n">pressure_scale</span>

    <span class="n">q_scale_tables</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">aesurf</span> <span class="ow">in</span> <span class="n">model</span><span class="o">.</span><span class="n">aesurf</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
        <span class="k">if</span> <span class="n">aesurf</span><span class="o">.</span><span class="n">hmllim</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">aesurf</span><span class="o">.</span><span class="n">hmllim</span> <span class="o">*=</span> <span class="n">moment_scale</span>
        <span class="k">if</span> <span class="n">aesurf</span><span class="o">.</span><span class="n">hmulim</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">aesurf</span><span class="o">.</span><span class="n">hmulim</span> <span class="o">*=</span> <span class="n">moment_scale</span>

        <span class="k">if</span> <span class="n">aesurf</span><span class="o">.</span><span class="n">tqllim</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">q_scale_tables</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">aesurf</span><span class="o">.</span><span class="n">tqllim</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">aesurf</span><span class="o">.</span><span class="n">tqulim</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">q_scale_tables</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">aesurf</span><span class="o">.</span><span class="n">tqulim</span><span class="p">)</span>

    <span class="c1">#for aesurfs in model.aesurfs.values():</span>
        <span class="c1">#aesurfs.cross_reference(model)</span>
    <span class="k">for</span> <span class="n">monitor</span> <span class="ow">in</span> <span class="n">model</span><span class="o">.</span><span class="n">monitor_points</span><span class="p">:</span>
        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">monitor</span><span class="p">,</span> <span class="s1">&#39;xyz&#39;</span><span class="p">):</span>
            <span class="n">monitor</span><span class="o">.</span><span class="n">xyz</span> <span class="o">*=</span> <span class="n">xyz_scale</span>

    <span class="c1"># update only the FLFACTs corresponding to density/velocity (not kferq)</span>
    <span class="n">flfact_rho_ids</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>
    <span class="n">flfact_velocity_ids</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">flutter</span> <span class="ow">in</span> <span class="n">model</span><span class="o">.</span><span class="n">flutters</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
        <span class="n">flfact</span> <span class="o">=</span> <span class="n">flutter</span><span class="o">.</span><span class="n">density_ref</span>
        <span class="n">flfact_rho_ids</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">flfact</span><span class="o">.</span><span class="n">sid</span><span class="p">)</span>
        <span class="k">if</span> <span class="s1">&#39;velocity&#39;</span> <span class="ow">in</span> <span class="n">flutter</span><span class="o">.</span><span class="n">headers</span><span class="p">:</span> <span class="c1"># we skip kfreq</span>
            <span class="n">flfact</span> <span class="o">=</span> <span class="n">flutter</span><span class="o">.</span><span class="n">reduced_freq_velocity_ref</span>
            <span class="n">flfact_velocity_ids</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">flfact</span><span class="o">.</span><span class="n">sid</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">flfact_id</span> <span class="ow">in</span> <span class="n">flfact_rho_ids</span><span class="p">:</span> <span class="c1"># density</span>
        <span class="n">flfact</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">flfacts</span><span class="p">[</span><span class="n">flfact_id</span><span class="p">]</span>
        <span class="n">flfact</span><span class="o">.</span><span class="n">factors</span> <span class="o">*=</span> <span class="n">density_scale</span>
    <span class="k">for</span> <span class="n">flfact_id</span> <span class="ow">in</span> <span class="n">flfact_velocity_ids</span><span class="p">:</span> <span class="c1"># velocity</span>
        <span class="n">flfact</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">flfacts</span><span class="p">[</span><span class="n">flfact_id</span><span class="p">]</span>
        <span class="n">flfact</span><span class="o">.</span><span class="n">factors</span> <span class="o">*=</span> <span class="n">velocity_scale</span></div>

<div class="viewcode-block" id="_scale_caero"><a class="viewcode-back" href="../../../../reference/bdf/mesh_utils/pyNastran.bdf.mesh_utils.split_elements.html#pyNastran.bdf.mesh_utils.convert._scale_caero">[docs]</a><span class="k">def</span> <span class="nf">_scale_caero</span><span class="p">(</span><span class="n">caero</span><span class="p">,</span> <span class="n">xyz_scale</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">xyz_aefacts</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">caero</span><span class="o">.</span><span class="n">type</span> <span class="o">==</span> <span class="s1">&#39;CAERO1&#39;</span><span class="p">:</span>
            <span class="n">caero</span><span class="o">.</span><span class="n">p1</span> <span class="o">*=</span> <span class="n">xyz_scale</span>
            <span class="n">caero</span><span class="o">.</span><span class="n">p4</span> <span class="o">*=</span> <span class="n">xyz_scale</span>
            <span class="n">caero</span><span class="o">.</span><span class="n">x12</span> <span class="o">*=</span> <span class="n">xyz_scale</span>
            <span class="n">caero</span><span class="o">.</span><span class="n">x43</span> <span class="o">*=</span> <span class="n">xyz_scale</span>
        <span class="k">elif</span> <span class="n">caero</span><span class="o">.</span><span class="n">type</span> <span class="o">==</span> <span class="s1">&#39;CAERO2&#39;</span><span class="p">:</span>
            <span class="n">caero</span><span class="o">.</span><span class="n">p1</span> <span class="o">*=</span> <span class="n">xyz_scale</span>
            <span class="n">caero</span><span class="o">.</span><span class="n">x12</span> <span class="o">*=</span> <span class="n">xyz_scale</span>
            <span class="c1">#: ID of an AEFACT Bulk Data entry for slender body division</span>
            <span class="c1">#: points; used only if NSB is zero or blank. (Integer &gt;= 0)</span>
            <span class="k">if</span> <span class="n">caero</span><span class="o">.</span><span class="n">lsb</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">xyz_aefacts</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">caero</span><span class="o">.</span><span class="n">lsb</span><span class="p">)</span>

            <span class="c1">#: ID of an AEFACT data entry containing a list of division</span>
            <span class="c1">#: points for interference elements; used only if NINT is zero</span>
            <span class="c1">#: or blank. (Integer &gt; 0)</span>
            <span class="k">if</span> <span class="n">caero</span><span class="o">.</span><span class="n">lint</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">xyz_aefacts</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">caero</span><span class="o">.</span><span class="n">lint</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">caero</span><span class="o">.</span><span class="n">type</span> <span class="o">==</span> <span class="s1">&#39;CAERO3&#39;</span><span class="p">:</span>
            <span class="n">caero</span><span class="o">.</span><span class="n">p1</span> <span class="o">*=</span> <span class="n">xyz_scale</span>
            <span class="n">caero</span><span class="o">.</span><span class="n">p4</span> <span class="o">*=</span> <span class="n">xyz_scale</span>
            <span class="n">caero</span><span class="o">.</span><span class="n">x12</span> <span class="o">*=</span> <span class="n">xyz_scale</span>
            <span class="n">caero</span><span class="o">.</span><span class="n">x43</span> <span class="o">*=</span> <span class="n">xyz_scale</span>
        <span class="k">elif</span> <span class="n">caero</span><span class="o">.</span><span class="n">type</span> <span class="o">==</span> <span class="s1">&#39;CAERO5&#39;</span><span class="p">:</span>
            <span class="n">caero</span><span class="o">.</span><span class="n">p1</span> <span class="o">*=</span> <span class="n">xyz_scale</span>
            <span class="n">caero</span><span class="o">.</span><span class="n">p4</span> <span class="o">*=</span> <span class="n">xyz_scale</span>
            <span class="n">caero</span><span class="o">.</span><span class="n">x12</span> <span class="o">*=</span> <span class="n">xyz_scale</span>
            <span class="n">caero</span><span class="o">.</span><span class="n">x43</span> <span class="o">*=</span> <span class="n">xyz_scale</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">caero</span><span class="p">))</span>
    <span class="k">except</span> <span class="ne">TypeError</span><span class="p">:</span>  <span class="c1"># pragma: no cover</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">caero</span><span class="o">.</span><span class="n">get_stats</span><span class="p">())</span>
        <span class="k">raise</span></div>

<div class="viewcode-block" id="_convert_optimization"><a class="viewcode-back" href="../../../../reference/bdf/mesh_utils/pyNastran.bdf.mesh_utils.split_elements.html#pyNastran.bdf.mesh_utils.convert._convert_optimization">[docs]</a><span class="k">def</span> <span class="nf">_convert_optimization</span><span class="p">(</span><span class="n">model</span><span class="p">:</span> <span class="n">BDF</span><span class="p">,</span>
                          <span class="n">xyz_scale</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
                          <span class="n">mass_scale</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
                          <span class="n">weight_scale</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
                          <span class="n">time_scale</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Converts the optimization objects</span>

<span class="sd">    Limited Support: DESVAR, DCONSTR, DVCREL1, DVPREL1</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1">#time_scale = 1.</span>
    <span class="c1">#area_scale = xyz_scale ** 2</span>
    <span class="c1">#inertia_scale = xyz_scale ** 4</span>
    <span class="n">force_scale</span> <span class="o">=</span> <span class="n">weight_scale</span>
    <span class="c1">#velocity_scale = xyz_scale / time_scale</span>
    <span class="n">pressure_scale</span> <span class="o">=</span> <span class="n">force_scale</span> <span class="o">/</span> <span class="n">xyz_scale</span> <span class="o">**</span> <span class="mi">2</span>
    <span class="c1">#stiffness_scale = force_scale / xyz_scale</span>
    <span class="c1">#damping_scale = force_scale / velocity_scale</span>
    <span class="c1">#for key, deqatn in model.dequations.items():</span>
        <span class="c1">#deqatn.cross_reference(model)</span>
    <span class="c1">#for key, dresp in model.dresps.items():</span>
        <span class="c1">#dresp.cross_reference(model)</span>
    <span class="c1">#for key, desvar in model.desvars.items():</span>
        <span class="c1">#desvar.xinit *= scale</span>
        <span class="c1">#desvar.xlb *= scale</span>
        <span class="c1">#desvar.xub *= scale</span>
        <span class="c1">#desvar.delx *= scale</span>
        <span class="c1">#raise NotImplementedError(desvar)</span>


    <span class="k">for</span> <span class="n">unused_key</span><span class="p">,</span> <span class="n">dconstrs</span> <span class="ow">in</span> <span class="n">model</span><span class="o">.</span><span class="n">dconstrs</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="k">for</span> <span class="n">dconstr</span> <span class="ow">in</span> <span class="n">dconstrs</span><span class="p">:</span>
            <span class="c1"># scale is appled to lid/uid</span>
            <span class="n">_convert_dconstr</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">dconstr</span><span class="p">,</span> <span class="n">pressure_scale</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">unused_key</span><span class="p">,</span> <span class="n">dvcrel</span> <span class="ow">in</span> <span class="n">model</span><span class="o">.</span><span class="n">dvcrels</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="k">if</span> <span class="n">dvcrel</span><span class="o">.</span><span class="n">type</span> <span class="o">==</span> <span class="s1">&#39;DVCREL1&#39;</span><span class="p">:</span>
            <span class="n">scale</span> <span class="o">=</span> <span class="n">_convert_dvcrel1</span><span class="p">(</span><span class="n">dvcrel</span><span class="p">,</span> <span class="n">xyz_scale</span><span class="p">)</span>
            <span class="n">desvars</span> <span class="o">=</span> <span class="n">dvcrel</span><span class="o">.</span><span class="n">dvids_ref</span>
            <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">desvars</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">desvars</span><span class="p">)</span>
            <span class="n">_convert_desvars</span><span class="p">(</span><span class="n">desvars</span><span class="p">,</span> <span class="n">scale</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="n">dvcrel</span><span class="p">)</span>

        <span class="n">desvars</span> <span class="o">=</span> <span class="n">dvcrel</span><span class="o">.</span><span class="n">dvids_ref</span>
        <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">desvars</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">desvars</span><span class="p">)</span>
        <span class="n">_convert_desvars</span><span class="p">(</span><span class="n">desvars</span><span class="p">,</span> <span class="n">scale</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">unused_key</span><span class="p">,</span> <span class="n">dvmrel</span> <span class="ow">in</span> <span class="n">model</span><span class="o">.</span><span class="n">dvmrels</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="n">dvmrel</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">unused_key</span><span class="p">,</span> <span class="n">dvprel</span> <span class="ow">in</span> <span class="n">model</span><span class="o">.</span><span class="n">dvprels</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="k">if</span> <span class="n">dvprel</span><span class="o">.</span><span class="n">type</span> <span class="o">==</span> <span class="s1">&#39;DVPREL1&#39;</span><span class="p">:</span>
            <span class="n">scale</span> <span class="o">=</span> <span class="n">_convert_dvprel1</span><span class="p">(</span><span class="n">dvprel</span><span class="p">,</span> <span class="n">xyz_scale</span><span class="p">,</span> <span class="n">mass_scale</span><span class="p">,</span> <span class="n">weight_scale</span><span class="p">,</span> <span class="n">time_scale</span><span class="p">)</span>
            <span class="n">desvars</span> <span class="o">=</span> <span class="n">dvprel</span><span class="o">.</span><span class="n">dvids_ref</span>
            <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">desvars</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">desvars</span><span class="p">)</span>
            <span class="n">_convert_desvars</span><span class="p">(</span><span class="n">desvars</span><span class="p">,</span> <span class="n">scale</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="n">dvprel</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">dvprel</span><span class="o">.</span><span class="n">p_max</span> <span class="o">!=</span> <span class="mf">1e20</span><span class="p">:</span>
            <span class="n">dvprel</span><span class="o">.</span><span class="n">p_max</span> <span class="o">*=</span> <span class="n">scale</span>
        <span class="k">if</span> <span class="n">dvprel</span><span class="o">.</span><span class="n">p_min</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">dvprel</span><span class="o">.</span><span class="n">p_min</span> <span class="o">*=</span> <span class="n">scale</span></div>
        <span class="c1">#print(&#39;------------&#39;)</span>
        <span class="c1">#print(dvprel)</span>

<div class="viewcode-block" id="_convert_dconstr"><a class="viewcode-back" href="../../../../reference/bdf/mesh_utils/pyNastran.bdf.mesh_utils.split_elements.html#pyNastran.bdf.mesh_utils.convert._convert_dconstr">[docs]</a><span class="k">def</span> <span class="nf">_convert_dconstr</span><span class="p">(</span><span class="n">model</span><span class="p">:</span> <span class="n">BDF</span><span class="p">,</span> <span class="n">dconstr</span><span class="p">:</span> <span class="n">DCONSTR</span><span class="p">,</span> <span class="n">pressure_scale</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;helper for ``_convert_optimization``&quot;&quot;&quot;</span>
    <span class="n">otype</span> <span class="o">=</span> <span class="n">dconstr</span><span class="o">.</span><span class="n">type</span>
    <span class="k">if</span> <span class="n">otype</span> <span class="o">==</span> <span class="s1">&#39;DCONSTR&#39;</span><span class="p">:</span>
        <span class="n">dresp</span> <span class="o">=</span> <span class="n">dconstr</span><span class="o">.</span><span class="n">dresp_id_ref</span>
        <span class="k">if</span> <span class="n">dresp</span><span class="o">.</span><span class="n">type</span> <span class="o">==</span> <span class="s1">&#39;DRESP1&#39;</span><span class="p">:</span>
            <span class="c1">#property_type = dresp.ptype</span>
            <span class="n">response_type</span> <span class="o">=</span> <span class="n">dresp</span><span class="o">.</span><span class="n">rtype</span>
            <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">dresp</span><span class="o">.</span><span class="n">atti</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">,</span> <span class="n">dresp</span><span class="o">.</span><span class="n">atti</span>
            <span class="k">for</span> <span class="n">atti</span> <span class="ow">in</span> <span class="n">dresp</span><span class="o">.</span><span class="n">atti</span><span class="p">:</span>
                <span class="c1">#label = dresp.label</span>
                <span class="c1">#atti_type = atti.type</span>
                <span class="k">if</span> <span class="n">response_type</span> <span class="o">==</span> <span class="s1">&#39;STRESS&#39;</span><span class="p">:</span>
                    <span class="n">scale</span> <span class="o">=</span> <span class="n">pressure_scale</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="n">atti</span><span class="p">)</span>
                <span class="c1">#if atti</span>
                <span class="c1">#if property_type == &#39;PSHELL&#39;:</span>
                    <span class="c1">#if rst</span>
        <span class="k">elif</span> <span class="n">dresp</span><span class="o">.</span><span class="n">type</span> <span class="o">==</span> <span class="s1">&#39;DRESP2&#39;</span><span class="p">:</span>
            <span class="n">msg</span> <span class="o">=</span> <span class="s1">&#39;skipping:</span><span class="se">\n</span><span class="si">%s%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">dconstr</span><span class="p">),</span> <span class="nb">str</span><span class="p">(</span><span class="n">dresp</span><span class="p">))</span>
            <span class="n">model</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
            <span class="k">return</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="n">dresp</span><span class="p">)</span>

        <span class="c1"># lower bound</span>
        <span class="n">dconstr</span><span class="o">.</span><span class="n">lid</span> <span class="o">*=</span> <span class="n">scale</span>
        <span class="c1"># upper bound</span>
        <span class="n">dconstr</span><span class="o">.</span><span class="n">uid</span> <span class="o">*=</span> <span class="n">scale</span>

        <span class="c1"># low end of frequency range (Hz)</span>
        <span class="n">dconstr</span><span class="o">.</span><span class="n">lowfq</span> <span class="o">=</span> <span class="n">scale</span>
        <span class="c1"># high end of frequency range (Hz)</span>
        <span class="n">dconstr</span><span class="o">.</span><span class="n">highfq</span> <span class="o">=</span> <span class="n">scale</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="n">dconstr</span><span class="p">)</span></div>

<div class="viewcode-block" id="_convert_dvcrel1"><a class="viewcode-back" href="../../../../reference/bdf/mesh_utils/pyNastran.bdf.mesh_utils.split_elements.html#pyNastran.bdf.mesh_utils.convert._convert_dvcrel1">[docs]</a><span class="k">def</span> <span class="nf">_convert_dvcrel1</span><span class="p">(</span><span class="n">dvcrel</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">DVCREL1</span><span class="p">,</span> <span class="n">DVCREL2</span><span class="p">],</span> <span class="n">xyz_scale</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;helper for ``_convert_optimization``&quot;&quot;&quot;</span>
    <span class="n">element_type</span> <span class="o">=</span> <span class="n">dvcrel</span><span class="o">.</span><span class="n">element_type</span>
    <span class="k">if</span> <span class="n">element_type</span> <span class="o">==</span> <span class="s1">&#39;CBUSH&#39;</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">dvcrel</span><span class="o">.</span><span class="n">cp_name</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;X1&#39;</span><span class="p">,</span> <span class="s1">&#39;X2&#39;</span><span class="p">,</span> <span class="s1">&#39;X3&#39;</span><span class="p">,</span> <span class="s1">&#39;S&#39;</span><span class="p">,</span> <span class="s1">&#39;S1&#39;</span><span class="p">,</span> <span class="s1">&#39;S2&#39;</span><span class="p">,</span> <span class="s1">&#39;S3&#39;</span><span class="p">]:</span>
            <span class="n">scale</span> <span class="o">=</span> <span class="n">xyz_scale</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="n">dvcrel</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="n">dvcrel</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">scale</span></div>

<div class="viewcode-block" id="_convert_dvprel1"><a class="viewcode-back" href="../../../../reference/bdf/mesh_utils/pyNastran.bdf.mesh_utils.split_elements.html#pyNastran.bdf.mesh_utils.convert._convert_dvprel1">[docs]</a><span class="k">def</span> <span class="nf">_convert_dvprel1</span><span class="p">(</span><span class="n">dvprel</span><span class="p">,</span> <span class="n">xyz_scale</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
                     <span class="n">mass_scale</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
                     <span class="n">weight_scale</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
                     <span class="n">time_scale</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;helper for ``_convert_optimization``&quot;&quot;&quot;</span>
    <span class="n">area_scale</span> <span class="o">=</span> <span class="n">xyz_scale</span> <span class="o">**</span> <span class="mi">2</span>
    <span class="n">inertia_scale</span> <span class="o">=</span> <span class="n">xyz_scale</span> <span class="o">**</span> <span class="mi">4</span>
    <span class="n">force_scale</span> <span class="o">=</span> <span class="n">weight_scale</span>
    <span class="n">velocity_scale</span> <span class="o">=</span> <span class="n">xyz_scale</span> <span class="o">/</span> <span class="n">time_scale</span>
    <span class="c1">#pressure_scale = force_scale / xyz_scale ** 2</span>
    <span class="n">stress_scale</span> <span class="o">=</span> <span class="n">force_scale</span> <span class="o">/</span> <span class="n">xyz_scale</span> <span class="o">**</span> <span class="mi">2</span>
    <span class="n">stiffness_scale</span> <span class="o">=</span> <span class="n">force_scale</span> <span class="o">/</span> <span class="n">xyz_scale</span>
    <span class="n">damping_scale</span> <span class="o">=</span> <span class="n">force_scale</span> <span class="o">/</span> <span class="n">velocity_scale</span>

    <span class="c1">#print(dvprel)</span>
    <span class="n">prop_type</span> <span class="o">=</span> <span class="n">dvprel</span><span class="o">.</span><span class="n">prop_type</span>
    <span class="n">var_to_change</span> <span class="o">=</span> <span class="n">dvprel</span><span class="o">.</span><span class="n">pname_fid</span>

    <span class="n">scale</span> <span class="o">=</span> <span class="mf">1.</span>
    <span class="k">if</span> <span class="n">prop_type</span> <span class="o">==</span> <span class="s1">&#39;PSHELL&#39;</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">var_to_change</span> <span class="o">==</span> <span class="s1">&#39;T&#39;</span><span class="p">:</span>
            <span class="n">scale</span> <span class="o">=</span> <span class="n">xyz_scale</span>
        <span class="k">elif</span> <span class="n">var_to_change</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">6</span><span class="p">,</span> <span class="mi">8</span><span class="p">]:</span> <span class="c1"># 12I/t^3, ts/t</span>
            <span class="n">scale</span> <span class="o">=</span> <span class="mf">1.</span>
        <span class="k">else</span><span class="p">:</span>  <span class="c1"># pragma: no cover</span>
            <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="s1">&#39;cannot convert </span><span class="si">%r</span><span class="se">\n</span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">var_to_change</span><span class="p">,</span> <span class="n">dvprel</span><span class="p">))</span>
    <span class="k">elif</span> <span class="n">prop_type</span> <span class="o">==</span> <span class="s1">&#39;PCOMP&#39;</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">var_to_change</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;THETA&#39;</span><span class="p">)</span> <span class="ow">or</span> <span class="n">var_to_change</span> <span class="o">==</span> <span class="s1">&#39;GE&#39;</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">scale</span>
        <span class="k">if</span> <span class="n">var_to_change</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;T&#39;</span><span class="p">)</span> <span class="ow">or</span> <span class="n">var_to_change</span> <span class="o">==</span> <span class="s1">&#39;Z0&#39;</span><span class="p">:</span>
            <span class="n">scale</span> <span class="o">=</span> <span class="n">xyz_scale</span>
        <span class="k">elif</span> <span class="n">var_to_change</span> <span class="o">==</span> <span class="s1">&#39;SB&#39;</span><span class="p">:</span> <span class="c1"># Allowable shear stress of the bonding material</span>
            <span class="n">scale</span> <span class="o">=</span> <span class="n">stress_scale</span>
        <span class="k">else</span><span class="p">:</span>  <span class="c1"># pragma: no cover</span>
            <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="s1">&#39;cannot convert </span><span class="si">%r</span><span class="se">\n</span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">var_to_change</span><span class="p">,</span> <span class="n">dvprel</span><span class="p">))</span>
    <span class="k">elif</span> <span class="n">prop_type</span> <span class="o">==</span> <span class="s1">&#39;PBARL&#39;</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">var_to_change</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;DIM&#39;</span><span class="p">):</span>
            <span class="n">scale</span> <span class="o">=</span> <span class="n">xyz_scale</span>
        <span class="k">else</span><span class="p">:</span>  <span class="c1"># pragma: no cover</span>
            <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="s1">&#39;cannot convert </span><span class="si">%r</span><span class="se">\n</span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">var_to_change</span><span class="p">,</span> <span class="n">dvprel</span><span class="p">))</span>
    <span class="k">elif</span> <span class="n">prop_type</span> <span class="o">==</span> <span class="s1">&#39;PBEAM&#39;</span><span class="p">:</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">prop_type</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
            <span class="n">word</span><span class="p">,</span> <span class="n">unused_num</span> <span class="o">=</span> <span class="n">break_word_by_trailing_parentheses_integer_ab</span><span class="p">(</span>
                <span class="n">var_to_change</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">word</span> <span class="o">==</span> <span class="s1">&#39;A&#39;</span><span class="p">:</span>
                <span class="n">scale</span> <span class="o">=</span> <span class="n">area_scale</span>
            <span class="k">elif</span> <span class="n">word</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;I1&#39;</span><span class="p">,</span> <span class="s1">&#39;I2&#39;</span><span class="p">,</span> <span class="s1">&#39;I12&#39;</span><span class="p">,</span> <span class="s1">&#39;J&#39;</span><span class="p">]:</span>
                <span class="n">scale</span> <span class="o">=</span> <span class="n">inertia_scale</span>
            <span class="k">elif</span> <span class="n">word</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;C1&#39;</span><span class="p">,</span> <span class="s1">&#39;C2&#39;</span><span class="p">,</span> <span class="s1">&#39;D1&#39;</span><span class="p">,</span> <span class="s1">&#39;D2&#39;</span><span class="p">,</span> <span class="s1">&#39;E1&#39;</span><span class="p">,</span> <span class="s1">&#39;E2&#39;</span><span class="p">,</span> <span class="s1">&#39;F1&#39;</span><span class="p">,</span> <span class="s1">&#39;F2&#39;</span><span class="p">]:</span>
                <span class="n">scale</span> <span class="o">=</span> <span class="n">xyz_scale</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="n">dvprel</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="n">dvprel</span><span class="p">)</span>

    <span class="k">elif</span> <span class="n">prop_type</span> <span class="o">==</span> <span class="s1">&#39;PBEAML&#39;</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">var_to_change</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;DIM&#39;</span><span class="p">):</span>
            <span class="n">scale</span> <span class="o">=</span> <span class="n">xyz_scale</span>
        <span class="k">else</span><span class="p">:</span>  <span class="c1"># pragma: no cover</span>
            <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="s1">&#39;cannot convert </span><span class="si">%r</span><span class="se">\n</span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">var_to_change</span><span class="p">,</span> <span class="n">dvprel</span><span class="p">))</span>
    <span class="k">elif</span> <span class="n">prop_type</span> <span class="o">==</span> <span class="s1">&#39;PSHEAR&#39;</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">var_to_change</span> <span class="o">==</span> <span class="s1">&#39;T&#39;</span><span class="p">:</span>
            <span class="n">scale</span> <span class="o">=</span> <span class="n">xyz_scale</span>
        <span class="k">else</span><span class="p">:</span>  <span class="c1"># pragma: no cover</span>
            <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="s1">&#39;cannot convert </span><span class="si">%r</span><span class="se">\n</span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">var_to_change</span><span class="p">,</span> <span class="n">dvprel</span><span class="p">))</span>
    <span class="k">elif</span> <span class="n">prop_type</span> <span class="o">==</span> <span class="s1">&#39;PBUSH&#39;</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">var_to_change</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;K1&#39;</span><span class="p">,</span> <span class="s1">&#39;K2&#39;</span><span class="p">,</span> <span class="s1">&#39;K3&#39;</span><span class="p">,</span> <span class="s1">&#39;K4&#39;</span><span class="p">,</span> <span class="s1">&#39;K5&#39;</span><span class="p">,</span> <span class="s1">&#39;K6&#39;</span><span class="p">]:</span>
            <span class="n">scale</span> <span class="o">=</span> <span class="n">stiffness_scale</span>
        <span class="k">elif</span> <span class="n">var_to_change</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;B1&#39;</span><span class="p">,</span> <span class="s1">&#39;B2&#39;</span><span class="p">,</span> <span class="s1">&#39;B3&#39;</span><span class="p">,</span> <span class="s1">&#39;B4&#39;</span><span class="p">,</span> <span class="s1">&#39;B5&#39;</span><span class="p">,</span> <span class="s1">&#39;B6&#39;</span><span class="p">]:</span>
            <span class="n">scale</span> <span class="o">=</span> <span class="n">damping_scale</span>
        <span class="k">else</span><span class="p">:</span>  <span class="c1"># pragma: no cover</span>
            <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="s1">&#39;cannot convert </span><span class="si">%r</span><span class="se">\n</span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">var_to_change</span><span class="p">,</span> <span class="n">dvprel</span><span class="p">))</span>
    <span class="k">elif</span> <span class="n">prop_type</span> <span class="o">==</span> <span class="s1">&#39;PGAP&#39;</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">var_to_change</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;KA&#39;</span><span class="p">,</span> <span class="s1">&#39;KB&#39;</span><span class="p">,</span> <span class="s1">&#39;KT&#39;</span><span class="p">]:</span>
            <span class="n">scale</span> <span class="o">=</span> <span class="n">stiffness_scale</span>
        <span class="k">else</span><span class="p">:</span>  <span class="c1"># pragma: no cover</span>
            <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="s1">&#39;cannot convert </span><span class="si">%r</span><span class="se">\n</span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">var_to_change</span><span class="p">,</span> <span class="n">dvprel</span><span class="p">))</span>
        <span class="c1">##: initial gap opening</span>
        <span class="c1">#prop.u0 *= xyz_scale</span>
        <span class="c1">##: preload</span>
        <span class="c1">#prop.f0 *= force_scale</span>

    <span class="k">elif</span> <span class="n">prop_type</span> <span class="o">==</span> <span class="s1">&#39;PBUSH1D&#39;</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">var_to_change</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;K&#39;</span><span class="p">]:</span>
            <span class="n">scale</span> <span class="o">=</span> <span class="n">stiffness_scale</span>
        <span class="k">elif</span> <span class="n">var_to_change</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;C&#39;</span><span class="p">]:</span>
            <span class="n">scale</span> <span class="o">=</span> <span class="n">damping_scale</span>
        <span class="k">elif</span> <span class="n">var_to_change</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;M&#39;</span><span class="p">]:</span>
            <span class="n">scale</span> <span class="o">=</span> <span class="n">mass_scale</span>
        <span class="k">else</span><span class="p">:</span>  <span class="c1"># pragma: no cover</span>
            <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="s1">&#39;cannot convert </span><span class="si">%r</span><span class="se">\n</span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">var_to_change</span><span class="p">,</span> <span class="n">dvprel</span><span class="p">))</span>

    <span class="k">elif</span> <span class="n">prop_type</span> <span class="o">==</span> <span class="s1">&#39;PVISC&#39;</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">var_to_change</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;CE1&#39;</span><span class="p">]:</span>
            <span class="n">scale</span> <span class="o">=</span> <span class="n">force_scale</span> <span class="o">/</span> <span class="n">velocity_scale</span>
        <span class="k">else</span><span class="p">:</span>  <span class="c1"># pragma: no cover</span>
            <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="s1">&#39;cannot convert </span><span class="si">%r</span><span class="se">\n</span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">var_to_change</span><span class="p">,</span> <span class="n">dvprel</span><span class="p">))</span>

        <span class="c1">#prop.ce *= force_scale / velocity_scale</span>
        <span class="c1">#prop.cr *= moment_scale / velocity_scale</span>
    <span class="k">elif</span> <span class="n">prop_type</span> <span class="o">==</span> <span class="s1">&#39;PDAMP&#39;</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">var_to_change</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;B1&#39;</span><span class="p">]:</span>
            <span class="n">scale</span> <span class="o">=</span> <span class="n">force_scale</span> <span class="o">/</span> <span class="n">velocity_scale</span>
        <span class="k">else</span><span class="p">:</span>  <span class="c1"># pragma: no cover</span>
            <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="s1">&#39;cannot convert </span><span class="si">%r</span><span class="se">\n</span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">var_to_change</span><span class="p">,</span> <span class="n">dvprel</span><span class="p">))</span>
    <span class="k">elif</span> <span class="n">prop_type</span> <span class="o">==</span> <span class="s1">&#39;PBAR&#39;</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">var_to_change</span> <span class="o">==</span> <span class="s1">&#39;A&#39;</span><span class="p">:</span>
            <span class="n">scale</span> <span class="o">=</span> <span class="n">area_scale</span>
        <span class="k">elif</span> <span class="n">var_to_change</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;I1&#39;</span><span class="p">,</span> <span class="s1">&#39;I2&#39;</span><span class="p">,</span> <span class="s1">&#39;I12&#39;</span><span class="p">,</span> <span class="s1">&#39;J&#39;</span><span class="p">]:</span>
            <span class="n">scale</span> <span class="o">=</span> <span class="n">inertia_scale</span>
        <span class="k">else</span><span class="p">:</span>  <span class="c1"># pragma: no cover</span>
            <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="s1">&#39;cannot convert </span><span class="si">%r</span><span class="se">\n</span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">var_to_change</span><span class="p">,</span> <span class="n">dvprel</span><span class="p">))</span>
    <span class="k">elif</span> <span class="n">prop_type</span> <span class="o">==</span> <span class="s1">&#39;PROD&#39;</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">var_to_change</span> <span class="o">==</span> <span class="s1">&#39;A&#39;</span><span class="p">:</span>
            <span class="n">scale</span> <span class="o">=</span> <span class="n">area_scale</span>
        <span class="k">elif</span> <span class="n">var_to_change</span> <span class="o">==</span> <span class="s1">&#39;J&#39;</span><span class="p">:</span>
            <span class="n">scale</span> <span class="o">=</span> <span class="n">inertia_scale</span>
        <span class="k">else</span><span class="p">:</span>  <span class="c1"># pragma: no cover</span>
            <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="s1">&#39;cannot convert </span><span class="si">%r</span><span class="se">\n</span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">var_to_change</span><span class="p">,</span> <span class="n">dvprel</span><span class="p">))</span>
    <span class="k">elif</span> <span class="n">prop_type</span> <span class="o">==</span> <span class="s1">&#39;PTUBE&#39;</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">var_to_change</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;OD&#39;</span><span class="p">,</span> <span class="s1">&#39;T&#39;</span><span class="p">]:</span>
            <span class="n">scale</span> <span class="o">=</span> <span class="n">xyz_scale</span>
        <span class="c1">#elif var_to_change == &#39;J&#39;:</span>
            <span class="c1">#scale = inertia_scale</span>
        <span class="k">else</span><span class="p">:</span>  <span class="c1"># pragma: no cover</span>
            <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="s1">&#39;cannot convert </span><span class="si">%r</span><span class="se">\n</span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">var_to_change</span><span class="p">,</span> <span class="n">dvprel</span><span class="p">))</span>
    <span class="k">else</span><span class="p">:</span>  <span class="c1"># pragma: no cover</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="s1">&#39;cannot convert </span><span class="si">%r</span><span class="se">\n</span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">prop_type</span><span class="p">,</span> <span class="n">dvprel</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">scale</span></div>

<div class="viewcode-block" id="_convert_desvars"><a class="viewcode-back" href="../../../../reference/bdf/mesh_utils/pyNastran.bdf.mesh_utils.split_elements.html#pyNastran.bdf.mesh_utils.convert._convert_desvars">[docs]</a><span class="k">def</span> <span class="nf">_convert_desvars</span><span class="p">(</span><span class="n">desvars</span><span class="p">,</span> <span class="n">scale</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;scales the DVPREL/DVCREL/DVMREL DESVAR values&quot;&quot;&quot;</span>
    <span class="k">for</span> <span class="n">desvar</span> <span class="ow">in</span> <span class="n">desvars</span><span class="p">:</span>
        <span class="n">desvar</span><span class="o">.</span><span class="n">xinit</span> <span class="o">*=</span> <span class="n">scale</span>
        <span class="k">if</span> <span class="n">desvar</span><span class="o">.</span><span class="n">xlb</span> <span class="o">!=</span> <span class="o">-</span><span class="mf">1e20</span><span class="p">:</span>
            <span class="n">desvar</span><span class="o">.</span><span class="n">xlb</span> <span class="o">*=</span> <span class="n">scale</span>
        <span class="k">if</span> <span class="n">desvar</span><span class="o">.</span><span class="n">xub</span> <span class="o">!=</span> <span class="mf">1e20</span><span class="p">:</span>
            <span class="n">desvar</span><span class="o">.</span><span class="n">xub</span> <span class="o">*=</span> <span class="n">scale</span>
        <span class="c1">#if desvar.delx != 1e20:</span>
        <span class="k">if</span> <span class="n">desvar</span><span class="o">.</span><span class="n">delx</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">desvar</span><span class="o">.</span><span class="n">delx</span> <span class="o">!=</span> <span class="mf">1e20</span><span class="p">:</span>
            <span class="n">desvar</span><span class="o">.</span><span class="n">delx</span> <span class="o">*=</span> <span class="n">scale</span>
        <span class="k">if</span> <span class="n">desvar</span><span class="o">.</span><span class="n">ddval</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">msg</span> <span class="o">=</span> <span class="s1">&#39;DESVAR id=</span><span class="si">%s</span><span class="s1"> DDVAL is not None</span><span class="se">\n</span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="nb">str</span><span class="p">(</span><span class="n">desvar</span><span class="p">)</span>
            <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
        <span class="k">assert</span> <span class="n">desvar</span><span class="o">.</span><span class="n">ddval</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">,</span> <span class="n">desvar</span></div>

<div class="viewcode-block" id="get_scale_factors"><a class="viewcode-back" href="../../../../reference/bdf/mesh_utils/pyNastran.bdf.mesh_utils.split_elements.html#pyNastran.bdf.mesh_utils.convert.get_scale_factors">[docs]</a><span class="k">def</span> <span class="nf">get_scale_factors</span><span class="p">(</span><span class="n">units_from</span><span class="p">,</span> <span class="n">units_to</span><span class="p">,</span> <span class="n">log</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    [length, mass, time]</span>
<span class="sd">    [in, lb, s]</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># in-lb-s</span>
    <span class="c1"># m-kg-s</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">length_from</span><span class="p">,</span> <span class="n">mass_from</span><span class="p">,</span> <span class="n">time_from</span> <span class="o">=</span> <span class="n">units_from</span>
        <span class="n">length_to</span><span class="p">,</span> <span class="n">mass_to</span><span class="p">,</span> <span class="n">time_to</span> <span class="o">=</span> <span class="n">units_to</span>
    <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
        <span class="n">msg</span> <span class="o">=</span> <span class="s1">&#39;units_from=</span><span class="si">%s</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">units_from</span>
        <span class="n">msg</span> <span class="o">+=</span> <span class="s1">&#39;units_to=</span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">units_to</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
    <span class="c1">#length_from = units_from[0]</span>
    <span class="c1">#length_to = units_to[0]</span>

    <span class="c1">#mass_from = units_from[1]</span>
    <span class="c1">#mass_to = units_to[1]</span>

    <span class="c1">#time_from = units_from[2]</span>
    <span class="c1">#time_to = units_to[2]</span>
    <span class="k">assert</span> <span class="n">time_from</span> <span class="o">==</span> <span class="n">time_to</span><span class="p">,</span> <span class="s1">&#39;units_from=</span><span class="si">%s</span><span class="s1"> units_to=</span><span class="si">%s</span><span class="s1"> time_from=</span><span class="si">%r</span><span class="s1"> time_to=</span><span class="si">%r</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span>
        <span class="n">units_from</span><span class="p">,</span> <span class="n">units_to</span><span class="p">,</span> <span class="n">time_from</span><span class="p">,</span> <span class="n">time_to</span><span class="p">)</span>
    <span class="n">time_scale</span> <span class="o">=</span> <span class="mf">1.0</span>
    <span class="n">gravity_scale</span> <span class="o">=</span> <span class="mf">1.0</span>
    <span class="n">xyz_scale</span><span class="p">,</span> <span class="n">gravity_scale_length</span> <span class="o">=</span> <span class="n">convert_length</span><span class="p">(</span><span class="n">length_from</span><span class="p">,</span> <span class="n">length_to</span><span class="p">)</span>

    <span class="n">mass_scale</span><span class="p">,</span> <span class="n">weight_scale</span><span class="p">,</span> <span class="n">gravity_scale_mass</span> <span class="o">=</span> <span class="n">convert_mass</span><span class="p">(</span><span class="n">mass_from</span><span class="p">,</span> <span class="n">mass_to</span><span class="p">,</span> <span class="n">log</span><span class="p">)</span>
    <span class="n">weight_scale</span> <span class="o">/=</span> <span class="n">time_scale</span> <span class="o">**</span> <span class="mi">2</span>   <span class="c1"># doesn&#39;t consider cm/mm</span>

    <span class="c1">#print(&#39;gravity_scale_length=%s gravity_scale_mass=%s gravity_scale=%s&#39; % (</span>
        <span class="c1">#gravity_scale_length, gravity_scale_mass, gravity_scale))</span>

    <span class="c1">## doesn&#39;t consider cm/mm</span>
    <span class="n">gravity_scale</span> <span class="o">=</span> <span class="n">gravity_scale_length</span> <span class="o">*</span> <span class="n">gravity_scale_mass</span> <span class="o">/</span> <span class="n">time_scale</span> <span class="o">**</span> <span class="mi">2</span>
    <span class="c1"># 4.448N = 1 lbm</span>
    <span class="c1"># 1 slug = 14.5939 kg</span>
    <span class="c1"># 1g = 32.174 ft/s^2 = 386.088 = 9.80665 m/s^2</span>
    <span class="k">return</span> <span class="n">xyz_scale</span><span class="p">,</span> <span class="n">mass_scale</span><span class="p">,</span> <span class="n">time_scale</span><span class="p">,</span> <span class="n">weight_scale</span><span class="p">,</span> <span class="n">gravity_scale</span></div>


<div class="viewcode-block" id="convert_length"><a class="viewcode-back" href="../../../../reference/bdf/mesh_utils/pyNastran.bdf.mesh_utils.split_elements.html#pyNastran.bdf.mesh_utils.convert.convert_length">[docs]</a><span class="k">def</span> <span class="nf">convert_length</span><span class="p">(</span><span class="n">length_from</span><span class="p">,</span> <span class="n">length_to</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Determines the length scale factor</span>

<span class="sd">    We crate a gravity_scale_length for any non-standard unit (ft, m)</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">xyz_scale</span> <span class="o">=</span> <span class="mf">1.0</span>
    <span class="n">gravity_scale_length</span> <span class="o">=</span> <span class="mf">1.0</span>

    <span class="c1">#if length_from != length_to:</span>
    <span class="k">if</span> <span class="n">length_from</span> <span class="o">==</span> <span class="s1">&#39;in&#39;</span><span class="p">:</span>
        <span class="n">xyz_scale</span> <span class="o">*=</span> <span class="mf">0.0254</span>
        <span class="n">gravity_scale_length</span> <span class="o">/=</span> <span class="mf">12.</span>
    <span class="k">elif</span> <span class="n">length_from</span> <span class="o">==</span> <span class="s1">&#39;ft&#39;</span><span class="p">:</span>
        <span class="n">xyz_scale</span> <span class="o">*=</span> <span class="mf">0.3048</span>
        <span class="c1"># ft/s^2 are the base units for english</span>

    <span class="k">elif</span> <span class="n">length_from</span> <span class="o">==</span> <span class="s1">&#39;m&#39;</span><span class="p">:</span>
        <span class="c1">#xyz_scale = 1.0</span>
        <span class="c1">#gravity_scale_length = 1.0</span>
        <span class="c1"># m/s^2 are the base units for SI</span>
        <span class="k">pass</span>
    <span class="k">elif</span> <span class="n">length_from</span> <span class="o">==</span> <span class="s1">&#39;cm&#39;</span><span class="p">:</span>
        <span class="n">xyz_scale</span> <span class="o">*=</span> <span class="mf">100.</span>
        <span class="n">gravity_scale_length</span> <span class="o">/=</span> <span class="mf">100.</span>
    <span class="k">elif</span> <span class="n">length_from</span> <span class="o">==</span> <span class="s1">&#39;mm&#39;</span><span class="p">:</span>
        <span class="n">xyz_scale</span> <span class="o">/=</span> <span class="mf">1000.</span>
        <span class="n">gravity_scale_length</span> <span class="o">/=</span> <span class="mf">1000.</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="s1">&#39;length from unit=</span><span class="si">%r</span><span class="s1">; expected=[in, ft, m, cm, mm]&#39;</span> <span class="o">%</span> <span class="n">length_from</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">length_to</span> <span class="o">==</span> <span class="s1">&#39;in&#39;</span><span class="p">:</span>
        <span class="n">xyz_scale</span> <span class="o">/=</span> <span class="mf">0.0254</span>
        <span class="n">gravity_scale_length</span> <span class="o">*=</span> <span class="mf">12.</span>
    <span class="k">elif</span> <span class="n">length_to</span> <span class="o">==</span> <span class="s1">&#39;ft&#39;</span><span class="p">:</span>
        <span class="n">xyz_scale</span> <span class="o">/=</span> <span class="mf">0.3048</span>
    <span class="k">elif</span> <span class="n">length_to</span> <span class="o">==</span> <span class="s1">&#39;m&#39;</span><span class="p">:</span>
        <span class="c1">#xyz_scale /= 1.0</span>
        <span class="k">pass</span>
    <span class="k">elif</span> <span class="n">length_to</span> <span class="o">==</span> <span class="s1">&#39;cm&#39;</span><span class="p">:</span>
        <span class="n">xyz_scale</span> <span class="o">/=</span> <span class="mf">100.</span>
        <span class="n">gravity_scale_length</span> <span class="o">*=</span> <span class="mf">100.</span>
    <span class="k">elif</span> <span class="n">length_to</span> <span class="o">==</span> <span class="s1">&#39;mm&#39;</span><span class="p">:</span>
        <span class="n">xyz_scale</span> <span class="o">*=</span> <span class="mf">1000.</span>
        <span class="n">gravity_scale_length</span> <span class="o">*=</span> <span class="mf">1000.</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="s1">&#39;length to unit=</span><span class="si">%r</span><span class="s1">; expected=[in, ft, m, cm, mm]&#39;</span> <span class="o">%</span> <span class="n">length_to</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">xyz_scale</span><span class="p">,</span> <span class="n">gravity_scale_length</span></div>


<div class="viewcode-block" id="convert_mass"><a class="viewcode-back" href="../../../../reference/bdf/mesh_utils/pyNastran.bdf.mesh_utils.split_elements.html#pyNastran.bdf.mesh_utils.convert.convert_mass">[docs]</a><span class="k">def</span> <span class="nf">convert_mass</span><span class="p">(</span><span class="n">mass_from</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">mass_to</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
                 <span class="n">log</span><span class="p">:</span> <span class="n">SimpleLogger</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="nb">float</span><span class="p">]:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    determines the mass, weight, gravity scale factor</span>

<span class="sd">    We apply a gravity_scale_mass for any unit not {kg, slug}.</span>
<span class="sd">    Then we convert to N.</span>

<span class="sd">    So for SI, if we have kg, we have a base unit, and the length is assumed</span>
<span class="sd">    to be m, so we have a consistent system and gravity_scale_mass is 1.0.</span>

<span class="sd">    For lbm:</span>
<span class="sd">       F = m*a</span>
<span class="sd">       1 lbf = 1 lbm * 1 ft/s^2</span>
<span class="sd">       32 lbf = 1 slug * 32 ft/s^2</span>
<span class="sd">       gscale = 1/g</span>
<span class="sd">       F = gscale * m * a</span>
<span class="sd">       1 lbf = gscale * 1 lbm * 32 ft/s^2</span>
<span class="sd">       --&gt; gscale = 1/32</span>

<span class="sd">    For slug:</span>
<span class="sd">       F = gscale * m * a</span>
<span class="sd">       32 lbf = gscale * 1 slug * 32 ft/s^2</span>
<span class="sd">       --&gt; gscale = 1</span>

<span class="sd">    For slinch:</span>
<span class="sd">       F = gscale * m * a</span>
<span class="sd">       386 lbf = gscale * 1 slinch * 12*32 in/s^2</span>
<span class="sd">       1 slinch = 12 slug</span>
<span class="sd">       12 in = 1 ft</span>
<span class="sd">       386 lbf = gscale * 12 slug * 32 ft/s^2</span>
<span class="sd">       --&gt; gscale = 1</span>

<span class="sd">    TODO: slinch/slug not validated</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">mass_scale</span> <span class="o">=</span> <span class="mf">1.0</span>
    <span class="n">weight_scale</span> <span class="o">=</span> <span class="mf">1.0</span>

    <span class="c1"># gravity scale is only required if you have a force-based system</span>
    <span class="n">gravity_scale_mass</span> <span class="o">=</span> <span class="mf">1.0</span>

    <span class="c1">#gravity_english = 9.80665 / .3048 #= 32.174; exact</span>
    <span class="n">gravity_english_ft</span> <span class="o">=</span> <span class="mf">32.174</span>
    <span class="c1">#gravity_english_in = gravity_english_ft * 12. #32.2 * 12.</span>

    <span class="n">slug_to_kg</span> <span class="o">=</span> <span class="mf">14.5939</span>
    <span class="n">slinch_to_kg</span> <span class="o">=</span> <span class="mf">12.</span> <span class="o">*</span> <span class="n">slug_to_kg</span>  <span class="c1"># 1 slinch = 12 slug</span>

    <span class="c1">#slinch_to_lbf = gravity_english_in</span>
    <span class="c1">#slug_to_lbf = gravity_english_ft</span>
    <span class="n">lbf_to_newton</span> <span class="o">=</span> <span class="mf">4.4482216152605</span>
    <span class="n">lbm_to_kg</span> <span class="o">=</span> <span class="mf">0.45359237</span>

    <span class="c1">#slug_to_newton = slug_to_lbf * lbf_to_newton</span>
    <span class="c1">#slinch_to_newton = slinch_to_lbf * lbf_to_newton</span>

    <span class="c1">#if mass_from == mass_to:</span>
        <span class="c1">#return mass_scale, weight_scale, gravity_scale</span>

    <span class="c1"># convert to kg</span>
    <span class="k">if</span> <span class="n">mass_from</span> <span class="o">==</span> <span class="s1">&#39;kg&#39;</span><span class="p">:</span>
        <span class="k">pass</span>
    <span class="k">elif</span> <span class="n">mass_from</span> <span class="o">==</span> <span class="s1">&#39;Mg&#39;</span><span class="p">:</span> <span class="c1"># mega-gram / ton</span>
        <span class="n">mass_scale</span> <span class="o">*=</span> <span class="mf">1000.</span>
        <span class="n">gravity_scale_mass</span> <span class="o">*=</span> <span class="mf">1000.</span>
    <span class="k">elif</span> <span class="n">mass_from</span> <span class="o">==</span> <span class="s1">&#39;g&#39;</span><span class="p">:</span>
        <span class="n">mass_scale</span> <span class="o">*=</span> <span class="mf">1.</span><span class="o">/</span><span class="mf">1000.</span>
        <span class="n">gravity_scale_mass</span> <span class="o">*=</span> <span class="mi">1</span><span class="o">/</span><span class="mf">1000.</span>
    <span class="k">elif</span> <span class="n">mass_from</span> <span class="o">==</span> <span class="s1">&#39;lbm&#39;</span><span class="p">:</span>
        <span class="n">mass_scale</span> <span class="o">*=</span> <span class="n">lbm_to_kg</span>
        <span class="n">weight_scale</span> <span class="o">*=</span> <span class="n">lbf_to_newton</span>
        <span class="n">gravity_scale_mass</span> <span class="o">/=</span> <span class="n">gravity_english_ft</span> <span class="c1"># ft/s^2 to m/s^2</span>
    <span class="k">elif</span> <span class="n">mass_from</span> <span class="o">==</span> <span class="s1">&#39;slug&#39;</span><span class="p">:</span>
        <span class="n">mass_scale</span> <span class="o">*=</span> <span class="n">slug_to_kg</span>
        <span class="c1"># assume lbf</span>
        <span class="n">weight_scale</span> <span class="o">*=</span> <span class="n">lbf_to_newton</span> <span class="c1">#* gravity_english_ft)</span>
        <span class="c1">#log.warning(&quot;not scaling force/weight&quot;)</span>
        <span class="c1">#weight_scale *= lbf_to_newton</span>
        <span class="c1">#gravity_scale_mass /= gravity_english_in # in/s^2 to m/s^2</span>
    <span class="k">elif</span> <span class="n">mass_from</span> <span class="o">==</span> <span class="s1">&#39;slinch&#39;</span><span class="p">:</span>
        <span class="n">mass_scale</span> <span class="o">*=</span> <span class="n">slinch_to_kg</span>
        <span class="n">weight_scale</span> <span class="o">*=</span> <span class="n">lbf_to_newton</span>
        <span class="c1">#weight_scale *= (slinch_to_lbf * gravity_english_ft)</span>
        <span class="c1">#log.warning(&quot;not scaling force/weight&quot;)</span>
        <span class="c1">#gravity_scale_mass /= gravity_english_in # in/s^2 to m/s^2</span>

    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;mass from unit=</span><span class="si">{</span><span class="n">mass_from</span><span class="si">!r}</span><span class="s1">; &#39;</span>
                                  <span class="s1">&#39;expected=[g, kg, Mg, lbm, slug, slinch]&#39;</span><span class="p">)</span>

    <span class="c1"># convert from kg</span>
    <span class="k">if</span> <span class="n">mass_to</span> <span class="o">==</span> <span class="s1">&#39;kg&#39;</span><span class="p">:</span>
        <span class="k">pass</span>
    <span class="k">elif</span> <span class="n">mass_to</span> <span class="o">==</span> <span class="s1">&#39;Mg&#39;</span><span class="p">:</span> <span class="c1"># mega-gram # what about weight_scale???</span>
        <span class="n">mass_scale</span> <span class="o">/=</span> <span class="mf">1000.</span>
        <span class="n">gravity_scale_mass</span> <span class="o">/=</span> <span class="mf">1000.</span>
    <span class="k">elif</span> <span class="n">mass_to</span> <span class="o">==</span> <span class="s1">&#39;g&#39;</span><span class="p">:</span> <span class="c1"># what about weight_scale???</span>
        <span class="n">mass_scale</span> <span class="o">*=</span> <span class="mf">1000.</span>
        <span class="n">gravity_scale_mass</span> <span class="o">*=</span> <span class="mf">1000.</span>
        <span class="c1">#weight_scale *= 1000.</span>
    <span class="k">elif</span> <span class="n">mass_to</span> <span class="o">==</span> <span class="s1">&#39;lbm&#39;</span><span class="p">:</span>
        <span class="n">mass_scale</span> <span class="o">/=</span> <span class="n">lbm_to_kg</span>
        <span class="n">weight_scale</span> <span class="o">/=</span> <span class="n">lbf_to_newton</span>
        <span class="n">gravity_scale_mass</span> <span class="o">*=</span> <span class="n">gravity_english_ft</span>
    <span class="k">elif</span> <span class="n">mass_to</span> <span class="o">==</span> <span class="s1">&#39;slug&#39;</span><span class="p">:</span>
        <span class="n">mass_scale</span> <span class="o">/=</span> <span class="n">slug_to_kg</span>
        <span class="c1">#weight_scale /= (slug_to_lbf * gravity_english_ft)</span>
        <span class="n">weight_scale</span> <span class="o">/=</span> <span class="n">lbf_to_newton</span>
        <span class="c1">#gravity_scale_mass *= gravity_english_in # in/s^2 to m/s^2</span>
    <span class="k">elif</span> <span class="n">mass_to</span> <span class="o">==</span> <span class="s1">&#39;slinch&#39;</span><span class="p">:</span>
        <span class="n">mass_scale</span> <span class="o">/=</span> <span class="n">slinch_to_kg</span>
        <span class="c1">#weight_scale /= (slinch_to_lbf * gravity_english_ft)</span>
        <span class="n">weight_scale</span> <span class="o">/=</span> <span class="n">lbf_to_newton</span>
    <span class="c1">#elif mass_to == &#39;slinch&#39;:</span>
        <span class="c1">#mass_scale /= 175.126836</span>
        <span class="c1">#gravity_scale_mass *= gravity_english_in # in/s^2 to m/s^2</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;mass to unit=</span><span class="si">{</span><span class="n">mass_to</span><span class="si">!r}</span><span class="s1">; &#39;</span>
                                  <span class="s1">&#39;expected=[g, kg, Mg, lbm, slug, slinch]&#39;</span><span class="p">)</span>

    <span class="c1">#print(&quot;weight_scale = &quot;, mass_from, mass_to, weight_scale)</span>
    <span class="k">return</span> <span class="n">mass_scale</span><span class="p">,</span> <span class="n">weight_scale</span><span class="p">,</span> <span class="n">gravity_scale_mass</span></div>
</pre></div>

           </div>
           
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>
        &#169; Copyright 2021, Steven Doyle.

    </p>
  </div>
    
    
    
    Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>
        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>