

<!DOCTYPE html>
<html class="writer-html4" lang="en" >
<head>
  <meta charset="utf-8" />
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
  <title>pyNastran.bdf.bdf &mdash; pyNastran 1.4-dev 1.4-dev documentation</title>
  

  
  <link rel="stylesheet" href="../../../_static/css/my_theme.css" type="text/css" />
  <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../../../_static/css/my_theme.css" type="text/css" />
  <link rel="stylesheet" href="../../../_static/graphviz.css" type="text/css" />

  
  

  
  

  

  
  <!--[if lt IE 9]>
    <script src="../../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../../" src="../../../_static/documentation_options.js"></script>
        <script data-url_root="../../../" id="documentation_options" src="../../../_static/documentation_options.js"></script>
        <script src="../../../_static/jquery.js"></script>
        <script src="../../../_static/underscore.js"></script>
        <script src="../../../_static/doctools.js"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    
    <script type="text/javascript" src="../../../_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../../../index.html" class="icon icon-home"> pyNastran 1.4-dev
          

          
            
            <img src="../../../_static/logo.png" class="logo" alt="Logo"/>
          
          </a>

          
            
            
              <div class="version">
                1.4-dev
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul>
<li class="toctree-l1"><a class="reference internal" href="../../../installation/index.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../quick_start/index.html">Quick Start</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../how_to/index.html">How To: pyNastran</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../reference/pyNastran.html">pyNastran Package</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../manual/index.html">pyNastran Manual</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../index.html">pyNastran 1.4-dev</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          

















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../../index.html" class="icon icon-home"></a> &raquo;</li>
        
          <li><a href="../../index.html">Module code</a> &raquo;</li>
        
      <li>pyNastran.bdf.bdf</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <h1>Source code for pyNastran.bdf.bdf</h1><div class="highlight"><pre>
<span></span><span class="c1"># coding: utf-8</span>
<span class="c1"># pylint: disable=W0201,R0915,R0912</span>
<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">Main BDF class.  Defines:</span>
<span class="sd">  - BDF</span>

<span class="sd">&quot;&quot;&quot;</span>
<span class="c1"># see https://docs.plm.automation.siemens.com/tdoc/nxnastran/10/help/#uid:index</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">sys</span>
<span class="kn">from</span> <span class="nn">copy</span> <span class="kn">import</span> <span class="n">deepcopy</span>
<span class="kn">from</span> <span class="nn">io</span> <span class="kn">import</span> <span class="n">StringIO</span><span class="p">,</span> <span class="n">IOBase</span>
<span class="kn">import</span> <span class="nn">traceback</span>
<span class="kn">from</span> <span class="nn">collections</span> <span class="kn">import</span> <span class="n">defaultdict</span>

<span class="kn">from</span> <span class="nn">typing</span> <span class="kn">import</span> <span class="n">List</span><span class="p">,</span> <span class="n">Dict</span><span class="p">,</span> <span class="n">Set</span><span class="p">,</span> <span class="n">Tuple</span><span class="p">,</span> <span class="n">Sequence</span><span class="p">,</span> <span class="n">Optional</span><span class="p">,</span> <span class="n">Union</span><span class="p">,</span> <span class="n">Any</span> <span class="c1"># , cast</span>
<span class="kn">from</span> <span class="nn">pickle</span> <span class="kn">import</span> <span class="n">load</span><span class="p">,</span> <span class="n">dump</span><span class="p">,</span> <span class="n">dumps</span>  <span class="c1"># type: ignore</span>

<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>  <span class="c1"># type: ignore</span>
<span class="kn">from</span> <span class="nn">cpylog</span> <span class="kn">import</span> <span class="n">get_logger2</span>

<span class="kn">from</span> <span class="nn">pyNastran.utils</span> <span class="kn">import</span> <span class="n">object_attributes</span><span class="p">,</span> <span class="n">check_path</span>
<span class="kn">from</span> <span class="nn">.utils</span> <span class="kn">import</span> <span class="n">parse_patran_syntax</span>
<span class="kn">from</span> <span class="nn">.bdf_interface.utils</span> <span class="kn">import</span> <span class="p">(</span>
    <span class="n">_parse_pynastran_header</span><span class="p">,</span> <span class="n">to_fields</span><span class="p">,</span> <span class="n">parse_executive_control_deck</span><span class="p">,</span>
    <span class="n">fill_dmigs</span><span class="p">,</span> <span class="n">_get_card_name</span><span class="p">,</span> <span class="n">_parse_dynamic_syntax</span><span class="p">,</span>
<span class="p">)</span>

<span class="kn">from</span> <span class="nn">.bdf_interface.replication</span> <span class="kn">import</span> <span class="p">(</span>
    <span class="n">to_fields_replication</span><span class="p">,</span> <span class="n">get_nrepeats</span><span class="p">,</span> <span class="n">int_replication</span><span class="p">,</span> <span class="n">float_replication</span><span class="p">,</span>
    <span class="n">_field</span><span class="p">,</span> <span class="n">repeat_cards</span><span class="p">)</span>

<span class="kn">from</span> <span class="nn">.field_writer_8</span> <span class="kn">import</span> <span class="n">print_card_8</span>
<span class="kn">from</span> <span class="nn">.field_writer_16</span> <span class="kn">import</span> <span class="n">print_card_16</span><span class="p">,</span> <span class="n">print_field_16</span>

<span class="kn">from</span> <span class="nn">.cards.base_card</span> <span class="kn">import</span> <span class="n">_format_comment</span>
<span class="kn">from</span> <span class="nn">.cards.utils</span> <span class="kn">import</span> <span class="n">wipe_empty_fields</span>

<span class="c1">#from .write_path import write_include</span>
<span class="kn">from</span> <span class="nn">.bdf_interface.assign_type</span> <span class="kn">import</span> <span class="p">(</span><span class="n">integer</span><span class="p">,</span>
                                        <span class="n">integer_or_string</span><span class="p">,</span> <span class="n">string</span><span class="p">)</span>

<span class="kn">from</span> <span class="nn">.cards.elements.elements</span> <span class="kn">import</span> <span class="n">CFAST</span><span class="p">,</span> <span class="n">CGAP</span><span class="p">,</span> <span class="n">CRAC2D</span><span class="p">,</span> <span class="n">CRAC3D</span><span class="p">,</span> <span class="n">PLOTEL</span><span class="p">,</span> <span class="n">GENEL</span>
<span class="kn">from</span> <span class="nn">.cards.properties.properties</span> <span class="kn">import</span> <span class="n">PFAST</span><span class="p">,</span> <span class="n">PGAP</span><span class="p">,</span> <span class="n">PRAC2D</span><span class="p">,</span> <span class="n">PRAC3D</span>
<span class="kn">from</span> <span class="nn">.cards.properties.solid</span> <span class="kn">import</span> <span class="n">PLSOLID</span><span class="p">,</span> <span class="n">PSOLID</span><span class="p">,</span> <span class="n">PIHEX</span><span class="p">,</span> <span class="n">PCOMPS</span>
<span class="kn">from</span> <span class="nn">.cards.cyclic</span> <span class="kn">import</span> <span class="n">CYAX</span><span class="p">,</span> <span class="n">CYJOIN</span>
<span class="kn">from</span> <span class="nn">.cards.msgmesh</span> <span class="kn">import</span> <span class="n">CGEN</span>

<span class="kn">from</span> <span class="nn">.cards.elements.springs</span> <span class="kn">import</span> <span class="n">CELAS1</span><span class="p">,</span> <span class="n">CELAS2</span><span class="p">,</span> <span class="n">CELAS3</span><span class="p">,</span> <span class="n">CELAS4</span>
<span class="kn">from</span> <span class="nn">.cards.properties.springs</span> <span class="kn">import</span> <span class="n">PELAS</span><span class="p">,</span> <span class="n">PELAST</span>

<span class="kn">from</span> <span class="nn">.cards.elements.solid</span> <span class="kn">import</span> <span class="p">(</span>
    <span class="c1">#CTETRA, CPYRAM, CPENTA, CHEXA,</span>
    <span class="n">CIHEX1</span><span class="p">,</span> <span class="n">CIHEX2</span><span class="p">,</span>
    <span class="n">CTETRA4</span><span class="p">,</span> <span class="n">CPYRAM5</span><span class="p">,</span> <span class="n">CPENTA6</span><span class="p">,</span> <span class="n">CHEXA8</span><span class="p">,</span>
    <span class="n">CTETRA10</span><span class="p">,</span> <span class="n">CPYRAM13</span><span class="p">,</span> <span class="n">CPENTA15</span><span class="p">,</span> <span class="n">CHEXA20</span><span class="p">,</span>
<span class="p">)</span>
<span class="kn">from</span> <span class="nn">.cards.elements.rigid</span> <span class="kn">import</span> <span class="n">RBAR</span><span class="p">,</span> <span class="n">RBAR1</span><span class="p">,</span> <span class="n">RBE1</span><span class="p">,</span> <span class="n">RBE2</span><span class="p">,</span> <span class="n">RBE3</span><span class="p">,</span> <span class="n">RROD</span><span class="p">,</span> <span class="n">RSPLINE</span><span class="p">,</span> <span class="n">RSSCON</span>

<span class="kn">from</span> <span class="nn">.cards.axisymmetric.axisymmetric</span> <span class="kn">import</span> <span class="p">(</span>
    <span class="n">AXIF</span><span class="p">,</span> <span class="n">RINGFL</span><span class="p">,</span>
    <span class="n">AXIC</span><span class="p">,</span> <span class="n">RINGAX</span><span class="p">,</span> <span class="n">POINTAX</span><span class="p">,</span> <span class="n">CCONEAX</span><span class="p">,</span> <span class="n">PCONEAX</span><span class="p">,</span> <span class="p">)</span>
<span class="kn">from</span> <span class="nn">.cards.axisymmetric.loads</span> <span class="kn">import</span> <span class="n">PLOADX1</span><span class="p">,</span> <span class="n">FORCEAX</span><span class="p">,</span> <span class="n">PRESAX</span><span class="p">,</span> <span class="n">TEMPAX</span>
<span class="kn">from</span> <span class="nn">.cards.elements.axisymmetric_shells</span> <span class="kn">import</span> <span class="p">(</span>
    <span class="n">CTRAX3</span><span class="p">,</span> <span class="n">CTRAX6</span><span class="p">,</span> <span class="n">CTRIAX</span><span class="p">,</span> <span class="n">CTRIAX6</span><span class="p">,</span> <span class="n">CQUADX</span><span class="p">,</span> <span class="n">CQUADX4</span><span class="p">,</span> <span class="n">CQUADX8</span><span class="p">)</span>
<span class="kn">from</span> <span class="nn">pyNastran.bdf.cards.elements.shell</span> <span class="kn">import</span> <span class="p">(</span>
    <span class="n">CQUAD</span><span class="p">,</span> <span class="n">CQUAD4</span><span class="p">,</span> <span class="n">CQUAD8</span><span class="p">,</span> <span class="n">CQUADR</span><span class="p">,</span> <span class="n">CSHEAR</span><span class="p">,</span>
    <span class="n">CTRIA3</span><span class="p">,</span> <span class="n">CTRIA6</span><span class="p">,</span> <span class="n">CTRIAR</span><span class="p">,</span>
    <span class="n">CPLSTN3</span><span class="p">,</span> <span class="n">CPLSTN4</span><span class="p">,</span> <span class="n">CPLSTN6</span><span class="p">,</span> <span class="n">CPLSTN8</span><span class="p">,</span>
    <span class="n">CPLSTS3</span><span class="p">,</span> <span class="n">CPLSTS4</span><span class="p">,</span> <span class="n">CPLSTS6</span><span class="p">,</span> <span class="n">CPLSTS8</span><span class="p">,</span>
    <span class="n">SNORM</span><span class="p">)</span>
<span class="kn">from</span> <span class="nn">.cards.properties.shell</span> <span class="kn">import</span> <span class="n">PSHELL</span><span class="p">,</span> <span class="n">PCOMP</span><span class="p">,</span> <span class="n">PCOMPG</span><span class="p">,</span> <span class="n">PSHEAR</span><span class="p">,</span> <span class="n">PLPLANE</span><span class="p">,</span> <span class="n">PPLANE</span>
<span class="kn">from</span> <span class="nn">.cards.elements.acoustic</span> <span class="kn">import</span> <span class="p">(</span>
    <span class="n">CHACAB</span><span class="p">,</span> <span class="n">CAABSF</span><span class="p">,</span> <span class="n">CHACBR</span><span class="p">,</span> <span class="n">PACABS</span><span class="p">,</span> <span class="n">PAABSF</span><span class="p">,</span> <span class="n">PACBAR</span><span class="p">,</span> <span class="n">ACMODL</span><span class="p">)</span>
<span class="kn">from</span> <span class="nn">.cards.elements.bush</span> <span class="kn">import</span> <span class="n">CBUSH</span><span class="p">,</span> <span class="n">CBUSH1D</span><span class="p">,</span> <span class="n">CBUSH2D</span>
<span class="kn">from</span> <span class="nn">.cards.properties.bush</span> <span class="kn">import</span> <span class="n">PBUSH</span><span class="p">,</span> <span class="n">PBUSH1D</span><span class="p">,</span> <span class="n">PBUSHT</span>
<span class="kn">from</span> <span class="nn">.cards.elements.damper</span> <span class="kn">import</span> <span class="p">(</span><span class="n">CVISC</span><span class="p">,</span> <span class="n">CDAMP1</span><span class="p">,</span> <span class="n">CDAMP2</span><span class="p">,</span> <span class="n">CDAMP3</span><span class="p">,</span> <span class="n">CDAMP4</span><span class="p">,</span>
                                    <span class="n">CDAMP5</span><span class="p">)</span>
<span class="kn">from</span> <span class="nn">.cards.properties.damper</span> <span class="kn">import</span> <span class="n">PVISC</span><span class="p">,</span> <span class="n">PDAMP</span><span class="p">,</span> <span class="n">PDAMP5</span><span class="p">,</span> <span class="n">PDAMPT</span>
<span class="kn">from</span> <span class="nn">.cards.elements.rods</span> <span class="kn">import</span> <span class="n">CROD</span><span class="p">,</span> <span class="n">CONROD</span><span class="p">,</span> <span class="n">CTUBE</span>
<span class="kn">from</span> <span class="nn">.cards.elements.bars</span> <span class="kn">import</span> <span class="n">CBAR</span><span class="p">,</span> <span class="n">BAROR</span><span class="p">,</span> <span class="n">CBARAO</span><span class="p">,</span> <span class="n">CBEAM3</span><span class="p">,</span> <span class="n">CBEND</span>
<span class="kn">from</span> <span class="nn">.cards.elements.beam</span> <span class="kn">import</span> <span class="n">CBEAM</span><span class="p">,</span> <span class="n">BEAMOR</span>
<span class="kn">from</span> <span class="nn">.cards.properties.rods</span> <span class="kn">import</span> <span class="n">PROD</span><span class="p">,</span> <span class="n">PTUBE</span>
<span class="kn">from</span> <span class="nn">.cards.properties.bars</span> <span class="kn">import</span> <span class="n">PBAR</span><span class="p">,</span> <span class="n">PBARL</span><span class="p">,</span> <span class="n">PBRSECT</span><span class="p">,</span> <span class="n">PBEND</span><span class="p">,</span> <span class="n">PBEAM3</span>
<span class="kn">from</span> <span class="nn">.cards.properties.beam</span> <span class="kn">import</span> <span class="n">PBEAM</span><span class="p">,</span> <span class="n">PBEAML</span><span class="p">,</span> <span class="n">PBCOMP</span><span class="p">,</span> <span class="n">PBMSECT</span>
<span class="c1"># CMASS5</span>
<span class="kn">from</span> <span class="nn">.cards.elements.mass</span> <span class="kn">import</span> <span class="n">CONM1</span><span class="p">,</span> <span class="n">CONM2</span><span class="p">,</span> <span class="n">CMASS1</span><span class="p">,</span> <span class="n">CMASS2</span><span class="p">,</span> <span class="n">CMASS3</span><span class="p">,</span> <span class="n">CMASS4</span>
<span class="kn">from</span> <span class="nn">.cards.properties.mass</span> <span class="kn">import</span> <span class="n">PMASS</span><span class="p">,</span> <span class="n">NSM</span><span class="p">,</span> <span class="n">NSM1</span><span class="p">,</span> <span class="n">NSML</span><span class="p">,</span> <span class="n">NSML1</span><span class="p">,</span> <span class="n">NSMADD</span>
<span class="kn">from</span> <span class="nn">.cards.constraints</span> <span class="kn">import</span> <span class="p">(</span><span class="n">SPC</span><span class="p">,</span> <span class="n">SPCADD</span><span class="p">,</span> <span class="n">SPCAX</span><span class="p">,</span> <span class="n">SPC1</span><span class="p">,</span> <span class="n">SPCOFF</span><span class="p">,</span> <span class="n">SPCOFF1</span><span class="p">,</span>
                                <span class="n">MPC</span><span class="p">,</span> <span class="n">MPCADD</span><span class="p">,</span> <span class="n">SUPORT1</span><span class="p">,</span> <span class="n">SUPORT</span><span class="p">,</span> <span class="n">SESUP</span><span class="p">,</span>
                                <span class="n">GMSPC</span><span class="p">)</span>
<span class="kn">from</span> <span class="nn">.cards.coordinate_systems</span> <span class="kn">import</span> <span class="p">(</span><span class="n">CORD1R</span><span class="p">,</span> <span class="n">CORD1C</span><span class="p">,</span> <span class="n">CORD1S</span><span class="p">,</span>
                                       <span class="n">CORD2R</span><span class="p">,</span> <span class="n">CORD2C</span><span class="p">,</span> <span class="n">CORD2S</span><span class="p">,</span> <span class="c1">#CORD3G,</span>
                                       <span class="n">GMCORD</span><span class="p">,</span> <span class="n">transform_coords_vectorized</span><span class="p">,</span>
                                       <span class="n">CORDx</span><span class="p">)</span>
<span class="kn">from</span> <span class="nn">.cards.deqatn</span> <span class="kn">import</span> <span class="n">DEQATN</span>
<span class="kn">from</span> <span class="nn">.cards.dynamic</span> <span class="kn">import</span> <span class="p">(</span>
    <span class="n">DELAY</span><span class="p">,</span> <span class="n">DPHASE</span><span class="p">,</span> <span class="n">FREQ</span><span class="p">,</span> <span class="n">FREQ1</span><span class="p">,</span> <span class="n">FREQ2</span><span class="p">,</span> <span class="n">FREQ3</span><span class="p">,</span> <span class="n">FREQ4</span><span class="p">,</span> <span class="n">FREQ5</span><span class="p">,</span>
    <span class="n">TSTEP</span><span class="p">,</span> <span class="n">TSTEP1</span><span class="p">,</span> <span class="n">TSTEPNL</span><span class="p">,</span> <span class="n">NLPARM</span><span class="p">,</span> <span class="n">NLPCI</span><span class="p">,</span> <span class="n">TF</span><span class="p">,</span> <span class="n">ROTORG</span><span class="p">,</span> <span class="n">ROTORD</span><span class="p">,</span> <span class="n">TIC</span><span class="p">)</span>
<span class="kn">from</span> <span class="nn">.cards.loads.loads</span> <span class="kn">import</span> <span class="p">(</span>
    <span class="n">LSEQ</span><span class="p">,</span> <span class="n">SLOAD</span><span class="p">,</span> <span class="n">DAREA</span><span class="p">,</span> <span class="n">RFORCE</span><span class="p">,</span> <span class="n">RFORCE1</span><span class="p">,</span> <span class="n">SPCD</span><span class="p">,</span> <span class="n">DEFORM</span><span class="p">,</span> <span class="n">LOADCYN</span><span class="p">,</span> <span class="n">LOADCYH</span><span class="p">)</span>
<span class="kn">from</span> <span class="nn">.cards.loads.dloads</span> <span class="kn">import</span> <span class="n">ACSRCE</span><span class="p">,</span> <span class="n">DLOAD</span><span class="p">,</span> <span class="n">TLOAD1</span><span class="p">,</span> <span class="n">TLOAD2</span><span class="p">,</span> <span class="n">RLOAD1</span><span class="p">,</span> <span class="n">RLOAD2</span>
<span class="kn">from</span> <span class="nn">.cards.loads.static_loads</span> <span class="kn">import</span> <span class="p">(</span><span class="n">LOAD</span><span class="p">,</span> <span class="n">CLOAD</span><span class="p">,</span> <span class="n">GRAV</span><span class="p">,</span> <span class="n">ACCEL</span><span class="p">,</span> <span class="n">ACCEL1</span><span class="p">,</span> <span class="n">FORCE</span><span class="p">,</span>
                                       <span class="n">FORCE1</span><span class="p">,</span> <span class="n">FORCE2</span><span class="p">,</span> <span class="n">MOMENT</span><span class="p">,</span> <span class="n">MOMENT1</span><span class="p">,</span> <span class="n">MOMENT2</span><span class="p">,</span>
                                       <span class="n">PLOAD</span><span class="p">,</span> <span class="n">PLOAD1</span><span class="p">,</span> <span class="n">PLOAD2</span><span class="p">,</span> <span class="n">PLOAD4</span><span class="p">,</span>
                                       <span class="n">GMLOAD</span><span class="p">)</span>
<span class="kn">from</span> <span class="nn">.cards.loads.random_loads</span> <span class="kn">import</span> <span class="n">RANDPS</span><span class="p">,</span> <span class="n">RANDT1</span>

<span class="kn">from</span> <span class="nn">.cards.materials</span> <span class="kn">import</span> <span class="p">(</span><span class="n">MAT1</span><span class="p">,</span> <span class="n">MAT2</span><span class="p">,</span> <span class="n">MAT3</span><span class="p">,</span> <span class="n">MAT4</span><span class="p">,</span> <span class="n">MAT5</span><span class="p">,</span>
                              <span class="n">MAT8</span><span class="p">,</span> <span class="n">MAT9</span><span class="p">,</span> <span class="n">MAT10</span><span class="p">,</span> <span class="n">MAT11</span><span class="p">,</span> <span class="n">MAT3D</span><span class="p">,</span>
                              <span class="n">MATG</span><span class="p">,</span> <span class="n">MATHE</span><span class="p">,</span> <span class="n">MATHP</span><span class="p">,</span> <span class="n">CREEP</span><span class="p">,</span> <span class="n">EQUIV</span><span class="p">,</span>
                              <span class="n">NXSTRAT</span><span class="p">)</span>
<span class="kn">from</span> <span class="nn">.cards.material_deps</span> <span class="kn">import</span> <span class="p">(</span>
    <span class="n">MATT1</span><span class="p">,</span> <span class="n">MATT2</span><span class="p">,</span> <span class="n">MATT3</span><span class="p">,</span> <span class="n">MATT4</span><span class="p">,</span> <span class="n">MATT5</span><span class="p">,</span> <span class="n">MATT8</span><span class="p">,</span> <span class="n">MATT9</span><span class="p">,</span> <span class="n">MATS1</span><span class="p">)</span>

<span class="kn">from</span> <span class="nn">.cards.methods</span> <span class="kn">import</span> <span class="n">EIGB</span><span class="p">,</span> <span class="n">EIGC</span><span class="p">,</span> <span class="n">EIGR</span><span class="p">,</span> <span class="n">EIGP</span><span class="p">,</span> <span class="n">EIGRL</span><span class="p">,</span> <span class="n">MODTRAK</span>
<span class="kn">from</span> <span class="nn">.cards.nodes</span> <span class="kn">import</span> <span class="n">GRID</span><span class="p">,</span> <span class="n">GRDSET</span><span class="p">,</span> <span class="n">SPOINTs</span><span class="p">,</span> <span class="n">EPOINTs</span><span class="p">,</span> <span class="n">POINT</span><span class="p">,</span> <span class="n">SEQGP</span><span class="p">,</span> <span class="n">GRIDB</span>
<span class="kn">from</span> <span class="nn">.cards.aero.aero</span> <span class="kn">import</span> <span class="p">(</span>
    <span class="n">AECOMP</span><span class="p">,</span> <span class="n">AECOMPL</span><span class="p">,</span> <span class="n">AEFACT</span><span class="p">,</span> <span class="n">AELINK</span><span class="p">,</span> <span class="n">AELIST</span><span class="p">,</span> <span class="n">AEPARM</span><span class="p">,</span> <span class="n">AESURF</span><span class="p">,</span> <span class="n">AESURFS</span><span class="p">,</span>
    <span class="n">CAERO1</span><span class="p">,</span> <span class="n">CAERO2</span><span class="p">,</span> <span class="n">CAERO3</span><span class="p">,</span> <span class="n">CAERO4</span><span class="p">,</span> <span class="n">CAERO5</span><span class="p">,</span>
    <span class="n">PAERO1</span><span class="p">,</span> <span class="n">PAERO2</span><span class="p">,</span> <span class="n">PAERO3</span><span class="p">,</span> <span class="n">PAERO4</span><span class="p">,</span> <span class="n">PAERO5</span><span class="p">,</span>
    <span class="n">MONPNT1</span><span class="p">,</span> <span class="n">MONPNT2</span><span class="p">,</span> <span class="n">MONPNT3</span><span class="p">,</span> <span class="n">MONDSP1</span><span class="p">,</span>
    <span class="n">SPLINE1</span><span class="p">,</span> <span class="n">SPLINE2</span><span class="p">,</span> <span class="n">SPLINE3</span><span class="p">,</span> <span class="n">SPLINE4</span><span class="p">,</span> <span class="n">SPLINE5</span><span class="p">)</span>
<span class="kn">from</span> <span class="nn">.cards.aero.static_loads</span> <span class="kn">import</span> <span class="n">AESTAT</span><span class="p">,</span> <span class="n">AEROS</span><span class="p">,</span> <span class="n">CSSCHD</span><span class="p">,</span> <span class="n">TRIM</span><span class="p">,</span> <span class="n">TRIM2</span><span class="p">,</span> <span class="n">DIVERG</span>
<span class="kn">from</span> <span class="nn">.cards.aero.dynamic_loads</span> <span class="kn">import</span> <span class="n">AERO</span><span class="p">,</span> <span class="n">FLFACT</span><span class="p">,</span> <span class="n">FLUTTER</span><span class="p">,</span> <span class="n">GUST</span><span class="p">,</span> <span class="n">MKAERO1</span><span class="p">,</span> <span class="n">MKAERO2</span>
<span class="kn">from</span> <span class="nn">.cards.optimization</span> <span class="kn">import</span> <span class="p">(</span>
    <span class="n">DCONADD</span><span class="p">,</span> <span class="n">DCONSTR</span><span class="p">,</span> <span class="n">DESVAR</span><span class="p">,</span> <span class="n">TOPVAR</span><span class="p">,</span> <span class="n">DDVAL</span><span class="p">,</span> <span class="n">DOPTPRM</span><span class="p">,</span> <span class="n">DLINK</span><span class="p">,</span>
    <span class="n">DRESP1</span><span class="p">,</span> <span class="n">DRESP2</span><span class="p">,</span> <span class="n">DRESP3</span><span class="p">,</span>
    <span class="n">DVCREL1</span><span class="p">,</span> <span class="n">DVCREL2</span><span class="p">,</span>
    <span class="n">DVMREL1</span><span class="p">,</span> <span class="n">DVMREL2</span><span class="p">,</span>
    <span class="n">DVPREL1</span><span class="p">,</span> <span class="n">DVPREL2</span><span class="p">,</span>
    <span class="n">DVGRID</span><span class="p">,</span> <span class="n">DSCREEN</span><span class="p">)</span>
<span class="kn">from</span> <span class="nn">.cards.superelements</span> <span class="kn">import</span> <span class="p">(</span>
    <span class="n">RELEASE</span><span class="p">,</span> <span class="n">SEBNDRY</span><span class="p">,</span> <span class="n">SEBULK</span><span class="p">,</span> <span class="n">SECONCT</span><span class="p">,</span> <span class="n">SEELT</span><span class="p">,</span> <span class="n">SEEXCLD</span><span class="p">,</span>
    <span class="n">SELABEL</span><span class="p">,</span> <span class="n">SELOAD</span><span class="p">,</span> <span class="n">SELOC</span><span class="p">,</span> <span class="n">SEMPLN</span><span class="p">,</span> <span class="n">SENQSET</span><span class="p">,</span> <span class="n">SETREE</span><span class="p">,</span>
    <span class="n">CSUPER</span><span class="p">,</span> <span class="n">CSUPEXT</span><span class="p">,</span>
<span class="p">)</span>
<span class="kn">from</span> <span class="nn">.cards.bdf_sets</span> <span class="kn">import</span> <span class="p">(</span>
    <span class="n">ASET</span><span class="p">,</span> <span class="n">BSET</span><span class="p">,</span> <span class="n">CSET</span><span class="p">,</span> <span class="n">QSET</span><span class="p">,</span> <span class="n">USET</span><span class="p">,</span>
    <span class="n">ASET1</span><span class="p">,</span> <span class="n">BSET1</span><span class="p">,</span> <span class="n">CSET1</span><span class="p">,</span> <span class="n">QSET1</span><span class="p">,</span> <span class="n">USET1</span><span class="p">,</span>
    <span class="n">OMIT</span><span class="p">,</span> <span class="n">OMIT1</span><span class="p">,</span>
    <span class="n">SET1</span><span class="p">,</span> <span class="n">SET3</span><span class="p">,</span>
    <span class="n">SEBSET</span><span class="p">,</span> <span class="n">SECSET</span><span class="p">,</span> <span class="n">SEQSET</span><span class="p">,</span> <span class="c1"># SEUSET</span>
    <span class="n">SEBSET1</span><span class="p">,</span> <span class="n">SECSET1</span><span class="p">,</span> <span class="n">SEQSET1</span><span class="p">,</span> <span class="c1"># SEUSET1</span>
    <span class="n">SESET</span><span class="p">,</span> <span class="c1">#SEQSEP</span>
    <span class="n">RADSET</span><span class="p">,</span>
<span class="p">)</span>
<span class="kn">from</span> <span class="nn">.cards.params</span> <span class="kn">import</span> <span class="n">PARAM</span>
<span class="kn">from</span> <span class="nn">.cards.dmig</span> <span class="kn">import</span> <span class="n">DMIG</span><span class="p">,</span> <span class="n">DMI</span><span class="p">,</span> <span class="n">DMIJ</span><span class="p">,</span> <span class="n">DMIK</span><span class="p">,</span> <span class="n">DMIJI</span><span class="p">,</span> <span class="n">DMIG_UACCEL</span><span class="p">,</span> <span class="n">DTI</span><span class="p">,</span> <span class="n">DMIAX</span>
<span class="kn">from</span> <span class="nn">.cards.thermal.loads</span> <span class="kn">import</span> <span class="p">(</span><span class="n">QBDY1</span><span class="p">,</span> <span class="n">QBDY2</span><span class="p">,</span> <span class="n">QBDY3</span><span class="p">,</span> <span class="n">QHBDY</span><span class="p">,</span> <span class="n">TEMP</span><span class="p">,</span> <span class="n">TEMPD</span><span class="p">,</span> <span class="n">TEMPB3</span><span class="p">,</span>
                                  <span class="n">TEMPRB</span><span class="p">,</span> <span class="n">QVOL</span><span class="p">,</span> <span class="n">QVECT</span><span class="p">)</span>
<span class="kn">from</span> <span class="nn">.cards.thermal.thermal</span> <span class="kn">import</span> <span class="p">(</span><span class="n">CHBDYE</span><span class="p">,</span> <span class="n">CHBDYG</span><span class="p">,</span> <span class="n">CHBDYP</span><span class="p">,</span> <span class="n">PCONV</span><span class="p">,</span> <span class="n">PCONVM</span><span class="p">,</span>
                                    <span class="n">PHBDY</span><span class="p">,</span> <span class="n">CONV</span><span class="p">,</span> <span class="n">CONVM</span><span class="p">,</span> <span class="n">TEMPBC</span><span class="p">)</span>
<span class="kn">from</span> <span class="nn">.cards.thermal.radiation</span> <span class="kn">import</span> <span class="n">RADM</span><span class="p">,</span> <span class="n">RADBC</span><span class="p">,</span> <span class="n">RADCAV</span><span class="p">,</span> <span class="n">RADLST</span><span class="p">,</span> <span class="n">RADMTX</span><span class="p">,</span> <span class="n">VIEW</span><span class="p">,</span> <span class="n">VIEW3D</span>
<span class="kn">from</span> <span class="nn">.cards.bdf_tables</span> <span class="kn">import</span> <span class="p">(</span><span class="n">TABLED1</span><span class="p">,</span> <span class="n">TABLED2</span><span class="p">,</span> <span class="n">TABLED3</span><span class="p">,</span> <span class="n">TABLED4</span><span class="p">,</span>
                               <span class="n">TABLEM1</span><span class="p">,</span> <span class="n">TABLEM2</span><span class="p">,</span> <span class="n">TABLEM3</span><span class="p">,</span> <span class="n">TABLEM4</span><span class="p">,</span>
                               <span class="n">TABLES1</span><span class="p">,</span> <span class="n">TABDMP1</span><span class="p">,</span> <span class="n">TABLEST</span><span class="p">,</span> <span class="n">TABLEHT</span><span class="p">,</span> <span class="n">TABLEH1</span><span class="p">,</span>
                               <span class="n">TABRND1</span><span class="p">,</span> <span class="n">TABRNDG</span><span class="p">,</span>
                               <span class="n">DTABLE</span><span class="p">)</span>
<span class="kn">from</span> <span class="nn">.cards.contact</span> <span class="kn">import</span> <span class="p">(</span>
    <span class="n">BCRPARA</span><span class="p">,</span> <span class="n">BCTADD</span><span class="p">,</span> <span class="n">BCTSET</span><span class="p">,</span> <span class="n">BSURF</span><span class="p">,</span> <span class="n">BSURFS</span><span class="p">,</span> <span class="n">BCTPARA</span><span class="p">,</span> <span class="n">BCONP</span><span class="p">,</span> <span class="n">BLSEG</span><span class="p">,</span> <span class="n">BFRIC</span><span class="p">)</span>
<span class="kn">from</span> <span class="nn">.cards.parametric.geometry</span> <span class="kn">import</span> <span class="n">PSET</span><span class="p">,</span> <span class="n">PVAL</span><span class="p">,</span> <span class="n">FEEDGE</span><span class="p">,</span> <span class="n">FEFACE</span><span class="p">,</span> <span class="n">GMCURV</span><span class="p">,</span> <span class="n">GMSURF</span>

<span class="kn">from</span> <span class="nn">.case_control_deck</span> <span class="kn">import</span> <span class="n">CaseControlDeck</span><span class="p">,</span> <span class="n">Subcase</span>
<span class="kn">from</span> <span class="nn">.bdf_methods</span> <span class="kn">import</span> <span class="n">BDFMethods</span>
<span class="kn">from</span> <span class="nn">.bdf_interface.get_card</span> <span class="kn">import</span> <span class="n">GetCard</span>
<span class="kn">from</span> <span class="nn">.bdf_interface.add_card</span> <span class="kn">import</span> <span class="n">AddCards</span>
<span class="kn">from</span> <span class="nn">.bdf_interface.bdf_card</span> <span class="kn">import</span> <span class="n">BDFCard</span>
<span class="kn">from</span> <span class="nn">.bdf_interface.write_mesh_file</span> <span class="kn">import</span> <span class="n">WriteMeshs</span>
<span class="kn">from</span> <span class="nn">.bdf_interface.uncross_reference</span> <span class="kn">import</span> <span class="n">UnXrefMesh</span>
<span class="kn">from</span> <span class="nn">.bdf_interface.verify_validate</span> <span class="kn">import</span> <span class="n">verify_bdf</span><span class="p">,</span> <span class="n">validate_bdf</span>
<span class="kn">from</span> <span class="nn">.bdf_interface.stats</span> <span class="kn">import</span> <span class="n">get_bdf_stats</span>

<span class="kn">from</span> <span class="nn">.errors</span> <span class="kn">import</span> <span class="p">(</span><span class="n">CrossReferenceError</span><span class="p">,</span> <span class="n">DuplicateIDsError</span><span class="p">,</span>
                                  <span class="n">CardParseSyntaxError</span><span class="p">,</span> <span class="n">UnsupportedCard</span><span class="p">,</span> <span class="n">DisabledCardError</span><span class="p">,</span>
                                  <span class="n">SuperelementFlagError</span><span class="p">,</span> <span class="n">ReplicationError</span><span class="p">)</span>
<span class="kn">from</span> <span class="nn">.bdf_interface.pybdf</span> <span class="kn">import</span> <span class="p">(</span>
    <span class="n">BDFInputPy</span><span class="p">,</span> <span class="n">_clean_comment</span><span class="p">,</span> <span class="n">_clean_comment_bulk</span><span class="p">,</span> <span class="n">EXECUTIVE_CASE_SPACES</span><span class="p">)</span>

<span class="c1">#from .bdf_interface.add_card import CARD_MAP</span>


<div class="viewcode-block" id="load_bdf_object"><a class="viewcode-back" href="../../../reference/bdf/pyNastran.bdf.bdf.html#pyNastran.bdf.bdf.load_bdf_object">[docs]</a><span class="k">def</span> <span class="nf">load_bdf_object</span><span class="p">(</span><span class="n">obj_filename</span><span class="p">:</span><span class="nb">str</span><span class="p">,</span> <span class="n">xref</span><span class="p">:</span> <span class="nb">bool</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">log</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">debug</span><span class="p">:</span> <span class="nb">bool</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
    <span class="n">model</span> <span class="o">=</span> <span class="n">BDF</span><span class="p">(</span><span class="n">log</span><span class="o">=</span><span class="n">log</span><span class="p">,</span> <span class="n">debug</span><span class="o">=</span><span class="n">debug</span><span class="p">)</span>
    <span class="n">model</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">obj_filename</span><span class="o">=</span><span class="n">obj_filename</span><span class="p">)</span>
    <span class="n">model</span><span class="o">.</span><span class="n">cross_reference</span><span class="p">(</span><span class="n">xref</span><span class="o">=</span><span class="n">xref</span><span class="p">,</span> <span class="n">xref_nodes</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">xref_elements</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                          <span class="n">xref_nodes_with_elements</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                          <span class="n">xref_properties</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                          <span class="n">xref_masses</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                          <span class="n">xref_materials</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                          <span class="n">xref_loads</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                          <span class="n">xref_constraints</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                          <span class="n">xref_aero</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                          <span class="n">xref_sets</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                          <span class="n">xref_optimization</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">model</span></div>


<span class="k">class</span> <span class="nc">BDF_</span><span class="p">(</span><span class="n">BDFMethods</span><span class="p">,</span> <span class="n">GetCard</span><span class="p">,</span> <span class="n">AddCards</span><span class="p">,</span> <span class="n">WriteMeshs</span><span class="p">,</span> <span class="n">UnXrefMesh</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Base class for the BDF Reader/Writer/Editor class that&#39;s used by the</span>
<span class="sd">    main BDF object and (temporarily) the in-development vectorized object</span>
<span class="sd">    to keep things working.</span>

<span class="sd">    If you add very few methods and attributes to this, you get the ``BDF``</span>
<span class="sd">    class.  The point of this class is to break out a attributes, so the</span>
<span class="sd">    names (e.g., nodes) can be reused when vectorize the data.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1">#: required for sphinx bug</span>
    <span class="c1">#: http://stackoverflow.com/questions/11208997/autoclass-and-instance-attributes</span>
    <span class="c1">#__slots__ = [&#39;_is_dynamic_syntax&#39;]</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">debug</span><span class="p">:</span> <span class="nb">bool</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">log</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">mode</span><span class="p">:</span> <span class="nb">str</span><span class="o">=</span><span class="s1">&#39;msc&#39;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="c1"># SimpleLogger</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Initializes the BDF_ object</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        debug : bool/None; default=True</span>
<span class="sd">            used to set the logger if no logger is passed in</span>
<span class="sd">                True:  logs debug/info/error messages</span>
<span class="sd">                False: logs info/error messages</span>
<span class="sd">                None:  logs error messages</span>
<span class="sd">        log : logging module object / None</span>
<span class="sd">            if log is set, debug is ignored and uses the</span>
<span class="sd">            settings the logging object has</span>
<span class="sd">        mode : str; default=&#39;msc&#39;</span>
<span class="sd">            the type of Nastran</span>
<span class="sd">            valid_modes = {&#39;msc&#39;, &#39;nx&#39;}</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">assert</span> <span class="n">debug</span> <span class="ow">in</span> <span class="p">[</span><span class="kc">True</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">None</span><span class="p">],</span> <span class="s1">&#39;debug=</span><span class="si">%r</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">debug</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">echo</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">read_includes</span> <span class="o">=</span> <span class="kc">True</span>

        <span class="c1"># file management parameters</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">active_filenames</span> <span class="o">=</span> <span class="p">[]</span>  <span class="c1"># type: List[str]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">active_filename</span> <span class="o">=</span> <span class="kc">None</span>  <span class="c1"># type: Optional[str]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">include_dir</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dumplines</span> <span class="o">=</span> <span class="kc">False</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">log</span> <span class="o">=</span> <span class="n">get_logger2</span><span class="p">(</span><span class="n">log</span><span class="p">,</span> <span class="n">debug</span><span class="p">)</span>

        <span class="c1"># list of all read in cards - useful in determining if entire BDF</span>
        <span class="c1"># was read &amp; really useful in debugging</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">card_count</span> <span class="o">=</span> <span class="p">{}</span>  <span class="c1"># type: Dict[str, int]</span>

        <span class="c1"># stores the card_count of cards that have been rejected</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">reject_count</span> <span class="o">=</span> <span class="p">{}</span>  <span class="c1"># type: Dict[str, int]</span>

        <span class="c1"># allows the BDF variables to be scoped properly (i think...)</span>
        <span class="n">GetCard</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="n">AddCards</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="n">BDFMethods</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="n">WriteMeshs</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="n">UnXrefMesh</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>

        <span class="c1"># useful in debugging errors in input</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">debug</span> <span class="o">=</span> <span class="n">debug</span>

        <span class="c1"># flag that allows for OpenMDAO-style optimization syntax to be used</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_is_dynamic_syntax</span> <span class="o">=</span> <span class="kc">False</span>

        <span class="c1"># lines that were rejected b/c they were for a card that isnt supported</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">reject_lines</span> <span class="o">=</span> <span class="p">[]</span>  <span class="c1"># type: List[List[str]]</span>

        <span class="c1"># cards that were created, but not processed</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">reject_cards</span> <span class="o">=</span> <span class="p">[]</span>  <span class="c1"># type: List[str]</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">include_filenames</span> <span class="o">=</span> <span class="n">defaultdict</span><span class="p">(</span><span class="nb">list</span><span class="p">)</span>
        <span class="c1"># self.__init_attributes()</span>

        <span class="n">cards_to_read</span> <span class="o">=</span> <span class="p">[</span>
            <span class="s1">&#39;/&#39;</span><span class="p">,</span>
            <span class="s1">&#39;ECHOON&#39;</span><span class="p">,</span> <span class="s1">&#39;ECHOOFF&#39;</span><span class="p">,</span>
            <span class="s1">&#39;PARAM&#39;</span><span class="p">,</span>

            <span class="c1">## nodes</span>
            <span class="s1">&#39;GRID&#39;</span><span class="p">,</span> <span class="s1">&#39;GRDSET&#39;</span><span class="p">,</span> <span class="s1">&#39;SPOINT&#39;</span><span class="p">,</span> <span class="s1">&#39;EPOINT&#39;</span><span class="p">,</span> <span class="s1">&#39;SEQGP&#39;</span><span class="p">,</span> <span class="s1">&#39;GRIDB&#39;</span><span class="p">,</span>

            <span class="c1"># points</span>
            <span class="s1">&#39;POINT&#39;</span><span class="p">,</span>
            <span class="c1">#&#39;GRIDG&#39;</span>

            <span class="c1">## ringfl</span>
            <span class="s1">&#39;RINGFL&#39;</span><span class="p">,</span>
            <span class="c1">## ringaxs</span>
            <span class="s1">&#39;RINGAX&#39;</span><span class="p">,</span> <span class="s1">&#39;POINTAX&#39;</span><span class="p">,</span>

            <span class="c1">## masses</span>
            <span class="s1">&#39;CONM1&#39;</span><span class="p">,</span> <span class="s1">&#39;CONM2&#39;</span><span class="p">,</span>
            <span class="s1">&#39;CMASS1&#39;</span><span class="p">,</span> <span class="s1">&#39;CMASS2&#39;</span><span class="p">,</span> <span class="s1">&#39;CMASS3&#39;</span><span class="p">,</span> <span class="s1">&#39;CMASS4&#39;</span><span class="p">,</span>

            <span class="c1">## nsms</span>
            <span class="s1">&#39;NSM&#39;</span><span class="p">,</span> <span class="s1">&#39;NSM1&#39;</span><span class="p">,</span> <span class="s1">&#39;NSML&#39;</span><span class="p">,</span> <span class="s1">&#39;NSML1&#39;</span><span class="p">,</span>

            <span class="c1">## nsmadds</span>
            <span class="s1">&#39;NSMADD&#39;</span><span class="p">,</span>

            <span class="c1">## elements</span>
            <span class="c1"># springs</span>
            <span class="s1">&#39;CELAS1&#39;</span><span class="p">,</span> <span class="s1">&#39;CELAS2&#39;</span><span class="p">,</span> <span class="s1">&#39;CELAS3&#39;</span><span class="p">,</span> <span class="s1">&#39;CELAS4&#39;</span><span class="p">,</span> <span class="c1"># &#39;CELAS5&#39;,</span>
            <span class="c1"># bushings</span>
            <span class="s1">&#39;CBUSH&#39;</span><span class="p">,</span> <span class="s1">&#39;CBUSH1D&#39;</span><span class="p">,</span> <span class="s1">&#39;CBUSH2D&#39;</span><span class="p">,</span>
            <span class="c1"># dampers</span>
            <span class="s1">&#39;CDAMP1&#39;</span><span class="p">,</span> <span class="s1">&#39;CDAMP2&#39;</span><span class="p">,</span> <span class="s1">&#39;CDAMP3&#39;</span><span class="p">,</span> <span class="s1">&#39;CDAMP4&#39;</span><span class="p">,</span> <span class="s1">&#39;CDAMP5&#39;</span><span class="p">,</span>
            <span class="s1">&#39;CFAST&#39;</span><span class="p">,</span>

            <span class="s1">&#39;CBAR&#39;</span><span class="p">,</span> <span class="s1">&#39;CBARAO&#39;</span><span class="p">,</span> <span class="s1">&#39;BAROR&#39;</span><span class="p">,</span>
            <span class="s1">&#39;CROD&#39;</span><span class="p">,</span> <span class="s1">&#39;CTUBE&#39;</span><span class="p">,</span> <span class="s1">&#39;CBEAM&#39;</span><span class="p">,</span> <span class="s1">&#39;CBEAM3&#39;</span><span class="p">,</span> <span class="s1">&#39;CONROD&#39;</span><span class="p">,</span> <span class="s1">&#39;CBEND&#39;</span><span class="p">,</span> <span class="s1">&#39;BEAMOR&#39;</span><span class="p">,</span>
            <span class="s1">&#39;CTRIA3&#39;</span><span class="p">,</span> <span class="s1">&#39;CTRIA6&#39;</span><span class="p">,</span> <span class="s1">&#39;CTRIAR&#39;</span><span class="p">,</span>
            <span class="s1">&#39;CQUAD4&#39;</span><span class="p">,</span> <span class="s1">&#39;CQUAD8&#39;</span><span class="p">,</span> <span class="s1">&#39;CQUADR&#39;</span><span class="p">,</span> <span class="s1">&#39;CQUAD&#39;</span><span class="p">,</span>
            <span class="s1">&#39;CTRAX3&#39;</span><span class="p">,</span> <span class="s1">&#39;CTRAX6&#39;</span><span class="p">,</span> <span class="s1">&#39;CTRIAX&#39;</span><span class="p">,</span> <span class="s1">&#39;CTRIAX6&#39;</span><span class="p">,</span> <span class="s1">&#39;CQUADX&#39;</span><span class="p">,</span> <span class="s1">&#39;CQUADX4&#39;</span><span class="p">,</span> <span class="s1">&#39;CQUADX8&#39;</span><span class="p">,</span>
            <span class="s1">&#39;SNORM&#39;</span><span class="p">,</span>

            <span class="s1">&#39;CPLSTN3&#39;</span><span class="p">,</span> <span class="s1">&#39;CPLSTN4&#39;</span><span class="p">,</span> <span class="s1">&#39;CPLSTN6&#39;</span><span class="p">,</span> <span class="s1">&#39;CPLSTN8&#39;</span><span class="p">,</span> <span class="c1"># plate strain</span>
            <span class="s1">&#39;CPLSTS3&#39;</span><span class="p">,</span> <span class="s1">&#39;CPLSTS4&#39;</span><span class="p">,</span> <span class="s1">&#39;CPLSTS6&#39;</span><span class="p">,</span> <span class="s1">&#39;CPLSTS8&#39;</span><span class="p">,</span> <span class="c1"># plate stress</span>

            <span class="c1"># acoustic</span>
            <span class="s1">&#39;CHACAB&#39;</span><span class="p">,</span> <span class="s1">&#39;CAABSF&#39;</span><span class="p">,</span> <span class="s1">&#39;CHACBR&#39;</span><span class="p">,</span>
            <span class="s1">&#39;PACABS&#39;</span><span class="p">,</span> <span class="s1">&#39;PAABSF&#39;</span><span class="p">,</span> <span class="s1">&#39;PACBAR&#39;</span><span class="p">,</span> <span class="s1">&#39;ACMODL&#39;</span><span class="p">,</span>

            <span class="s1">&#39;CTETRA&#39;</span><span class="p">,</span> <span class="s1">&#39;CPYRAM&#39;</span><span class="p">,</span> <span class="s1">&#39;CPENTA&#39;</span><span class="p">,</span> <span class="s1">&#39;CHEXA&#39;</span><span class="p">,</span>
            <span class="s1">&#39;CIHEX1&#39;</span><span class="p">,</span> <span class="s1">&#39;CIHEX2&#39;</span><span class="p">,</span>
            <span class="s1">&#39;CSHEAR&#39;</span><span class="p">,</span> <span class="s1">&#39;CVISC&#39;</span><span class="p">,</span> <span class="s1">&#39;CRAC2D&#39;</span><span class="p">,</span> <span class="s1">&#39;CRAC3D&#39;</span><span class="p">,</span>
            <span class="s1">&#39;CGAP&#39;</span><span class="p">,</span>
            <span class="s1">&#39;GENEL&#39;</span><span class="p">,</span>

            <span class="c1">## rigid_elements</span>
            <span class="s1">&#39;RBAR&#39;</span><span class="p">,</span> <span class="s1">&#39;RBAR1&#39;</span><span class="p">,</span> <span class="s1">&#39;RBE1&#39;</span><span class="p">,</span> <span class="s1">&#39;RBE2&#39;</span><span class="p">,</span> <span class="s1">&#39;RBE3&#39;</span><span class="p">,</span> <span class="s1">&#39;RROD&#39;</span><span class="p">,</span> <span class="s1">&#39;RSPLINE&#39;</span><span class="p">,</span> <span class="s1">&#39;RSSCON&#39;</span><span class="p">,</span>

            <span class="c1">## plotels</span>
            <span class="s1">&#39;PLOTEL&#39;</span><span class="p">,</span>

            <span class="c1">## properties</span>
            <span class="s1">&#39;PMASS&#39;</span><span class="p">,</span>
            <span class="s1">&#39;PELAS&#39;</span><span class="p">,</span> <span class="s1">&#39;PGAP&#39;</span><span class="p">,</span> <span class="s1">&#39;PFAST&#39;</span><span class="p">,</span> <span class="s1">&#39;PLPLANE&#39;</span><span class="p">,</span> <span class="s1">&#39;PPLANE&#39;</span><span class="p">,</span>
            <span class="s1">&#39;PBUSH&#39;</span><span class="p">,</span> <span class="s1">&#39;PBUSH1D&#39;</span><span class="p">,</span>
            <span class="s1">&#39;PDAMP&#39;</span><span class="p">,</span> <span class="s1">&#39;PDAMP5&#39;</span><span class="p">,</span>
            <span class="s1">&#39;PROD&#39;</span><span class="p">,</span> <span class="s1">&#39;PBAR&#39;</span><span class="p">,</span> <span class="s1">&#39;PBARL&#39;</span><span class="p">,</span> <span class="s1">&#39;PBEAM&#39;</span><span class="p">,</span> <span class="s1">&#39;PTUBE&#39;</span><span class="p">,</span> <span class="s1">&#39;PBCOMP&#39;</span><span class="p">,</span> <span class="s1">&#39;PBRSECT&#39;</span><span class="p">,</span> <span class="s1">&#39;PBEND&#39;</span><span class="p">,</span>
            <span class="s1">&#39;PBEAML&#39;</span><span class="p">,</span> <span class="s1">&#39;PBMSECT&#39;</span><span class="p">,</span> <span class="c1"># not fully supported</span>
            <span class="s1">&#39;PBEAM3&#39;</span><span class="p">,</span>  <span class="c1"># v1.3</span>

            <span class="s1">&#39;PSHELL&#39;</span><span class="p">,</span> <span class="s1">&#39;PCOMP&#39;</span><span class="p">,</span> <span class="s1">&#39;PCOMPG&#39;</span><span class="p">,</span> <span class="s1">&#39;PSHEAR&#39;</span><span class="p">,</span>
            <span class="s1">&#39;PSOLID&#39;</span><span class="p">,</span> <span class="s1">&#39;PLSOLID&#39;</span><span class="p">,</span> <span class="s1">&#39;PVISC&#39;</span><span class="p">,</span> <span class="s1">&#39;PRAC2D&#39;</span><span class="p">,</span> <span class="s1">&#39;PRAC3D&#39;</span><span class="p">,</span>
            <span class="s1">&#39;PIHEX&#39;</span><span class="p">,</span> <span class="s1">&#39;PCOMPS&#39;</span><span class="p">,</span>
            <span class="c1"># PQUAD4</span>

            <span class="c1"># axixsymmetric</span>
            <span class="s1">&#39;CCONEAX&#39;</span><span class="p">,</span> <span class="c1"># element</span>
            <span class="s1">&#39;PCONEAX&#39;</span><span class="p">,</span> <span class="c1"># property</span>
            <span class="s1">&#39;AXIC&#39;</span><span class="p">,</span> <span class="c1"># axic</span>
            <span class="s1">&#39;AXIF&#39;</span><span class="p">,</span> <span class="c1"># axif</span>
            <span class="s1">&#39;FORCEAX&#39;</span><span class="p">,</span> <span class="c1"># loads</span>

            <span class="c1">## pdampt</span>
            <span class="s1">&#39;PDAMPT&#39;</span><span class="p">,</span>

            <span class="c1">## pelast</span>
            <span class="s1">&#39;PELAST&#39;</span><span class="p">,</span>

            <span class="c1">## pbusht</span>
            <span class="s1">&#39;PBUSHT&#39;</span><span class="p">,</span>

            <span class="c1">## creep_materials</span>
            <span class="s1">&#39;CREEP&#39;</span><span class="p">,</span>

            <span class="c1">## materials</span>
            <span class="s1">&#39;MAT1&#39;</span><span class="p">,</span> <span class="s1">&#39;MAT2&#39;</span><span class="p">,</span> <span class="s1">&#39;MAT3&#39;</span><span class="p">,</span> <span class="s1">&#39;MAT8&#39;</span><span class="p">,</span> <span class="s1">&#39;MAT9&#39;</span><span class="p">,</span> <span class="s1">&#39;MAT10&#39;</span><span class="p">,</span> <span class="s1">&#39;MAT11&#39;</span><span class="p">,</span> <span class="s1">&#39;MAT3D&#39;</span><span class="p">,</span>
            <span class="s1">&#39;MATG&#39;</span><span class="p">,</span> <span class="s1">&#39;MATHE&#39;</span><span class="p">,</span> <span class="s1">&#39;MATHP&#39;</span><span class="p">,</span>

            <span class="c1">## Material dependence - MATT1/MATT2/etc.</span>
            <span class="s1">&#39;MATT1&#39;</span><span class="p">,</span> <span class="s1">&#39;MATT2&#39;</span><span class="p">,</span> <span class="s1">&#39;MATT3&#39;</span><span class="p">,</span> <span class="s1">&#39;MATT4&#39;</span><span class="p">,</span> <span class="s1">&#39;MATT5&#39;</span><span class="p">,</span> <span class="s1">&#39;MATT8&#39;</span><span class="p">,</span> <span class="s1">&#39;MATT9&#39;</span><span class="p">,</span>
            <span class="s1">&#39;MATS1&#39;</span><span class="p">,</span> <span class="c1">#&#39;MATS3&#39;, &#39;MATS8&#39;,</span>
            <span class="c1"># &#39;MATHE&#39;</span>
            <span class="c1">#&#39;EQUIV&#39;, # testing only, should never be activated...</span>

            <span class="c1">## nxstrats</span>
            <span class="s1">&#39;NXSTRAT&#39;</span><span class="p">,</span>

            <span class="c1">## thermal_materials</span>
            <span class="s1">&#39;MAT4&#39;</span><span class="p">,</span> <span class="s1">&#39;MAT5&#39;</span><span class="p">,</span>

            <span class="c1">## spcs</span>
            <span class="s1">&#39;SPC&#39;</span><span class="p">,</span> <span class="s1">&#39;SPCADD&#39;</span><span class="p">,</span> <span class="s1">&#39;SPC1&#39;</span><span class="p">,</span> <span class="s1">&#39;SPCAX&#39;</span><span class="p">,</span> <span class="s1">&#39;SPCOFF&#39;</span><span class="p">,</span> <span class="s1">&#39;SPCOFF1&#39;</span><span class="p">,</span>
            <span class="s1">&#39;GMSPC&#39;</span><span class="p">,</span>

            <span class="c1">## mpcs</span>
            <span class="s1">&#39;MPC&#39;</span><span class="p">,</span> <span class="s1">&#39;MPCADD&#39;</span><span class="p">,</span>

            <span class="c1">## suport/suport1/se_suport</span>
            <span class="s1">&#39;SUPORT&#39;</span><span class="p">,</span> <span class="s1">&#39;SUPORT1&#39;</span><span class="p">,</span> <span class="s1">&#39;SESUP&#39;</span><span class="p">,</span>

            <span class="c1">## dloads</span>
            <span class="s1">&#39;DLOAD&#39;</span><span class="p">,</span>

            <span class="c1">## dload_entries</span>
            <span class="s1">&#39;ACSRCE&#39;</span><span class="p">,</span> <span class="s1">&#39;TLOAD1&#39;</span><span class="p">,</span> <span class="s1">&#39;TLOAD2&#39;</span><span class="p">,</span> <span class="s1">&#39;RLOAD1&#39;</span><span class="p">,</span> <span class="s1">&#39;RLOAD2&#39;</span><span class="p">,</span>
            <span class="s1">&#39;QVECT&#39;</span><span class="p">,</span>
            <span class="s1">&#39;RANDPS&#39;</span><span class="p">,</span> <span class="s1">&#39;RANDT1&#39;</span><span class="p">,</span> <span class="c1"># random</span>

            <span class="c1">## loads</span>
            <span class="s1">&#39;LOAD&#39;</span><span class="p">,</span> <span class="s1">&#39;CLOAD&#39;</span><span class="p">,</span> <span class="s1">&#39;LSEQ&#39;</span><span class="p">,</span> <span class="s1">&#39;LOADCYN&#39;</span><span class="p">,</span> <span class="s1">&#39;LOADCYH&#39;</span><span class="p">,</span>
            <span class="s1">&#39;SLOAD&#39;</span><span class="p">,</span>
            <span class="s1">&#39;FORCE&#39;</span><span class="p">,</span> <span class="s1">&#39;FORCE1&#39;</span><span class="p">,</span> <span class="s1">&#39;FORCE2&#39;</span><span class="p">,</span>
            <span class="s1">&#39;MOMENT&#39;</span><span class="p">,</span> <span class="s1">&#39;MOMENT1&#39;</span><span class="p">,</span> <span class="s1">&#39;MOMENT2&#39;</span><span class="p">,</span>
            <span class="s1">&#39;GRAV&#39;</span><span class="p">,</span> <span class="s1">&#39;ACCEL&#39;</span><span class="p">,</span> <span class="s1">&#39;ACCEL1&#39;</span><span class="p">,</span>
            <span class="s1">&#39;PLOAD&#39;</span><span class="p">,</span> <span class="s1">&#39;PLOAD1&#39;</span><span class="p">,</span> <span class="s1">&#39;PLOAD2&#39;</span><span class="p">,</span> <span class="s1">&#39;PLOAD4&#39;</span><span class="p">,</span>
            <span class="s1">&#39;PLOADX1&#39;</span><span class="p">,</span> <span class="s1">&#39;RFORCE&#39;</span><span class="p">,</span> <span class="s1">&#39;RFORCE1&#39;</span><span class="p">,</span>
            <span class="s1">&#39;GMLOAD&#39;</span><span class="p">,</span> <span class="s1">&#39;SPCD&#39;</span><span class="p">,</span> <span class="s1">&#39;DEFORM&#39;</span><span class="p">,</span>

            <span class="c1"># axisymmetric</span>
            <span class="s1">&#39;PRESAX&#39;</span><span class="p">,</span>

            <span class="c1">#thermal</span>
            <span class="s1">&#39;QVOL&#39;</span><span class="p">,</span>

            <span class="c1"># aero cards</span>
            <span class="s1">&#39;AERO&#39;</span><span class="p">,</span>  <span class="c1">## aero</span>
            <span class="s1">&#39;AEROS&#39;</span><span class="p">,</span>  <span class="c1">## aeros</span>
            <span class="s1">&#39;GUST&#39;</span><span class="p">,</span>  <span class="c1">## gusts</span>
            <span class="s1">&#39;FLUTTER&#39;</span><span class="p">,</span>   <span class="c1">## flutters</span>
            <span class="s1">&#39;FLFACT&#39;</span><span class="p">,</span>   <span class="c1">## flfacts</span>
            <span class="s1">&#39;MKAERO1&#39;</span><span class="p">,</span> <span class="s1">&#39;MKAERO2&#39;</span><span class="p">,</span>  <span class="c1">## mkaeros</span>
            <span class="s1">&#39;AECOMP&#39;</span><span class="p">,</span> <span class="s1">&#39;AECOMPL&#39;</span><span class="p">,</span>   <span class="c1">## aecomps</span>
            <span class="s1">&#39;AEFACT&#39;</span><span class="p">,</span>   <span class="c1">## aefacts</span>
            <span class="s1">&#39;AELINK&#39;</span><span class="p">,</span>   <span class="c1">## aelinks</span>
            <span class="s1">&#39;AELIST&#39;</span><span class="p">,</span>   <span class="c1">## aelists</span>
            <span class="s1">&#39;AEPARM&#39;</span><span class="p">,</span>   <span class="c1">## aeparams</span>
            <span class="s1">&#39;AESTAT&#39;</span><span class="p">,</span>   <span class="c1">## aestats</span>
            <span class="s1">&#39;AESURF&#39;</span><span class="p">,</span>  <span class="c1">## aesurf</span>
            <span class="s1">&#39;AESURFS&#39;</span><span class="p">,</span> <span class="c1">## aesurfs</span>
            <span class="s1">&#39;CAERO1&#39;</span><span class="p">,</span> <span class="s1">&#39;CAERO2&#39;</span><span class="p">,</span> <span class="s1">&#39;CAERO3&#39;</span><span class="p">,</span> <span class="s1">&#39;CAERO4&#39;</span><span class="p">,</span> <span class="s1">&#39;CAERO5&#39;</span><span class="p">,</span> <span class="c1">## caeros</span>
            <span class="s1">&#39;PAERO1&#39;</span><span class="p">,</span> <span class="s1">&#39;PAERO2&#39;</span><span class="p">,</span> <span class="s1">&#39;PAERO3&#39;</span><span class="p">,</span> <span class="s1">&#39;PAERO4&#39;</span><span class="p">,</span> <span class="s1">&#39;PAERO5&#39;</span><span class="p">,</span> <span class="c1">## paeros</span>

            <span class="s1">&#39;MONPNT1&#39;</span><span class="p">,</span> <span class="s1">&#39;MONPNT2&#39;</span><span class="p">,</span> <span class="s1">&#39;MONPNT3&#39;</span><span class="p">,</span> <span class="s1">&#39;MONDSP1&#39;</span><span class="p">,</span> <span class="c1">## monitor_points</span>
            <span class="s1">&#39;SPLINE1&#39;</span><span class="p">,</span> <span class="s1">&#39;SPLINE2&#39;</span><span class="p">,</span> <span class="s1">&#39;SPLINE3&#39;</span><span class="p">,</span> <span class="s1">&#39;SPLINE4&#39;</span><span class="p">,</span> <span class="s1">&#39;SPLINE5&#39;</span><span class="p">,</span>  <span class="c1">## splines</span>
            <span class="s1">&#39;SPLINE6&#39;</span><span class="p">,</span> <span class="s1">&#39;SPLINE7&#39;</span><span class="p">,</span>
            <span class="s1">&#39;TRIM&#39;</span><span class="p">,</span> <span class="s1">&#39;TRIM2&#39;</span><span class="p">,</span>  <span class="c1">## trims</span>
            <span class="s1">&#39;CSSCHD&#39;</span><span class="p">,</span>  <span class="c1">## csschds</span>
            <span class="s1">&#39;DIVERG&#39;</span><span class="p">,</span>  <span class="c1">## divergs</span>

            <span class="c1">## coords</span>
            <span class="s1">&#39;CORD1R&#39;</span><span class="p">,</span> <span class="s1">&#39;CORD1C&#39;</span><span class="p">,</span> <span class="s1">&#39;CORD1S&#39;</span><span class="p">,</span>
            <span class="s1">&#39;CORD2R&#39;</span><span class="p">,</span> <span class="s1">&#39;CORD2C&#39;</span><span class="p">,</span> <span class="s1">&#39;CORD2S&#39;</span><span class="p">,</span>
            <span class="s1">&#39;GMCORD&#39;</span><span class="p">,</span>

            <span class="c1"># temperature cards</span>
            <span class="s1">&#39;TEMP&#39;</span><span class="p">,</span> <span class="s1">&#39;TEMPD&#39;</span><span class="p">,</span> <span class="s1">&#39;TEMPB3&#39;</span><span class="p">,</span> <span class="s1">&#39;TEMPAX&#39;</span><span class="p">,</span>
            <span class="s1">&#39;QBDY1&#39;</span><span class="p">,</span> <span class="s1">&#39;QBDY2&#39;</span><span class="p">,</span> <span class="s1">&#39;QBDY3&#39;</span><span class="p">,</span> <span class="s1">&#39;QHBDY&#39;</span><span class="p">,</span>
            <span class="s1">&#39;CHBDYE&#39;</span><span class="p">,</span> <span class="s1">&#39;CHBDYG&#39;</span><span class="p">,</span> <span class="s1">&#39;CHBDYP&#39;</span><span class="p">,</span>
            <span class="s1">&#39;PCONV&#39;</span><span class="p">,</span> <span class="s1">&#39;PCONVM&#39;</span><span class="p">,</span> <span class="s1">&#39;PHBDY&#39;</span><span class="p">,</span>
            <span class="s1">&#39;RADBC&#39;</span><span class="p">,</span> <span class="s1">&#39;CONV&#39;</span><span class="p">,</span>
            <span class="s1">&#39;RADM&#39;</span><span class="p">,</span> <span class="s1">&#39;VIEW&#39;</span><span class="p">,</span> <span class="s1">&#39;VIEW3D&#39;</span><span class="p">,</span>  <span class="c1"># TODO: not validated</span>


            <span class="s1">&#39;RADCAV&#39;</span><span class="p">,</span> <span class="c1">## radcavs</span>

            <span class="c1"># ---- dynamic cards ---- #</span>
            <span class="s1">&#39;DAREA&#39;</span><span class="p">,</span>  <span class="c1">## dareas</span>
            <span class="s1">&#39;DPHASE&#39;</span><span class="p">,</span>  <span class="c1">## dphases</span>
            <span class="s1">&#39;DELAY&#39;</span><span class="p">,</span>  <span class="c1">## delays</span>
            <span class="s1">&#39;NLPARM&#39;</span><span class="p">,</span>  <span class="c1">## nlparms</span>
            <span class="s1">&#39;ROTORG&#39;</span><span class="p">,</span> <span class="s1">&#39;ROTORD&#39;</span><span class="p">,</span> <span class="c1">## rotors</span>
            <span class="s1">&#39;NLPCI&#39;</span><span class="p">,</span>  <span class="c1">## nlpcis</span>
            <span class="s1">&#39;TSTEP&#39;</span><span class="p">,</span>  <span class="c1">## tsteps</span>
            <span class="s1">&#39;TSTEPNL&#39;</span><span class="p">,</span> <span class="s1">&#39;TSTEP1&#39;</span><span class="p">,</span>  <span class="c1">## tstepnls</span>
            <span class="s1">&#39;TF&#39;</span><span class="p">,</span>  <span class="c1">## transfer_functions</span>
            <span class="s1">&#39;TIC&#39;</span><span class="p">,</span> <span class="c1">## initial conditions - sid (set ID)</span>

            <span class="c1">## frequencies</span>
            <span class="s1">&#39;FREQ&#39;</span><span class="p">,</span> <span class="s1">&#39;FREQ1&#39;</span><span class="p">,</span> <span class="s1">&#39;FREQ2&#39;</span><span class="p">,</span> <span class="s1">&#39;FREQ3&#39;</span><span class="p">,</span> <span class="s1">&#39;FREQ4&#39;</span><span class="p">,</span> <span class="s1">&#39;FREQ5&#39;</span><span class="p">,</span>

            <span class="c1"># direct matrix input cards</span>
            <span class="s1">&#39;DMIG&#39;</span><span class="p">,</span> <span class="s1">&#39;DMIJ&#39;</span><span class="p">,</span> <span class="s1">&#39;DMIJI&#39;</span><span class="p">,</span> <span class="s1">&#39;DMIK&#39;</span><span class="p">,</span> <span class="s1">&#39;DMI&#39;</span><span class="p">,</span> <span class="s1">&#39;DTI&#39;</span><span class="p">,</span>
            <span class="s1">&#39;DMIAX&#39;</span><span class="p">,</span>

            <span class="c1"># optimization cards</span>
            <span class="s1">&#39;DEQATN&#39;</span><span class="p">,</span> <span class="s1">&#39;DTABLE&#39;</span><span class="p">,</span>
            <span class="s1">&#39;DCONSTR&#39;</span><span class="p">,</span> <span class="s1">&#39;DESVAR&#39;</span><span class="p">,</span> <span class="s1">&#39;TOPVAR&#39;</span><span class="p">,</span> <span class="s1">&#39;DDVAL&#39;</span><span class="p">,</span> <span class="s1">&#39;DRESP1&#39;</span><span class="p">,</span> <span class="s1">&#39;DRESP2&#39;</span><span class="p">,</span> <span class="s1">&#39;DRESP3&#39;</span><span class="p">,</span>
            <span class="s1">&#39;DVCREL1&#39;</span><span class="p">,</span> <span class="s1">&#39;DVCREL2&#39;</span><span class="p">,</span>
            <span class="s1">&#39;DVPREL1&#39;</span><span class="p">,</span> <span class="s1">&#39;DVPREL2&#39;</span><span class="p">,</span>
            <span class="s1">&#39;DVMREL1&#39;</span><span class="p">,</span> <span class="s1">&#39;DVMREL2&#39;</span><span class="p">,</span>
            <span class="s1">&#39;DOPTPRM&#39;</span><span class="p">,</span> <span class="s1">&#39;DLINK&#39;</span><span class="p">,</span> <span class="s1">&#39;DCONADD&#39;</span><span class="p">,</span> <span class="s1">&#39;DVGRID&#39;</span><span class="p">,</span>
            <span class="s1">&#39;DSCREEN&#39;</span><span class="p">,</span>

            <span class="c1"># sets</span>
            <span class="s1">&#39;SET1&#39;</span><span class="p">,</span> <span class="s1">&#39;SET3&#39;</span><span class="p">,</span>  <span class="c1">## sets</span>
            <span class="s1">&#39;ASET&#39;</span><span class="p">,</span> <span class="s1">&#39;ASET1&#39;</span><span class="p">,</span>  <span class="c1">## asets</span>
            <span class="s1">&#39;OMIT&#39;</span><span class="p">,</span> <span class="s1">&#39;OMIT1&#39;</span><span class="p">,</span>  <span class="c1">## omits</span>
            <span class="s1">&#39;BSET&#39;</span><span class="p">,</span> <span class="s1">&#39;BSET1&#39;</span><span class="p">,</span>  <span class="c1">## bsets</span>
            <span class="s1">&#39;CSET&#39;</span><span class="p">,</span> <span class="s1">&#39;CSET1&#39;</span><span class="p">,</span>  <span class="c1">## csets</span>
            <span class="s1">&#39;QSET&#39;</span><span class="p">,</span> <span class="s1">&#39;QSET1&#39;</span><span class="p">,</span>  <span class="c1">## qsets</span>
            <span class="s1">&#39;USET&#39;</span><span class="p">,</span> <span class="s1">&#39;USET1&#39;</span><span class="p">,</span>  <span class="c1">## usets</span>

            <span class="s1">&#39;RADSET&#39;</span><span class="p">,</span>  <span class="c1"># radset</span>

            <span class="c1"># superelements</span>
            <span class="s1">&#39;SETREE&#39;</span><span class="p">,</span> <span class="s1">&#39;SENQSET&#39;</span><span class="p">,</span> <span class="s1">&#39;SEBULK&#39;</span><span class="p">,</span> <span class="s1">&#39;SEBNDRY&#39;</span><span class="p">,</span> <span class="s1">&#39;SEELT&#39;</span><span class="p">,</span> <span class="s1">&#39;SELOC&#39;</span><span class="p">,</span> <span class="s1">&#39;SEMPLN&#39;</span><span class="p">,</span>
            <span class="s1">&#39;SECONCT&#39;</span><span class="p">,</span> <span class="s1">&#39;SELABEL&#39;</span><span class="p">,</span> <span class="s1">&#39;SEEXCLD&#39;</span><span class="p">,</span> <span class="s1">&#39;CSUPER&#39;</span><span class="p">,</span> <span class="s1">&#39;CSUPEXT&#39;</span><span class="p">,</span>
            <span class="s1">&#39;SELOAD&#39;</span><span class="p">,</span> <span class="s1">&#39;RELEASE&#39;</span><span class="p">,</span>

            <span class="c1"># super-element sets</span>
            <span class="s1">&#39;SESET&#39;</span><span class="p">,</span>  <span class="c1">## se_sets</span>

            <span class="s1">&#39;SEBSET&#39;</span><span class="p">,</span> <span class="s1">&#39;SEBSET1&#39;</span><span class="p">,</span>  <span class="c1">## se_bsets</span>
            <span class="s1">&#39;SECSET&#39;</span><span class="p">,</span> <span class="s1">&#39;SECSET1&#39;</span><span class="p">,</span>  <span class="c1">## se_csets</span>
            <span class="s1">&#39;SEQSET&#39;</span><span class="p">,</span> <span class="s1">&#39;SEQSET1&#39;</span><span class="p">,</span>  <span class="c1">## se_qsets</span>
            <span class="c1">#&#39;SEUSET&#39;, &#39;SEUSET1&#39;,  ## se_usets</span>
            <span class="s1">&#39;SEQSEP&#39;</span><span class="p">,</span>

            <span class="c1">#------------------------------------------------------------------</span>
            <span class="c1">## parametric</span>
            <span class="s1">&#39;PSET&#39;</span><span class="p">,</span> <span class="s1">&#39;PVAL&#39;</span><span class="p">,</span> <span class="s1">&#39;GMCURV&#39;</span><span class="p">,</span> <span class="s1">&#39;GMSURF&#39;</span><span class="p">,</span> <span class="s1">&#39;FEEDGE&#39;</span><span class="p">,</span> <span class="s1">&#39;FEFACE&#39;</span><span class="p">,</span>

            <span class="c1">#------------------------------------------------------------------</span>
            <span class="c1">## tables</span>
            <span class="s1">&#39;TABLED1&#39;</span><span class="p">,</span> <span class="s1">&#39;TABLED2&#39;</span><span class="p">,</span> <span class="s1">&#39;TABLED3&#39;</span><span class="p">,</span> <span class="s1">&#39;TABLED4&#39;</span><span class="p">,</span>  <span class="c1"># dynamic tables - freq/time loads</span>
            <span class="s1">&#39;TABLEM1&#39;</span><span class="p">,</span> <span class="s1">&#39;TABLEM2&#39;</span><span class="p">,</span> <span class="s1">&#39;TABLEM3&#39;</span><span class="p">,</span> <span class="s1">&#39;TABLEM4&#39;</span><span class="p">,</span>  <span class="c1"># material tables - temperature</span>

            <span class="c1"># nonlinear elastic temperature dependent materials (e.g. creep)</span>
            <span class="c1"># sees TABLES1</span>
            <span class="s1">&#39;TABLEST&#39;</span><span class="p">,</span>
            <span class="c1"># material tables - stress (MATS1, CREEP, MATHP)</span>
            <span class="s1">&#39;TABLES1&#39;</span><span class="p">,</span>

            <span class="c1">## modal damping table - tables_sdamping</span>
            <span class="s1">&#39;TABDMP1&#39;</span><span class="p">,</span>

            <span class="c1">## random_tables</span>
            <span class="c1"># PSD=func(freq); used by RANDPS card</span>
            <span class="s1">&#39;TABRND1&#39;</span><span class="p">,</span>
            <span class="c1"># gust for aeroelastic response; used by RANDPS card</span>
            <span class="s1">&#39;TABRNDG&#39;</span><span class="p">,</span>

            <span class="c1"># ???</span>
            <span class="s1">&#39;TABLEHT&#39;</span><span class="p">,</span> <span class="s1">&#39;TABLEH1&#39;</span><span class="p">,</span>

            <span class="c1">#------------------------------------------------------------------</span>
            <span class="c1">#: methods</span>
            <span class="s1">&#39;EIGB&#39;</span><span class="p">,</span> <span class="s1">&#39;EIGR&#39;</span><span class="p">,</span> <span class="s1">&#39;EIGRL&#39;</span><span class="p">,</span>

            <span class="c1">#: cMethods</span>
            <span class="s1">&#39;EIGC&#39;</span><span class="p">,</span> <span class="s1">&#39;EIGP&#39;</span><span class="p">,</span>

            <span class="c1"># : modtrak</span>
            <span class="s1">&#39;MODTRAK&#39;</span><span class="p">,</span>

            <span class="c1">#: contact</span>
            <span class="s1">&#39;BCTPARA&#39;</span><span class="p">,</span>  <span class="c1">## bctpara</span>
            <span class="s1">&#39;BCRPARA&#39;</span><span class="p">,</span>  <span class="c1">## bcrpara</span>
            <span class="s1">&#39;BCTADD&#39;</span><span class="p">,</span>  <span class="c1">## bctadds</span>
            <span class="s1">&#39;BCTSET&#39;</span><span class="p">,</span>  <span class="c1">## bctsets</span>
            <span class="s1">&#39;BSURF&#39;</span><span class="p">,</span>  <span class="c1">## bsurf</span>
            <span class="s1">&#39;BSURFS&#39;</span><span class="p">,</span>  <span class="c1">## bsurfs</span>
            <span class="s1">&#39;BCONP&#39;</span><span class="p">,</span> <span class="c1">## bconp</span>
            <span class="s1">&#39;BLSEG&#39;</span><span class="p">,</span> <span class="c1">## blseg</span>
            <span class="s1">&#39;BFRIC&#39;</span><span class="p">,</span> <span class="c1">## bfric</span>

            <span class="s1">&#39;TEMPBC&#39;</span><span class="p">,</span>
            <span class="c1">#&#39;RADMT&#39;,</span>
            <span class="s1">&#39;RADLST&#39;</span><span class="p">,</span> <span class="s1">&#39;RADMTX&#39;</span><span class="p">,</span> <span class="c1">#&#39;RADBND&#39;,</span>
            <span class="c1">#&#39;TEMPP1&#39;,</span>
            <span class="s1">&#39;TEMPRB&#39;</span><span class="p">,</span>
            <span class="s1">&#39;CONVM&#39;</span><span class="p">,</span>
            <span class="c1">## ???</span>
            <span class="c1">#&#39;PANEL&#39;, &#39;SWLDPRM&#39;,</span>
            <span class="c1">#&#39;CWELD&#39;, &#39;PWELD&#39;, &#39;PWSEAM&#39;, &#39;CWSEAM&#39;, &#39;CSEAM&#39;, &#39;PSEAM&#39;, &#39;DVSHAP&#39;, &#39;BNDGRID&#39;,</span>
            <span class="c1">#&#39;CYSYM&#39;, &#39;CYJOIN&#39;, &#39;MODTRAK&#39;, &#39;DSCONS&#39;, &#39;DVAR&#39;, &#39;DVSET&#39;, &#39;DYNRED&#39;,</span>
            <span class="c1">#&#39;BNDFIX&#39;, &#39;BNDFIX1&#39;,</span>
            <span class="c1">#&#39;AEFORCE&#39;, &#39;UXVEC&#39;, &#39;GUST2&#39;,</span>

            <span class="c1"># cyclic</span>
            <span class="s1">&#39;CYJOIN&#39;</span><span class="p">,</span> <span class="s1">&#39;CYAX&#39;</span><span class="p">,</span>

            <span class="c1"># other</span>
            <span class="s1">&#39;INCLUDE&#39;</span><span class="p">,</span>  <span class="c1"># &#39;=&#39;</span>
            <span class="s1">&#39;ENDDATA&#39;</span><span class="p">,</span>
        <span class="p">]</span>
        <span class="n">set_cards_to_read</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">cards_to_read</span><span class="p">)</span>
        <span class="kn">from</span> <span class="nn">collections</span> <span class="kn">import</span> <span class="n">Counter</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">cards_to_read</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="n">set_cards_to_read</span><span class="p">):</span>  <span class="c1"># pragma: no cover</span>
            <span class="n">bad_cards</span> <span class="o">=</span> <span class="p">[</span><span class="n">key</span> <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">Counter</span><span class="p">(</span><span class="n">cards_to_read</span><span class="p">)</span><span class="o">.</span><span class="n">items</span><span class="p">()</span>
                         <span class="k">if</span> <span class="n">value</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">]</span>
            <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="n">bad_cards</span><span class="p">)</span>

        <span class="c1"># the list of possible cards that will be parsed</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">cards_to_read</span> <span class="o">=</span> <span class="n">set_cards_to_read</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_xref</span> <span class="o">=</span> <span class="kc">False</span>

        <span class="c1">#case_control_cards = {&#39;FREQ&#39;, &#39;GUST&#39;, &#39;MPC&#39;, &#39;SPC&#39;, &#39;NLPARM&#39;, &#39;NSM&#39;,</span>
                              <span class="c1">#&#39;TEMP&#39;, &#39;TSTEPNL&#39;, &#39;INCLUDE&#39;}</span>
        <span class="c1">#self._unique_bulk_data_cards = self.cards_to_read.difference(CASE_CONTROL_CARDS)</span>

        <span class="c1">#: / is the delete from restart card</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">special_cards</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;DEQATN&#39;</span><span class="p">,</span> <span class="s1">&#39;/&#39;</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_make_card_parser</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_nastran_format</span> <span class="o">=</span> <span class="n">mode</span>
        <span class="k">if</span> <span class="n">mode</span> <span class="o">==</span> <span class="s1">&#39;msc&#39;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">set_as_msc</span><span class="p">()</span>
        <span class="k">elif</span> <span class="n">mode</span> <span class="o">==</span> <span class="s1">&#39;nx&#39;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">set_as_nx</span><span class="p">()</span>
        <span class="k">elif</span> <span class="n">mode</span> <span class="o">==</span> <span class="s1">&#39;zona&#39;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">set_as_zona</span><span class="p">()</span>
        <span class="k">elif</span> <span class="n">mode</span> <span class="o">==</span> <span class="s1">&#39;nasa95&#39;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">set_as_nasa95</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>  <span class="c1"># pragma: no cover</span>
            <span class="n">msg</span> <span class="o">=</span> <span class="s1">&#39;mode=</span><span class="si">%r</span><span class="s1"> is not supported; modes=[msc, nx, zona]&#39;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">_nastran_format</span>
            <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">__getstate__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;clears out a few variables in order to pickle the object&quot;&quot;&quot;</span>
        <span class="c1"># Copy the object&#39;s state from self.__dict__ which contains</span>
        <span class="c1"># all our instance attributes. Always use the dict.copy()</span>
        <span class="c1"># method to avoid modifying the original state.</span>
        <span class="n">state</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__dict__</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="c1"># Remove the unpicklable entries.</span>
        <span class="k">del</span> <span class="n">state</span><span class="p">[</span><span class="s1">&#39;_card_parser&#39;</span><span class="p">],</span> <span class="n">state</span><span class="p">[</span><span class="s1">&#39;log&#39;</span><span class="p">]</span>
        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;_card_parser_b&#39;</span><span class="p">):</span>
            <span class="k">del</span> <span class="n">state</span><span class="p">[</span><span class="s1">&#39;_card_parser_b&#39;</span><span class="p">]</span>
        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;_card_parser_prepare&#39;</span><span class="p">):</span>
            <span class="k">del</span> <span class="n">state</span><span class="p">[</span><span class="s1">&#39;_card_parser_prepare&#39;</span><span class="p">]</span>
        <span class="k">return</span> <span class="n">state</span>

    <span class="k">def</span> <span class="nf">get_h5attrs</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
        <span class="sd">&quot;&quot;&quot;helper method for dict_to_h5py&quot;&quot;&quot;</span>
        <span class="n">attrs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">object_attributes</span><span class="p">(</span><span class="n">mode</span><span class="o">=</span><span class="s1">&#39;both&#39;</span><span class="p">,</span> <span class="n">keys_to_skip</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">attrs</span>

    <span class="k">def</span> <span class="nf">export_hdf5_filename</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">hdf5_filename</span><span class="p">:</span><span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Converts the BDF objects into hdf5 object</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        hdf5_filename : str</span>
<span class="sd">            the path to the hdf5 file</span>

<span class="sd">        TODO: doesn&#39;t support:</span>
<span class="sd">          - BucklingEigenvalues</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="kn">import</span> <span class="nn">h5py</span>
        <span class="k">with</span> <span class="n">h5py</span><span class="o">.</span><span class="n">File</span><span class="p">(</span><span class="n">hdf5_filename</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">hdf5_file</span><span class="p">:</span>
            <span class="c1">#self.log.info(&#39;starting export_hdf5_file of %r&#39; % hdf5_filename)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">export_hdf5_file</span><span class="p">(</span><span class="n">hdf5_file</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">export_hdf5_file</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">hdf5_file</span><span class="p">,</span> <span class="n">exporter</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Converts the BDF objects into hdf5 object</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        hdf5_file : H5File()</span>
<span class="sd">            an h5py object</span>
<span class="sd">        exporter : HDF5Exporter; default=None</span>
<span class="sd">            unused</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="kn">from</span> <span class="nn">pyNastran.bdf.bdf_interface.hdf5_exporter</span> <span class="kn">import</span> <span class="n">export_bdf_to_hdf5_file</span>
        <span class="n">export_bdf_to_hdf5_file</span><span class="p">(</span><span class="n">hdf5_file</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">load_hdf5_filename</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">hdf5_filename</span><span class="p">:</span><span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Loads a BDF object from an hdf5 filename</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        hdf5_filename : str</span>
<span class="sd">            the path to the hdf5 file</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="kn">import</span> <span class="nn">h5py</span>
        <span class="k">with</span> <span class="n">h5py</span><span class="o">.</span><span class="n">File</span><span class="p">(</span><span class="n">hdf5_filename</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">hdf5_file</span><span class="p">:</span>
            <span class="c1">#self.log.info(&#39;starting load_hdf5_file of %r&#39; % hdf5_filename)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">load_hdf5_file</span><span class="p">(</span><span class="n">hdf5_file</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">load_hdf5_file</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">h5_file</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Loads a BDF object from an hdf5 object</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        hdf5_file : H5File()</span>
<span class="sd">            an h5py object</span>
<span class="sd">        exporter : HDF5Exporter; default=None</span>
<span class="sd">            unused</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="kn">from</span> <span class="nn">pyNastran.bdf.bdf_interface.hdf5_loader</span> <span class="kn">import</span> <span class="n">load_bdf_from_hdf5_file</span>
        <span class="n">load_bdf_from_hdf5_file</span><span class="p">(</span><span class="n">h5_file</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">saves</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">unxref</span><span class="p">:</span> <span class="nb">bool</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Saves a pickled string&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">unxref</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">uncross_reference</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">dumps</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">save</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">obj_filename</span><span class="p">:</span> <span class="nb">str</span><span class="o">=</span><span class="s1">&#39;model.obj&#39;</span><span class="p">,</span> <span class="n">unxref</span><span class="p">:</span> <span class="nb">bool</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Saves a pickleable object&quot;&quot;&quot;</span>
        <span class="c1">#del self.log</span>
        <span class="c1">#del self._card_parser, self._card_parser_prepare</span>

        <span class="c1">#try:</span>
            <span class="c1">#del self.log</span>
        <span class="c1">#except AttributeError:</span>
            <span class="c1">#pass</span>
        <span class="c1">#self.case_control_lines = str(self.case_control_deck).split(&#39;\n&#39;)</span>
        <span class="c1">#del self.case_control_deck</span>

        <span class="k">if</span> <span class="n">unxref</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">uncross_reference</span><span class="p">()</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">obj_filename</span><span class="p">,</span> <span class="s1">&#39;wb&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">obj_file</span><span class="p">:</span>
            <span class="n">dump</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">obj_file</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">load</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">obj_filename</span><span class="p">:</span> <span class="nb">str</span><span class="o">=</span><span class="s1">&#39;model.obj&#39;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Loads a pickleable object&quot;&quot;&quot;</span>
        <span class="c1">#del self.log</span>
        <span class="c1">#lines = print(self.case_control_deck)</span>
        <span class="c1">#self.case_control_lines = lines.split(&#39;\n&#39;)</span>
        <span class="c1">#del self.case_control_deck</span>
        <span class="c1">#self.uncross_reference()</span>
        <span class="c1">#import types</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">obj_filename</span><span class="p">,</span> <span class="s1">&#39;rb&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">obj_file</span><span class="p">:</span>
            <span class="n">obj</span> <span class="o">=</span> <span class="n">load</span><span class="p">(</span><span class="n">obj_file</span><span class="p">)</span>

        <span class="c1"># these are properties, functions, etc.</span>
        <span class="n">keys_to_skip</span> <span class="o">=</span> <span class="p">[</span>
            <span class="s1">&#39;case_control_deck&#39;</span><span class="p">,</span>
            <span class="s1">&#39;log&#39;</span><span class="p">,</span>
            <span class="s1">&#39;node_ids&#39;</span><span class="p">,</span> <span class="s1">&#39;coord_ids&#39;</span><span class="p">,</span> <span class="s1">&#39;element_ids&#39;</span><span class="p">,</span> <span class="s1">&#39;property_ids&#39;</span><span class="p">,</span>
            <span class="s1">&#39;material_ids&#39;</span><span class="p">,</span> <span class="s1">&#39;caero_ids&#39;</span><span class="p">,</span> <span class="s1">&#39;is_long_ids&#39;</span><span class="p">,</span>
            <span class="s1">&#39;nnodes&#39;</span><span class="p">,</span> <span class="s1">&#39;npoints&#39;</span><span class="p">,</span> <span class="s1">&#39;ncoords&#39;</span><span class="p">,</span> <span class="s1">&#39;nelements&#39;</span><span class="p">,</span> <span class="s1">&#39;nproperties&#39;</span><span class="p">,</span>
            <span class="s1">&#39;nmaterials&#39;</span><span class="p">,</span> <span class="s1">&#39;ncaeros&#39;</span><span class="p">,</span> <span class="s1">&#39;nid_map&#39;</span><span class="p">,</span>
            <span class="s1">&#39;is_bdf_vectorized&#39;</span><span class="p">,</span> <span class="s1">&#39;type_slot_str&#39;</span><span class="p">,</span>
            <span class="c1">#&#39;dmigs&#39;, &#39;dmijs&#39;, &#39;dmiks&#39;, &#39;dmijis&#39;, &#39;dtis&#39;, &#39;dmis&#39;,</span>

            <span class="s1">&#39;point_ids&#39;</span><span class="p">,</span> <span class="s1">&#39;subcases&#39;</span><span class="p">,</span>
            <span class="s1">&#39;_card_parser&#39;</span><span class="p">,</span> <span class="s1">&#39;_card_parser_b&#39;</span><span class="p">,</span> <span class="s1">&#39;_card_parser_prepare&#39;</span><span class="p">,</span>
            <span class="s1">&#39;wtmass&#39;</span><span class="p">,</span>
        <span class="p">]</span>
        <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">object_attributes</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;all&#39;</span><span class="p">,</span> <span class="n">keys_to_skip</span><span class="o">=</span><span class="n">keys_to_skip</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">key</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;__&#39;</span><span class="p">)</span> <span class="ow">and</span> <span class="n">key</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s1">&#39;__&#39;</span><span class="p">):</span>
                <span class="k">continue</span>

            <span class="n">val</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="n">key</span><span class="p">)</span>
            <span class="c1">#print(key)</span>
            <span class="c1">#if isinstance(val, types.FunctionType):</span>
                <span class="c1">#continue</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="nb">setattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">,</span> <span class="n">val</span><span class="p">)</span>
            <span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span>  <span class="c1"># pragma: no cover</span>
                <span class="k">raise</span> <span class="ne">AttributeError</span><span class="p">(</span><span class="s1">&#39;key=</span><span class="si">%r</span><span class="s1"> val=</span><span class="si">%s</span><span class="se">\n</span><span class="s1">update ~line 860 of bdf.py and &#39;</span>
                                     <span class="s1">&#39;add the new key (</span><span class="si">%s</span><span class="s1">)&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">val</span><span class="p">,</span> <span class="n">key</span><span class="p">))</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">case_control_deck</span> <span class="o">=</span> <span class="n">CaseControlDeck</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">case_control_lines</span><span class="p">,</span> <span class="n">log</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="p">)</span>
        <span class="c1">#self.log.debug(&#39;done loading!&#39;)</span>
        <span class="k">for</span> <span class="n">model</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">superelement_models</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
            <span class="n">model</span><span class="o">.</span><span class="n">log</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">log</span>

    <span class="k">def</span> <span class="nf">replace_cards</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">replace_model</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Replaces the common cards from the current (self) model from the</span>
<span class="sd">        ones in the new replace_model.  The intention is that you&#39;re</span>
<span class="sd">        going to replace things like PSHELLs and DESVARs from a pch file</span>
<span class="sd">        in order to update your BDF with the optimized geometry.</span>

<span class="sd">        .. todo:: only does a subset of cards.</span>

<span class="sd">        Notes</span>
<span class="sd">        -----</span>
<span class="sd">        loads/spcs (not supported) are tricky because you can&#39;t replace</span>
<span class="sd">        cards one-to-one...not sure what to do</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">nid</span><span class="p">,</span> <span class="n">node</span> <span class="ow">in</span> <span class="n">replace_model</span><span class="o">.</span><span class="n">nodes</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">nodes</span><span class="p">[</span><span class="n">nid</span><span class="p">]</span> <span class="o">=</span> <span class="n">node</span>
        <span class="k">for</span> <span class="n">eid</span><span class="p">,</span> <span class="n">elem</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">elements</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">elements</span><span class="p">[</span><span class="n">eid</span><span class="p">]</span> <span class="o">=</span> <span class="n">elem</span>
        <span class="k">for</span> <span class="n">eid</span><span class="p">,</span> <span class="n">elem</span> <span class="ow">in</span> <span class="n">replace_model</span><span class="o">.</span><span class="n">rigid_elements</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">rigid_elements</span><span class="p">[</span><span class="n">eid</span><span class="p">]</span> <span class="o">=</span> <span class="n">elem</span>
        <span class="k">for</span> <span class="n">pid</span><span class="p">,</span> <span class="n">prop</span> <span class="ow">in</span> <span class="n">replace_model</span><span class="o">.</span><span class="n">properties</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">properties</span><span class="p">[</span><span class="n">pid</span><span class="p">]</span> <span class="o">=</span> <span class="n">prop</span>
        <span class="k">for</span> <span class="n">mid</span><span class="p">,</span> <span class="n">mat</span> <span class="ow">in</span> <span class="n">replace_model</span><span class="o">.</span><span class="n">materials</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">materials</span><span class="p">[</span><span class="n">mid</span><span class="p">]</span> <span class="o">=</span> <span class="n">mat</span>

        <span class="k">for</span> <span class="n">dvid</span><span class="p">,</span> <span class="n">desvar</span> <span class="ow">in</span> <span class="n">replace_model</span><span class="o">.</span><span class="n">desvars</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">desvars</span><span class="p">[</span><span class="n">dvid</span><span class="p">]</span> <span class="o">=</span> <span class="n">desvar</span>
        <span class="k">for</span> <span class="n">dvid</span><span class="p">,</span> <span class="n">dvprel</span> <span class="ow">in</span> <span class="n">replace_model</span><span class="o">.</span><span class="n">dvprels</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">dvprels</span><span class="p">[</span><span class="n">dvid</span><span class="p">]</span> <span class="o">=</span> <span class="n">dvprel</span>
        <span class="k">for</span> <span class="n">dvid</span><span class="p">,</span> <span class="n">dvmrel</span> <span class="ow">in</span> <span class="n">replace_model</span><span class="o">.</span><span class="n">dvmrels</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">dvmrels</span><span class="p">[</span><span class="n">dvid</span><span class="p">]</span> <span class="o">=</span> <span class="n">dvmrel</span>
        <span class="k">for</span> <span class="n">dvid</span><span class="p">,</span> <span class="n">dvgrid</span> <span class="ow">in</span> <span class="n">replace_model</span><span class="o">.</span><span class="n">dvgrids</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">dvgrids</span><span class="p">[</span><span class="n">dvid</span><span class="p">]</span> <span class="o">=</span> <span class="n">dvgrid</span>

    <span class="k">def</span> <span class="nf">disable_cards</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">cards</span><span class="p">:</span> <span class="n">Sequence</span><span class="p">[</span><span class="nb">str</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Method for removing broken cards from the reader</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        cards : List[str]; Set[str]</span>
<span class="sd">            a list/set of cards that should not be read</span>

<span class="sd">        .. python ::</span>

<span class="sd">            bdf_model.disable_cards([&#39;DMIG&#39;, &#39;PCOMP&#39;])</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">cards</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">cards</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
            <span class="n">disable_set</span> <span class="o">=</span> <span class="nb">set</span><span class="p">([</span><span class="n">cards</span><span class="p">])</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">disable_set</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">cards</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">cards_to_read</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cards_to_read</span><span class="o">.</span><span class="n">difference</span><span class="p">(</span><span class="n">disable_set</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">set_cards</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">cards</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span><span class="n">Set</span><span class="p">[</span><span class="nb">str</span><span class="p">]])</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Method for setting the cards that will be processed</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        cards : List[str]; Set[str]</span>
<span class="sd">            a list/set of cards that should not be read</span>

<span class="sd">        .. python ::</span>

<span class="sd">            bdf_model.set_cards([&#39;GRID&#39;, &#39;CTRIA3&#39;])</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">cards</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">cards</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
            <span class="n">enable_set</span> <span class="o">=</span> <span class="nb">set</span><span class="p">([</span><span class="n">cards</span><span class="p">])</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">enable_set</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">cards</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">cards_to_read</span> <span class="o">=</span> <span class="n">enable_set</span>

    <span class="k">def</span> <span class="nf">set_error_storage</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">nparse_errors</span><span class="p">:</span> <span class="nb">int</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">stop_on_parsing_error</span><span class="p">:</span> <span class="nb">bool</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                          <span class="n">nxref_errors</span><span class="p">:</span> <span class="nb">int</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">stop_on_xref_error</span><span class="p">:</span> <span class="nb">bool</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Catch parsing errors and store them up to print them out all at once</span>
<span class="sd">        (not all errors are caught).</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        nparse_errors : int</span>
<span class="sd">            how many parse errors should be stored</span>
<span class="sd">            (default=0; all=None; no storage=0)</span>
<span class="sd">        stop_on_parsing_error : bool</span>
<span class="sd">            should an error be raised if there</span>
<span class="sd">            are parsing errors (default=True)</span>
<span class="sd">        nxref_errors : int</span>
<span class="sd">            how many cross-reference errors</span>
<span class="sd">            should be stored (default=0; all=None; no storage=0)</span>
<span class="sd">        stop_on_xref_error : bool</span>
<span class="sd">            should an error be raised if there</span>
<span class="sd">            are cross-reference errors (default=True)</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">nparse_errors</span><span class="p">,</span> <span class="nb">int</span><span class="p">),</span> <span class="nb">type</span><span class="p">(</span><span class="n">nparse_errors</span><span class="p">)</span>
        <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">nxref_errors</span><span class="p">,</span> <span class="nb">int</span><span class="p">),</span> <span class="nb">type</span><span class="p">(</span><span class="n">nxref_errors</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_nparse_errors</span> <span class="o">=</span> <span class="n">nparse_errors</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_nxref_errors</span> <span class="o">=</span> <span class="n">nxref_errors</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_stop_on_parsing_error</span> <span class="o">=</span> <span class="n">stop_on_parsing_error</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_stop_on_xref_error</span> <span class="o">=</span> <span class="n">stop_on_xref_error</span>

    <span class="k">def</span> <span class="nf">validate</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;runs some checks on the input data beyond just type checking&quot;&quot;&quot;</span>
        <span class="n">validate_bdf</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_verify_bdf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">xref</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Cross reference verification method.&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">xref</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">xref</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_xref</span>
        <span class="n">verify_bdf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">xref</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">include_zip</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">bdf_filename</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                    <span class="n">encoding</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                    <span class="n">make_ilines</span><span class="p">:</span> <span class="nb">bool</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="p">(</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="n">Any</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Read a bdf without perform any other operation, except (optionally)</span>
<span class="sd">        insert the INCLUDE files in the bdf</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        bdf_filename : str / None</span>
<span class="sd">            the input bdf (default=None; popup a dialog)</span>
<span class="sd">        encoding : str; default=None -&gt; system default</span>
<span class="sd">            the unicode encoding</span>
<span class="sd">        make_ilines : bool; default=True</span>
<span class="sd">            flag for ilines</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        all_lines : List[str]</span>
<span class="sd">            all the lines packed into a single line stream</span>
<span class="sd">        ilines : (nlines, 2) int ndarray</span>
<span class="sd">            if make_ilines = True:</span>
<span class="sd">                the [ifile, iline] pair for each line in the file</span>
<span class="sd">            if make_ilines = False:</span>
<span class="sd">                 ilines = None</span>

<span class="sd">        .. note::  Setting read_includes to False is kind of pointless if</span>
<span class="sd">                   called directly; it&#39;s useful for ``read_bdf``</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">punch</span> <span class="o">=</span> <span class="kc">False</span> <span class="c1">#  doesn&#39;t really matter</span>
        <span class="n">read_includes</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_read_bdf_helper</span><span class="p">(</span><span class="n">bdf_filename</span><span class="p">,</span> <span class="n">encoding</span><span class="p">,</span> <span class="n">punch</span><span class="p">,</span> <span class="n">read_includes</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_parse_primary_file_header</span><span class="p">(</span><span class="n">bdf_filename</span><span class="p">)</span>

        <span class="n">obj</span> <span class="o">=</span> <span class="n">BDFInputPy</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">read_includes</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">dumplines</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_encoding</span><span class="p">,</span>
                         <span class="n">nastran_format</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">nastran_format</span><span class="p">,</span>
                         <span class="n">consider_superelements</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">is_superelements</span><span class="p">,</span>
                         <span class="n">log</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="p">,</span> <span class="n">debug</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">debug</span><span class="p">)</span>
        <span class="n">main_lines</span> <span class="o">=</span> <span class="n">obj</span><span class="o">.</span><span class="n">get_main_lines</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">bdf_filename</span><span class="p">)</span>
        <span class="n">all_lines</span><span class="p">,</span> <span class="n">ilines</span> <span class="o">=</span> <span class="n">obj</span><span class="o">.</span><span class="n">lines_to_deck_lines</span><span class="p">(</span><span class="n">main_lines</span><span class="p">,</span> <span class="n">make_ilines</span><span class="o">=</span><span class="n">make_ilines</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_set_pybdf_attributes</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="n">save_file_structure</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">all_lines</span><span class="p">,</span> <span class="n">ilines</span>

    <span class="k">def</span> <span class="nf">_set_pybdf_attributes</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">obj</span><span class="p">:</span> <span class="n">BDFInputPy</span><span class="p">,</span>
                              <span class="n">save_file_structure</span><span class="p">:</span> <span class="nb">bool</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="c1"># type: (BDFInputPy, bool) -&gt; None</span>
        <span class="sd">&quot;&quot;&quot;common method for all functions that use BDFInputPy&quot;&quot;&quot;</span>
        <span class="c1"># these are include line pairs</span>
        <span class="c1">#print(obj.include_lines)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">active_filenames</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">reject_lines</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">include_filenames</span> <span class="o">=</span> <span class="n">defaultdict</span><span class="p">(</span><span class="nb">list</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">ifile</span><span class="p">,</span> <span class="n">include_lines_filename_pairs</span> <span class="ow">in</span> <span class="n">obj</span><span class="o">.</span><span class="n">include_lines</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">include_lines_filename_pairs</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">,</span> <span class="n">include_lines_filename_pairs</span>
            <span class="k">for</span> <span class="n">include_lines</span><span class="p">,</span> <span class="n">bdf_filename2</span> <span class="ow">in</span> <span class="n">include_lines_filename_pairs</span><span class="p">:</span>
                <span class="c1">#print(ifile, include_lines)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">include_filenames</span><span class="p">[</span><span class="n">ifile</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">bdf_filename2</span><span class="p">)</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="n">save_file_structure</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">obj</span><span class="o">.</span><span class="n">read_includes</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">reject_lines</span> <span class="o">+=</span> <span class="n">include_lines</span>
        <span class="c1">#print(&#39;-------------ssett (end)----------&#39;)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">active_filenames</span> <span class="o">+=</span> <span class="n">obj</span><span class="o">.</span><span class="n">active_filenames</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">active_filename</span> <span class="o">=</span> <span class="n">obj</span><span class="o">.</span><span class="n">active_filename</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">include_dir</span> <span class="o">=</span> <span class="n">obj</span><span class="o">.</span><span class="n">include_dir</span>

    <span class="k">def</span> <span class="nf">read_bdf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">bdf_filename</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                 <span class="n">validate</span><span class="p">:</span> <span class="nb">bool</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                 <span class="n">xref</span><span class="p">:</span> <span class="nb">bool</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                 <span class="n">punch</span><span class="p">:</span> <span class="nb">bool</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                 <span class="n">read_includes</span><span class="p">:</span> <span class="nb">bool</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                 <span class="n">save_file_structure</span><span class="p">:</span> <span class="nb">bool</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                 <span class="n">encoding</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Read method for the bdf files</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        bdf_filename : str / None</span>
<span class="sd">            the input bdf (default=None; popup a dialog)</span>
<span class="sd">        validate : bool; default=True</span>
<span class="sd">            runs various checks on the BDF</span>
<span class="sd">        xref :  bool; default=True</span>
<span class="sd">            should the bdf be cross referenced</span>
<span class="sd">        punch : bool; default=False</span>
<span class="sd">            indicates whether the file is a punch file</span>
<span class="sd">        read_includes : bool; default=True</span>
<span class="sd">            indicates whether INCLUDE files should be read</span>
<span class="sd">        save_file_structure : bool; default=False</span>
<span class="sd">            enables the ``write_bdfs`` method</span>
<span class="sd">        encoding : str; default=None -&gt; system default</span>
<span class="sd">            the unicode encoding</span>

<span class="sd">        .. code-block:: python</span>

<span class="sd">           &gt;&gt;&gt; bdf = BDF()</span>
<span class="sd">           &gt;&gt;&gt; bdf.read_bdf(bdf_filename, xref=True)</span>
<span class="sd">           &gt;&gt;&gt; g1 = bdf.Node(1)</span>
<span class="sd">           &gt;&gt;&gt; print(g1.get_position())</span>
<span class="sd">           [10.0, 12.0, 42.0]</span>
<span class="sd">           &gt;&gt;&gt; bdf.write_card(bdf_filename2)</span>
<span class="sd">           &gt;&gt;&gt; print(bdf.card_stats())</span>

<span class="sd">           ---BDF Statistics---</span>
<span class="sd">           SOL 101</span>
<span class="sd">           bdf.nodes = 20</span>
<span class="sd">           bdf.elements = 10</span>
<span class="sd">           etc.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">save_file_structure</span> <span class="o">=</span> <span class="n">save_file_structure</span>
        <span class="k">if</span> <span class="n">bdf_filename</span> <span class="ow">and</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">bdf_filename</span><span class="p">,</span> <span class="p">(</span><span class="n">StringIO</span><span class="p">,</span> <span class="nb">list</span><span class="p">)):</span>
            <span class="n">check_path</span><span class="p">(</span><span class="n">bdf_filename</span><span class="p">,</span> <span class="s1">&#39;bdf_filename&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_read_bdf_helper</span><span class="p">(</span><span class="n">bdf_filename</span><span class="p">,</span> <span class="n">encoding</span><span class="p">,</span> <span class="n">punch</span><span class="p">,</span> <span class="n">read_includes</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s1">&#39;---starting BDF.read_bdf of </span><span class="si">%s</span><span class="s1">---&#39;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">bdf_filename</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_parse_primary_file_header</span><span class="p">(</span><span class="n">bdf_filename</span><span class="p">)</span>

        <span class="n">obj</span> <span class="o">=</span> <span class="n">BDFInputPy</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">read_includes</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">dumplines</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_encoding</span><span class="p">,</span>
                         <span class="n">nastran_format</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">nastran_format</span><span class="p">,</span>
                         <span class="n">consider_superelements</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">is_superelements</span><span class="p">,</span>
                         <span class="n">log</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="p">,</span> <span class="n">debug</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">debug</span><span class="p">)</span>
        <span class="n">out</span> <span class="o">=</span> <span class="n">obj</span><span class="o">.</span><span class="n">get_lines</span><span class="p">(</span><span class="n">bdf_filename</span><span class="p">,</span> <span class="n">punch</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">punch</span><span class="p">,</span> <span class="n">make_ilines</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">system_lines</span><span class="p">,</span> <span class="n">executive_control_lines</span><span class="p">,</span> <span class="n">case_control_lines</span><span class="p">,</span> <span class="n">bulk_data_lines</span><span class="p">,</span> <span class="n">bulk_data_ilines</span><span class="p">,</span> <span class="n">superelement_lines</span><span class="p">,</span> <span class="n">superelement_ilines</span> <span class="o">=</span> <span class="n">out</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_set_pybdf_attributes</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="n">save_file_structure</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">system_command_lines</span> <span class="o">=</span> <span class="n">system_lines</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">executive_control_lines</span> <span class="o">=</span> <span class="n">executive_control_lines</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">case_control_lines</span> <span class="o">=</span> <span class="n">case_control_lines</span>

        <span class="n">sol</span><span class="p">,</span> <span class="n">method</span><span class="p">,</span> <span class="n">sol_iline</span> <span class="o">=</span> <span class="n">parse_executive_control_deck</span><span class="p">(</span><span class="n">executive_control_lines</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">update_solution</span><span class="p">(</span><span class="n">sol</span><span class="p">,</span> <span class="n">method</span><span class="p">,</span> <span class="n">sol_iline</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">case_control_deck</span> <span class="o">=</span> <span class="n">CaseControlDeck</span><span class="p">(</span><span class="n">case_control_lines</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">case_control_deck</span><span class="o">.</span><span class="n">solmap_to_value</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_solmap_to_value</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">case_control_deck</span><span class="o">.</span><span class="n">rsolmap_to_str</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">rsolmap_to_str</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_parse_all_cards</span><span class="p">(</span><span class="n">bulk_data_lines</span><span class="p">,</span> <span class="n">bulk_data_ilines</span><span class="p">)</span>
        <span class="k">except</span> <span class="n">SuperelementFlagError</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_superelements</span><span class="p">:</span>
                <span class="k">raise</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">clear_attributes</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s1">&#39;Attempting to use is_superelements=True.&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">is_superelements</span> <span class="o">=</span> <span class="kc">True</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">read_bdf</span><span class="p">(</span><span class="n">bdf_filename</span><span class="o">=</span><span class="n">bdf_filename</span><span class="p">,</span> <span class="n">validate</span><span class="o">=</span><span class="n">validate</span><span class="p">,</span> <span class="n">xref</span><span class="o">=</span><span class="n">xref</span><span class="p">,</span> <span class="n">punch</span><span class="o">=</span><span class="n">punch</span><span class="p">,</span>
                          <span class="n">read_includes</span><span class="o">=</span><span class="n">read_includes</span><span class="p">,</span> <span class="n">save_file_structure</span><span class="o">=</span><span class="n">save_file_structure</span><span class="p">,</span>
                          <span class="n">encoding</span><span class="o">=</span><span class="n">encoding</span><span class="p">)</span>
            <span class="k">return</span>

        <span class="k">if</span> <span class="n">superelement_lines</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_add_superelements</span><span class="p">(</span><span class="n">superelement_lines</span><span class="p">,</span> <span class="n">superelement_ilines</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">pop_parse_errors</span><span class="p">()</span>
        <span class="n">fill_dmigs</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">validate</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">validate</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">cross_reference</span><span class="p">(</span><span class="n">xref</span><span class="o">=</span><span class="n">xref</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_xref</span> <span class="o">=</span> <span class="n">xref</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s1">&#39;---finished BDF.read_bdf of </span><span class="si">%s</span><span class="s1">---&#39;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">bdf_filename</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_add_superelements</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">superelement_lines</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span>
                           <span class="n">superelement_ilines</span><span class="p">:</span> <span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>  <span class="c1"># pragma: no cover</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s1">&#39;_add_superelements should be overwritten&#39;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_parse_all_cards</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">bulk_data_lines</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="n">bulk_data_ilines</span><span class="p">:</span> <span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;creates and loads all the cards the bulk data section&quot;&quot;&quot;</span>
        <span class="n">cards_list</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">cards_dict</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_is_cards_dict</span><span class="p">:</span>
            <span class="n">cards_dict</span><span class="p">,</span> <span class="n">card_count</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_bdf_cards_dict</span><span class="p">(</span>
                <span class="n">bulk_data_lines</span><span class="p">,</span> <span class="n">bulk_data_ilines</span><span class="p">)</span>
            <span class="c1">#if 0:</span>
                <span class="c1">#with open(&#39;dump.bdf&#39;, &#39;w&#39;) as bdf_file_obj:</span>
                    <span class="c1">#bdf_file_obj.write(&#39;\n&#39;.join(executive_control_lines))</span>
                    <span class="c1">#bdf_file_obj.write(str(case_control_deck))</span>
                    <span class="c1">#for cardname, cards in cards.items():</span>
                        <span class="c1">#for (comment, cardlines) in cards:</span>
                            <span class="c1">##bdf_file_obj.write(comment + &#39;\n&#39;)</span>
                            <span class="c1">#bdf_file_obj.write(&#39;\n&#39;.join(cardlines) + &#39;\n&#39;)</span>
                        <span class="c1">#bdf_file_obj.write(&#39;\n&#39;)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">cards_list</span><span class="p">,</span> <span class="n">cards_dict</span><span class="p">,</span> <span class="n">card_count</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_bdf_cards</span><span class="p">(</span>
                <span class="n">bulk_data_lines</span><span class="p">,</span> <span class="n">bulk_data_ilines</span><span class="p">)</span>
            <span class="c1">#for card in cards_list:</span>
                <span class="c1">#card_name = card[0]</span>
                <span class="c1">#if card_name == &#39;CBAR&#39;:</span>
                    <span class="c1">#print(card)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_parse_cards</span><span class="p">(</span><span class="n">cards_list</span><span class="p">,</span> <span class="n">cards_dict</span><span class="p">,</span> <span class="n">card_count</span><span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">values_to_skip</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">values</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">values_to_skip</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                <span class="n">dict_values</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">)</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">dict_values</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
                    <span class="n">msg</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">%r</span><span class="s1"> is an invalid type; only dictionaries are supported&#39;</span> <span class="o">%</span> <span class="n">key</span>
                    <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
                <span class="k">for</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">values</span><span class="p">:</span>
                    <span class="k">del</span> <span class="n">dict_values</span><span class="p">[</span><span class="n">value</span><span class="p">]</span>
            <span class="c1"># TODO: redo get_card_ids_by_card_types &amp; card_count</span>

    <span class="k">def</span> <span class="nf">_read_bdf_helper</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">bdf_filename</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">encoding</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
                         <span class="n">punch</span><span class="p">:</span> <span class="nb">bool</span><span class="p">,</span> <span class="n">read_includes</span><span class="p">:</span> <span class="nb">bool</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;creates the file loading if bdf_filename is None&quot;&quot;&quot;</span>
        <span class="c1">#self.set_error_storage(nparse_errors=None, stop_on_parsing_error=True,</span>
        <span class="c1">#                       nxref_errors=None, stop_on_xref_error=True)</span>
        <span class="k">if</span> <span class="n">encoding</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">encoding</span> <span class="o">=</span> <span class="n">sys</span><span class="o">.</span><span class="n">getdefaultencoding</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_encoding</span> <span class="o">=</span> <span class="n">encoding</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">read_includes</span> <span class="o">=</span> <span class="n">read_includes</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">active_filenames</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="k">if</span> <span class="n">bdf_filename</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="kn">from</span> <span class="nn">pyNastran.utils.gui_io</span> <span class="kn">import</span> <span class="n">load_file_dialog</span>
            <span class="n">wildcard_wx</span> <span class="o">=</span> <span class="s2">&quot;Nastran BDF (*.bdf; *.dat; *.nas; *.pch, *.ecd)|&quot;</span> \
                <span class="s2">&quot;*.bdf;*.dat;*.nas;*.pch;*.ecd|&quot;</span> \
                <span class="s2">&quot;All files (*.*)|*.*&quot;</span>
            <span class="n">wildcard_qt</span> <span class="o">=</span> <span class="s2">&quot;Nastran BDF (*.bdf *.dat *.nas *.pch *.ecd);;All files (*)&quot;</span>
            <span class="n">title</span> <span class="o">=</span> <span class="s1">&#39;Please select a BDF/DAT/PCH/ECD to load&#39;</span>
            <span class="n">bdf_filename</span> <span class="o">=</span> <span class="n">load_file_dialog</span><span class="p">(</span><span class="n">title</span><span class="p">,</span> <span class="n">wildcard_wx</span><span class="p">,</span> <span class="n">wildcard_qt</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
            <span class="k">assert</span> <span class="n">bdf_filename</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">,</span> <span class="n">bdf_filename</span>

        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">bdf_filename</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
            <span class="k">pass</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">bdf_filename</span><span class="p">,</span> <span class="p">(</span><span class="n">StringIO</span><span class="p">,</span> <span class="n">IOBase</span><span class="p">)):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">bdf_filename</span> <span class="o">=</span> <span class="n">bdf_filename</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">punch</span> <span class="o">=</span> <span class="n">punch</span>
            <span class="k">return</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="n">bdf_filename</span><span class="p">)</span>

        <span class="n">check_path</span><span class="p">(</span><span class="n">bdf_filename</span><span class="p">,</span> <span class="s1">&#39;bdf_filename&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">bdf_filename</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s1">&#39;.pch&#39;</span><span class="p">):</span>  <span class="c1"># .. todo:: should this be removed???</span>
            <span class="n">punch</span> <span class="o">=</span> <span class="kc">True</span>

        <span class="c1">#: the active filename (string)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">bdf_filename</span> <span class="o">=</span> <span class="n">bdf_filename</span>

        <span class="c1">#: is this a punch file (no executive control deck)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">punch</span> <span class="o">=</span> <span class="n">punch</span>
        <span class="k">assert</span> <span class="ow">not</span> <span class="n">bdf_filename</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s1">&#39;.op2&#39;</span><span class="p">),</span> <span class="n">bdf_filename</span>

    <span class="k">def</span> <span class="nf">pop_parse_errors</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;raises an error if there are parsing errors&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_stop_on_parsing_error</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_iparse_errors</span> <span class="o">==</span> <span class="mi">1</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">_nparse_errors</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="k">raise</span>
            <span class="n">is_error</span> <span class="o">=</span> <span class="kc">False</span>
            <span class="n">msg</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_duplicate_elements</span><span class="p">:</span>
                <span class="n">duplicate_eids</span> <span class="o">=</span> <span class="p">[</span><span class="n">elem</span><span class="o">.</span><span class="n">eid</span> <span class="k">for</span> <span class="n">elem</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_duplicate_elements</span><span class="p">]</span>
                <span class="n">uduplicate_eids</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">duplicate_eids</span><span class="p">)</span>
                <span class="n">msg</span> <span class="o">+=</span> <span class="s1">&#39;self.elements IDs are not unique=</span><span class="si">%s</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">uduplicate_eids</span>
                <span class="k">for</span> <span class="n">eid</span> <span class="ow">in</span> <span class="n">uduplicate_eids</span><span class="p">:</span>
                    <span class="n">msg</span> <span class="o">+=</span> <span class="s1">&#39;old_element=</span><span class="se">\n</span><span class="si">%s</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">elements</span><span class="p">[</span><span class="n">eid</span><span class="p">])</span>
                    <span class="n">msg</span> <span class="o">+=</span> <span class="s1">&#39;new_elements=</span><span class="se">\n</span><span class="s1">&#39;</span>
                    <span class="k">for</span> <span class="n">elem</span><span class="p">,</span> <span class="n">eidi</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_duplicate_elements</span><span class="p">,</span> <span class="n">duplicate_eids</span><span class="p">):</span>
                        <span class="k">if</span> <span class="n">eidi</span> <span class="o">==</span> <span class="n">eid</span><span class="p">:</span>
                            <span class="n">msg</span> <span class="o">+=</span> <span class="nb">str</span><span class="p">(</span><span class="n">elem</span><span class="p">)</span>
                    <span class="n">msg</span> <span class="o">+=</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span>
                    <span class="n">is_error</span> <span class="o">=</span> <span class="kc">True</span>
                    <span class="k">raise</span> <span class="n">DuplicateIDsError</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>

            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_duplicate_properties</span><span class="p">:</span>
                <span class="n">duplicate_pids</span> <span class="o">=</span> <span class="p">[</span><span class="n">prop</span><span class="o">.</span><span class="n">pid</span> <span class="k">for</span> <span class="n">prop</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_duplicate_properties</span><span class="p">]</span>
                <span class="n">uduplicate_pids</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">duplicate_pids</span><span class="p">)</span>
                <span class="n">msg</span> <span class="o">+=</span> <span class="s1">&#39;self.properties IDs are not unique=</span><span class="si">%s</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">uduplicate_pids</span>
                <span class="k">for</span> <span class="n">pid</span> <span class="ow">in</span> <span class="n">duplicate_pids</span><span class="p">:</span>
                    <span class="n">msg</span> <span class="o">+=</span> <span class="s1">&#39;old_property=</span><span class="se">\n</span><span class="si">%s</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">properties</span><span class="p">[</span><span class="n">pid</span><span class="p">])</span>
                    <span class="n">msg</span> <span class="o">+=</span> <span class="s1">&#39;new_properties=</span><span class="se">\n</span><span class="s1">&#39;</span>
                    <span class="k">for</span> <span class="n">prop</span><span class="p">,</span> <span class="n">pidi</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_duplicate_properties</span><span class="p">,</span> <span class="n">duplicate_pids</span><span class="p">):</span>
                        <span class="k">if</span> <span class="n">pidi</span> <span class="o">==</span> <span class="n">pid</span><span class="p">:</span>
                            <span class="n">msg</span> <span class="o">+=</span> <span class="nb">str</span><span class="p">(</span><span class="n">prop</span><span class="p">)</span>
                    <span class="n">msg</span> <span class="o">+=</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span>
                    <span class="n">is_error</span> <span class="o">=</span> <span class="kc">True</span>

            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_duplicate_masses</span><span class="p">:</span>
                <span class="n">duplicate_eids</span> <span class="o">=</span> <span class="p">[</span><span class="n">elem</span><span class="o">.</span><span class="n">eid</span> <span class="k">for</span> <span class="n">elem</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_duplicate_masses</span><span class="p">]</span>
                <span class="n">uduplicate_eids</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">duplicate_eids</span><span class="p">)</span>
                <span class="n">msg</span> <span class="o">+=</span> <span class="s1">&#39;self.massses IDs are not unique=</span><span class="si">%s</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">uduplicate_eids</span>
                <span class="k">for</span> <span class="n">eid</span> <span class="ow">in</span> <span class="n">uduplicate_eids</span><span class="p">:</span>
                    <span class="n">msg</span> <span class="o">+=</span> <span class="s1">&#39;old_mass=</span><span class="se">\n</span><span class="si">%s</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">masses</span><span class="p">[</span><span class="n">eid</span><span class="p">])</span>
                    <span class="n">msg</span> <span class="o">+=</span> <span class="s1">&#39;new_masses=</span><span class="se">\n</span><span class="s1">&#39;</span>
                    <span class="k">for</span> <span class="n">elem</span><span class="p">,</span> <span class="n">eidi</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_duplicate_masses</span><span class="p">,</span> <span class="n">duplicate_eids</span><span class="p">):</span>
                        <span class="k">if</span> <span class="n">eidi</span> <span class="o">==</span> <span class="n">eid</span><span class="p">:</span>
                            <span class="n">msg</span> <span class="o">+=</span> <span class="nb">str</span><span class="p">(</span><span class="n">elem</span><span class="p">)</span>
                    <span class="n">msg</span> <span class="o">+=</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span>
                    <span class="n">is_error</span> <span class="o">=</span> <span class="kc">True</span>

            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_duplicate_materials</span><span class="p">:</span>
                <span class="n">duplicate_mids</span> <span class="o">=</span> <span class="p">[</span><span class="n">mat</span><span class="o">.</span><span class="n">mid</span> <span class="k">for</span> <span class="n">mat</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_duplicate_materials</span><span class="p">]</span>
                <span class="n">uduplicate_mids</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">duplicate_mids</span><span class="p">)</span>
                <span class="n">msg</span> <span class="o">+=</span> <span class="s1">&#39;self.materials IDs are not unique=</span><span class="si">%s</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">uduplicate_mids</span>
                <span class="k">for</span> <span class="n">mid</span> <span class="ow">in</span> <span class="n">uduplicate_mids</span><span class="p">:</span>
                    <span class="n">msg</span> <span class="o">+=</span> <span class="s1">&#39;old_material=</span><span class="se">\n</span><span class="si">%s</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">materials</span><span class="p">[</span><span class="n">mid</span><span class="p">])</span>
                    <span class="n">msg</span> <span class="o">+=</span> <span class="s1">&#39;new_materials=</span><span class="se">\n</span><span class="s1">&#39;</span>
                    <span class="k">for</span> <span class="n">mat</span><span class="p">,</span> <span class="n">midi</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_duplicate_materials</span><span class="p">,</span> <span class="n">duplicate_mids</span><span class="p">):</span>
                        <span class="k">if</span> <span class="n">midi</span> <span class="o">==</span> <span class="n">mid</span><span class="p">:</span>
                            <span class="n">msg</span> <span class="o">+=</span> <span class="nb">str</span><span class="p">(</span><span class="n">mat</span><span class="p">)</span>
                    <span class="n">msg</span> <span class="o">+=</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span>
                    <span class="n">is_error</span> <span class="o">=</span> <span class="kc">True</span>

            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_duplicate_thermal_materials</span><span class="p">:</span>
                <span class="n">duplicate_mids</span> <span class="o">=</span> <span class="p">[</span><span class="n">mat</span><span class="o">.</span><span class="n">mid</span> <span class="k">for</span> <span class="n">mat</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_duplicate_thermal_materials</span><span class="p">]</span>
                <span class="n">uduplicate_mids</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">duplicate_mids</span><span class="p">)</span>
                <span class="n">msg</span> <span class="o">+=</span> <span class="s1">&#39;self.thermal_materials IDs are not unique=</span><span class="si">%s</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">uduplicate_mids</span>
                <span class="k">for</span> <span class="n">mid</span> <span class="ow">in</span> <span class="n">uduplicate_mids</span><span class="p">:</span>
                    <span class="n">msg</span> <span class="o">+=</span> <span class="s1">&#39;old_thermal_material=</span><span class="se">\n</span><span class="si">%s</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">thermal_materials</span><span class="p">[</span><span class="n">mid</span><span class="p">])</span>
                    <span class="n">msg</span> <span class="o">+=</span> <span class="s1">&#39;new_thermal_materials=</span><span class="se">\n</span><span class="s1">&#39;</span>
                    <span class="k">for</span> <span class="n">mat</span><span class="p">,</span> <span class="n">midi</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_duplicate_thermal_materials</span><span class="p">,</span> <span class="n">duplicate_mids</span><span class="p">):</span>
                        <span class="k">if</span> <span class="n">midi</span> <span class="o">==</span> <span class="n">mid</span><span class="p">:</span>
                            <span class="n">msg</span> <span class="o">+=</span> <span class="nb">str</span><span class="p">(</span><span class="n">mat</span><span class="p">)</span>
                    <span class="n">msg</span> <span class="o">+=</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span>
                    <span class="n">is_error</span> <span class="o">=</span> <span class="kc">True</span>

            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_duplicate_coords</span><span class="p">:</span>
                <span class="n">duplicate_cids</span> <span class="o">=</span> <span class="p">[</span><span class="n">coord</span><span class="o">.</span><span class="n">cid</span> <span class="k">for</span> <span class="n">coord</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_duplicate_coords</span><span class="p">]</span>
                <span class="n">uduplicate_cids</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">duplicate_cids</span><span class="p">)</span>
                <span class="n">msg</span> <span class="o">+=</span> <span class="s1">&#39;self.coords IDs are not unique=</span><span class="si">%s</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">uduplicate_cids</span>
                <span class="k">for</span> <span class="n">cid</span> <span class="ow">in</span> <span class="n">uduplicate_cids</span><span class="p">:</span>
                    <span class="n">msg</span> <span class="o">+=</span> <span class="s1">&#39;old_coord=</span><span class="se">\n</span><span class="si">%s</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">coords</span><span class="p">[</span><span class="n">cid</span><span class="p">])</span>
                    <span class="n">msg</span> <span class="o">+=</span> <span class="s1">&#39;new_coords=</span><span class="se">\n</span><span class="s1">&#39;</span>
                    <span class="k">for</span> <span class="n">coord</span><span class="p">,</span> <span class="n">cidi</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_duplicate_coords</span><span class="p">,</span> <span class="n">duplicate_cids</span><span class="p">):</span>
                        <span class="k">if</span> <span class="n">cidi</span> <span class="o">==</span> <span class="n">cid</span><span class="p">:</span>
                            <span class="n">msg</span> <span class="o">+=</span> <span class="nb">str</span><span class="p">(</span><span class="n">coord</span><span class="p">)</span>
                    <span class="n">msg</span> <span class="o">+=</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span>
                    <span class="n">is_error</span> <span class="o">=</span> <span class="kc">True</span>

            <span class="k">if</span> <span class="n">is_error</span><span class="p">:</span>
                <span class="n">msg</span> <span class="o">=</span> <span class="s1">&#39;There are duplicate cards.</span><span class="se">\n\n</span><span class="s1">&#39;</span> <span class="o">+</span> <span class="n">msg</span>

            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_stop_on_xref_error</span><span class="p">:</span>
                <span class="n">msg</span> <span class="o">+=</span> <span class="s1">&#39;There are parsing errors.</span><span class="se">\n\n</span><span class="s1">&#39;</span>
                <span class="k">for</span> <span class="p">(</span><span class="n">card</span><span class="p">,</span> <span class="n">an_error</span><span class="p">)</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_stored_parse_errors</span><span class="p">:</span>
                    <span class="n">msg</span> <span class="o">+=</span> <span class="s1">&#39;</span><span class="si">%s</span><span class="s1">card=</span><span class="si">%s</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">an_error</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">card</span><span class="p">)</span>
                    <span class="n">msg</span> <span class="o">+=</span> <span class="s1">&#39;xref error: </span><span class="si">%s</span><span class="se">\n\n</span><span class="s1">&#39;</span><span class="o">%</span> <span class="n">an_error</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
                    <span class="n">is_error</span> <span class="o">=</span> <span class="kc">True</span>

            <span class="k">if</span> <span class="n">is_error</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">msg</span><span class="p">)</span>
                <span class="k">raise</span> <span class="n">DuplicateIDsError</span><span class="p">(</span><span class="n">msg</span><span class="o">.</span><span class="n">rstrip</span><span class="p">())</span>

    <span class="k">def</span> <span class="nf">pop_xref_errors</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;raises an error if there are cross-reference errors&quot;&quot;&quot;</span>
        <span class="n">is_error</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_stop_on_xref_error</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_ixref_errors</span> <span class="o">==</span> <span class="mi">1</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">_nxref_errors</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="k">raise</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_stored_xref_errors</span><span class="p">:</span>
                <span class="n">msg</span> <span class="o">=</span> <span class="s1">&#39;There are cross-reference errors.</span><span class="se">\n\n</span><span class="s1">&#39;</span>
                <span class="k">for</span> <span class="p">(</span><span class="n">card</span><span class="p">,</span> <span class="n">an_error</span><span class="p">)</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_stored_xref_errors</span><span class="p">:</span>
                    <span class="n">msg</span> <span class="o">+=</span> <span class="s1">&#39;</span><span class="si">%s</span><span class="s1">card=</span><span class="si">%s</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">an_error</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">card</span><span class="p">)</span>
                    <span class="n">is_error</span> <span class="o">=</span> <span class="kc">True</span>

                <span class="k">if</span> <span class="n">is_error</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">_stop_on_xref_error</span><span class="p">:</span>
                    <span class="k">raise</span> <span class="n">CrossReferenceError</span><span class="p">(</span><span class="n">msg</span><span class="o">.</span><span class="n">rstrip</span><span class="p">())</span>

    <span class="k">def</span> <span class="nf">get_bdf_cards</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">bulk_data_lines</span><span class="p">,</span> <span class="n">bulk_data_ilines</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="c1"># type: (List[str], Optional[Any]) -&gt; Any, Any, Any</span>
        <span class="sd">&quot;&quot;&quot;Parses the BDF lines into a list of card_lines&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">bulk_data_ilines</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">bulk_data_ilines</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="nb">len</span><span class="p">(</span><span class="n">bulk_data_lines</span><span class="p">),</span> <span class="mi">2</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="s1">&#39;int32&#39;</span><span class="p">)</span>

        <span class="n">cards_list</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">cards_dict</span> <span class="o">=</span> <span class="n">defaultdict</span><span class="p">(</span><span class="nb">list</span><span class="p">)</span>
        <span class="n">dict_cards</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;BAROR&#39;</span><span class="p">,</span> <span class="s1">&#39;BEAMOR&#39;</span><span class="p">]</span>
        <span class="c1">#cards = defaultdict(list)</span>
        <span class="n">card_count</span> <span class="o">=</span> <span class="n">defaultdict</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
        <span class="n">full_comment</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
        <span class="n">card_lines</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">old_ifile_iline</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="n">old_card_name</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="n">backup_comment</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
        <span class="n">nlines</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">bulk_data_lines</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">bulk_data_lines</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="n">bulk_data_ilines</span><span class="p">):</span>
            <span class="n">msg</span> <span class="o">=</span> <span class="s1">&#39;len(bulk_data_lines)=</span><span class="si">%s</span><span class="s1"> len(bulk_data_ilines)=</span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span>
                <span class="nb">len</span><span class="p">(</span><span class="n">bulk_data_lines</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">bulk_data_ilines</span><span class="p">))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">iline_bulk</span><span class="p">,</span> <span class="n">line</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">bulk_data_lines</span><span class="p">):</span>
            <span class="n">ifile_iline</span> <span class="o">=</span> <span class="n">bulk_data_ilines</span><span class="p">[</span><span class="n">iline_bulk</span><span class="p">,</span> <span class="p">:]</span>
            <span class="c1">#print(iline_bulk, ifile_iline, line)</span>
            <span class="c1">#print(&#39;    backup=%r&#39; % backup_comment)</span>
            <span class="n">comment</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
            <span class="k">if</span> <span class="s1">&#39;$&#39;</span> <span class="ow">in</span> <span class="n">line</span><span class="p">:</span>
                <span class="n">line</span><span class="p">,</span> <span class="n">comment</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;$&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
            <span class="n">card_name</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)[</span><span class="mi">0</span><span class="p">][:</span><span class="mi">8</span><span class="p">]</span><span class="o">.</span><span class="n">rstrip</span><span class="p">()</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span>
            <span class="k">if</span> <span class="n">card_name</span> <span class="ow">and</span> <span class="n">card_name</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;+&#39;</span><span class="p">,</span> <span class="s1">&#39;*&#39;</span><span class="p">]:</span>
                <span class="k">if</span> <span class="n">old_card_name</span><span class="p">:</span>
                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">echo</span> <span class="ow">and</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">force_echo_off</span><span class="p">:</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s1">&#39;Reading </span><span class="si">%s</span><span class="s1">:</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span>
                                      <span class="n">old_card_name</span> <span class="o">+</span> <span class="n">full_comment</span> <span class="o">+</span> <span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">card_lines</span><span class="p">))</span>

                    <span class="c1"># old dictionary version</span>
                    <span class="c1"># cards_list[old_card_name].append([full_comment, card_lines, ifile_iline])</span>

                    <span class="c1"># new list version</span>
                    <span class="c1">#if full_comment:</span>
                        <span class="c1">#print(&#39;full_comment = &#39;, full_comment)</span>
                    <span class="k">if</span> <span class="n">old_card_name</span> <span class="ow">in</span> <span class="n">dict_cards</span><span class="p">:</span>
                        <span class="n">cards_dict</span><span class="p">[</span><span class="n">old_card_name</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">_prep_comment</span><span class="p">(</span><span class="n">full_comment</span><span class="p">),</span>
                                                          <span class="n">card_lines</span><span class="p">,</span> <span class="n">ifile_iline</span><span class="p">])</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">cards_list</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">old_card_name</span><span class="p">,</span> <span class="n">_prep_comment</span><span class="p">(</span><span class="n">full_comment</span><span class="p">),</span>
                                           <span class="n">card_lines</span><span class="p">,</span> <span class="n">old_ifile_iline</span><span class="p">])</span>

                    <span class="n">card_count</span><span class="p">[</span><span class="n">old_card_name</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>
                    <span class="n">card_lines</span> <span class="o">=</span> <span class="p">[]</span>
                    <span class="n">full_comment</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>

                    <span class="k">if</span> <span class="n">old_card_name</span> <span class="o">==</span> <span class="s1">&#39;ECHOON&#39;</span><span class="p">:</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">echo</span> <span class="o">=</span> <span class="kc">True</span>
                    <span class="k">elif</span> <span class="n">old_card_name</span> <span class="o">==</span> <span class="s1">&#39;ECHOOFF&#39;</span><span class="p">:</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">echo</span> <span class="o">=</span> <span class="kc">False</span>
                <span class="n">old_ifile_iline</span> <span class="o">=</span> <span class="n">ifile_iline</span>
                <span class="n">old_card_name</span> <span class="o">=</span> <span class="n">card_name</span><span class="o">.</span><span class="n">rstrip</span><span class="p">(</span><span class="s1">&#39; *&#39;</span><span class="p">)</span>

                <span class="k">if</span> <span class="n">old_card_name</span> <span class="o">==</span> <span class="s1">&#39;ENDDATA&#39;</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">card_count</span><span class="p">[</span><span class="s1">&#39;ENDDATA&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
                    <span class="k">if</span> <span class="n">nlines</span> <span class="o">-</span> <span class="n">iline_bulk</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
                        <span class="n">nleftover</span> <span class="o">=</span> <span class="n">nlines</span> <span class="o">-</span> <span class="n">iline_bulk</span> <span class="o">-</span> <span class="mi">1</span>
                        <span class="n">msg</span> <span class="o">=</span> <span class="s1">&#39;exiting due to ENDDATA found with </span><span class="si">%i</span><span class="s1"> lines left&#39;</span> <span class="o">%</span> <span class="n">nleftover</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
                    <span class="k">return</span> <span class="n">cards_list</span><span class="p">,</span> <span class="n">cards_dict</span><span class="p">,</span> <span class="n">card_count</span>
                <span class="c1">#print(&quot;card_name = %s&quot; % card_name)</span>

            <span class="n">comment</span> <span class="o">=</span> <span class="n">_clean_comment</span><span class="p">(</span><span class="n">comment</span><span class="p">)</span>

            <span class="c1">#TODO: these additional \n need to be there for rejected cards</span>
            <span class="c1">#      but not parsed cards</span>
            <span class="k">if</span> <span class="n">line</span><span class="o">.</span><span class="n">rstrip</span><span class="p">():</span>
                <span class="n">card_lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">line</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">backup_comment</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">comment</span><span class="p">:</span>
                        <span class="n">full_comment</span> <span class="o">+=</span> <span class="n">backup_comment</span> <span class="o">+</span> <span class="n">comment</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">full_comment</span> <span class="o">+=</span> <span class="n">backup_comment</span>
                    <span class="n">backup_comment</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
                <span class="k">elif</span> <span class="n">comment</span><span class="p">:</span>
                    <span class="n">full_comment</span> <span class="o">+=</span> <span class="n">comment</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span>
                    <span class="n">backup_comment</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>

            <span class="k">elif</span> <span class="n">comment</span><span class="p">:</span>
                <span class="n">backup_comment</span> <span class="o">+=</span> <span class="n">comment</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span>
            <span class="c1">#elif comment:</span>
                <span class="c1">#backup_comment += &#39;$&#39; + comment + &#39;\n&#39;</span>


        <span class="k">if</span> <span class="n">card_lines</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">echo</span> <span class="ow">and</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">force_echo_off</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s1">&#39;Reading </span><span class="si">%s</span><span class="s1">:</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">old_card_name</span> <span class="o">+</span> <span class="n">full_comment</span> <span class="o">+</span> <span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">card_lines</span><span class="p">))</span>
            <span class="c1">#print(&#39;end_add %s&#39; % card_lines)</span>

            <span class="c1"># old dictionary version</span>
            <span class="c1">#cards[old_card_name].append([backup_comment + full_comment, card_lines])</span>

            <span class="c1"># new list version</span>
            <span class="c1">#if backup_comment + full_comment:</span>
                <span class="c1">#print(&#39;backup_comment + full_comment = &#39;, backup_comment + full_comment)</span>
            <span class="k">if</span> <span class="n">old_card_name</span> <span class="ow">in</span> <span class="n">dict_cards</span><span class="p">:</span>
                <span class="n">cards_dict</span><span class="p">[</span><span class="n">old_card_name</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">_prep_comment</span><span class="p">(</span>
                    <span class="n">backup_comment</span> <span class="o">+</span> <span class="n">full_comment</span><span class="p">),</span> <span class="n">card_lines</span><span class="p">,</span> <span class="n">ifile_iline</span><span class="p">])</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">cards_list</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">old_card_name</span><span class="p">,</span> <span class="n">_prep_comment</span><span class="p">(</span>
                    <span class="n">backup_comment</span> <span class="o">+</span> <span class="n">full_comment</span><span class="p">),</span> <span class="n">card_lines</span><span class="p">,</span> <span class="n">ifile_iline</span><span class="p">])</span>
            <span class="n">card_count</span><span class="p">[</span><span class="n">old_card_name</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">echo</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="k">return</span> <span class="n">cards_list</span><span class="p">,</span> <span class="n">cards_dict</span><span class="p">,</span> <span class="n">card_count</span>

    <span class="k">def</span> <span class="nf">get_bdf_cards_dict</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">bulk_data_lines</span><span class="p">,</span> <span class="n">bulk_data_ilines</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Parses the BDF lines into a list of card_lines&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">bulk_data_ilines</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">bulk_data_ilines</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="nb">len</span><span class="p">(</span><span class="n">bulk_data_lines</span><span class="p">),</span> <span class="mi">2</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="s1">&#39;int32&#39;</span><span class="p">)</span>

        <span class="n">cards_dict</span> <span class="o">=</span> <span class="n">defaultdict</span><span class="p">(</span><span class="nb">list</span><span class="p">)</span>
        <span class="n">card_count</span> <span class="o">=</span> <span class="n">defaultdict</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
        <span class="n">full_comment</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
        <span class="n">card_lines</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">old_card_name</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="n">backup_comment</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
        <span class="n">nlines</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">bulk_data_lines</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">iline_bulk</span><span class="p">,</span> <span class="n">line</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">bulk_data_lines</span><span class="p">):</span>
            <span class="n">ifile_iline</span> <span class="o">=</span> <span class="n">bulk_data_ilines</span><span class="p">[</span><span class="n">iline_bulk</span><span class="p">,</span> <span class="p">:]</span>
            <span class="c1">#print(&#39;    backup=%r&#39; % backup_comment)</span>
            <span class="n">comment</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
            <span class="k">if</span> <span class="s1">&#39;$&#39;</span> <span class="ow">in</span> <span class="n">line</span><span class="p">:</span>
                <span class="n">line</span><span class="p">,</span> <span class="n">comment</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;$&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
            <span class="n">card_name</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)[</span><span class="mi">0</span><span class="p">][:</span><span class="mi">8</span><span class="p">]</span><span class="o">.</span><span class="n">rstrip</span><span class="p">()</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span>
            <span class="k">if</span> <span class="n">card_name</span> <span class="ow">and</span> <span class="n">card_name</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;+&#39;</span><span class="p">,</span> <span class="s1">&#39;*&#39;</span><span class="p">]:</span>
                <span class="k">if</span> <span class="n">old_card_name</span><span class="p">:</span>
                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">echo</span> <span class="ow">and</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">force_echo_off</span><span class="p">:</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s1">&#39;Reading </span><span class="si">%s</span><span class="s1">:</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span>
                                      <span class="n">old_card_name</span> <span class="o">+</span> <span class="n">full_comment</span> <span class="o">+</span> <span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">card_lines</span><span class="p">))</span>

                    <span class="c1"># old dictionary version</span>
                    <span class="n">cards_dict</span><span class="p">[</span><span class="n">old_card_name</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">full_comment</span><span class="p">,</span> <span class="n">card_lines</span><span class="p">,</span> <span class="n">ifile_iline</span><span class="p">])</span>

                    <span class="c1"># new list version</span>
                    <span class="c1">#cards.append([old_card_name, full_comment, card_lines, ifile_iline])</span>

                    <span class="n">card_count</span><span class="p">[</span><span class="n">old_card_name</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>
                    <span class="n">card_lines</span> <span class="o">=</span> <span class="p">[]</span>
                    <span class="n">full_comment</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>

                    <span class="k">if</span> <span class="n">old_card_name</span> <span class="o">==</span> <span class="s1">&#39;ECHOON&#39;</span><span class="p">:</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">echo</span> <span class="o">=</span> <span class="kc">True</span>
                    <span class="k">elif</span> <span class="n">old_card_name</span> <span class="o">==</span> <span class="s1">&#39;ECHOOFF&#39;</span><span class="p">:</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">echo</span> <span class="o">=</span> <span class="kc">False</span>
                <span class="n">old_card_name</span> <span class="o">=</span> <span class="n">card_name</span><span class="o">.</span><span class="n">rstrip</span><span class="p">(</span><span class="s1">&#39; *&#39;</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">old_card_name</span> <span class="o">==</span> <span class="s1">&#39;ENDDATA&#39;</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">card_count</span><span class="p">[</span><span class="s1">&#39;ENDDATA&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
                    <span class="k">if</span> <span class="n">nlines</span> <span class="o">-</span> <span class="n">iline_bulk</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
                        <span class="n">nleftover</span> <span class="o">=</span> <span class="n">nlines</span> <span class="o">-</span> <span class="n">iline_bulk</span> <span class="o">-</span> <span class="mi">1</span>
                        <span class="n">msg</span> <span class="o">=</span> <span class="s1">&#39;exiting due to ENDDATA found with </span><span class="si">%i</span><span class="s1"> lines left&#39;</span> <span class="o">%</span> <span class="n">nleftover</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
                    <span class="k">return</span> <span class="n">cards_dict</span><span class="p">,</span> <span class="n">card_count</span>
                <span class="c1">#print(&quot;card_name = %s&quot; % card_name)</span>

            <span class="n">comment</span> <span class="o">=</span> <span class="n">_clean_comment_bulk</span><span class="p">(</span><span class="n">comment</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">line</span><span class="o">.</span><span class="n">rstrip</span><span class="p">():</span>
                <span class="n">card_lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">line</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">backup_comment</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">comment</span><span class="p">:</span>
                        <span class="n">full_comment</span> <span class="o">+=</span> <span class="n">backup_comment</span> <span class="o">+</span> <span class="n">comment</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">full_comment</span> <span class="o">+=</span> <span class="n">backup_comment</span>
                    <span class="n">backup_comment</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
                <span class="k">elif</span> <span class="n">comment</span><span class="p">:</span>
                    <span class="n">full_comment</span> <span class="o">+=</span> <span class="n">comment</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span>
                    <span class="n">backup_comment</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>

            <span class="k">elif</span> <span class="n">comment</span><span class="p">:</span>
                <span class="n">backup_comment</span> <span class="o">+=</span> <span class="n">comment</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span>
                <span class="c1">#print(&#39;add backup=%r&#39; % backup_comment)</span>
            <span class="c1">#elif comment:</span>
                <span class="c1">#backup_comment += comment + &#39;\n&#39;</span>

        <span class="k">if</span> <span class="n">card_lines</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">echo</span> <span class="ow">and</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">force_echo_off</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s1">&#39;Reading </span><span class="si">%s</span><span class="s1">:</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">old_card_name</span> <span class="o">+</span> <span class="n">full_comment</span> <span class="o">+</span> <span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">card_lines</span><span class="p">))</span>
            <span class="c1">#print(&#39;end_add %s&#39; % card_lines)</span>

            <span class="c1"># old dictionary version</span>
            <span class="n">cards_dict</span><span class="p">[</span><span class="n">old_card_name</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                <span class="p">[</span><span class="n">backup_comment</span> <span class="o">+</span> <span class="n">full_comment</span><span class="p">,</span> <span class="n">card_lines</span><span class="p">,</span> <span class="n">ifile_iline</span><span class="p">])</span>

            <span class="c1"># new list version</span>
            <span class="c1">#cards.append([old_card_name, backup_comment + full_comment, card_lines])</span>
            <span class="n">card_count</span><span class="p">[</span><span class="n">old_card_name</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="k">return</span> <span class="n">cards_dict</span><span class="p">,</span> <span class="n">card_count</span>

    <span class="k">def</span> <span class="nf">update_solution</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">sol</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
                        <span class="n">method</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span>
                        <span class="n">sol_iline</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Updates the overall solution type (e.g. 101,200,600)</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        sol : int</span>
<span class="sd">            the solution type (101, 103, etc)</span>
<span class="sd">        method : str</span>
<span class="sd">            the solution method (only for SOL=600)</span>
<span class="sd">        sol_iline : int</span>
<span class="sd">            the line to put the SOL/method on</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sol_iline</span> <span class="o">=</span> <span class="n">sol_iline</span>
        <span class="c1"># the integer of the solution type (e.g. SOL 101)</span>
        <span class="k">if</span> <span class="n">sol</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">sol</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">sol_method</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="k">return</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">sol</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">sol</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">sol</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_solmap_to_value</span><span class="p">[</span><span class="n">sol</span><span class="p">]</span>
            <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">sol</span> <span class="o">=</span> <span class="n">sol</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">sol</span> <span class="o">==</span> <span class="mi">600</span><span class="p">:</span>
            <span class="c1">#: solution 600 method modifier</span>
            <span class="k">if</span> <span class="n">method</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">method</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">sol_method</span> <span class="o">=</span> <span class="n">method</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;sol=</span><span class="si">%s</span><span class="s2"> method=</span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sol</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">sol_method</span><span class="p">))</span>
        <span class="k">else</span><span class="p">:</span>  <span class="c1"># very common</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">sol_method</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="k">def</span> <span class="nf">update_card</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">card_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">icard</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">ifield</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
                    <span class="n">value</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="nb">str</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Updates a Nastran card based on standard Nastran optimization names</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        card_name : str</span>
<span class="sd">            the name of the card</span>
<span class="sd">            (e.g. GRID)</span>
<span class="sd">        icard : int</span>
<span class="sd">            the unique 1-based index identifier for the card</span>
<span class="sd">            (e.g. the GRID id)</span>
<span class="sd">        ifield : int</span>
<span class="sd">            the index on the card</span>
<span class="sd">            (e.g. X on GRID card as an integer representing the field number)</span>
<span class="sd">        value : varies</span>
<span class="sd">            the value to assign</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        obj : varies</span>
<span class="sd">            the corresponding object</span>
<span class="sd">            (e.g. the GRID object)</span>

<span class="sd">        # On GRID 100, set Cp (2) to 42</span>
<span class="sd">        &gt;&gt;&gt; model.update_card(&#39;GRID&#39;, 100, 2, 42)</span>

<span class="sd">        # On GRID 100, set X (3) to 43.</span>
<span class="sd">        &gt;&gt;&gt; model.update_card(&#39;GRID&#39;, 100, 3, 43.)</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1">#rslot_map = self.get_rslot_map(reset_type_to_slot_map=False)</span>

        <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">card_count</span><span class="p">:</span>
            <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="nb">str</span><span class="p">),</span> <span class="s1">&#39;key=</span><span class="si">%r</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">key</span>
            <span class="k">if</span> <span class="n">key</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_type_to_slot_map</span><span class="p">:</span>
                <span class="n">msg</span> <span class="o">=</span> <span class="s1">&#39;add </span><span class="si">%r</span><span class="s1"> to self._type_to_slot_map</span><span class="se">\n</span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_type_to_slot_map</span><span class="p">))</span>
                <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
        <span class="c1">#_slot_to_type_map[&#39;nodes&#39;] : [&#39;GRID&#39;]</span>
        <span class="c1">#_type_to_slot_map[&#39;GRID&#39;] : [&#39;nodes&#39;]</span>

        <span class="c1"># get the storage object</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">field_str</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_type_to_slot_map</span><span class="p">[</span><span class="n">card_name</span><span class="p">]</span> <span class="c1"># &#39;nodes&#39;</span>
        <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
            <span class="n">msg</span> <span class="o">=</span> <span class="s1">&#39;Updating card card_name=</span><span class="si">%r</span><span class="s1"> is not supported</span><span class="se">\n</span><span class="s1">keys=</span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span>
                <span class="n">card_name</span><span class="p">,</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_type_to_slot_map</span><span class="o">.</span><span class="n">keys</span><span class="p">()))</span>
            <span class="k">raise</span> <span class="ne">KeyError</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>

        <span class="n">objs</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">field_str</span><span class="p">)</span> <span class="c1"># self.nodes</span>
        <span class="c1"># get the specific card</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">obj</span> <span class="o">=</span> <span class="n">objs</span><span class="p">[</span><span class="n">icard</span><span class="p">]</span>
        <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
            <span class="n">msg</span> <span class="o">=</span> <span class="s1">&#39;Could not find </span><span class="si">%s</span><span class="s1"> ID=</span><span class="si">%r</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">card_name</span><span class="p">,</span> <span class="n">icard</span><span class="p">)</span>
            <span class="k">raise</span> <span class="ne">KeyError</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>

        <span class="c1"># update the card</span>
        <span class="n">obj</span><span class="o">.</span><span class="n">update_field</span><span class="p">(</span><span class="n">ifield</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">obj</span>

    <span class="k">def</span> <span class="nf">set_dynamic_syntax</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dict_of_vars</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Union</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="nb">str</span><span class="p">]])</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Uses the OpenMDAO syntax of %varName in an embedded BDF to</span>
<span class="sd">        update the values for an optimization study.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        dict_of_vars : dict[str] = int/float/str</span>
<span class="sd">            dictionary of 7 character variable names to map.</span>

<span class="sd">        .. code-block:: python</span>

<span class="sd">           GRID, 1, %xVar, %yVar, %zVar</span>

<span class="sd">           &gt;&gt;&gt; dict_of_vars = {&#39;xVar&#39;: 1.0, &#39;yVar&#39;, 2.0, &#39;zVar&#39;:3.0}</span>
<span class="sd">           &gt;&gt;&gt; bdf = BDF()</span>
<span class="sd">           &gt;&gt;&gt; bdf.set_dynamic_syntax(dict_of_vars)</span>
<span class="sd">           &gt;&gt;&gt; bdf.read_bdf(bdf_filename, xref=True)</span>

<span class="sd">        Notes</span>
<span class="sd">        -----</span>
<span class="sd">        Case sensitivity is supported.</span>
<span class="sd">        Variables should be 7 characters or less to fit in an</span>
<span class="sd">        8-character field.</span>

<span class="sd">        .. warning:: Type matters!</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dict_of_vars</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">dict_of_vars</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;nvars = </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="nb">len</span><span class="p">(</span><span class="n">dict_of_vars</span><span class="p">)</span>
        <span class="k">for</span> <span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">dict_of_vars</span><span class="o">.</span><span class="n">items</span><span class="p">()):</span>
            <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">key</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="mi">7</span><span class="p">,</span> <span class="p">(</span><span class="s1">&#39;max length for key is 7; &#39;</span>
                                   <span class="s1">&#39;len(</span><span class="si">%s</span><span class="s1">)=</span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">key</span><span class="p">)))</span>
            <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">key</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="mi">1</span><span class="p">,</span> <span class="p">(</span><span class="s1">&#39;min length for key is 1; &#39;</span>
                                   <span class="s1">&#39;len(</span><span class="si">%s</span><span class="s1">)=</span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">key</span><span class="p">)))</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
                <span class="n">msg</span> <span class="o">=</span> <span class="s1">&#39;key=</span><span class="si">%r</span><span class="s1"> must be a string.  type=</span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="nb">type</span><span class="p">(</span><span class="n">key</span><span class="p">))</span>
                <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">dict_of_vars</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_is_dynamic_syntax</span> <span class="o">=</span> <span class="kc">True</span>

    <span class="k">def</span> <span class="nf">is_reject</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">card_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Can the card be read.</span>

<span class="sd">        If the card is rejected, it&#39;s added to self.reject_count</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        card_name : str</span>
<span class="sd">            the card_name -&gt; &#39;GRID&#39;</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">assert</span> <span class="s1">&#39;=&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">card_name</span><span class="p">,</span> <span class="n">card_name</span>
        <span class="k">if</span> <span class="n">card_name</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;=&#39;</span><span class="p">):</span>
            <span class="k">return</span> <span class="kc">False</span>
        <span class="k">elif</span> <span class="n">card_name</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">cards_to_read</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">False</span>
        <span class="k">if</span> <span class="n">card_name</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">card_name</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">reject_count</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">reject_count</span><span class="p">[</span><span class="n">card_name</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">reject_count</span><span class="p">[</span><span class="n">card_name</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="k">return</span> <span class="kc">True</span>

    <span class="k">def</span> <span class="nf">_process_card</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">card_lines</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Converts card_lines into a card.</span>
<span class="sd">        Considers dynamic syntax and removes empty fields</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        card_lines : List[str]</span>
<span class="sd">            list of strings that represent the card&#39;s lines</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        fields : list[str]</span>
<span class="sd">            the parsed card&#39;s fields</span>
<span class="sd">        card_name : str</span>
<span class="sd">            the card&#39;s name</span>

<span class="sd">        .. code-block:: python</span>

<span class="sd">            &gt;&gt;&gt; card_lines = [&#39;GRID,1,,1.0,2.0,3.0,,&#39;]</span>
<span class="sd">            &gt;&gt;&gt; model = BDF()</span>
<span class="sd">            &gt;&gt;&gt; fields, card_name = model._process_card(card_lines)</span>
<span class="sd">            &gt;&gt;&gt; fields</span>
<span class="sd">            [&#39;GRID&#39;, &#39;1&#39;, &#39;&#39;, &#39;1.0&#39;, &#39;2.0&#39;, &#39;3.0&#39;]</span>
<span class="sd">            &gt;&gt;&gt; card_name</span>
<span class="sd">            &#39;GRID&#39;</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">card_name</span> <span class="o">=</span> <span class="n">_get_card_name</span><span class="p">(</span><span class="n">card_lines</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">active_filename</span><span class="p">)</span>
        <span class="n">fields</span> <span class="o">=</span> <span class="n">to_fields</span><span class="p">(</span><span class="n">card_lines</span><span class="p">,</span> <span class="n">card_name</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_is_dynamic_syntax</span><span class="p">:</span>
            <span class="n">fields</span> <span class="o">=</span> <span class="p">[</span>
                <span class="n">print_field_16</span><span class="p">(</span><span class="n">_parse_dynamic_syntax</span><span class="p">(</span><span class="n">field</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">dict_of_vars</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="p">))</span>
                <span class="k">if</span> <span class="s1">&#39;%&#39;</span> <span class="ow">in</span> <span class="n">field</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">1</span><span class="p">]</span> <span class="k">else</span> <span class="n">field</span>
                <span class="k">for</span> <span class="n">field</span> <span class="ow">in</span> <span class="n">fields</span><span class="p">]</span>
        <span class="n">card</span> <span class="o">=</span> <span class="n">wipe_empty_fields</span><span class="p">(</span><span class="n">fields</span><span class="p">)</span>
        <span class="n">card</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">card_name</span>
        <span class="k">return</span> <span class="n">card</span>

    <span class="k">def</span> <span class="nf">create_card_object</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">card_lines</span><span class="p">,</span> <span class="n">card_name</span><span class="p">,</span> <span class="n">is_list</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">has_none</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Creates a BDFCard object, which is really just a list that</span>
<span class="sd">        allows indexing past the last field</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        card_lines: list[str]</span>
<span class="sd">            the list of the card fields</span>
<span class="sd">            input is list of card_lines -&gt; [&#39;GRID, 1, 2, 3.0, 4.0, 5.0&#39;]</span>
<span class="sd">        card_name : str</span>
<span class="sd">            the card_name -&gt; &#39;GRID&#39;</span>
<span class="sd">        is_list : bool; default=True</span>
<span class="sd">            True : this is a list of fields</span>
<span class="sd">            False : this is a list of lines</span>
<span class="sd">        has_none : bool; default=True</span>
<span class="sd">            can there be trailing Nones in the card data (e.g. [&#39;GRID, 1, 2, 3.0, 4.0, 5.0, &#39;])</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        card_object : BDFCard()</span>
<span class="sd">            the card object representation of card</span>
<span class="sd">        card : list[str]</span>
<span class="sd">            the card with empty fields removed</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">card_name</span> <span class="o">=</span> <span class="n">card_name</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">increase_card_count</span><span class="p">(</span><span class="n">card_name</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">card_name</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;DEQATN&#39;</span><span class="p">,</span> <span class="s1">&#39;PBRSECT&#39;</span><span class="p">,</span> <span class="s1">&#39;PBMSECT&#39;</span><span class="p">,</span> <span class="s1">&#39;GMCURV&#39;</span><span class="p">,</span> <span class="s1">&#39;GMSURF&#39;</span><span class="p">,</span> <span class="s1">&#39;OUTPUT&#39;</span><span class="p">,</span> <span class="s1">&#39;ADAPT&#39;</span><span class="p">]:</span>
            <span class="n">card_obj</span> <span class="o">=</span> <span class="n">card_lines</span>
            <span class="n">card</span> <span class="o">=</span> <span class="n">card_lines</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">is_list</span><span class="p">:</span>
                <span class="n">fields</span> <span class="o">=</span> <span class="n">card_lines</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">fields</span> <span class="o">=</span> <span class="n">to_fields</span><span class="p">(</span><span class="n">card_lines</span><span class="p">,</span> <span class="n">card_name</span><span class="p">)</span>

            <span class="c1"># apply OPENMDAO syntax</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_is_dynamic_syntax</span><span class="p">:</span>
                <span class="n">fields</span> <span class="o">=</span> <span class="p">[</span>
                    <span class="n">print_field_16</span><span class="p">(</span><span class="n">_parse_dynamic_syntax</span><span class="p">(</span><span class="n">field</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">dict_of_vars</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="p">))</span>
                    <span class="k">if</span> <span class="s1">&#39;%&#39;</span> <span class="ow">in</span> <span class="n">field</span><span class="o">.</span><span class="n">strip</span><span class="p">()[</span><span class="mi">0</span><span class="p">:</span><span class="mi">1</span><span class="p">]</span> <span class="k">else</span> <span class="n">print_field_16</span><span class="p">(</span><span class="n">field</span><span class="p">)</span>
                    <span class="k">for</span> <span class="n">field</span> <span class="ow">in</span> <span class="n">fields</span><span class="p">]</span>
                <span class="n">has_none</span> <span class="o">=</span> <span class="kc">False</span>

            <span class="k">if</span> <span class="n">has_none</span><span class="p">:</span>
                <span class="n">card</span> <span class="o">=</span> <span class="n">wipe_empty_fields</span><span class="p">([</span><span class="n">print_field_16</span><span class="p">(</span><span class="n">field</span><span class="p">)</span> <span class="k">for</span> <span class="n">field</span> <span class="ow">in</span> <span class="n">fields</span><span class="p">])</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="c1">#card = remove_trailing_fields(fields)</span>
                <span class="n">card</span> <span class="o">=</span> <span class="n">wipe_empty_fields</span><span class="p">(</span><span class="n">fields</span><span class="p">)</span>
            <span class="n">card_obj</span> <span class="o">=</span> <span class="n">BDFCard</span><span class="p">(</span><span class="n">card</span><span class="p">,</span> <span class="n">has_none</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">card_obj</span><span class="p">,</span> <span class="n">card</span>

    <span class="k">def</span> <span class="nf">_parse_dynamic_syntax</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]:</span>
        <span class="k">return</span> <span class="n">_parse_dynamic_syntax</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">dict_of_vars</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_make_card_parser</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;creates the card parser variables that are used by add_card&quot;&quot;&quot;</span>
        <span class="k">class</span> <span class="nc">Crash</span><span class="p">:</span>
            <span class="sd">&quot;&quot;&quot;class for crashing on specific cards&quot;&quot;&quot;</span>
            <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
                <span class="sd">&quot;&quot;&quot;dummy init&quot;&quot;&quot;</span>
                <span class="k">pass</span>
            <span class="nd">@classmethod</span>
            <span class="k">def</span> <span class="nf">add_card</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">card</span><span class="p">,</span> <span class="n">comment</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">):</span>
                <span class="sd">&quot;&quot;&quot;the method that forces the crash&quot;&quot;&quot;</span>
                <span class="c1">#raise CardParseSyntaxError(card)</span>
                <span class="n">msg</span> <span class="o">=</span> <span class="n">_format_comment</span><span class="p">(</span><span class="n">comment</span><span class="p">)</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">card</span><span class="p">)</span>
                <span class="k">raise</span> <span class="n">UnsupportedCard</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>

        <span class="c1">#class CrashIgnore:</span>
            <span class="c1">#&quot;&quot;&quot;class for crashing on specific cards&quot;&quot;&quot;</span>
            <span class="c1">#def __init__(self):</span>
                <span class="c1">#&quot;&quot;&quot;dummy init&quot;&quot;&quot;</span>
                <span class="c1">#pass</span>
            <span class="c1">#@classmethod</span>
            <span class="c1">#def add_card(cls, card, comment=&#39;&#39;):</span>
                <span class="c1">#&quot;&quot;&quot;the method that forces the crash&quot;&quot;&quot;</span>
                <span class="c1">##raise CardParseSyntaxError(card)</span>
                <span class="c1">#msg = _format_comment(comment) + str(card)</span>
                <span class="c1">#raise DisabledCardError(msg)</span>

        <span class="c1">#: a storage of card_name to (card_class, add_method)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_card_parser</span> <span class="o">=</span> <span class="p">{</span>
            <span class="c1">#&#39;=&#39; : (Crash, None),</span>
            <span class="s1">&#39;/&#39;</span> <span class="p">:</span> <span class="p">(</span><span class="n">Crash</span><span class="p">,</span> <span class="kc">None</span><span class="p">),</span>

            <span class="c1">#&#39;CGEN&#39; : (CrashIgnore, None),</span>

            <span class="s1">&#39;SETREE&#39;</span> <span class="p">:</span> <span class="p">(</span><span class="n">SETREE</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_add_setree_object</span><span class="p">),</span>
            <span class="s1">&#39;SENQSET&#39;</span> <span class="p">:</span> <span class="p">(</span><span class="n">SENQSET</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_add_senqset_object</span><span class="p">),</span>
            <span class="s1">&#39;SEBULK&#39;</span> <span class="p">:</span> <span class="p">(</span><span class="n">SEBULK</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_add_sebulk_object</span><span class="p">),</span>
            <span class="s1">&#39;RELEASE&#39;</span><span class="p">:</span> <span class="p">(</span><span class="n">RELEASE</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_add_release_object</span><span class="p">),</span>
            <span class="s1">&#39;SEBNDRY&#39;</span> <span class="p">:</span> <span class="p">(</span><span class="n">SEBNDRY</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_add_sebndry_object</span><span class="p">),</span>
            <span class="s1">&#39;SEELT&#39;</span> <span class="p">:</span> <span class="p">(</span><span class="n">SEELT</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_add_seelt_object</span><span class="p">),</span>
            <span class="s1">&#39;SELOC&#39;</span> <span class="p">:</span> <span class="p">(</span><span class="n">SELOC</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_add_seloc_object</span><span class="p">),</span>
            <span class="s1">&#39;SEMPLN&#39;</span> <span class="p">:</span> <span class="p">(</span><span class="n">SEMPLN</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_add_sempln_object</span><span class="p">),</span>
            <span class="s1">&#39;SECONCT&#39;</span> <span class="p">:</span> <span class="p">(</span><span class="n">SECONCT</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_add_seconct_object</span><span class="p">),</span>
            <span class="s1">&#39;SELABEL&#39;</span> <span class="p">:</span> <span class="p">(</span><span class="n">SELABEL</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_add_selabel_object</span><span class="p">),</span>
            <span class="s1">&#39;SEEXCLD&#39;</span> <span class="p">:</span> <span class="p">(</span><span class="n">SEEXCLD</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_add_seexcld_object</span><span class="p">),</span>
            <span class="s1">&#39;CSUPER&#39;</span> <span class="p">:</span> <span class="p">(</span><span class="n">CSUPER</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_add_csuper_object</span><span class="p">),</span>
            <span class="s1">&#39;CSUPEXT&#39;</span> <span class="p">:</span> <span class="p">(</span><span class="n">CSUPEXT</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_add_csupext_object</span><span class="p">),</span>
            <span class="s1">&#39;SELOAD&#39;</span> <span class="p">:</span> <span class="p">(</span><span class="n">SELOAD</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_add_seload_object</span><span class="p">),</span>

            <span class="s1">&#39;CHACAB&#39;</span><span class="p">:</span> <span class="p">(</span><span class="n">CHACAB</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_add_element_object</span><span class="p">),</span>
            <span class="s1">&#39;CHACBR&#39;</span><span class="p">:</span> <span class="p">(</span><span class="n">CHACBR</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_add_element_object</span><span class="p">),</span>
            <span class="s1">&#39;CAABSF&#39;</span><span class="p">:</span> <span class="p">(</span><span class="n">CAABSF</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_add_element_object</span><span class="p">),</span>
            <span class="s1">&#39;PACABS&#39;</span><span class="p">:</span> <span class="p">(</span><span class="n">PACABS</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_add_acoustic_property_object</span><span class="p">),</span>
            <span class="s1">&#39;PAABSF&#39;</span><span class="p">:</span> <span class="p">(</span><span class="n">PAABSF</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_add_acoustic_property_object</span><span class="p">),</span>
            <span class="s1">&#39;PACBAR&#39;</span><span class="p">:</span> <span class="p">(</span><span class="n">PACBAR</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_add_acoustic_property_object</span><span class="p">),</span>
            <span class="c1">#&#39;PANEL&#39; : (Crash, None),</span>

            <span class="s1">&#39;BCONP&#39;</span> <span class="p">:</span> <span class="p">(</span><span class="n">BCONP</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_add_bconp_object</span><span class="p">),</span>
            <span class="s1">&#39;BLSEG&#39;</span> <span class="p">:</span> <span class="p">(</span><span class="n">BLSEG</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_add_blseg_object</span><span class="p">),</span>
            <span class="s1">&#39;BFRIC&#39;</span> <span class="p">:</span> <span class="p">(</span><span class="n">BFRIC</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_add_bfric_object</span><span class="p">),</span>
            <span class="s1">&#39;MODTRAK&#39;</span> <span class="p">:</span> <span class="p">(</span><span class="n">MODTRAK</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_add_modtrak_object</span><span class="p">),</span>

            <span class="c1">#&#39;BGADD&#39;, &#39;BGSET&#39;, &#39;BOLT&#39;, &#39;BOLTFOR&#39;</span>
            <span class="s1">&#39;BGADD&#39;</span> <span class="p">:</span> <span class="p">(</span><span class="n">Crash</span><span class="p">,</span> <span class="kc">None</span><span class="p">),</span>
            <span class="s1">&#39;BGSET&#39;</span> <span class="p">:</span> <span class="p">(</span><span class="n">Crash</span><span class="p">,</span> <span class="kc">None</span><span class="p">),</span>
            <span class="s1">&#39;BOLT&#39;</span> <span class="p">:</span> <span class="p">(</span><span class="n">Crash</span><span class="p">,</span> <span class="kc">None</span><span class="p">),</span>
            <span class="s1">&#39;BOLTFOR&#39;</span> <span class="p">:</span> <span class="p">(</span><span class="n">Crash</span><span class="p">,</span> <span class="kc">None</span><span class="p">),</span>

            <span class="c1">#&#39;CBEAR&#39;, &#39;PBEAR&#39;, &#39;ROTORB&#39;,</span>
            <span class="s1">&#39;CBEAR&#39;</span> <span class="p">:</span> <span class="p">(</span><span class="n">Crash</span><span class="p">,</span> <span class="kc">None</span><span class="p">),</span>
            <span class="s1">&#39;PBEAR&#39;</span> <span class="p">:</span> <span class="p">(</span><span class="n">Crash</span><span class="p">,</span> <span class="kc">None</span><span class="p">),</span>
            <span class="s1">&#39;ROTORB&#39;</span> <span class="p">:</span> <span class="p">(</span><span class="n">Crash</span><span class="p">,</span> <span class="kc">None</span><span class="p">),</span>

            <span class="c1">#&#39;SWLDPRM&#39; : (Crash, None),</span>

            <span class="c1">#&#39;CWELD&#39; : (Crash, None),</span>
            <span class="c1">#&#39;PWELD&#39; : (Crash, None),</span>
            <span class="c1">#&#39;PWSEAM&#39; : (Crash, None),</span>
            <span class="c1">#&#39;CWSEAM&#39; : (Crash, None),</span>
            <span class="c1">#&#39;CSEAM&#39; : (Crash, None),</span>
            <span class="c1">#&#39;PSEAM&#39; : (Crash, None),</span>

            <span class="c1">#&#39;DVSHAP&#39; : (Crash, None),</span>
            <span class="c1">#&#39;BNDGRID&#39; : (Crash, None),</span>

            <span class="c1">#&#39;CYSYM&#39; : (Crash, None),</span>
            <span class="c1">#&#39;TEMPP1&#39; : (Crash, None),</span>
            <span class="c1">#&#39;DSCONS&#39; : (Crash, None),</span>
            <span class="c1">#&#39;DVAR&#39; : (Crash, None),</span>
            <span class="c1">#&#39;DVSET&#39; : (Crash, None),</span>
            <span class="c1">#&#39;DYNRED&#39; : (Crash, None),</span>
            <span class="c1">#&#39;BNDFIX&#39; : (Crash, None),</span>
            <span class="c1">#&#39;BNDFIX1&#39; : (Crash, None),</span>

            <span class="c1">#&#39;AEFORCE&#39; : (Crash, None),</span>
            <span class="c1">#&#39;UXVEC&#39; : (Crash, None),</span>
            <span class="s1">&#39;GUST2&#39;</span> <span class="p">:</span> <span class="p">(</span><span class="n">Crash</span><span class="p">,</span> <span class="kc">None</span><span class="p">),</span>

            <span class="c1">#&#39;RADBND&#39; : (Crash, None),</span>


            <span class="c1"># nodes</span>
            <span class="s1">&#39;GRID&#39;</span> <span class="p">:</span> <span class="p">(</span><span class="n">GRID</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_add_node_object</span><span class="p">),</span>
            <span class="s1">&#39;SPOINT&#39;</span> <span class="p">:</span> <span class="p">(</span><span class="n">SPOINTs</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_add_spoint_object</span><span class="p">),</span>
            <span class="s1">&#39;EPOINT&#39;</span> <span class="p">:</span> <span class="p">(</span><span class="n">EPOINTs</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_add_epoint_object</span><span class="p">),</span>
            <span class="s1">&#39;RINGAX&#39;</span> <span class="p">:</span> <span class="p">(</span><span class="n">RINGAX</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_add_ringax_object</span><span class="p">),</span>
            <span class="s1">&#39;POINTAX&#39;</span> <span class="p">:</span> <span class="p">(</span><span class="n">POINTAX</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_add_ringax_object</span><span class="p">),</span>
            <span class="s1">&#39;POINT&#39;</span> <span class="p">:</span> <span class="p">(</span><span class="n">POINT</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_add_point_object</span><span class="p">),</span>
            <span class="s1">&#39;SEQGP&#39;</span> <span class="p">:</span> <span class="p">(</span><span class="n">SEQGP</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_add_seqgp_object</span><span class="p">),</span>
            <span class="s1">&#39;GRIDB&#39;</span> <span class="p">:</span> <span class="p">(</span><span class="n">GRIDB</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_add_gridb_object</span><span class="p">),</span>

            <span class="s1">&#39;PARAM&#39;</span> <span class="p">:</span> <span class="p">(</span><span class="n">PARAM</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_add_param_object</span><span class="p">),</span>

            <span class="s1">&#39;CORD2R&#39;</span> <span class="p">:</span> <span class="p">(</span><span class="n">CORD2R</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_add_coord_object</span><span class="p">),</span>
            <span class="s1">&#39;CORD2C&#39;</span> <span class="p">:</span> <span class="p">(</span><span class="n">CORD2C</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_add_coord_object</span><span class="p">),</span>
            <span class="s1">&#39;CORD2S&#39;</span> <span class="p">:</span> <span class="p">(</span><span class="n">CORD2S</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_add_coord_object</span><span class="p">),</span>

            <span class="c1"># parametric</span>
            <span class="s1">&#39;PSET&#39;</span> <span class="p">:</span> <span class="p">(</span><span class="n">PSET</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_add_pset</span><span class="p">),</span>
            <span class="s1">&#39;PVAL&#39;</span> <span class="p">:</span> <span class="p">(</span><span class="n">PVAL</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_add_pval</span><span class="p">),</span>
            <span class="s1">&#39;GMCURV&#39;</span> <span class="p">:</span> <span class="p">(</span><span class="n">GMCURV</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_add_gmcurv</span><span class="p">),</span>
            <span class="s1">&#39;GMSURF&#39;</span> <span class="p">:</span> <span class="p">(</span><span class="n">GMSURF</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_add_gmsurf</span><span class="p">),</span>
            <span class="s1">&#39;FEFACE&#39;</span> <span class="p">:</span> <span class="p">(</span><span class="n">FEFACE</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_add_feface</span><span class="p">),</span>
            <span class="s1">&#39;FEEDGE&#39;</span> <span class="p">:</span> <span class="p">(</span><span class="n">FEEDGE</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_add_feedge</span><span class="p">),</span>

            <span class="c1"># msgmesh</span>
            <span class="s1">&#39;GMCORD&#39;</span> <span class="p">:</span> <span class="p">(</span><span class="n">GMCORD</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_add_coord_object</span><span class="p">),</span>
            <span class="s1">&#39;CGEN&#39;</span> <span class="p">:</span> <span class="p">(</span><span class="n">CGEN</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_add_element_object</span><span class="p">),</span>

            <span class="s1">&#39;CONROD&#39;</span> <span class="p">:</span> <span class="p">(</span><span class="n">CONROD</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_add_element_object</span><span class="p">),</span>
            <span class="s1">&#39;CROD&#39;</span> <span class="p">:</span> <span class="p">(</span><span class="n">CROD</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_add_element_object</span><span class="p">),</span>
            <span class="s1">&#39;PROD&#39;</span> <span class="p">:</span> <span class="p">(</span><span class="n">PROD</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_add_property_object</span><span class="p">),</span>
            <span class="s1">&#39;CTUBE&#39;</span> <span class="p">:</span> <span class="p">(</span><span class="n">CTUBE</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_add_element_object</span><span class="p">),</span>
            <span class="s1">&#39;PTUBE&#39;</span> <span class="p">:</span> <span class="p">(</span><span class="n">PTUBE</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_add_property_object</span><span class="p">),</span>

            <span class="s1">&#39;BAROR&#39;</span> <span class="p">:</span> <span class="p">(</span><span class="n">BAROR</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_add_baror_object</span><span class="p">),</span>
            <span class="s1">&#39;CBARAO&#39;</span> <span class="p">:</span> <span class="p">(</span><span class="n">CBARAO</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_add_ao_object</span><span class="p">),</span>
            <span class="s1">&#39;PBAR&#39;</span> <span class="p">:</span> <span class="p">(</span><span class="n">PBAR</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_add_property_object</span><span class="p">),</span>
            <span class="s1">&#39;PBARL&#39;</span> <span class="p">:</span> <span class="p">(</span><span class="n">PBARL</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_add_property_object</span><span class="p">),</span>
            <span class="s1">&#39;PBRSECT&#39;</span> <span class="p">:</span> <span class="p">(</span><span class="n">PBRSECT</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_add_property_object</span><span class="p">),</span>

            <span class="s1">&#39;BEAMOR&#39;</span> <span class="p">:</span> <span class="p">(</span><span class="n">BEAMOR</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_add_beamor_object</span><span class="p">),</span>
            <span class="s1">&#39;PBEAM&#39;</span> <span class="p">:</span> <span class="p">(</span><span class="n">PBEAM</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_add_property_object</span><span class="p">),</span>
            <span class="s1">&#39;PBEAML&#39;</span> <span class="p">:</span> <span class="p">(</span><span class="n">PBEAML</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_add_property_object</span><span class="p">),</span>
            <span class="s1">&#39;PBCOMP&#39;</span> <span class="p">:</span> <span class="p">(</span><span class="n">PBCOMP</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_add_property_object</span><span class="p">),</span>
            <span class="s1">&#39;PBMSECT&#39;</span> <span class="p">:</span> <span class="p">(</span><span class="n">PBMSECT</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_add_property_object</span><span class="p">),</span>

            <span class="s1">&#39;CBEAM3&#39;</span> <span class="p">:</span> <span class="p">(</span><span class="n">CBEAM3</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_add_element_object</span><span class="p">),</span>
            <span class="s1">&#39;PBEAM3&#39;</span> <span class="p">:</span> <span class="p">(</span><span class="n">PBEAM3</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_add_property_object</span><span class="p">),</span>

            <span class="s1">&#39;CBEND&#39;</span> <span class="p">:</span> <span class="p">(</span><span class="n">CBEND</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_add_element_object</span><span class="p">),</span>
            <span class="s1">&#39;PBEND&#39;</span> <span class="p">:</span> <span class="p">(</span><span class="n">PBEND</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_add_property_object</span><span class="p">),</span>

            <span class="s1">&#39;CTRIA3&#39;</span> <span class="p">:</span> <span class="p">(</span><span class="n">CTRIA3</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_add_element_object</span><span class="p">),</span>
            <span class="s1">&#39;CQUAD4&#39;</span> <span class="p">:</span> <span class="p">(</span><span class="n">CQUAD4</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_add_element_object</span><span class="p">),</span>
            <span class="s1">&#39;CQUAD&#39;</span> <span class="p">:</span> <span class="p">(</span><span class="n">CQUAD</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_add_element_object</span><span class="p">),</span>
            <span class="s1">&#39;CQUAD8&#39;</span> <span class="p">:</span> <span class="p">(</span><span class="n">CQUAD8</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_add_element_object</span><span class="p">),</span>
            <span class="s1">&#39;CQUADX&#39;</span> <span class="p">:</span> <span class="p">(</span><span class="n">CQUADX</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_add_element_object</span><span class="p">),</span>
            <span class="s1">&#39;CQUADX4&#39;</span> <span class="p">:</span> <span class="p">(</span><span class="n">CQUADX4</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_add_element_object</span><span class="p">),</span>
            <span class="s1">&#39;CQUADX8&#39;</span> <span class="p">:</span> <span class="p">(</span><span class="n">CQUADX8</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_add_element_object</span><span class="p">),</span>
            <span class="s1">&#39;CQUADR&#39;</span> <span class="p">:</span> <span class="p">(</span><span class="n">CQUADR</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_add_element_object</span><span class="p">),</span>
            <span class="s1">&#39;CTRIA6&#39;</span> <span class="p">:</span> <span class="p">(</span><span class="n">CTRIA6</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_add_element_object</span><span class="p">),</span>
            <span class="s1">&#39;CTRIAR&#39;</span> <span class="p">:</span> <span class="p">(</span><span class="n">CTRIAR</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_add_element_object</span><span class="p">),</span>
            <span class="s1">&#39;CTRAX3&#39;</span> <span class="p">:</span> <span class="p">(</span><span class="n">CTRAX3</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_add_element_object</span><span class="p">),</span>
            <span class="s1">&#39;CTRAX6&#39;</span> <span class="p">:</span> <span class="p">(</span><span class="n">CTRAX6</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_add_element_object</span><span class="p">),</span>
            <span class="s1">&#39;CTRIAX&#39;</span> <span class="p">:</span> <span class="p">(</span><span class="n">CTRIAX</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_add_element_object</span><span class="p">),</span>
            <span class="s1">&#39;CTRIAX6&#39;</span> <span class="p">:</span> <span class="p">(</span><span class="n">CTRIAX6</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_add_element_object</span><span class="p">),</span>
            <span class="s1">&#39;SNORM&#39;</span> <span class="p">:</span> <span class="p">(</span><span class="n">SNORM</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_add_normal_object</span><span class="p">),</span>
            <span class="s1">&#39;PCOMP&#39;</span> <span class="p">:</span> <span class="p">(</span><span class="n">PCOMP</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_add_property_object</span><span class="p">),</span>
            <span class="s1">&#39;PCOMPG&#39;</span> <span class="p">:</span> <span class="p">(</span><span class="n">PCOMPG</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_add_property_object</span><span class="p">),</span>
            <span class="s1">&#39;PSHELL&#39;</span> <span class="p">:</span> <span class="p">(</span><span class="n">PSHELL</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_add_property_object</span><span class="p">),</span>
            <span class="s1">&#39;PLPLANE&#39;</span> <span class="p">:</span> <span class="p">(</span><span class="n">PLPLANE</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_add_property_object</span><span class="p">),</span>
            <span class="s1">&#39;CPLSTN3&#39;</span> <span class="p">:</span> <span class="p">(</span><span class="n">CPLSTN3</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_add_element_object</span><span class="p">),</span>
            <span class="s1">&#39;CPLSTN4&#39;</span> <span class="p">:</span> <span class="p">(</span><span class="n">CPLSTN4</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_add_element_object</span><span class="p">),</span>
            <span class="s1">&#39;CPLSTN6&#39;</span> <span class="p">:</span> <span class="p">(</span><span class="n">CPLSTN6</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_add_element_object</span><span class="p">),</span>
            <span class="s1">&#39;CPLSTN8&#39;</span> <span class="p">:</span> <span class="p">(</span><span class="n">CPLSTN8</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_add_element_object</span><span class="p">),</span>
            <span class="s1">&#39;CPLSTS3&#39;</span> <span class="p">:</span> <span class="p">(</span><span class="n">CPLSTS3</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_add_element_object</span><span class="p">),</span>
            <span class="s1">&#39;CPLSTS4&#39;</span> <span class="p">:</span> <span class="p">(</span><span class="n">CPLSTS4</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_add_element_object</span><span class="p">),</span>
            <span class="s1">&#39;CPLSTS6&#39;</span> <span class="p">:</span> <span class="p">(</span><span class="n">CPLSTS6</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_add_element_object</span><span class="p">),</span>
            <span class="s1">&#39;CPLSTS8&#39;</span> <span class="p">:</span> <span class="p">(</span><span class="n">CPLSTS8</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_add_element_object</span><span class="p">),</span>
            <span class="s1">&#39;PPLANE&#39;</span> <span class="p">:</span> <span class="p">(</span><span class="n">PPLANE</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_add_property_object</span><span class="p">),</span>

            <span class="s1">&#39;CSHEAR&#39;</span> <span class="p">:</span> <span class="p">(</span><span class="n">CSHEAR</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_add_element_object</span><span class="p">),</span>
            <span class="s1">&#39;PSHEAR&#39;</span> <span class="p">:</span> <span class="p">(</span><span class="n">PSHEAR</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_add_property_object</span><span class="p">),</span>

            <span class="s1">&#39;CIHEX1&#39;</span> <span class="p">:</span> <span class="p">(</span><span class="n">CIHEX1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_add_element_object</span><span class="p">),</span>
            <span class="s1">&#39;CIHEX2&#39;</span> <span class="p">:</span> <span class="p">(</span><span class="n">CIHEX2</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_add_element_object</span><span class="p">),</span>
            <span class="s1">&#39;PIHEX&#39;</span> <span class="p">:</span> <span class="p">(</span><span class="n">PIHEX</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_add_property_object</span><span class="p">),</span>
            <span class="s1">&#39;PSOLID&#39;</span> <span class="p">:</span> <span class="p">(</span><span class="n">PSOLID</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_add_property_object</span><span class="p">),</span>
            <span class="s1">&#39;PLSOLID&#39;</span> <span class="p">:</span> <span class="p">(</span><span class="n">PLSOLID</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_add_property_object</span><span class="p">),</span>
            <span class="s1">&#39;PCOMPS&#39;</span> <span class="p">:</span> <span class="p">(</span><span class="n">PCOMPS</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_add_property_object</span><span class="p">),</span>

            <span class="s1">&#39;CELAS1&#39;</span> <span class="p">:</span> <span class="p">(</span><span class="n">CELAS1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_add_element_object</span><span class="p">),</span>
            <span class="s1">&#39;CELAS2&#39;</span> <span class="p">:</span> <span class="p">(</span><span class="n">CELAS2</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_add_element_object</span><span class="p">),</span>
            <span class="s1">&#39;CELAS3&#39;</span> <span class="p">:</span> <span class="p">(</span><span class="n">CELAS3</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_add_element_object</span><span class="p">),</span>
            <span class="s1">&#39;CELAS4&#39;</span> <span class="p">:</span> <span class="p">(</span><span class="n">CELAS4</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_add_element_object</span><span class="p">),</span>
            <span class="s1">&#39;CVISC&#39;</span> <span class="p">:</span> <span class="p">(</span><span class="n">CVISC</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_add_element_object</span><span class="p">),</span>
            <span class="s1">&#39;PELAST&#39;</span> <span class="p">:</span> <span class="p">(</span><span class="n">PELAST</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_add_pelast_object</span><span class="p">),</span>

            <span class="s1">&#39;CDAMP1&#39;</span> <span class="p">:</span> <span class="p">(</span><span class="n">CDAMP1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_add_damper_object</span><span class="p">),</span>
            <span class="s1">&#39;CDAMP2&#39;</span> <span class="p">:</span> <span class="p">(</span><span class="n">CDAMP2</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_add_damper_object</span><span class="p">),</span>
            <span class="s1">&#39;CDAMP3&#39;</span> <span class="p">:</span> <span class="p">(</span><span class="n">CDAMP3</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_add_damper_object</span><span class="p">),</span>
            <span class="c1"># CDAMP4 added later because the documentation is wrong</span>
            <span class="s1">&#39;CDAMP5&#39;</span> <span class="p">:</span> <span class="p">(</span><span class="n">CDAMP5</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_add_damper_object</span><span class="p">),</span>
            <span class="s1">&#39;PDAMP5&#39;</span> <span class="p">:</span> <span class="p">(</span><span class="n">PDAMP5</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_add_property_object</span><span class="p">),</span>

            <span class="s1">&#39;CFAST&#39;</span> <span class="p">:</span> <span class="p">(</span><span class="n">CFAST</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_add_damper_object</span><span class="p">),</span>
            <span class="s1">&#39;PFAST&#39;</span> <span class="p">:</span> <span class="p">(</span><span class="n">PFAST</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_add_property_object</span><span class="p">),</span>

            <span class="s1">&#39;CGAP&#39;</span> <span class="p">:</span> <span class="p">(</span><span class="n">CGAP</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_add_element_object</span><span class="p">),</span>
            <span class="s1">&#39;PGAP&#39;</span> <span class="p">:</span> <span class="p">(</span><span class="n">PGAP</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_add_property_object</span><span class="p">),</span>

            <span class="s1">&#39;CBUSH&#39;</span> <span class="p">:</span> <span class="p">(</span><span class="n">CBUSH</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_add_damper_object</span><span class="p">),</span>
            <span class="s1">&#39;CBUSH1D&#39;</span> <span class="p">:</span> <span class="p">(</span><span class="n">CBUSH1D</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_add_damper_object</span><span class="p">),</span>
            <span class="s1">&#39;CBUSH2D&#39;</span> <span class="p">:</span> <span class="p">(</span><span class="n">CBUSH2D</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_add_damper_object</span><span class="p">),</span>
            <span class="s1">&#39;PBUSH&#39;</span> <span class="p">:</span> <span class="p">(</span><span class="n">PBUSH</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_add_property_object</span><span class="p">),</span>
            <span class="s1">&#39;PBUSH1D&#39;</span> <span class="p">:</span> <span class="p">(</span><span class="n">PBUSH1D</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_add_property_object</span><span class="p">),</span>

            <span class="s1">&#39;CRAC2D&#39;</span> <span class="p">:</span> <span class="p">(</span><span class="n">CRAC2D</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_add_element_object</span><span class="p">),</span>
            <span class="s1">&#39;PRAC2D&#39;</span> <span class="p">:</span> <span class="p">(</span><span class="n">PRAC2D</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_add_property_object</span><span class="p">),</span>

            <span class="s1">&#39;CRAC3D&#39;</span> <span class="p">:</span> <span class="p">(</span><span class="n">CRAC3D</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_add_element_object</span><span class="p">),</span>
            <span class="s1">&#39;PRAC3D&#39;</span> <span class="p">:</span> <span class="p">(</span><span class="n">PRAC3D</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_add_property_object</span><span class="p">),</span>

            <span class="s1">&#39;GENEL&#39;</span> <span class="p">:</span> <span class="p">(</span><span class="n">GENEL</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_add_element_object</span><span class="p">),</span>


            <span class="s1">&#39;PDAMPT&#39;</span> <span class="p">:</span> <span class="p">(</span><span class="n">PDAMPT</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_add_pdampt_object</span><span class="p">),</span>
            <span class="s1">&#39;PBUSHT&#39;</span> <span class="p">:</span> <span class="p">(</span><span class="n">PBUSHT</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_add_pbusht_object</span><span class="p">),</span>

            <span class="s1">&#39;CCONEAX&#39;</span> <span class="p">:</span> <span class="p">(</span><span class="n">CCONEAX</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_add_element_object</span><span class="p">),</span>
            <span class="s1">&#39;PCONEAX&#39;</span> <span class="p">:</span> <span class="p">(</span><span class="n">PCONEAX</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_add_property_object</span><span class="p">),</span>
            <span class="s1">&#39;AXIC&#39;</span> <span class="p">:</span> <span class="p">(</span><span class="n">AXIC</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_add_axic_object</span><span class="p">),</span>
            <span class="s1">&#39;AXIF&#39;</span> <span class="p">:</span> <span class="p">(</span><span class="n">AXIF</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_add_axif_object</span><span class="p">),</span>
            <span class="s1">&#39;CYAX&#39;</span> <span class="p">:</span> <span class="p">(</span><span class="n">CYAX</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_add_cyax_object</span><span class="p">),</span>

            <span class="s1">&#39;RBAR&#39;</span> <span class="p">:</span> <span class="p">(</span><span class="n">RBAR</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_add_rigid_element_object</span><span class="p">),</span>
            <span class="s1">&#39;RBAR1&#39;</span> <span class="p">:</span> <span class="p">(</span><span class="n">RBAR1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_add_rigid_element_object</span><span class="p">),</span>
            <span class="s1">&#39;RBE1&#39;</span> <span class="p">:</span> <span class="p">(</span><span class="n">RBE1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_add_rigid_element_object</span><span class="p">),</span>
            <span class="s1">&#39;RBE2&#39;</span> <span class="p">:</span> <span class="p">(</span><span class="n">RBE2</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_add_rigid_element_object</span><span class="p">),</span>
            <span class="s1">&#39;RBE3&#39;</span> <span class="p">:</span> <span class="p">(</span><span class="n">RBE3</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_add_rigid_element_object</span><span class="p">),</span>
            <span class="s1">&#39;RROD&#39;</span> <span class="p">:</span> <span class="p">(</span><span class="n">RROD</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_add_rigid_element_object</span><span class="p">),</span>
            <span class="s1">&#39;RSPLINE&#39;</span> <span class="p">:</span> <span class="p">(</span><span class="n">RSPLINE</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_add_rigid_element_object</span><span class="p">),</span>
            <span class="s1">&#39;RSSCON&#39;</span> <span class="p">:</span> <span class="p">(</span><span class="n">RSSCON</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_add_rigid_element_object</span><span class="p">),</span>


            <span class="c1">## there is no MAT6 or MAT7</span>
            <span class="s1">&#39;MAT1&#39;</span> <span class="p">:</span> <span class="p">(</span><span class="n">MAT1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_add_structural_material_object</span><span class="p">),</span>
            <span class="s1">&#39;MAT2&#39;</span> <span class="p">:</span> <span class="p">(</span><span class="n">MAT2</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_add_structural_material_object</span><span class="p">),</span>
            <span class="s1">&#39;MAT3&#39;</span> <span class="p">:</span> <span class="p">(</span><span class="n">MAT3</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_add_structural_material_object</span><span class="p">),</span>
            <span class="s1">&#39;MAT8&#39;</span> <span class="p">:</span> <span class="p">(</span><span class="n">MAT8</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_add_structural_material_object</span><span class="p">),</span>
            <span class="s1">&#39;MAT9&#39;</span> <span class="p">:</span> <span class="p">(</span><span class="n">MAT9</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_add_structural_material_object</span><span class="p">),</span>
            <span class="s1">&#39;MAT10&#39;</span> <span class="p">:</span> <span class="p">(</span><span class="n">MAT10</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_add_structural_material_object</span><span class="p">),</span>
            <span class="s1">&#39;MAT11&#39;</span> <span class="p">:</span> <span class="p">(</span><span class="n">MAT11</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_add_structural_material_object</span><span class="p">),</span>
            <span class="s1">&#39;MAT3D&#39;</span> <span class="p">:</span> <span class="p">(</span><span class="n">MAT3D</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_add_structural_material_object</span><span class="p">),</span>
            <span class="s1">&#39;EQUIV&#39;</span> <span class="p">:</span> <span class="p">(</span><span class="n">EQUIV</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_add_structural_material_object</span><span class="p">),</span>
            <span class="s1">&#39;MATG&#39;</span> <span class="p">:</span> <span class="p">(</span><span class="n">MATG</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_add_structural_material_object</span><span class="p">),</span>

            <span class="s1">&#39;MATHE&#39;</span> <span class="p">:</span> <span class="p">(</span><span class="n">MATHE</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_add_hyperelastic_material_object</span><span class="p">),</span>
            <span class="s1">&#39;MATHP&#39;</span> <span class="p">:</span> <span class="p">(</span><span class="n">MATHP</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_add_hyperelastic_material_object</span><span class="p">),</span>
            <span class="s1">&#39;MAT4&#39;</span> <span class="p">:</span> <span class="p">(</span><span class="n">MAT4</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_add_thermal_material_object</span><span class="p">),</span>
            <span class="s1">&#39;MAT5&#39;</span> <span class="p">:</span> <span class="p">(</span><span class="n">MAT5</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_add_thermal_material_object</span><span class="p">),</span>

            <span class="s1">&#39;MATS1&#39;</span> <span class="p">:</span> <span class="p">(</span><span class="n">MATS1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_add_material_dependence_object</span><span class="p">),</span>
            <span class="c1">#&#39;MATS3&#39; : (MATS3, self._add_material_dependence_object),</span>
            <span class="c1">#&#39;MATS8&#39; : (MATS8, self._add_material_dependence_object),</span>
            <span class="s1">&#39;MATT1&#39;</span> <span class="p">:</span> <span class="p">(</span><span class="n">MATT1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_add_material_dependence_object</span><span class="p">),</span>
            <span class="s1">&#39;MATT2&#39;</span> <span class="p">:</span> <span class="p">(</span><span class="n">MATT2</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_add_material_dependence_object</span><span class="p">),</span>
            <span class="s1">&#39;MATT3&#39;</span> <span class="p">:</span> <span class="p">(</span><span class="n">MATT3</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_add_material_dependence_object</span><span class="p">),</span>
            <span class="s1">&#39;MATT4&#39;</span> <span class="p">:</span> <span class="p">(</span><span class="n">MATT4</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_add_material_dependence_object</span><span class="p">),</span>
            <span class="s1">&#39;MATT5&#39;</span> <span class="p">:</span> <span class="p">(</span><span class="n">MATT5</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_add_material_dependence_object</span><span class="p">),</span>
            <span class="s1">&#39;MATT8&#39;</span> <span class="p">:</span> <span class="p">(</span><span class="n">MATT8</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_add_material_dependence_object</span><span class="p">),</span>
            <span class="s1">&#39;MATT9&#39;</span> <span class="p">:</span> <span class="p">(</span><span class="n">MATT9</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_add_material_dependence_object</span><span class="p">),</span>
            <span class="s1">&#39;NXSTRAT&#39;</span> <span class="p">:</span> <span class="p">(</span><span class="n">NXSTRAT</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_add_nxstrat_object</span><span class="p">),</span>

            <span class="c1"># hasnt been verified, links up to MAT1, MAT2, MAT9 w/ same MID</span>
            <span class="s1">&#39;CREEP&#39;</span> <span class="p">:</span> <span class="p">(</span><span class="n">CREEP</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_add_creep_material_object</span><span class="p">),</span>

            <span class="s1">&#39;NSMADD&#39;</span> <span class="p">:</span> <span class="p">(</span><span class="n">NSMADD</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_add_nsmadd_object</span><span class="p">),</span>
            <span class="s1">&#39;NSM1&#39;</span> <span class="p">:</span> <span class="p">(</span><span class="n">NSM1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_add_nsm_object</span><span class="p">),</span>
            <span class="s1">&#39;NSML1&#39;</span> <span class="p">:</span> <span class="p">(</span><span class="n">NSML1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_add_nsm_object</span><span class="p">),</span>

            <span class="s1">&#39;CONM1&#39;</span> <span class="p">:</span> <span class="p">(</span><span class="n">CONM1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_add_mass_object</span><span class="p">),</span>
            <span class="s1">&#39;CONM2&#39;</span> <span class="p">:</span> <span class="p">(</span><span class="n">CONM2</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_add_mass_object</span><span class="p">),</span>
            <span class="s1">&#39;CMASS1&#39;</span> <span class="p">:</span> <span class="p">(</span><span class="n">CMASS1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_add_mass_object</span><span class="p">),</span>
            <span class="s1">&#39;CMASS2&#39;</span> <span class="p">:</span> <span class="p">(</span><span class="n">CMASS2</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_add_mass_object</span><span class="p">),</span>
            <span class="s1">&#39;CMASS3&#39;</span> <span class="p">:</span> <span class="p">(</span><span class="n">CMASS3</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_add_mass_object</span><span class="p">),</span>
            <span class="c1"># CMASS4 - added later because documentation is wrong</span>

            <span class="s1">&#39;MPC&#39;</span> <span class="p">:</span> <span class="p">(</span><span class="n">MPC</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_add_constraint_mpc_object</span><span class="p">),</span>
            <span class="s1">&#39;MPCADD&#39;</span> <span class="p">:</span> <span class="p">(</span><span class="n">MPCADD</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_add_constraint_mpcadd_object</span><span class="p">),</span>

            <span class="s1">&#39;SPC&#39;</span> <span class="p">:</span> <span class="p">(</span><span class="n">SPC</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_add_constraint_spc_object</span><span class="p">),</span>
            <span class="s1">&#39;SPC1&#39;</span> <span class="p">:</span> <span class="p">(</span><span class="n">SPC1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_add_constraint_spc_object</span><span class="p">),</span>
            <span class="s1">&#39;SPCOFF&#39;</span> <span class="p">:</span> <span class="p">(</span><span class="n">SPCOFF</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_add_constraint_spcoff_object</span><span class="p">),</span>
            <span class="s1">&#39;SPCOFF1&#39;</span> <span class="p">:</span> <span class="p">(</span><span class="n">SPCOFF1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_add_constraint_spcoff_object</span><span class="p">),</span>
            <span class="s1">&#39;SPCAX&#39;</span> <span class="p">:</span> <span class="p">(</span><span class="n">SPCAX</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_add_constraint_spc_object</span><span class="p">),</span>
            <span class="s1">&#39;SPCADD&#39;</span> <span class="p">:</span> <span class="p">(</span><span class="n">SPCADD</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_add_constraint_spcadd_object</span><span class="p">),</span>
            <span class="s1">&#39;GMSPC&#39;</span> <span class="p">:</span> <span class="p">(</span><span class="n">GMSPC</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_add_constraint_spc_object</span><span class="p">),</span>

            <span class="s1">&#39;SESUP&#39;</span> <span class="p">:</span> <span class="p">(</span><span class="n">SESUP</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_add_sesuport_object</span><span class="p">),</span> <span class="c1"># pseudo-constraint</span>
            <span class="s1">&#39;SUPORT&#39;</span> <span class="p">:</span> <span class="p">(</span><span class="n">SUPORT</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_add_suport_object</span><span class="p">),</span> <span class="c1"># pseudo-constraint</span>
            <span class="s1">&#39;SUPORT1&#39;</span> <span class="p">:</span> <span class="p">(</span><span class="n">SUPORT1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_add_suport1_object</span><span class="p">),</span>  <span class="c1"># pseudo-constraint</span>

            <span class="s1">&#39;FORCE&#39;</span> <span class="p">:</span> <span class="p">(</span><span class="n">FORCE</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_add_load_object</span><span class="p">),</span>
            <span class="s1">&#39;FORCE1&#39;</span> <span class="p">:</span> <span class="p">(</span><span class="n">FORCE1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_add_load_object</span><span class="p">),</span>
            <span class="s1">&#39;FORCE2&#39;</span> <span class="p">:</span> <span class="p">(</span><span class="n">FORCE2</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_add_load_object</span><span class="p">),</span>
            <span class="s1">&#39;MOMENT&#39;</span> <span class="p">:</span> <span class="p">(</span><span class="n">MOMENT</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_add_load_object</span><span class="p">),</span>
            <span class="s1">&#39;MOMENT1&#39;</span> <span class="p">:</span> <span class="p">(</span><span class="n">MOMENT1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_add_load_object</span><span class="p">),</span>
            <span class="s1">&#39;MOMENT2&#39;</span> <span class="p">:</span> <span class="p">(</span><span class="n">MOMENT2</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_add_load_object</span><span class="p">),</span>

            <span class="s1">&#39;LSEQ&#39;</span> <span class="p">:</span> <span class="p">(</span><span class="n">LSEQ</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_add_lseq_object</span><span class="p">),</span>
            <span class="s1">&#39;LOAD&#39;</span> <span class="p">:</span> <span class="p">(</span><span class="n">LOAD</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_add_load_combination_object</span><span class="p">),</span>
            <span class="s1">&#39;CLOAD&#39;</span> <span class="p">:</span> <span class="p">(</span><span class="n">CLOAD</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_add_load_combination_object</span><span class="p">),</span>
            <span class="s1">&#39;LOADCYN&#39;</span> <span class="p">:</span> <span class="p">(</span><span class="n">LOADCYN</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_add_load_object</span><span class="p">),</span>
            <span class="s1">&#39;LOADCYH&#39;</span> <span class="p">:</span> <span class="p">(</span><span class="n">LOADCYH</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_add_load_object</span><span class="p">),</span>

            <span class="c1"># basic static loads</span>
            <span class="s1">&#39;GRAV&#39;</span> <span class="p">:</span> <span class="p">(</span><span class="n">GRAV</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_add_load_object</span><span class="p">),</span>
            <span class="s1">&#39;ACCEL&#39;</span> <span class="p">:</span> <span class="p">(</span><span class="n">ACCEL</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_add_load_object</span><span class="p">),</span>
            <span class="s1">&#39;ACCEL1&#39;</span> <span class="p">:</span> <span class="p">(</span><span class="n">ACCEL1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_add_load_object</span><span class="p">),</span>
            <span class="s1">&#39;PLOAD&#39;</span> <span class="p">:</span> <span class="p">(</span><span class="n">PLOAD</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_add_load_object</span><span class="p">),</span>
            <span class="s1">&#39;PLOAD1&#39;</span> <span class="p">:</span> <span class="p">(</span><span class="n">PLOAD1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_add_load_object</span><span class="p">),</span>
            <span class="s1">&#39;PLOAD2&#39;</span> <span class="p">:</span> <span class="p">(</span><span class="n">PLOAD2</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_add_load_object</span><span class="p">),</span>
            <span class="s1">&#39;PLOAD4&#39;</span> <span class="p">:</span> <span class="p">(</span><span class="n">PLOAD4</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_add_load_object</span><span class="p">),</span>
            <span class="s1">&#39;RFORCE&#39;</span> <span class="p">:</span> <span class="p">(</span><span class="n">RFORCE</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_add_load_object</span><span class="p">),</span>
            <span class="s1">&#39;RFORCE1&#39;</span> <span class="p">:</span> <span class="p">(</span><span class="n">RFORCE1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_add_load_object</span><span class="p">),</span>
            <span class="s1">&#39;SLOAD&#39;</span> <span class="p">:</span> <span class="p">(</span><span class="n">SLOAD</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_add_load_object</span><span class="p">),</span>
            <span class="s1">&#39;GMLOAD&#39;</span> <span class="p">:</span> <span class="p">(</span><span class="n">GMLOAD</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_add_load_object</span><span class="p">),</span>
            <span class="s1">&#39;SPCD&#39;</span> <span class="p">:</span> <span class="p">(</span><span class="n">SPCD</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_add_load_object</span><span class="p">),</span>  <span class="c1"># enforced displacement</span>
            <span class="s1">&#39;QVOL&#39;</span> <span class="p">:</span> <span class="p">(</span><span class="n">QVOL</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_add_load_object</span><span class="p">),</span>  <span class="c1"># thermal</span>

            <span class="c1"># axisymmetric loads</span>
            <span class="s1">&#39;FORCEAX&#39;</span> <span class="p">:</span> <span class="p">(</span><span class="n">FORCEAX</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_add_load_object</span><span class="p">),</span>
            <span class="s1">&#39;PLOADX1&#39;</span> <span class="p">:</span> <span class="p">(</span><span class="n">PLOADX1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_add_load_object</span><span class="p">),</span>
            <span class="s1">&#39;PRESAX&#39;</span> <span class="p">:</span> <span class="p">(</span><span class="n">PRESAX</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_add_load_object</span><span class="p">),</span>  <span class="c1"># axisymmetric</span>

            <span class="s1">&#39;DLOAD&#39;</span> <span class="p">:</span> <span class="p">(</span><span class="n">DLOAD</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_add_dload_object</span><span class="p">),</span>

            <span class="s1">&#39;ACSRCE&#39;</span> <span class="p">:</span> <span class="p">(</span><span class="n">ACSRCE</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_add_dload_entry</span><span class="p">),</span>
            <span class="s1">&#39;TLOAD1&#39;</span> <span class="p">:</span> <span class="p">(</span><span class="n">TLOAD1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_add_dload_entry</span><span class="p">),</span>
            <span class="s1">&#39;TLOAD2&#39;</span> <span class="p">:</span> <span class="p">(</span><span class="n">TLOAD2</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_add_dload_entry</span><span class="p">),</span>
            <span class="s1">&#39;RLOAD1&#39;</span> <span class="p">:</span> <span class="p">(</span><span class="n">RLOAD1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_add_dload_entry</span><span class="p">),</span>
            <span class="s1">&#39;RLOAD2&#39;</span> <span class="p">:</span> <span class="p">(</span><span class="n">RLOAD2</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_add_dload_entry</span><span class="p">),</span>
            <span class="s1">&#39;RANDPS&#39;</span> <span class="p">:</span> <span class="p">(</span><span class="n">RANDPS</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_add_dload_entry</span><span class="p">),</span> <span class="c1"># random</span>
            <span class="s1">&#39;RANDT1&#39;</span> <span class="p">:</span> <span class="p">(</span><span class="n">RANDT1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_add_dload_entry</span><span class="p">),</span> <span class="c1"># random</span>
            <span class="s1">&#39;QVECT&#39;</span> <span class="p">:</span> <span class="p">(</span><span class="n">QVECT</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_add_dload_entry</span><span class="p">),</span>

            <span class="s1">&#39;FREQ&#39;</span> <span class="p">:</span> <span class="p">(</span><span class="n">FREQ</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_add_freq_object</span><span class="p">),</span>
            <span class="s1">&#39;FREQ1&#39;</span> <span class="p">:</span> <span class="p">(</span><span class="n">FREQ1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_add_freq_object</span><span class="p">),</span>
            <span class="s1">&#39;FREQ2&#39;</span> <span class="p">:</span> <span class="p">(</span><span class="n">FREQ2</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_add_freq_object</span><span class="p">),</span>
            <span class="s1">&#39;FREQ3&#39;</span> <span class="p">:</span> <span class="p">(</span><span class="n">FREQ3</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_add_freq_object</span><span class="p">),</span>
            <span class="s1">&#39;FREQ4&#39;</span> <span class="p">:</span> <span class="p">(</span><span class="n">FREQ4</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_add_freq_object</span><span class="p">),</span>
            <span class="s1">&#39;FREQ5&#39;</span> <span class="p">:</span> <span class="p">(</span><span class="n">FREQ5</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_add_freq_object</span><span class="p">),</span>

            <span class="s1">&#39;DOPTPRM&#39;</span> <span class="p">:</span> <span class="p">(</span><span class="n">DOPTPRM</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_add_doptprm_object</span><span class="p">),</span>
            <span class="s1">&#39;DESVAR&#39;</span> <span class="p">:</span> <span class="p">(</span><span class="n">DESVAR</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_add_desvar_object</span><span class="p">),</span>
            <span class="s1">&#39;TOPVAR&#39;</span> <span class="p">:</span> <span class="p">(</span><span class="n">TOPVAR</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_add_topvar_object</span><span class="p">),</span>
            <span class="c1"># BCTSET</span>

            <span class="s1">&#39;TEMPRB&#39;</span> <span class="p">:</span> <span class="p">(</span><span class="n">TEMPRB</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_add_thermal_load_object</span><span class="p">),</span>
            <span class="s1">&#39;TEMP&#39;</span> <span class="p">:</span> <span class="p">(</span><span class="n">TEMP</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_add_thermal_load_object</span><span class="p">),</span>
            <span class="s1">&#39;TEMPB3&#39;</span> <span class="p">:</span> <span class="p">(</span><span class="n">TEMPB3</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_add_thermal_load_object</span><span class="p">),</span>
            <span class="s1">&#39;QBDY1&#39;</span> <span class="p">:</span> <span class="p">(</span><span class="n">QBDY1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_add_thermal_load_object</span><span class="p">),</span>
            <span class="s1">&#39;QBDY2&#39;</span> <span class="p">:</span> <span class="p">(</span><span class="n">QBDY2</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_add_thermal_load_object</span><span class="p">),</span>
            <span class="s1">&#39;QBDY3&#39;</span> <span class="p">:</span> <span class="p">(</span><span class="n">QBDY3</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_add_thermal_load_object</span><span class="p">),</span>
            <span class="s1">&#39;QHBDY&#39;</span> <span class="p">:</span> <span class="p">(</span><span class="n">QHBDY</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_add_thermal_load_object</span><span class="p">),</span>
            <span class="s1">&#39;PHBDY&#39;</span> <span class="p">:</span> <span class="p">(</span><span class="n">PHBDY</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_add_phbdy_object</span><span class="p">),</span>

            <span class="s1">&#39;CHBDYE&#39;</span> <span class="p">:</span> <span class="p">(</span><span class="n">CHBDYE</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_add_thermal_element_object</span><span class="p">),</span>
            <span class="s1">&#39;CHBDYG&#39;</span> <span class="p">:</span> <span class="p">(</span><span class="n">CHBDYG</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_add_thermal_element_object</span><span class="p">),</span>
            <span class="s1">&#39;CHBDYP&#39;</span> <span class="p">:</span> <span class="p">(</span><span class="n">CHBDYP</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_add_thermal_element_object</span><span class="p">),</span>
            <span class="s1">&#39;PCONV&#39;</span> <span class="p">:</span> <span class="p">(</span><span class="n">PCONV</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_add_convection_property_object</span><span class="p">),</span>
            <span class="s1">&#39;PCONVM&#39;</span> <span class="p">:</span> <span class="p">(</span><span class="n">PCONVM</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_add_convection_property_object</span><span class="p">),</span>

            <span class="s1">&#39;VIEW&#39;</span> <span class="p">:</span> <span class="p">(</span><span class="n">VIEW</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_add_view_object</span><span class="p">),</span>
            <span class="s1">&#39;VIEW3D&#39;</span> <span class="p">:</span> <span class="p">(</span><span class="n">VIEW3D</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_add_view3d_object</span><span class="p">),</span>

            <span class="c1"># aero</span>
            <span class="s1">&#39;AECOMP&#39;</span> <span class="p">:</span> <span class="p">(</span><span class="n">AECOMP</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_add_aecomp_object</span><span class="p">),</span>
            <span class="s1">&#39;AECOMPL&#39;</span> <span class="p">:</span> <span class="p">(</span><span class="n">AECOMPL</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_add_aecomp_object</span><span class="p">),</span>
            <span class="s1">&#39;AEFACT&#39;</span> <span class="p">:</span> <span class="p">(</span><span class="n">AEFACT</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_add_aefact_object</span><span class="p">),</span>
            <span class="s1">&#39;AELINK&#39;</span> <span class="p">:</span> <span class="p">(</span><span class="n">AELINK</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_add_aelink_object</span><span class="p">),</span>
            <span class="s1">&#39;AELIST&#39;</span> <span class="p">:</span> <span class="p">(</span><span class="n">AELIST</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_add_aelist_object</span><span class="p">),</span>
            <span class="s1">&#39;AEPARM&#39;</span> <span class="p">:</span> <span class="p">(</span><span class="n">AEPARM</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_add_aeparm_object</span><span class="p">),</span>
            <span class="s1">&#39;AESTAT&#39;</span> <span class="p">:</span> <span class="p">(</span><span class="n">AESTAT</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_add_aestat_object</span><span class="p">),</span>
            <span class="s1">&#39;AESURF&#39;</span> <span class="p">:</span> <span class="p">(</span><span class="n">AESURF</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_add_aesurf_object</span><span class="p">),</span>
            <span class="s1">&#39;AESURFS&#39;</span> <span class="p">:</span> <span class="p">(</span><span class="n">AESURFS</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_add_aesurfs_object</span><span class="p">),</span>

            <span class="s1">&#39;CAERO1&#39;</span> <span class="p">:</span> <span class="p">(</span><span class="n">CAERO1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_add_caero_object</span><span class="p">),</span>
            <span class="s1">&#39;CAERO2&#39;</span> <span class="p">:</span> <span class="p">(</span><span class="n">CAERO2</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_add_caero_object</span><span class="p">),</span>
            <span class="s1">&#39;CAERO3&#39;</span> <span class="p">:</span> <span class="p">(</span><span class="n">CAERO3</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_add_caero_object</span><span class="p">),</span>
            <span class="s1">&#39;CAERO4&#39;</span> <span class="p">:</span> <span class="p">(</span><span class="n">CAERO4</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_add_caero_object</span><span class="p">),</span>
            <span class="s1">&#39;CAERO5&#39;</span> <span class="p">:</span> <span class="p">(</span><span class="n">CAERO5</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_add_caero_object</span><span class="p">),</span>

            <span class="s1">&#39;PAERO1&#39;</span> <span class="p">:</span> <span class="p">(</span><span class="n">PAERO1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_add_paero_object</span><span class="p">),</span>
            <span class="s1">&#39;PAERO2&#39;</span> <span class="p">:</span> <span class="p">(</span><span class="n">PAERO2</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_add_paero_object</span><span class="p">),</span>
            <span class="s1">&#39;PAERO3&#39;</span> <span class="p">:</span> <span class="p">(</span><span class="n">PAERO3</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_add_paero_object</span><span class="p">),</span>
            <span class="s1">&#39;PAERO4&#39;</span> <span class="p">:</span> <span class="p">(</span><span class="n">PAERO4</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_add_paero_object</span><span class="p">),</span>
            <span class="s1">&#39;PAERO5&#39;</span> <span class="p">:</span> <span class="p">(</span><span class="n">PAERO5</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_add_paero_object</span><span class="p">),</span>

            <span class="s1">&#39;SPLINE1&#39;</span> <span class="p">:</span> <span class="p">(</span><span class="n">SPLINE1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_add_spline_object</span><span class="p">),</span>
            <span class="s1">&#39;SPLINE2&#39;</span> <span class="p">:</span> <span class="p">(</span><span class="n">SPLINE2</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_add_spline_object</span><span class="p">),</span>
            <span class="s1">&#39;SPLINE3&#39;</span> <span class="p">:</span> <span class="p">(</span><span class="n">SPLINE3</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_add_spline_object</span><span class="p">),</span>
            <span class="s1">&#39;SPLINE4&#39;</span> <span class="p">:</span> <span class="p">(</span><span class="n">SPLINE4</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_add_spline_object</span><span class="p">),</span>
            <span class="s1">&#39;SPLINE5&#39;</span> <span class="p">:</span> <span class="p">(</span><span class="n">SPLINE5</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_add_spline_object</span><span class="p">),</span>

            <span class="c1"># SOL 144</span>
            <span class="s1">&#39;AEROS&#39;</span> <span class="p">:</span> <span class="p">(</span><span class="n">AEROS</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_add_aeros_object</span><span class="p">),</span>
            <span class="s1">&#39;TRIM&#39;</span> <span class="p">:</span> <span class="p">(</span><span class="n">TRIM</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_add_trim_object</span><span class="p">),</span>
            <span class="s1">&#39;TRIM2&#39;</span> <span class="p">:</span> <span class="p">(</span><span class="n">TRIM2</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_add_trim_object</span><span class="p">),</span>
            <span class="s1">&#39;DIVERG&#39;</span> <span class="p">:</span> <span class="p">(</span><span class="n">DIVERG</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_add_diverg_object</span><span class="p">),</span>

            <span class="c1"># SOL 145</span>
            <span class="s1">&#39;AERO&#39;</span> <span class="p">:</span> <span class="p">(</span><span class="n">AERO</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_add_aero_object</span><span class="p">),</span>
            <span class="s1">&#39;FLUTTER&#39;</span> <span class="p">:</span> <span class="p">(</span><span class="n">FLUTTER</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_add_flutter_object</span><span class="p">),</span>
            <span class="s1">&#39;FLFACT&#39;</span> <span class="p">:</span> <span class="p">(</span><span class="n">FLFACT</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_add_flfact_object</span><span class="p">),</span>
            <span class="s1">&#39;MKAERO1&#39;</span> <span class="p">:</span> <span class="p">(</span><span class="n">MKAERO1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_add_mkaero_object</span><span class="p">),</span>
            <span class="s1">&#39;MKAERO2&#39;</span> <span class="p">:</span> <span class="p">(</span><span class="n">MKAERO2</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_add_mkaero_object</span><span class="p">),</span>

            <span class="s1">&#39;GUST&#39;</span> <span class="p">:</span> <span class="p">(</span><span class="n">GUST</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_add_gust_object</span><span class="p">),</span>
            <span class="s1">&#39;CSSCHD&#39;</span> <span class="p">:</span> <span class="p">(</span><span class="n">CSSCHD</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_add_csschd_object</span><span class="p">),</span>
            <span class="s1">&#39;MONPNT1&#39;</span> <span class="p">:</span> <span class="p">(</span><span class="n">MONPNT1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_add_monpnt_object</span><span class="p">),</span>
            <span class="s1">&#39;MONPNT2&#39;</span> <span class="p">:</span> <span class="p">(</span><span class="n">MONPNT2</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_add_monpnt_object</span><span class="p">),</span>
            <span class="s1">&#39;MONPNT3&#39;</span> <span class="p">:</span> <span class="p">(</span><span class="n">MONPNT3</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_add_monpnt_object</span><span class="p">),</span>
            <span class="s1">&#39;MONDSP1&#39;</span> <span class="p">:</span> <span class="p">(</span><span class="n">MONDSP1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_add_monpnt_object</span><span class="p">),</span>

            <span class="s1">&#39;NLPARM&#39;</span> <span class="p">:</span> <span class="p">(</span><span class="n">NLPARM</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_add_nlparm_object</span><span class="p">),</span>
            <span class="s1">&#39;NLPCI&#39;</span> <span class="p">:</span> <span class="p">(</span><span class="n">NLPCI</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_add_nlpci_object</span><span class="p">),</span>
            <span class="s1">&#39;TSTEP&#39;</span> <span class="p">:</span> <span class="p">(</span><span class="n">TSTEP</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_add_tstep_object</span><span class="p">),</span>
            <span class="s1">&#39;TSTEP1&#39;</span> <span class="p">:</span> <span class="p">(</span><span class="n">TSTEP1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_add_tstepnl_object</span><span class="p">),</span>
            <span class="s1">&#39;TSTEPNL&#39;</span> <span class="p">:</span> <span class="p">(</span><span class="n">TSTEPNL</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_add_tstepnl_object</span><span class="p">),</span>

            <span class="s1">&#39;TF&#39;</span> <span class="p">:</span> <span class="p">(</span><span class="n">TF</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_add_tf_object</span><span class="p">),</span>
            <span class="s1">&#39;TIC&#39;</span> <span class="p">:</span> <span class="p">(</span><span class="n">TIC</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_add_tic_object</span><span class="p">),</span>

            <span class="s1">&#39;DCONADD&#39;</span> <span class="p">:</span> <span class="p">(</span><span class="n">DCONADD</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_add_dconstr_object</span><span class="p">),</span>
            <span class="s1">&#39;DCONSTR&#39;</span> <span class="p">:</span> <span class="p">(</span><span class="n">DCONSTR</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_add_dconstr_object</span><span class="p">),</span>
            <span class="s1">&#39;DDVAL&#39;</span> <span class="p">:</span> <span class="p">(</span><span class="n">DDVAL</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_add_ddval_object</span><span class="p">),</span>
            <span class="s1">&#39;DLINK&#39;</span> <span class="p">:</span> <span class="p">(</span><span class="n">DLINK</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_add_dlink_object</span><span class="p">),</span>
            <span class="s1">&#39;DSCREEN&#39;</span> <span class="p">:</span> <span class="p">(</span><span class="n">DSCREEN</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_add_dscreen_object</span><span class="p">),</span>

            <span class="s1">&#39;DTABLE&#39;</span> <span class="p">:</span> <span class="p">(</span><span class="n">DTABLE</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_add_dtable_object</span><span class="p">),</span>
            <span class="s1">&#39;DRESP1&#39;</span> <span class="p">:</span> <span class="p">(</span><span class="n">DRESP1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_add_dresp_object</span><span class="p">),</span> <span class="c1"># dresps</span>
            <span class="s1">&#39;DRESP2&#39;</span> <span class="p">:</span> <span class="p">(</span><span class="n">DRESP2</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_add_dresp_object</span><span class="p">),</span>
            <span class="s1">&#39;DRESP3&#39;</span> <span class="p">:</span> <span class="p">(</span><span class="n">DRESP3</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_add_dresp_object</span><span class="p">),</span>
            <span class="s1">&#39;DVCREL1&#39;</span> <span class="p">:</span> <span class="p">(</span><span class="n">DVCREL1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_add_dvcrel_object</span><span class="p">),</span> <span class="c1"># dvcrels</span>
            <span class="s1">&#39;DVCREL2&#39;</span> <span class="p">:</span> <span class="p">(</span><span class="n">DVCREL2</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_add_dvcrel_object</span><span class="p">),</span>
            <span class="s1">&#39;DVPREL1&#39;</span> <span class="p">:</span> <span class="p">(</span><span class="n">DVPREL1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_add_dvprel_object</span><span class="p">),</span> <span class="c1"># dvprels</span>
            <span class="s1">&#39;DVPREL2&#39;</span> <span class="p">:</span> <span class="p">(</span><span class="n">DVPREL2</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_add_dvprel_object</span><span class="p">),</span>
            <span class="s1">&#39;DVMREL1&#39;</span> <span class="p">:</span> <span class="p">(</span><span class="n">DVMREL1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_add_dvmrel_object</span><span class="p">),</span> <span class="c1"># ddvmrels</span>
            <span class="s1">&#39;DVMREL2&#39;</span> <span class="p">:</span> <span class="p">(</span><span class="n">DVMREL2</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_add_dvmrel_object</span><span class="p">),</span>
            <span class="s1">&#39;DVGRID&#39;</span> <span class="p">:</span> <span class="p">(</span><span class="n">DVGRID</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_add_dvgrid_object</span><span class="p">),</span> <span class="c1"># dvgrids</span>

            <span class="c1"># tables</span>
            <span class="s1">&#39;TABLES1&#39;</span> <span class="p">:</span> <span class="p">(</span><span class="n">TABLES1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_add_table_object</span><span class="p">),</span>
            <span class="s1">&#39;TABLEST&#39;</span> <span class="p">:</span> <span class="p">(</span><span class="n">TABLEST</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_add_table_object</span><span class="p">),</span>
            <span class="s1">&#39;TABLEHT&#39;</span> <span class="p">:</span> <span class="p">(</span><span class="n">TABLEHT</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_add_table_object</span><span class="p">),</span>
            <span class="s1">&#39;TABLEH1&#39;</span> <span class="p">:</span> <span class="p">(</span><span class="n">TABLEH1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_add_table_object</span><span class="p">),</span>

            <span class="c1"># dynamic tables</span>
            <span class="s1">&#39;TABLED1&#39;</span> <span class="p">:</span> <span class="p">(</span><span class="n">TABLED1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_add_tabled_object</span><span class="p">),</span>
            <span class="s1">&#39;TABLED2&#39;</span> <span class="p">:</span> <span class="p">(</span><span class="n">TABLED2</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_add_tabled_object</span><span class="p">),</span>
            <span class="s1">&#39;TABLED3&#39;</span> <span class="p">:</span> <span class="p">(</span><span class="n">TABLED3</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_add_tabled_object</span><span class="p">),</span>
            <span class="s1">&#39;TABLED4&#39;</span> <span class="p">:</span> <span class="p">(</span><span class="n">TABLED4</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_add_tabled_object</span><span class="p">),</span>

            <span class="c1"># material tables</span>
            <span class="s1">&#39;TABLEM1&#39;</span> <span class="p">:</span> <span class="p">(</span><span class="n">TABLEM1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_add_tablem_object</span><span class="p">),</span>
            <span class="s1">&#39;TABLEM2&#39;</span> <span class="p">:</span> <span class="p">(</span><span class="n">TABLEM2</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_add_tablem_object</span><span class="p">),</span>
            <span class="s1">&#39;TABLEM3&#39;</span> <span class="p">:</span> <span class="p">(</span><span class="n">TABLEM3</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_add_tablem_object</span><span class="p">),</span>
            <span class="s1">&#39;TABLEM4&#39;</span> <span class="p">:</span> <span class="p">(</span><span class="n">TABLEM4</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_add_tablem_object</span><span class="p">),</span>

            <span class="c1"># other tables</span>
            <span class="s1">&#39;TABDMP1&#39;</span> <span class="p">:</span> <span class="p">(</span><span class="n">TABDMP1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_add_table_sdamping_object</span><span class="p">),</span>
            <span class="s1">&#39;TABRND1&#39;</span> <span class="p">:</span> <span class="p">(</span><span class="n">TABRND1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_add_random_table_object</span><span class="p">),</span>
            <span class="s1">&#39;TABRNDG&#39;</span> <span class="p">:</span> <span class="p">(</span><span class="n">TABRNDG</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_add_random_table_object</span><span class="p">),</span>

            <span class="s1">&#39;EIGB&#39;</span> <span class="p">:</span> <span class="p">(</span><span class="n">EIGB</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_add_method_object</span><span class="p">),</span>
            <span class="s1">&#39;EIGR&#39;</span> <span class="p">:</span> <span class="p">(</span><span class="n">EIGR</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_add_method_object</span><span class="p">),</span>
            <span class="s1">&#39;EIGRL&#39;</span> <span class="p">:</span> <span class="p">(</span><span class="n">EIGRL</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_add_method_object</span><span class="p">),</span>
            <span class="s1">&#39;EIGC&#39;</span> <span class="p">:</span> <span class="p">(</span><span class="n">EIGC</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_add_cmethod_object</span><span class="p">),</span>
            <span class="s1">&#39;EIGP&#39;</span> <span class="p">:</span> <span class="p">(</span><span class="n">EIGP</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_add_cmethod_object</span><span class="p">),</span>

            <span class="s1">&#39;BCRPARA&#39;</span> <span class="p">:</span> <span class="p">(</span><span class="n">BCRPARA</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_add_bcrpara_object</span><span class="p">),</span>
            <span class="s1">&#39;BCTADD&#39;</span> <span class="p">:</span> <span class="p">(</span><span class="n">BCTADD</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_add_bctadd_object</span><span class="p">),</span>
            <span class="s1">&#39;BCTPARA&#39;</span> <span class="p">:</span> <span class="p">(</span><span class="n">BCTPARA</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_add_bctpara_object</span><span class="p">),</span>
            <span class="s1">&#39;BSURF&#39;</span> <span class="p">:</span> <span class="p">(</span><span class="n">BSURF</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_add_bsurf_object</span><span class="p">),</span>
            <span class="s1">&#39;BSURFS&#39;</span> <span class="p">:</span> <span class="p">(</span><span class="n">BSURFS</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_add_bsurfs_object</span><span class="p">),</span>
            <span class="c1"># &#39;BGADD&#39;, &#39;BGSET&#39;, &#39;BOUTPUT&#39;, &#39;BOLT&#39;, &#39;BOLTFOR&#39;, &#39;BOLTFRC&#39;,</span>
            <span class="s1">&#39;BGADD&#39;</span><span class="p">:</span> <span class="p">(</span><span class="n">Crash</span><span class="p">,</span> <span class="kc">None</span><span class="p">),</span>
            <span class="s1">&#39;BGSET&#39;</span><span class="p">:</span> <span class="p">(</span><span class="n">Crash</span><span class="p">,</span> <span class="kc">None</span><span class="p">),</span>
            <span class="s1">&#39;BOUTPUT&#39;</span><span class="p">:</span> <span class="p">(</span><span class="n">Crash</span><span class="p">,</span> <span class="kc">None</span><span class="p">),</span>
            <span class="s1">&#39;BOLT&#39;</span><span class="p">:</span> <span class="p">(</span><span class="n">Crash</span><span class="p">,</span> <span class="kc">None</span><span class="p">),</span>
            <span class="s1">&#39;BOLTFOR&#39;</span><span class="p">:</span> <span class="p">(</span><span class="n">Crash</span><span class="p">,</span> <span class="kc">None</span><span class="p">),</span>
            <span class="s1">&#39;BOLTFRC&#39;</span><span class="p">:</span> <span class="p">(</span><span class="n">Crash</span><span class="p">,</span> <span class="kc">None</span><span class="p">),</span>

            <span class="s1">&#39;RADCAV&#39;</span> <span class="p">:</span> <span class="p">(</span><span class="n">RADCAV</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_add_radcav_object</span><span class="p">),</span> <span class="c1">#</span>
            <span class="c1">#&#39;RADLST&#39; : (RADLST, self._add_radcav_object), # TestOP2.test_bdf_op2_thermal_02</span>
            <span class="c1">#&#39;RADMTX&#39; : (RADMTX, self._add_radmtx_object), # TestOP2.test_bdf_op2_thermal_02</span>
            <span class="c1">#&#39;RADMT&#39; : (Crash, None),</span>

            <span class="s1">&#39;ASET&#39;</span> <span class="p">:</span> <span class="p">(</span><span class="n">ASET</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_add_aset_object</span><span class="p">),</span>
            <span class="s1">&#39;ASET1&#39;</span> <span class="p">:</span> <span class="p">(</span><span class="n">ASET1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_add_aset_object</span><span class="p">),</span>

            <span class="s1">&#39;BSET&#39;</span> <span class="p">:</span> <span class="p">(</span><span class="n">BSET</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_add_bset_object</span><span class="p">),</span>
            <span class="s1">&#39;BSET1&#39;</span> <span class="p">:</span> <span class="p">(</span><span class="n">BSET1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_add_bset_object</span><span class="p">),</span>

            <span class="s1">&#39;CSET&#39;</span> <span class="p">:</span> <span class="p">(</span><span class="n">CSET</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_add_cset_object</span><span class="p">),</span>
            <span class="s1">&#39;CSET1&#39;</span> <span class="p">:</span> <span class="p">(</span><span class="n">CSET1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_add_cset_object</span><span class="p">),</span>

            <span class="s1">&#39;QSET&#39;</span> <span class="p">:</span> <span class="p">(</span><span class="n">QSET</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_add_qset_object</span><span class="p">),</span>
            <span class="s1">&#39;QSET1&#39;</span> <span class="p">:</span> <span class="p">(</span><span class="n">QSET1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_add_qset_object</span><span class="p">),</span>

            <span class="s1">&#39;USET&#39;</span> <span class="p">:</span> <span class="p">(</span><span class="n">USET</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_add_uset_object</span><span class="p">),</span>
            <span class="s1">&#39;USET1&#39;</span> <span class="p">:</span> <span class="p">(</span><span class="n">USET1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_add_uset_object</span><span class="p">),</span>

            <span class="s1">&#39;OMIT&#39;</span> <span class="p">:</span> <span class="p">(</span><span class="n">OMIT</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_add_omit_object</span><span class="p">),</span>
            <span class="s1">&#39;OMIT1&#39;</span> <span class="p">:</span> <span class="p">(</span><span class="n">OMIT1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_add_omit_object</span><span class="p">),</span>

            <span class="s1">&#39;SET1&#39;</span> <span class="p">:</span> <span class="p">(</span><span class="n">SET1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_add_set_object</span><span class="p">),</span>
            <span class="s1">&#39;SET3&#39;</span> <span class="p">:</span> <span class="p">(</span><span class="n">SET3</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_add_set_object</span><span class="p">),</span>

            <span class="c1"># radset</span>
            <span class="s1">&#39;RADSET&#39;</span> <span class="p">:</span> <span class="p">(</span><span class="n">RADSET</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_add_radset_object</span><span class="p">),</span>

            <span class="s1">&#39;SESET&#39;</span> <span class="p">:</span> <span class="p">(</span><span class="n">SESET</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_add_seset_object</span><span class="p">),</span>

            <span class="s1">&#39;SEBSET&#39;</span> <span class="p">:</span> <span class="p">(</span><span class="n">SEBSET</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_add_sebset_object</span><span class="p">),</span>
            <span class="s1">&#39;SEBSET1&#39;</span> <span class="p">:</span> <span class="p">(</span><span class="n">SEBSET1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_add_sebset_object</span><span class="p">),</span>

            <span class="s1">&#39;SECSET&#39;</span> <span class="p">:</span> <span class="p">(</span><span class="n">SECSET</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_add_secset_object</span><span class="p">),</span>
            <span class="s1">&#39;SECSET1&#39;</span> <span class="p">:</span> <span class="p">(</span><span class="n">SECSET1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_add_secset_object</span><span class="p">),</span>

            <span class="s1">&#39;SEQSET&#39;</span> <span class="p">:</span> <span class="p">(</span><span class="n">SEQSET</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_add_seqset_object</span><span class="p">),</span>
            <span class="s1">&#39;SEQSET1&#39;</span> <span class="p">:</span> <span class="p">(</span><span class="n">SEQSET1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_add_seqset_object</span><span class="p">),</span>

            <span class="c1">#&#39;SESUP&#39; : (SESUP, self._add_sesup_object),  # pseudo-constraint</span>

            <span class="c1">#&#39;SEUSET&#39; : (SEUSET, self._add_seuset_object),</span>
            <span class="c1">#&#39;SEUSET1&#39; : (SEUSET1, self._add_seuset_object),</span>

            <span class="c1"># BCTSET</span>
            <span class="s1">&#39;ROTORG&#39;</span> <span class="p">:</span> <span class="p">(</span><span class="n">ROTORG</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_add_rotor_object</span><span class="p">),</span>
            <span class="s1">&#39;ROTORD&#39;</span> <span class="p">:</span> <span class="p">(</span><span class="n">ROTORD</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_add_rotor_object</span><span class="p">),</span>

            <span class="s1">&#39;DAREA&#39;</span> <span class="p">:</span> <span class="p">(</span><span class="n">DAREA</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_add_darea_object</span><span class="p">),</span>
            <span class="s1">&#39;DPHASE&#39;</span> <span class="p">:</span> <span class="p">(</span><span class="n">DPHASE</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_add_dphase_object</span><span class="p">),</span>
            <span class="s1">&#39;DELAY&#39;</span> <span class="p">:</span> <span class="p">(</span><span class="n">DELAY</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_add_delay_object</span><span class="p">),</span>

            <span class="s1">&#39;CYJOIN&#39;</span> <span class="p">:</span> <span class="p">(</span><span class="n">CYJOIN</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_add_cyjoin_object</span><span class="p">),</span>
        <span class="p">}</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_card_parser_prepare</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;PLOTEL&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_prepare_plotel</span><span class="p">,</span>
            <span class="s1">&#39;CBAR&#39;</span> <span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_prepare_cbar</span><span class="p">,</span>
            <span class="s1">&#39;CBEAM&#39;</span> <span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_prepare_cbeam</span><span class="p">,</span>
            <span class="s1">&#39;CTETRA&#39;</span> <span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_prepare_ctetra</span><span class="p">,</span>
            <span class="s1">&#39;CPENTA&#39;</span> <span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_prepare_cpenta</span><span class="p">,</span>
            <span class="s1">&#39;CHEXA&#39;</span> <span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_prepare_chexa</span><span class="p">,</span>
            <span class="s1">&#39;CPYRAM&#39;</span> <span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_prepare_cpyram</span><span class="p">,</span>

            <span class="s1">&#39;CORD1R&#39;</span> <span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_prepare_cord1r</span><span class="p">,</span>
            <span class="s1">&#39;CORD1C&#39;</span> <span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_prepare_cord1c</span><span class="p">,</span>
            <span class="s1">&#39;CORD1S&#39;</span> <span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_prepare_cord1s</span><span class="p">,</span>
            <span class="c1">#&#39;CORD3G&#39; : self._prepare_CORD3G,</span>

            <span class="s1">&#39;PMASS&#39;</span> <span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_prepare_pmass</span><span class="p">,</span>
            <span class="s1">&#39;CMASS4&#39;</span> <span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_prepare_cmass4</span><span class="p">,</span>
            <span class="s1">&#39;CDAMP4&#39;</span> <span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_prepare_cdamp4</span><span class="p">,</span>
            <span class="s1">&#39;DEFORM&#39;</span> <span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_prepare_deform</span><span class="p">,</span>  <span class="c1"># enforced displacement</span>

            <span class="s1">&#39;DTI&#39;</span> <span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_prepare_dti</span><span class="p">,</span>
            <span class="s1">&#39;DMIG&#39;</span> <span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_prepare_dmig</span><span class="p">,</span>
            <span class="s1">&#39;DMIAX&#39;</span> <span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_prepare_dmiax</span><span class="p">,</span>
            <span class="s1">&#39;DMI&#39;</span> <span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_prepare_dmi</span><span class="p">,</span>
            <span class="s1">&#39;DMIJ&#39;</span> <span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_prepare_dmij</span><span class="p">,</span>
            <span class="s1">&#39;DMIK&#39;</span> <span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_prepare_dmik</span><span class="p">,</span>
            <span class="s1">&#39;DMIJI&#39;</span> <span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_prepare_dmiji</span><span class="p">,</span>
            <span class="s1">&#39;RINGFL&#39;</span> <span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_prepare_ringfl</span><span class="p">,</span>

            <span class="s1">&#39;DEQATN&#39;</span> <span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_prepare_dequatn</span><span class="p">,</span>

            <span class="s1">&#39;NSM&#39;</span> <span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_prepare_nsm</span><span class="p">,</span>
            <span class="s1">&#39;NSML&#39;</span> <span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_prepare_nsml</span><span class="p">,</span>
            <span class="s1">&#39;PVISC&#39;</span> <span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_prepare_pvisc</span><span class="p">,</span>
            <span class="s1">&#39;PELAS&#39;</span> <span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_prepare_pelas</span><span class="p">,</span>
            <span class="s1">&#39;PDAMP&#39;</span> <span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_prepare_pdamp</span><span class="p">,</span>

            <span class="s1">&#39;TEMPAX&#39;</span> <span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_prepare_tempax</span><span class="p">,</span>
            <span class="s1">&#39;TEMPD&#39;</span> <span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_prepare_tempd</span><span class="p">,</span>
            <span class="s1">&#39;TEMPBC&#39;</span> <span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_prepare_tempbc</span><span class="p">,</span>
            <span class="s1">&#39;CONVM&#39;</span> <span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_prepare_convm</span><span class="p">,</span>
            <span class="s1">&#39;CONV&#39;</span> <span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_prepare_conv</span><span class="p">,</span>
            <span class="s1">&#39;RADM&#39;</span> <span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_prepare_radm</span><span class="p">,</span>
            <span class="s1">&#39;RADBC&#39;</span> <span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_prepare_radbc</span><span class="p">,</span>
            <span class="c1"># GRDSET-will be last card to update from _card_parser_prepare</span>
            <span class="s1">&#39;GRDSET&#39;</span> <span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_prepare_grdset</span><span class="p">,</span>

            <span class="s1">&#39;BCTSET&#39;</span> <span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_prepare_bctset</span><span class="p">,</span>
            <span class="s1">&#39;ACMODL&#39;</span> <span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_prepare_acmodl</span><span class="p">,</span>
        <span class="p">}</span>

        <span class="n">new_reject_method</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="k">if</span> <span class="n">new_reject_method</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">cards_to_read</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="s1">&#39;CONM2&#39;</span><span class="p">)</span>
            <span class="c1"># bwb_saero: 6.37-6.57 before using</span>

            <span class="n">all_cards</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_card_parser</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">_card_parser_prepare</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
            <span class="n">reject_cards</span> <span class="o">=</span> <span class="n">all_cards</span><span class="o">.</span><span class="n">difference</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">cards_to_read</span><span class="p">)</span>
            <span class="c1">#print(&#39;reject_cards =&#39;, reject_cards)</span>
            <span class="k">for</span> <span class="n">card_name</span> <span class="ow">in</span> <span class="n">reject_cards</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">card_name</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_card_parser</span><span class="p">:</span>
                    <span class="k">del</span> <span class="bp">self</span><span class="o">.</span><span class="n">_card_parser</span><span class="p">[</span><span class="n">card_name</span><span class="p">]</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_card_parser_prepare</span><span class="p">[</span><span class="n">card_name</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_reject_card_obj2</span>

    <span class="k">def</span> <span class="nf">_reject_card_obj2</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">unused_card_name</span><span class="p">,</span> <span class="n">card_obj</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;rejects a card object&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">reject_cards</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">card_obj</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">reject_card_lines</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">card_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">card_lines</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span>
                          <span class="n">show_log</span><span class="p">:</span> <span class="nb">bool</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">comment</span><span class="p">:</span> <span class="nb">str</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;rejects a card&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">card_name</span><span class="o">.</span><span class="n">isdigit</span><span class="p">():</span>
            <span class="c1"># TODO: this should technically work (I think), but it&#39;s a problem</span>
            <span class="c1">#       for the code</span>
            <span class="c1">#</span>
            <span class="c1"># prevents:</span>
            <span class="c1"># spc1,100,456,10013832,10013833,10013830,10013831,10013836,10013837,</span>
            <span class="c1"># 10013834,10013835,10013838,10013839,10014508,10008937,10008936,10008935,</span>
            <span class="n">msg</span> <span class="o">=</span> <span class="s1">&#39;card_name=</span><span class="si">%r</span><span class="s1"> was misparsed...</span><span class="se">\n</span><span class="s1">card_lines=</span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span>
                <span class="n">card_name</span><span class="p">,</span> <span class="n">card_lines</span><span class="p">)</span>
            <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">card_name</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">card_count</span><span class="p">:</span>
            <span class="n">_check_for_spaces</span><span class="p">(</span><span class="n">card_name</span><span class="p">,</span> <span class="n">card_lines</span><span class="p">,</span> <span class="n">comment</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">card_name</span> <span class="o">==</span> <span class="s1">&#39;</span><span class="se">\ufeff</span><span class="s1">&#39;</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s1">&#39;    rejecting card_name = </span><span class="si">%r</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">card_name</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s1">&#39;    comment:</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
                <span class="nb">print</span><span class="p">(</span><span class="n">comment</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s1">&#39;    lines:</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
                <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">card_lines</span><span class="p">:</span>
                    <span class="nb">print</span><span class="p">(</span><span class="n">line</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">show_log</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s1">&#39;    rejecting card_name = </span><span class="si">%r</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">card_name</span><span class="p">)</span>
            <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">show_log</span><span class="p">,</span> <span class="nb">bool</span><span class="p">),</span> <span class="n">show_log</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">increase_card_count</span><span class="p">(</span><span class="n">card_name</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">reject_lines</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">_format_comment</span><span class="p">(</span><span class="n">comment</span><span class="p">)]</span> <span class="o">+</span> <span class="n">card_lines</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_write_reject_message</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">card_name</span><span class="p">,</span> <span class="n">unused_card_obj</span><span class="p">,</span> <span class="n">comment</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;common method to not write duplicate reject card names&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">card_name</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">card_count</span><span class="p">:</span>
            <span class="c1">#if &#39; &#39; in card_name:</span>
                <span class="c1">#_check_for_spaces(card_name, card_lines, comment, self.log)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s1">&#39;    rejecting card_name = </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">card_name</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_prepare_plotel</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">unused_card</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="n">card_obj</span><span class="p">:</span> <span class="n">BDFCard</span><span class="p">,</span> <span class="n">comment</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;adds a PLOTEL&quot;&quot;&quot;</span>
        <span class="c1">#[&#39;PLOTEL&#39;, &#39;3101&#39;, &#39;3101&#39;, &#39;3102&#39;, None, &#39;3102&#39;, &#39;3102&#39;, &#39;3103&#39;]</span>
        <span class="n">plotels</span> <span class="o">=</span> <span class="p">[</span><span class="n">PLOTEL</span><span class="o">.</span><span class="n">add_card</span><span class="p">(</span><span class="n">card_obj</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">comment</span><span class="o">=</span><span class="n">comment</span><span class="p">)]</span>
        <span class="k">if</span> <span class="n">card_obj</span><span class="o">.</span><span class="n">field</span><span class="p">(</span><span class="mi">5</span><span class="p">):</span>  <span class="c1"># eid</span>
            <span class="n">plotels</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">PLOTEL</span><span class="o">.</span><span class="n">add_card</span><span class="p">(</span><span class="n">card_obj</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">comment</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">))</span>
        <span class="k">for</span> <span class="n">plotel</span> <span class="ow">in</span> <span class="n">plotels</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_add_plotel_object</span><span class="p">(</span><span class="n">plotel</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">plotels</span>

    <span class="k">def</span> <span class="nf">_prepare_cbar</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">unused_card</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="n">card_obj</span><span class="p">:</span> <span class="n">BDFCard</span><span class="p">,</span> <span class="n">comment</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;adds a CBAR&quot;&quot;&quot;</span>
        <span class="n">elem</span> <span class="o">=</span> <span class="n">CBAR</span><span class="o">.</span><span class="n">add_card</span><span class="p">(</span><span class="n">card_obj</span><span class="p">,</span> <span class="n">baror</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">baror</span><span class="p">,</span> <span class="n">comment</span><span class="o">=</span><span class="n">comment</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_add_element_object</span><span class="p">(</span><span class="n">elem</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">elem</span>

    <span class="k">def</span> <span class="nf">_prepare_cbeam</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">unused_card</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="n">card_obj</span><span class="p">:</span> <span class="n">BDFCard</span><span class="p">,</span> <span class="n">comment</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;adds a CBEAM&quot;&quot;&quot;</span>
        <span class="n">elem</span> <span class="o">=</span> <span class="n">CBEAM</span><span class="o">.</span><span class="n">add_card</span><span class="p">(</span><span class="n">card_obj</span><span class="p">,</span> <span class="n">beamor</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">beamor</span><span class="p">,</span> <span class="n">comment</span><span class="o">=</span><span class="n">comment</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_add_element_object</span><span class="p">(</span><span class="n">elem</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">elem</span>

    <span class="k">def</span> <span class="nf">_prepare_ctetra</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">unused_card</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="n">card_obj</span><span class="p">:</span> <span class="n">BDFCard</span><span class="p">,</span> <span class="n">comment</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;adds a CTETRA4/CTETRA10&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">card_obj</span><span class="p">)</span> <span class="o">==</span> <span class="mi">7</span><span class="p">:</span>
            <span class="n">elem</span> <span class="o">=</span> <span class="n">CTETRA4</span><span class="o">.</span><span class="n">add_card</span><span class="p">(</span><span class="n">card_obj</span><span class="p">,</span> <span class="n">comment</span><span class="o">=</span><span class="n">comment</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">elem</span> <span class="o">=</span> <span class="n">CTETRA10</span><span class="o">.</span><span class="n">add_card</span><span class="p">(</span><span class="n">card_obj</span><span class="p">,</span> <span class="n">comment</span><span class="o">=</span><span class="n">comment</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_add_element_object</span><span class="p">(</span><span class="n">elem</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">elem</span>

    <span class="k">def</span> <span class="nf">_prepare_cpyram</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">unused_card</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="n">card_obj</span><span class="p">:</span> <span class="n">BDFCard</span><span class="p">,</span> <span class="n">comment</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;adds a CPYRAM5/CPYRAM13&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">card_obj</span><span class="p">)</span> <span class="o">==</span> <span class="mi">8</span><span class="p">:</span>
            <span class="n">elem</span> <span class="o">=</span> <span class="n">CPYRAM5</span><span class="o">.</span><span class="n">add_card</span><span class="p">(</span><span class="n">card_obj</span><span class="p">,</span> <span class="n">comment</span><span class="o">=</span><span class="n">comment</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">elem</span> <span class="o">=</span> <span class="n">CPYRAM13</span><span class="o">.</span><span class="n">add_card</span><span class="p">(</span><span class="n">card_obj</span><span class="p">,</span> <span class="n">comment</span><span class="o">=</span><span class="n">comment</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_add_element_object</span><span class="p">(</span><span class="n">elem</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">elem</span>

    <span class="k">def</span> <span class="nf">_prepare_cpenta</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">unused_card</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="n">card_obj</span><span class="p">:</span> <span class="n">BDFCard</span><span class="p">,</span> <span class="n">comment</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;adds a CPENTA6/CPENTA15&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">card_obj</span><span class="p">)</span> <span class="o">==</span> <span class="mi">9</span><span class="p">:</span>
            <span class="n">elem</span> <span class="o">=</span> <span class="n">CPENTA6</span><span class="o">.</span><span class="n">add_card</span><span class="p">(</span><span class="n">card_obj</span><span class="p">,</span> <span class="n">comment</span><span class="o">=</span><span class="n">comment</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">elem</span> <span class="o">=</span> <span class="n">CPENTA15</span><span class="o">.</span><span class="n">add_card</span><span class="p">(</span><span class="n">card_obj</span><span class="p">,</span> <span class="n">comment</span><span class="o">=</span><span class="n">comment</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_add_element_object</span><span class="p">(</span><span class="n">elem</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">elem</span>

    <span class="k">def</span> <span class="nf">_prepare_chexa</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">unused_card</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="n">card_obj</span><span class="p">:</span> <span class="n">BDFCard</span><span class="p">,</span> <span class="n">comment</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;adds a CHEXA8/CHEXA20&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">card_obj</span><span class="p">)</span> <span class="o">==</span> <span class="mi">11</span><span class="p">:</span>
            <span class="n">elem</span> <span class="o">=</span> <span class="n">CHEXA8</span><span class="o">.</span><span class="n">add_card</span><span class="p">(</span><span class="n">card_obj</span><span class="p">,</span> <span class="n">comment</span><span class="o">=</span><span class="n">comment</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">elem</span> <span class="o">=</span> <span class="n">CHEXA20</span><span class="o">.</span><span class="n">add_card</span><span class="p">(</span><span class="n">card_obj</span><span class="p">,</span> <span class="n">comment</span><span class="o">=</span><span class="n">comment</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_add_element_object</span><span class="p">(</span><span class="n">elem</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">elem</span>

    <span class="k">def</span> <span class="nf">_prepare_bctset</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">unused_card</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="n">card_obj</span><span class="p">:</span> <span class="n">BDFCard</span><span class="p">,</span> <span class="n">comment</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;adds a BCTSET&quot;&quot;&quot;</span>
        <span class="n">bctset</span> <span class="o">=</span> <span class="n">BCTSET</span><span class="o">.</span><span class="n">add_card</span><span class="p">(</span><span class="n">card_obj</span><span class="p">,</span> <span class="n">comment</span><span class="o">=</span><span class="n">comment</span><span class="p">,</span> <span class="n">sol</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">sol</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_add_bctset_object</span><span class="p">(</span><span class="n">bctset</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">bctset</span>

    <span class="k">def</span> <span class="nf">_prepare_grdset</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">unused_card</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="n">card_obj</span><span class="p">:</span> <span class="n">BDFCard</span><span class="p">,</span> <span class="n">comment</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;adds a GRDSET&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">grdset</span> <span class="o">=</span> <span class="n">GRDSET</span><span class="o">.</span><span class="n">add_card</span><span class="p">(</span><span class="n">card_obj</span><span class="p">,</span> <span class="n">comment</span><span class="o">=</span><span class="n">comment</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">grdset</span>

    <span class="k">def</span> <span class="nf">_prepare_cdamp4</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">unused_card</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="n">card_obj</span><span class="p">:</span> <span class="n">BDFCard</span><span class="p">,</span> <span class="n">comment</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;adds a CDAMP4&quot;&quot;&quot;</span>
        <span class="n">dampers</span> <span class="o">=</span> <span class="p">[</span><span class="n">CDAMP4</span><span class="o">.</span><span class="n">add_card</span><span class="p">(</span><span class="n">card_obj</span><span class="p">,</span> <span class="n">comment</span><span class="o">=</span><span class="n">comment</span><span class="p">)]</span>
        <span class="k">if</span> <span class="n">card_obj</span><span class="o">.</span><span class="n">field</span><span class="p">(</span><span class="mi">5</span><span class="p">):</span>
            <span class="n">dampers</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">CDAMP4</span><span class="o">.</span><span class="n">add_card</span><span class="p">(</span><span class="n">card_obj</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">comment</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">))</span>
        <span class="k">for</span> <span class="n">damper</span> <span class="ow">in</span> <span class="n">dampers</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_add_damper_object</span><span class="p">(</span><span class="n">damper</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">dampers</span>

    <span class="k">def</span> <span class="nf">_prepare_deform</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">unused_card</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="n">card_obj</span><span class="p">:</span> <span class="n">BDFCard</span><span class="p">,</span> <span class="n">comment</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;adds a DEFORM&quot;&quot;&quot;</span>
        <span class="n">loads</span> <span class="o">=</span> <span class="p">[</span><span class="n">DEFORM</span><span class="o">.</span><span class="n">add_card</span><span class="p">(</span><span class="n">card_obj</span><span class="p">,</span> <span class="n">comment</span><span class="o">=</span><span class="n">comment</span><span class="p">)]</span>
        <span class="k">if</span> <span class="n">card_obj</span><span class="o">.</span><span class="n">field</span><span class="p">(</span><span class="mi">4</span><span class="p">):</span>
            <span class="n">loads</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">DEFORM</span><span class="o">.</span><span class="n">add_card</span><span class="p">(</span><span class="n">card_obj</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">comment</span><span class="o">=</span><span class="n">comment</span><span class="p">))</span>
        <span class="k">if</span> <span class="n">card_obj</span><span class="o">.</span><span class="n">field</span><span class="p">(</span><span class="mi">6</span><span class="p">):</span>
            <span class="n">loads</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">DEFORM</span><span class="o">.</span><span class="n">add_card</span><span class="p">(</span><span class="n">card_obj</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">comment</span><span class="o">=</span><span class="n">comment</span><span class="p">))</span>
        <span class="k">for</span> <span class="n">loadi</span> <span class="ow">in</span> <span class="n">loads</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_add_load_object</span><span class="p">(</span><span class="n">loadi</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">loads</span>

    <span class="k">def</span> <span class="nf">_prepare_tempbc</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">unused_card</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="n">card_obj</span><span class="p">:</span> <span class="n">BDFCard</span><span class="p">,</span> <span class="n">comment</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;adds a TEMPBC&quot;&quot;&quot;</span>
        <span class="n">boundary_condition</span> <span class="o">=</span> <span class="n">TEMPBC</span><span class="o">.</span><span class="n">add_card</span><span class="p">(</span><span class="n">card_obj</span><span class="p">,</span> <span class="n">comment</span><span class="o">=</span><span class="n">comment</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_add_thermal_bc_object</span><span class="p">(</span><span class="n">boundary_condition</span><span class="p">,</span> <span class="n">boundary_condition</span><span class="o">.</span><span class="n">eid</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">boundary_condition</span>

    <span class="k">def</span> <span class="nf">_prepare_convm</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">unused_card</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="n">card_obj</span><span class="p">:</span> <span class="n">BDFCard</span><span class="p">,</span> <span class="n">comment</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;adds a CONVM&quot;&quot;&quot;</span>
        <span class="n">boundary_condition</span> <span class="o">=</span> <span class="n">CONVM</span><span class="o">.</span><span class="n">add_card</span><span class="p">(</span><span class="n">card_obj</span><span class="p">,</span> <span class="n">comment</span><span class="o">=</span><span class="n">comment</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_add_thermal_bc_object</span><span class="p">(</span><span class="n">boundary_condition</span><span class="p">,</span> <span class="n">boundary_condition</span><span class="o">.</span><span class="n">eid</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">boundary_condition</span>

    <span class="k">def</span> <span class="nf">_prepare_conv</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">unused_card</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="n">card_obj</span><span class="p">:</span> <span class="n">BDFCard</span><span class="p">,</span> <span class="n">comment</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;adds a CONV&quot;&quot;&quot;</span>
        <span class="n">boundary_condition</span> <span class="o">=</span> <span class="n">CONV</span><span class="o">.</span><span class="n">add_card</span><span class="p">(</span><span class="n">card_obj</span><span class="p">,</span> <span class="n">comment</span><span class="o">=</span><span class="n">comment</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_add_thermal_bc_object</span><span class="p">(</span><span class="n">boundary_condition</span><span class="p">,</span> <span class="n">boundary_condition</span><span class="o">.</span><span class="n">eid</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">boundary_condition</span>

    <span class="k">def</span> <span class="nf">_prepare_radm</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">unused_card</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="n">card_obj</span><span class="p">:</span> <span class="n">BDFCard</span><span class="p">,</span> <span class="n">comment</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;adds a RADM&quot;&quot;&quot;</span>
        <span class="n">boundary_condition</span> <span class="o">=</span> <span class="n">RADM</span><span class="o">.</span><span class="n">add_card</span><span class="p">(</span><span class="n">card_obj</span><span class="p">,</span> <span class="n">comment</span><span class="o">=</span><span class="n">comment</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_add_thermal_bc_object</span><span class="p">(</span><span class="n">boundary_condition</span><span class="p">,</span> <span class="n">boundary_condition</span><span class="o">.</span><span class="n">radmid</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">boundary_condition</span>

    <span class="k">def</span> <span class="nf">_prepare_radbc</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">unused_card</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="n">card_obj</span><span class="p">:</span> <span class="n">BDFCard</span><span class="p">,</span> <span class="n">comment</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;adds a RADBC&quot;&quot;&quot;</span>
        <span class="n">boundary_condition</span> <span class="o">=</span> <span class="n">RADBC</span><span class="o">.</span><span class="n">add_card</span><span class="p">(</span><span class="n">card_obj</span><span class="p">,</span> <span class="n">comment</span><span class="o">=</span><span class="n">comment</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_add_thermal_bc_object</span><span class="p">(</span><span class="n">boundary_condition</span><span class="p">,</span> <span class="n">boundary_condition</span><span class="o">.</span><span class="n">nodamb</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">boundary_condition</span>

    <span class="k">def</span> <span class="nf">_prepare_tempd</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">unused_card</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="n">card_obj</span><span class="p">:</span> <span class="n">BDFCard</span><span class="p">,</span> <span class="n">comment</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;adds a TEMPD&quot;&quot;&quot;</span>
        <span class="n">tempds</span> <span class="o">=</span> <span class="p">[</span><span class="n">TEMPD</span><span class="o">.</span><span class="n">add_card</span><span class="p">(</span><span class="n">card_obj</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">comment</span><span class="o">=</span><span class="n">comment</span><span class="p">)]</span>
        <span class="k">if</span> <span class="n">card_obj</span><span class="o">.</span><span class="n">field</span><span class="p">(</span><span class="mi">3</span><span class="p">):</span>
            <span class="n">tempds</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">TEMPD</span><span class="o">.</span><span class="n">add_card</span><span class="p">(</span><span class="n">card_obj</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">comment</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">))</span>
            <span class="k">if</span> <span class="n">card_obj</span><span class="o">.</span><span class="n">field</span><span class="p">(</span><span class="mi">5</span><span class="p">):</span>
                <span class="n">tempds</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">TEMPD</span><span class="o">.</span><span class="n">add_card</span><span class="p">(</span><span class="n">card_obj</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">comment</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">))</span>
                <span class="k">if</span> <span class="n">card_obj</span><span class="o">.</span><span class="n">field</span><span class="p">(</span><span class="mi">7</span><span class="p">):</span>
                    <span class="n">tempds</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">TEMPD</span><span class="o">.</span><span class="n">add_card</span><span class="p">(</span><span class="n">card_obj</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">comment</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">))</span>
        <span class="k">for</span> <span class="n">tempd</span> <span class="ow">in</span> <span class="n">tempds</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_add_tempd_object</span><span class="p">(</span><span class="n">tempd</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">tempds</span>

    <span class="k">def</span> <span class="nf">_prepare_tempax</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">unused_card</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="n">card_obj</span><span class="p">:</span> <span class="n">BDFCard</span><span class="p">,</span> <span class="n">comment</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;adds a TEMPAX&quot;&quot;&quot;</span>
        <span class="n">tempaxs</span> <span class="o">=</span> <span class="p">[</span><span class="n">TEMPAX</span><span class="o">.</span><span class="n">add_card</span><span class="p">(</span><span class="n">card_obj</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">comment</span><span class="o">=</span><span class="n">comment</span><span class="p">)]</span>
        <span class="k">if</span> <span class="n">card_obj</span><span class="o">.</span><span class="n">field</span><span class="p">(</span><span class="mi">5</span><span class="p">):</span>
            <span class="n">tempaxs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">TEMPAX</span><span class="o">.</span><span class="n">add_card</span><span class="p">(</span><span class="n">card_obj</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">comment</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">))</span>
        <span class="k">for</span> <span class="n">tempax</span> <span class="ow">in</span> <span class="n">tempaxs</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_add_load_object</span><span class="p">(</span><span class="n">tempax</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">tempaxs</span>

    <span class="k">def</span> <span class="nf">_prepare_dequatn</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">unused_card</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="n">card_obj</span><span class="p">:</span> <span class="n">BDFCard</span><span class="p">,</span> <span class="n">comment</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;adds a DEQATN&quot;&quot;&quot;</span>
        <span class="n">deqatn</span> <span class="o">=</span> <span class="n">DEQATN</span><span class="o">.</span><span class="n">add_card</span><span class="p">(</span><span class="n">card_obj</span><span class="p">,</span> <span class="n">comment</span><span class="o">=</span><span class="n">comment</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_add_deqatn_object</span><span class="p">(</span><span class="n">deqatn</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">deqatn</span>

    <span class="k">def</span> <span class="nf">_prepare_dti</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">unused_card_name</span><span class="p">,</span> <span class="n">card_obj</span><span class="p">,</span> <span class="n">comment</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;adds a DTI&quot;&quot;&quot;</span>
        <span class="c1">#name = string(card_obj, 1, &#39;name&#39;)</span>
        <span class="n">dti</span> <span class="o">=</span> <span class="n">DTI</span><span class="o">.</span><span class="n">add_card</span><span class="p">(</span><span class="n">card_obj</span><span class="p">,</span> <span class="n">comment</span><span class="o">=</span><span class="n">comment</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_add_dti_object</span><span class="p">(</span><span class="n">dti</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">dti</span>

    <span class="k">def</span> <span class="nf">_prepare_dmig</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">unused_card</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="n">card_obj</span><span class="p">:</span> <span class="n">BDFCard</span><span class="p">,</span> <span class="n">comment</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;adds a DMIG&quot;&quot;&quot;</span>
        <span class="n">name</span> <span class="o">=</span> <span class="n">string</span><span class="p">(</span><span class="n">card_obj</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;name&#39;</span><span class="p">)</span>
        <span class="n">field2</span> <span class="o">=</span> <span class="n">integer_or_string</span><span class="p">(</span><span class="n">card_obj</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;flag&#39;</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">name</span> <span class="o">==</span> <span class="s1">&#39;UACCEL&#39;</span><span class="p">:</span>  <span class="c1"># special DMIG card</span>
            <span class="k">if</span> <span class="n">field2</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">dmig</span> <span class="o">=</span> <span class="n">DMIG_UACCEL</span><span class="o">.</span><span class="n">add_card</span><span class="p">(</span><span class="n">card_obj</span><span class="p">,</span> <span class="n">comment</span><span class="o">=</span><span class="n">comment</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_add_dmig_object</span><span class="p">(</span><span class="n">dmig</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">dmig</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_dmig_temp</span><span class="p">[</span><span class="n">name</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">card_obj</span><span class="p">,</span> <span class="n">comment</span><span class="p">))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">field2</span> <span class="o">=</span> <span class="n">integer_or_string</span><span class="p">(</span><span class="n">card_obj</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;flag&#39;</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">field2</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">dmig</span> <span class="o">=</span> <span class="n">DMIG</span><span class="o">.</span><span class="n">add_card</span><span class="p">(</span><span class="n">card_obj</span><span class="p">,</span> <span class="n">comment</span><span class="o">=</span><span class="n">comment</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_add_dmig_object</span><span class="p">(</span><span class="n">dmig</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">dmig</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_dmig_temp</span><span class="p">[</span><span class="n">name</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">card_obj</span><span class="p">,</span> <span class="n">comment</span><span class="p">))</span>
        <span class="k">return</span> <span class="n">dmig</span>

    <span class="k">def</span> <span class="nf">_prepare_dmix</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">class_obj</span><span class="p">,</span> <span class="n">add_method</span><span class="p">,</span> <span class="n">card_obj</span><span class="p">,</span> <span class="n">comment</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;adds a DMI, DMIJ, DMIJI, or DMIK&quot;&quot;&quot;</span>
        <span class="n">field2</span> <span class="o">=</span> <span class="n">integer</span><span class="p">(</span><span class="n">card_obj</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;flag&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">field2</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">dmix</span> <span class="o">=</span> <span class="n">class_obj</span><span class="o">.</span><span class="n">add_card</span><span class="p">(</span><span class="n">card_obj</span><span class="p">,</span> <span class="n">comment</span><span class="o">=</span><span class="n">comment</span><span class="p">)</span>
            <span class="n">add_method</span><span class="p">(</span><span class="n">dmix</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">dmix</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
            <span class="n">name</span> <span class="o">=</span> <span class="n">string</span><span class="p">(</span><span class="n">card_obj</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;name&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_dmig_temp</span><span class="p">[</span><span class="n">name</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">card_obj</span><span class="p">,</span> <span class="n">comment</span><span class="p">))</span>
        <span class="k">return</span> <span class="n">dmix</span>

    <span class="k">def</span> <span class="nf">_prepare_dmiax</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">unused_card</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="n">card_obj</span><span class="p">:</span> <span class="n">BDFCard</span><span class="p">,</span> <span class="n">comment</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;adds a DMIAX&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_prepare_dmix</span><span class="p">(</span><span class="n">DMIAX</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_add_dmiax_object</span><span class="p">,</span> <span class="n">card_obj</span><span class="p">,</span> <span class="n">comment</span><span class="o">=</span><span class="n">comment</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_prepare_dmi</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">unused_card</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="n">card_obj</span><span class="p">:</span> <span class="n">BDFCard</span><span class="p">,</span> <span class="n">comment</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;adds a DMI&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_prepare_dmix</span><span class="p">(</span><span class="n">DMI</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_add_dmi_object</span><span class="p">,</span> <span class="n">card_obj</span><span class="p">,</span> <span class="n">comment</span><span class="o">=</span><span class="n">comment</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_prepare_dmij</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">unused_card</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="n">card_obj</span><span class="p">:</span> <span class="n">BDFCard</span><span class="p">,</span> <span class="n">comment</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;adds a DMIJ&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_prepare_dmix</span><span class="p">(</span><span class="n">DMIJ</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_add_dmij_object</span><span class="p">,</span> <span class="n">card_obj</span><span class="p">,</span> <span class="n">comment</span><span class="o">=</span><span class="n">comment</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_prepare_dmik</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">unused_card</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="n">card_obj</span><span class="p">:</span> <span class="n">BDFCard</span><span class="p">,</span> <span class="n">comment</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;adds a DMIK&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_prepare_dmix</span><span class="p">(</span><span class="n">DMIK</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_add_dmik_object</span><span class="p">,</span> <span class="n">card_obj</span><span class="p">,</span> <span class="n">comment</span><span class="o">=</span><span class="n">comment</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_prepare_dmiji</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">unused_card</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="n">card_obj</span><span class="p">:</span> <span class="n">BDFCard</span><span class="p">,</span> <span class="n">comment</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;adds a DMIJI&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_prepare_dmix</span><span class="p">(</span><span class="n">DMIJI</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_add_dmiji_object</span><span class="p">,</span> <span class="n">card_obj</span><span class="p">,</span> <span class="n">comment</span><span class="o">=</span><span class="n">comment</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_prepare_cmass4</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">unused_card</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="n">card_obj</span><span class="p">:</span> <span class="n">BDFCard</span><span class="p">,</span> <span class="n">comment</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;adds a CMASS4&quot;&quot;&quot;</span>
        <span class="n">elements</span> <span class="o">=</span> <span class="p">[</span><span class="n">CMASS4</span><span class="o">.</span><span class="n">add_card</span><span class="p">(</span><span class="n">card_obj</span><span class="p">,</span> <span class="n">icard</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">comment</span><span class="o">=</span><span class="n">comment</span><span class="p">)]</span>
        <span class="k">if</span> <span class="n">card_obj</span><span class="o">.</span><span class="n">field</span><span class="p">(</span><span class="mi">5</span><span class="p">):</span>
            <span class="n">elements</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">CMASS4</span><span class="o">.</span><span class="n">add_card</span><span class="p">(</span><span class="n">card_obj</span><span class="p">,</span> <span class="n">icard</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">comment</span><span class="o">=</span><span class="n">comment</span><span class="p">))</span>
        <span class="k">for</span> <span class="n">elem</span> <span class="ow">in</span> <span class="n">elements</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_add_mass_object</span><span class="p">(</span><span class="n">elem</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">elements</span>

    <span class="k">def</span> <span class="nf">_prepare_pelas</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">unused_card</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="n">card_obj</span><span class="p">:</span> <span class="n">BDFCard</span><span class="p">,</span> <span class="n">comment</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;adds a PELAS&quot;&quot;&quot;</span>
        <span class="n">properties</span> <span class="o">=</span> <span class="p">[</span><span class="n">PELAS</span><span class="o">.</span><span class="n">add_card</span><span class="p">(</span><span class="n">card_obj</span><span class="p">,</span> <span class="n">icard</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">comment</span><span class="o">=</span><span class="n">comment</span><span class="p">)]</span>
        <span class="k">if</span> <span class="n">card_obj</span><span class="o">.</span><span class="n">field</span><span class="p">(</span><span class="mi">5</span><span class="p">):</span>
            <span class="n">properties</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">PELAS</span><span class="o">.</span><span class="n">add_card</span><span class="p">(</span><span class="n">card_obj</span><span class="p">,</span> <span class="n">icard</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">comment</span><span class="o">=</span><span class="n">comment</span><span class="p">))</span>
        <span class="k">for</span> <span class="n">prop</span> <span class="ow">in</span> <span class="n">properties</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_add_property_object</span><span class="p">(</span><span class="n">prop</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">properties</span>

    <span class="k">def</span> <span class="nf">_prepare_nsm</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">unused_card</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="n">card_obj</span><span class="p">:</span> <span class="n">BDFCard</span><span class="p">,</span> <span class="n">comment</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;adds an NSM&quot;&quot;&quot;</span>
        <span class="n">nfields</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">card_obj</span><span class="p">)</span>
        <span class="n">ncards</span> <span class="o">=</span> <span class="p">(</span><span class="n">nfields</span> <span class="o">-</span> <span class="mi">3</span><span class="p">)</span> <span class="o">//</span> <span class="mi">2</span>
        <span class="n">nextra</span> <span class="o">=</span> <span class="p">(</span><span class="n">nfields</span> <span class="o">-</span> <span class="mi">3</span><span class="p">)</span> <span class="o">%</span> <span class="mi">2</span>
        <span class="k">assert</span> <span class="n">nextra</span> <span class="o">==</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;NSM error; nfields=</span><span class="si">%s</span><span class="s1"> must have an odd number of fields</span><span class="se">\n</span><span class="s1">card=</span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span>
            <span class="n">nfields</span><span class="p">,</span> <span class="n">card_obj</span><span class="p">)</span>

        <span class="n">nsms</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">icard</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">ncards</span><span class="p">):</span>
            <span class="n">nsms</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">NSM</span><span class="o">.</span><span class="n">add_card</span><span class="p">(</span><span class="n">card_obj</span><span class="p">,</span> <span class="n">icard</span><span class="p">,</span> <span class="n">comment</span><span class="o">=</span><span class="n">comment</span><span class="p">))</span>
        <span class="k">for</span> <span class="n">nsm</span> <span class="ow">in</span> <span class="n">nsms</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_add_nsm_object</span><span class="p">(</span><span class="n">nsm</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">nsms</span>

    <span class="k">def</span> <span class="nf">_prepare_nsml</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">unused_card</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="n">card_obj</span><span class="p">:</span> <span class="n">BDFCard</span><span class="p">,</span> <span class="n">comment</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;adds an NSML&quot;&quot;&quot;</span>
        <span class="n">nfields</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">card_obj</span><span class="p">)</span>
        <span class="n">ncards</span> <span class="o">=</span> <span class="p">(</span><span class="n">nfields</span> <span class="o">-</span> <span class="mi">3</span><span class="p">)</span> <span class="o">//</span> <span class="mi">2</span>
        <span class="n">nextra</span> <span class="o">=</span> <span class="p">(</span><span class="n">nfields</span> <span class="o">-</span> <span class="mi">3</span><span class="p">)</span> <span class="o">%</span> <span class="mi">2</span>
        <span class="k">assert</span> <span class="n">nextra</span> <span class="o">==</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;NSML error; nfields=</span><span class="si">%s</span><span class="s1"> must have an odd number of fields</span><span class="se">\n</span><span class="s1">card=</span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span>
            <span class="n">nfields</span><span class="p">,</span> <span class="n">card_obj</span><span class="p">)</span>
        <span class="n">nsms</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">icard</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">ncards</span><span class="p">):</span>
            <span class="n">nsms</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">NSML</span><span class="o">.</span><span class="n">add_card</span><span class="p">(</span><span class="n">card_obj</span><span class="p">,</span> <span class="n">icard</span><span class="p">,</span> <span class="n">comment</span><span class="o">=</span><span class="n">comment</span><span class="p">))</span>
        <span class="k">for</span> <span class="n">nsm</span> <span class="ow">in</span> <span class="n">nsms</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_add_nsm_object</span><span class="p">(</span><span class="n">nsm</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">nsms</span>

    <span class="k">def</span> <span class="nf">_prepare_pvisc</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">unused_card</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="n">card_obj</span><span class="p">:</span> <span class="n">BDFCard</span><span class="p">,</span> <span class="n">comment</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;adds a PVISC&quot;&quot;&quot;</span>
        <span class="n">properties</span> <span class="o">=</span> <span class="p">[</span><span class="n">PVISC</span><span class="o">.</span><span class="n">add_card</span><span class="p">(</span><span class="n">card_obj</span><span class="p">,</span> <span class="n">icard</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">comment</span><span class="o">=</span><span class="n">comment</span><span class="p">)]</span>
        <span class="k">if</span> <span class="n">card_obj</span><span class="o">.</span><span class="n">field</span><span class="p">(</span><span class="mi">5</span><span class="p">):</span>
            <span class="n">properties</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">PVISC</span><span class="o">.</span><span class="n">add_card</span><span class="p">(</span><span class="n">card_obj</span><span class="p">,</span> <span class="n">icard</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">comment</span><span class="o">=</span><span class="n">comment</span><span class="p">))</span>
        <span class="k">for</span> <span class="n">prop</span> <span class="ow">in</span> <span class="n">properties</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_add_property_object</span><span class="p">(</span><span class="n">prop</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">properties</span>

    <span class="k">def</span> <span class="nf">_prepare_ringfl</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">unused_card</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="n">card_obj</span><span class="p">:</span> <span class="n">BDFCard</span><span class="p">,</span> <span class="n">comment</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;adds a RINGFL&quot;&quot;&quot;</span>
        <span class="n">rings</span> <span class="o">=</span> <span class="p">[</span><span class="n">RINGFL</span><span class="o">.</span><span class="n">add_card</span><span class="p">(</span><span class="n">card_obj</span><span class="p">,</span> <span class="n">icard</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">comment</span><span class="o">=</span><span class="n">comment</span><span class="p">)]</span>
        <span class="k">if</span> <span class="n">card_obj</span><span class="o">.</span><span class="n">field</span><span class="p">(</span><span class="mi">3</span><span class="p">):</span>
            <span class="n">rings</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">RINGFL</span><span class="o">.</span><span class="n">add_card</span><span class="p">(</span><span class="n">card_obj</span><span class="p">,</span> <span class="n">icard</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">comment</span><span class="o">=</span><span class="n">comment</span><span class="p">))</span>
        <span class="k">if</span> <span class="n">card_obj</span><span class="o">.</span><span class="n">field</span><span class="p">(</span><span class="mi">5</span><span class="p">):</span>
            <span class="n">rings</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">RINGFL</span><span class="o">.</span><span class="n">add_card</span><span class="p">(</span><span class="n">card_obj</span><span class="p">,</span> <span class="n">icard</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">comment</span><span class="o">=</span><span class="n">comment</span><span class="p">))</span>
        <span class="k">for</span> <span class="n">ring</span> <span class="ow">in</span> <span class="n">rings</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_add_ringfl_object</span><span class="p">(</span><span class="n">ring</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">rings</span>

    <span class="k">def</span> <span class="nf">_prepare_pdamp</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">unused_card</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="n">card_obj</span><span class="p">:</span> <span class="n">BDFCard</span><span class="p">,</span> <span class="n">comment</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;adds a PDAMP&quot;&quot;&quot;</span>
        <span class="n">properties</span> <span class="o">=</span> <span class="p">[</span><span class="n">PDAMP</span><span class="o">.</span><span class="n">add_card</span><span class="p">(</span><span class="n">card_obj</span><span class="p">,</span> <span class="n">icard</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">comment</span><span class="o">=</span><span class="n">comment</span><span class="p">)]</span>
        <span class="k">if</span> <span class="n">card_obj</span><span class="o">.</span><span class="n">field</span><span class="p">(</span><span class="mi">3</span><span class="p">):</span>
            <span class="n">properties</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">PDAMP</span><span class="o">.</span><span class="n">add_card</span><span class="p">(</span><span class="n">card_obj</span><span class="p">,</span> <span class="n">icard</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">comment</span><span class="o">=</span><span class="n">comment</span><span class="p">))</span>
        <span class="k">if</span> <span class="n">card_obj</span><span class="o">.</span><span class="n">field</span><span class="p">(</span><span class="mi">5</span><span class="p">):</span>
            <span class="n">properties</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">PDAMP</span><span class="o">.</span><span class="n">add_card</span><span class="p">(</span><span class="n">card_obj</span><span class="p">,</span> <span class="n">icard</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">comment</span><span class="o">=</span><span class="n">comment</span><span class="p">))</span>
        <span class="k">if</span> <span class="n">card_obj</span><span class="o">.</span><span class="n">field</span><span class="p">(</span><span class="mi">7</span><span class="p">):</span>
            <span class="n">properties</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">PDAMP</span><span class="o">.</span><span class="n">add_card</span><span class="p">(</span><span class="n">card_obj</span><span class="p">,</span> <span class="n">icard</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">comment</span><span class="o">=</span><span class="n">comment</span><span class="p">))</span>
        <span class="k">for</span> <span class="n">prop</span> <span class="ow">in</span> <span class="n">properties</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_add_property_object</span><span class="p">(</span><span class="n">prop</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">properties</span>

    <span class="k">def</span> <span class="nf">_prepare_pmass</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">unused_card</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="n">card_obj</span><span class="p">:</span> <span class="n">BDFCard</span><span class="p">,</span> <span class="n">comment</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;adds a PMASS&quot;&quot;&quot;</span>
        <span class="n">properties</span> <span class="o">=</span> <span class="p">[</span><span class="n">PMASS</span><span class="o">.</span><span class="n">add_card</span><span class="p">(</span><span class="n">card_obj</span><span class="p">,</span> <span class="n">icard</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">comment</span><span class="o">=</span><span class="n">comment</span><span class="p">)]</span>
        <span class="k">for</span> <span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">([</span><span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">7</span><span class="p">]):</span>
            <span class="k">if</span> <span class="n">card_obj</span><span class="o">.</span><span class="n">field</span><span class="p">(</span><span class="n">j</span><span class="p">):</span>
                <span class="n">properties</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">PMASS</span><span class="o">.</span><span class="n">add_card</span><span class="p">(</span><span class="n">card_obj</span><span class="p">,</span> <span class="n">icard</span><span class="o">=</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="n">comment</span><span class="o">=</span><span class="n">comment</span><span class="p">))</span>
        <span class="k">for</span> <span class="n">prop</span> <span class="ow">in</span> <span class="n">properties</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_add_property_mass_object</span><span class="p">(</span><span class="n">prop</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">properties</span>

    <span class="k">def</span> <span class="nf">_prepare_cord1r</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">unused_card</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="n">card_obj</span><span class="p">:</span> <span class="n">BDFCard</span><span class="p">,</span> <span class="n">comment</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;adds a CORD1R&quot;&quot;&quot;</span>
        <span class="n">coords</span> <span class="o">=</span> <span class="p">[</span><span class="n">CORD1R</span><span class="o">.</span><span class="n">add_card</span><span class="p">(</span><span class="n">card_obj</span><span class="p">,</span> <span class="n">comment</span><span class="o">=</span><span class="n">comment</span><span class="p">)]</span>
        <span class="k">if</span> <span class="n">card_obj</span><span class="o">.</span><span class="n">field</span><span class="p">(</span><span class="mi">5</span><span class="p">):</span>
            <span class="n">coords</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">CORD1R</span><span class="o">.</span><span class="n">add_card</span><span class="p">(</span><span class="n">card_obj</span><span class="p">,</span> <span class="n">icard</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">comment</span><span class="o">=</span><span class="n">comment</span><span class="p">))</span>
        <span class="k">for</span> <span class="n">coord</span> <span class="ow">in</span> <span class="n">coords</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_add_coord_object</span><span class="p">(</span><span class="n">coord</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">coords</span>

    <span class="k">def</span> <span class="nf">_prepare_cord1c</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">unused_card</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="n">card_obj</span><span class="p">:</span> <span class="n">BDFCard</span><span class="p">,</span> <span class="n">comment</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;adds a CORD1C&quot;&quot;&quot;</span>
        <span class="n">coords</span> <span class="o">=</span> <span class="p">[</span><span class="n">CORD1C</span><span class="o">.</span><span class="n">add_card</span><span class="p">(</span><span class="n">card_obj</span><span class="p">,</span> <span class="n">comment</span><span class="o">=</span><span class="n">comment</span><span class="p">)]</span>
        <span class="k">if</span> <span class="n">card_obj</span><span class="o">.</span><span class="n">field</span><span class="p">(</span><span class="mi">5</span><span class="p">):</span>
            <span class="n">coords</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">CORD1C</span><span class="o">.</span><span class="n">add_card</span><span class="p">(</span><span class="n">card_obj</span><span class="p">,</span> <span class="n">icard</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">comment</span><span class="o">=</span><span class="n">comment</span><span class="p">))</span>
        <span class="k">for</span> <span class="n">coord</span> <span class="ow">in</span> <span class="n">coords</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_add_coord_object</span><span class="p">(</span><span class="n">coord</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">coords</span>

    <span class="k">def</span> <span class="nf">_prepare_cord1s</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">unused_card</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="n">card_obj</span><span class="p">:</span> <span class="n">BDFCard</span><span class="p">,</span> <span class="n">comment</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;adds a CORD1S&quot;&quot;&quot;</span>
        <span class="n">coords</span> <span class="o">=</span> <span class="p">[</span><span class="n">CORD1S</span><span class="o">.</span><span class="n">add_card</span><span class="p">(</span><span class="n">card_obj</span><span class="p">,</span> <span class="n">comment</span><span class="o">=</span><span class="n">comment</span><span class="p">)]</span>
        <span class="k">if</span> <span class="n">card_obj</span><span class="o">.</span><span class="n">field</span><span class="p">(</span><span class="mi">5</span><span class="p">):</span>
            <span class="n">coords</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">CORD1S</span><span class="o">.</span><span class="n">add_card</span><span class="p">(</span><span class="n">card_obj</span><span class="p">,</span> <span class="n">icard</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">comment</span><span class="o">=</span><span class="n">comment</span><span class="p">))</span>
        <span class="k">for</span> <span class="n">coord</span> <span class="ow">in</span> <span class="n">coords</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_add_coord_object</span><span class="p">(</span><span class="n">coord</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">coords</span>

    <span class="k">def</span> <span class="nf">_prepare_acmodl</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">unused_card</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="n">card_obj</span><span class="p">:</span> <span class="n">BDFCard</span><span class="p">,</span> <span class="n">comment</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">acmodl</span> <span class="o">=</span> <span class="n">ACMODL</span><span class="o">.</span><span class="n">add_card</span><span class="p">(</span><span class="n">card_obj</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_nastran_format</span><span class="p">,</span> <span class="n">comment</span><span class="o">=</span><span class="n">comment</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_add_acmodl_object</span><span class="p">(</span><span class="n">acmodl</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">add_card_ifile</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ifile</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">card_lines</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="n">card_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
                       <span class="n">comment</span><span class="p">:</span> <span class="nb">str</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">is_list</span><span class="p">:</span> <span class="nb">bool</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">has_none</span><span class="p">:</span> <span class="nb">bool</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Any</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Same as ``add_card`` except it has an ifile parameter&quot;&quot;&quot;</span>
        <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">ifile</span><span class="p">,</span> <span class="p">(</span><span class="nb">int</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">int32</span><span class="p">)),</span> <span class="s1">&#39;ifile=</span><span class="si">%s</span><span class="s1"> type=</span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">ifile</span><span class="p">,</span> <span class="nb">type</span><span class="p">(</span><span class="n">ifile</span><span class="p">))</span>
        <span class="n">card_name</span> <span class="o">=</span> <span class="n">card_name</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span>
        <span class="n">card_obj</span><span class="p">,</span> <span class="n">unused_card</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">create_card_object</span><span class="p">(</span>
            <span class="n">card_lines</span><span class="p">,</span> <span class="n">card_name</span><span class="p">,</span>
            <span class="n">is_list</span><span class="o">=</span><span class="n">is_list</span><span class="p">,</span> <span class="n">has_none</span><span class="o">=</span><span class="n">has_none</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_add_card_helper_ifile</span><span class="p">(</span><span class="n">ifile</span><span class="p">,</span> <span class="n">card_obj</span><span class="p">,</span> <span class="n">card_name</span><span class="p">,</span> <span class="n">card_name</span><span class="p">,</span> <span class="n">comment</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">card_obj</span>

    <span class="k">def</span> <span class="nf">add_card</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">card_lines</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="n">card_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
                 <span class="n">comment</span><span class="p">:</span> <span class="nb">str</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">ifile</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">is_list</span><span class="p">:</span> <span class="nb">bool</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">has_none</span><span class="p">:</span> <span class="nb">bool</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Any</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Adds a card object to the BDF object.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        card_lines: list[str]</span>
<span class="sd">            the list of the card fields</span>
<span class="sd">        card_name : str</span>
<span class="sd">            the card_name -&gt; &#39;GRID&#39;</span>
<span class="sd">        comment : str</span>
<span class="sd">            an optional the comment for the card</span>
<span class="sd">        is_list : bool, optional</span>
<span class="sd">            False : input is a list of card fields -&gt; [&#39;GRID&#39;, 1, None, 3.0, 4.0, 5.0]</span>
<span class="sd">            True :  input is list of card_lines -&gt; [&#39;GRID, 1,, 3.0, 4.0, 5.0&#39;]</span>
<span class="sd">        has_none : bool; default=True</span>
<span class="sd">            can there be trailing Nones in the card data (e.g. [&#39;GRID&#39;, 1, 2, 3.0, 4.0, 5.0, None])</span>
<span class="sd">            can there be trailing Nones in the card data (e.g. [&#39;GRID, 1, 2, 3.0, 4.0, 5.0, &#39;])</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        card_object : BDFCard()</span>
<span class="sd">            the card object representation of card</span>

<span class="sd">        .. code-block:: python</span>

<span class="sd">           &gt;&gt;&gt; model = BDF()</span>

<span class="sd">           # is_list is a somewhat misleading name; is it a list of card_lines</span>
<span class="sd">           # where a card_line is an unparsed string</span>
<span class="sd">           &gt;&gt;&gt; card_lines = [&#39;GRID,1,2&#39;]</span>
<span class="sd">           &gt;&gt;&gt; comment = &#39;this is a comment&#39;</span>
<span class="sd">           &gt;&gt;&gt; model.add_card(card_lines, &#39;GRID&#39;, comment, is_list=True)</span>

<span class="sd">           # here is_list=False because it&#39;s been parsed</span>
<span class="sd">           &gt;&gt;&gt; card = [&#39;GRID&#39;, 1, 2,]</span>
<span class="sd">           &gt;&gt;&gt; model.add_card(card_lines, &#39;GRID&#39;, comment, is_list=False)</span>

<span class="sd">           # here is_list=False because it&#39;s been parsed</span>
<span class="sd">           # Note the None at the end of the 1st line, which is there</span>
<span class="sd">           #      because the CONM2 card has a blank field.</span>
<span class="sd">           #      It must be there.</span>
<span class="sd">           # We also set i32 on the 2nd line, so it will default to 0.0</span>
<span class="sd">           &gt;&gt;&gt; card = [</span>
<span class="sd">                   &#39;CONM2&#39;, eid, nid, cid, mass, x1, x2, x3, None,</span>
<span class="sd">                            i11, i21, i22, i31, None, i33,</span>
<span class="sd">               ]</span>
<span class="sd">           &gt;&gt;&gt; model.add_card(card_lines, &#39;CONM2&#39;, comment, is_list=False)</span>

<span class="sd">           # here&#39;s an alternate approach for the CONM2</span>
<span class="sd">           # we use Nastran&#39;s CSV format</span>
<span class="sd">           # There are many blank fields, but it&#39;s parsed exactly like a</span>
<span class="sd">           # standard CONM2.</span>
<span class="sd">           &gt;&gt;&gt; card = [</span>
<span class="sd">                   &#39;CONM2,1,2,3,10.0&#39;,</span>
<span class="sd">                   &#39;,1.0,,5.0&#39;</span>
<span class="sd">               ]</span>
<span class="sd">           &gt;&gt;&gt; model.add_card(card_lines, &#39;CONM2&#39;, comment, is_list=True)</span>

<span class="sd">        .. note:: this is a very useful method for interfacing with the code</span>
<span class="sd">        .. note:: the card_object is not a card-type object...so not a GRID</span>
<span class="sd">                  card or CQUAD4 object.  It&#39;s a BDFCard Object.  However,</span>
<span class="sd">                  you know the type (assuming a GRID), so just call the</span>
<span class="sd">                  *mesh.Node(nid)* to get the Node object that was just</span>
<span class="sd">                  created.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">card_name</span> <span class="o">=</span> <span class="n">card_name</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span>
        <span class="n">card_obj</span><span class="p">,</span> <span class="n">unused_card</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">create_card_object</span><span class="p">(</span>
            <span class="n">card_lines</span><span class="p">,</span> <span class="n">card_name</span><span class="p">,</span>
            <span class="n">is_list</span><span class="o">=</span><span class="n">is_list</span><span class="p">,</span> <span class="n">has_none</span><span class="o">=</span><span class="n">has_none</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_add_card_helper</span><span class="p">(</span><span class="n">card_obj</span><span class="p">,</span> <span class="n">card_name</span><span class="p">,</span> <span class="n">card_name</span><span class="p">,</span> <span class="n">ifile</span><span class="p">,</span> <span class="n">comment</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">card_obj</span>

    <span class="k">def</span> <span class="nf">add_card_fields</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">card_lines</span><span class="p">,</span> <span class="n">card_name</span><span class="p">,</span> <span class="n">comment</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">has_none</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Adds a card object to the BDF object.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        card_lines: list[str]</span>
<span class="sd">            the list of the card fields</span>
<span class="sd">            input is a list of card fields -&gt; [&#39;GRID&#39;, 1, 2, 3.0, 4.0, 5.0]</span>
<span class="sd">        card_name : str</span>
<span class="sd">            the card_name -&gt; &#39;GRID&#39;</span>
<span class="sd">        comment : str</span>
<span class="sd">            an optional the comment for the card</span>
<span class="sd">        has_none : bool; default=True</span>
<span class="sd">            can there be trailing Nones in the card data (e.g. [&#39;GRID&#39;, 1, 2, 3.0, 4.0, 5.0, None])</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        card_object : BDFCard()</span>
<span class="sd">            the card object representation of card</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">card_name</span> <span class="o">=</span> <span class="n">card_name</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span>
        <span class="n">card_obj</span><span class="p">,</span> <span class="n">card</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">create_card_object</span><span class="p">(</span><span class="n">card_lines</span><span class="p">,</span> <span class="n">card_name</span><span class="p">,</span>
                                                 <span class="n">is_list</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">has_none</span><span class="o">=</span><span class="n">has_none</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_add_card_helper</span><span class="p">(</span><span class="n">card_obj</span><span class="p">,</span> <span class="n">card</span><span class="p">,</span> <span class="n">card_name</span><span class="p">,</span> <span class="n">comment</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">add_card_lines</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">card_lines</span><span class="p">,</span> <span class="n">card_name</span><span class="p">,</span> <span class="n">comment</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">has_none</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Adds a card object to the BDF object.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        card_lines: list[str]</span>
<span class="sd">            the list of the card fields</span>
<span class="sd">            input is list of card_lines -&gt; [&#39;GRID, 1, 2, 3.0, 4.0, 5.0&#39;]</span>
<span class="sd">        card_name : str</span>
<span class="sd">            the card_name -&gt; &#39;GRID&#39;</span>
<span class="sd">        comment : str; default=&#39;&#39;</span>
<span class="sd">            an optional the comment for the card</span>
<span class="sd">        has_none : bool; default=True</span>
<span class="sd">            can there be trailing Nones in the card data (e.g. [&#39;GRID, 1, 2, 3.0, 4.0, 5.0, &#39;])</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">card_name</span> <span class="o">=</span> <span class="n">card_name</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span>
        <span class="n">card_obj</span><span class="p">,</span> <span class="n">card</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">create_card_object</span><span class="p">(</span><span class="n">card_lines</span><span class="p">,</span> <span class="n">card_name</span><span class="p">,</span>
                                                 <span class="n">is_list</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">has_none</span><span class="o">=</span><span class="n">has_none</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_add_card_helper</span><span class="p">(</span><span class="n">card_obj</span><span class="p">,</span> <span class="n">card</span><span class="p">,</span> <span class="n">card_name</span><span class="p">,</span> <span class="n">comment</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">get_xyz_in_coord_no_xref</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">cid</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">fdtype</span><span class="o">=</span><span class="s1">&#39;float64&#39;</span><span class="p">,</span> <span class="n">sort_ids</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;see get_xyz_in_coord&quot;&quot;&quot;</span>
        <span class="n">npoints</span><span class="p">,</span> <span class="n">nids</span><span class="p">,</span> <span class="n">all_nodes</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_npoints_nids_allnids</span><span class="p">()</span>

        <span class="n">xyz_cid0</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">npoints</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">fdtype</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">cid</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">nid</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">nids</span><span class="p">):</span>
                <span class="n">node</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">nodes</span><span class="p">[</span><span class="n">nid</span><span class="p">]</span>
                <span class="n">xyz</span> <span class="o">=</span> <span class="n">node</span><span class="o">.</span><span class="n">get_position_no_xref</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
                <span class="n">xyz_cid0</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="p">:]</span> <span class="o">=</span> <span class="n">xyz</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">nid</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">nids</span><span class="p">):</span>
                <span class="n">node</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">nodes</span><span class="p">[</span><span class="n">nid</span><span class="p">]</span>
                <span class="n">xyz</span> <span class="o">=</span> <span class="n">node</span><span class="o">.</span><span class="n">get_position_wrt_no_xref</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">cid</span><span class="p">)</span>
                <span class="n">xyz_cid0</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="p">:]</span> <span class="o">=</span> <span class="n">xyz</span>
        <span class="k">if</span> <span class="n">sort_ids</span><span class="p">:</span>
            <span class="n">isort</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argsort</span><span class="p">(</span><span class="n">all_nodes</span><span class="p">)</span>
            <span class="n">xyz_cid0</span> <span class="o">=</span> <span class="n">xyz_cid0</span><span class="p">[</span><span class="n">isort</span><span class="p">,</span> <span class="p">:]</span>
        <span class="k">return</span> <span class="n">all_nodes</span><span class="p">,</span> <span class="n">xyz_cid0</span>

    <span class="k">def</span> <span class="nf">_get_npoints_nids_allnids</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;helper method for get_xyz_in_coord&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_bdf_vectorized</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">nodes</span><span class="o">.</span><span class="n">nids</span>

        <span class="n">nnodes</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nodes</span><span class="p">)</span>
        <span class="n">nspoints</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">nepoints</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">nids</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">node_ids</span><span class="p">)</span>
        <span class="n">all_nodes</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">node_ids</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">spoints</span><span class="p">:</span>
            <span class="n">spoints</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">spoints</span><span class="p">)</span>
            <span class="n">nspoints</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">spoints</span><span class="p">)</span>
            <span class="n">all_nodes</span> <span class="o">+=</span> <span class="n">spoints</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">epoints</span><span class="p">:</span>
            <span class="n">epoints</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">epoints</span><span class="p">)</span>
            <span class="n">nepoints</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">epoints</span><span class="p">)</span>
            <span class="n">all_nodes</span> <span class="o">+=</span> <span class="n">epoints</span>
        <span class="c1">#self.log.debug(&#39;all_nodes = %s&#39; % all_nodes)</span>

        <span class="n">npoints</span> <span class="o">=</span> <span class="n">nnodes</span> <span class="o">+</span> <span class="n">nspoints</span> <span class="o">+</span> <span class="n">nepoints</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">all_nodes</span><span class="p">)</span> <span class="o">!=</span> <span class="n">npoints</span><span class="p">:</span>
            <span class="n">msg</span> <span class="o">=</span> <span class="s1">&#39;len(unique(all_nodes))=</span><span class="si">%s</span><span class="s1"> npoints=</span><span class="si">%s</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">all_nodes</span><span class="p">)),</span> <span class="n">npoints</span><span class="p">)</span>
            <span class="n">msg</span> <span class="o">+=</span> <span class="s1">&#39;npoints = nnodes+nspoints+nepoints = </span><span class="si">%s</span><span class="s1"> + </span><span class="si">%s</span><span class="s1"> + </span><span class="si">%s</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span>
                <span class="n">nnodes</span><span class="p">,</span> <span class="n">nspoints</span><span class="p">,</span> <span class="n">nepoints</span><span class="p">)</span>
            <span class="n">msg</span> <span class="o">+=</span> <span class="s1">&#39;all_nodes=</span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">all_nodes</span><span class="p">)</span>
            <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">npoints</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">msg</span> <span class="o">=</span> <span class="s1">&#39;nnodes=</span><span class="si">%s</span><span class="s1"> nspoints=</span><span class="si">%s</span><span class="s1"> nepoints=</span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">nnodes</span><span class="p">,</span> <span class="n">nspoints</span><span class="p">,</span> <span class="n">nepoints</span><span class="p">)</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">npoints</span><span class="p">,</span> <span class="n">nids</span><span class="p">,</span> <span class="n">all_nodes</span>

    <span class="k">def</span> <span class="nf">get_xyz_in_coord</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">cid</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">fdtype</span><span class="o">=</span><span class="s1">&#39;float64&#39;</span><span class="p">,</span> <span class="n">sort_ids</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Gets the xyz points (including SPOINTS) in the desired coordinate frame</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        cid : int; default=0</span>
<span class="sd">            the desired coordinate system</span>
<span class="sd">        fdtype : str; default=&#39;float64&#39;</span>
<span class="sd">            the data type of the xyz coordinates</span>
<span class="sd">        sort_ids : bool; default=True</span>
<span class="sd">            sort the ids</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        xyz : (n, 3) ndarray</span>
<span class="sd">            the xyz points in the cid coordinate frame</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1">#return self.get_displacement_index_xyz_cp_cd(cid=cid, fdtype=dtype)[2]</span>
        <span class="n">npoints</span><span class="p">,</span> <span class="n">nids</span><span class="p">,</span> <span class="n">all_nodes</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_npoints_nids_allnids</span><span class="p">()</span>
        <span class="n">xyz_cid0</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">npoints</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">fdtype</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">cid</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">nid</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">nids</span><span class="p">):</span>
                <span class="n">node</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">nodes</span><span class="p">[</span><span class="n">nid</span><span class="p">]</span>
                <span class="n">xyz</span> <span class="o">=</span> <span class="n">node</span><span class="o">.</span><span class="n">get_position</span><span class="p">()</span>
                <span class="n">xyz_cid0</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="p">:]</span> <span class="o">=</span> <span class="n">xyz</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">nid</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">nids</span><span class="p">):</span>
                <span class="n">node</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">nodes</span><span class="p">[</span><span class="n">nid</span><span class="p">]</span>
                <span class="n">xyz</span> <span class="o">=</span> <span class="n">node</span><span class="o">.</span><span class="n">get_position_wrt</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">cid</span><span class="p">)</span>
                <span class="n">xyz_cid0</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="p">:]</span> <span class="o">=</span> <span class="n">xyz</span>
        <span class="k">if</span> <span class="n">sort_ids</span><span class="p">:</span>
            <span class="n">isort</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argsort</span><span class="p">(</span><span class="n">all_nodes</span><span class="p">)</span>
            <span class="n">xyz_cid0</span> <span class="o">=</span> <span class="n">xyz_cid0</span><span class="p">[</span><span class="n">isort</span><span class="p">,</span> <span class="p">:]</span>
        <span class="k">return</span> <span class="n">xyz_cid0</span>

    <span class="k">def</span> <span class="nf">_add_card_helper_ifile</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ifile</span><span class="p">,</span> <span class="n">card_obj</span><span class="p">,</span> <span class="n">card</span><span class="p">,</span> <span class="n">card_name</span><span class="p">,</span> <span class="n">comment</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;See ``_add_card_helper``&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">card_name</span> <span class="o">==</span> <span class="s1">&#39;ECHOON&#39;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">echo</span> <span class="o">=</span> <span class="kc">True</span>
            <span class="k">return</span>
        <span class="k">elif</span> <span class="n">card_name</span> <span class="o">==</span> <span class="s1">&#39;ECHOOFF&#39;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">echo</span> <span class="o">=</span> <span class="kc">False</span>
            <span class="k">return</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">echo</span> <span class="ow">and</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">force_echo_off</span><span class="p">:</span>
            <span class="n">_echo_card</span><span class="p">(</span><span class="n">card</span><span class="p">,</span> <span class="n">card_obj</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">card_name</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_card_parser</span><span class="p">:</span>
            <span class="n">card_class</span><span class="p">,</span> <span class="n">add_card_function</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_card_parser</span><span class="p">[</span><span class="n">card_name</span><span class="p">]</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">class_instance</span> <span class="o">=</span> <span class="n">card_class</span><span class="o">.</span><span class="n">add_card</span><span class="p">(</span><span class="n">card_obj</span><span class="p">,</span> <span class="n">comment</span><span class="o">=</span><span class="n">comment</span><span class="p">)</span>
                <span class="n">class_instance</span><span class="o">.</span><span class="n">ifile</span> <span class="o">=</span> <span class="n">ifile</span>
                <span class="n">add_card_function</span><span class="p">(</span><span class="n">class_instance</span><span class="p">)</span>
            <span class="k">except</span> <span class="ne">TypeError</span><span class="p">:</span>
                <span class="c1"># this should never be turned on, but is useful for testing</span>
                <span class="n">msg</span> <span class="o">=</span> <span class="s1">&#39;problem adding </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">card_obj</span>
                <span class="nb">print</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
                <span class="k">raise</span>
            <span class="k">except</span> <span class="p">(</span><span class="ne">SyntaxError</span><span class="p">,</span> <span class="ne">AssertionError</span><span class="p">,</span> <span class="ne">KeyError</span><span class="p">,</span> <span class="ne">ValueError</span><span class="p">)</span> <span class="k">as</span> <span class="n">exception</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_iparse_errors</span> <span class="o">+=</span> <span class="mi">1</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="n">card_obj</span><span class="p">)</span>
                <span class="n">var</span> <span class="o">=</span> <span class="n">traceback</span><span class="o">.</span><span class="n">format_exception_only</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">exception</span><span class="p">),</span> <span class="n">exception</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_stored_parse_errors</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">card</span><span class="p">,</span> <span class="n">var</span><span class="p">))</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_iparse_errors</span> <span class="o">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">_nparse_errors</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">pop_parse_errors</span><span class="p">()</span>

        <span class="k">elif</span> <span class="n">card_name</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_card_parser_prepare</span><span class="p">:</span>
            <span class="n">add_card_function</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_card_parser_prepare</span><span class="p">[</span><span class="n">card_name</span><span class="p">]</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">obj</span> <span class="o">=</span> <span class="n">add_card_function</span><span class="p">(</span><span class="n">card</span><span class="p">,</span> <span class="n">card_obj</span><span class="p">,</span> <span class="n">comment</span><span class="o">=</span><span class="n">comment</span><span class="p">)</span>
            <span class="k">except</span> <span class="p">(</span><span class="ne">SyntaxError</span><span class="p">,</span> <span class="ne">AssertionError</span><span class="p">,</span> <span class="ne">KeyError</span><span class="p">,</span> <span class="ne">ValueError</span><span class="p">)</span> <span class="k">as</span> <span class="n">exception</span><span class="p">:</span>
                <span class="c1">#raise</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_iparse_errors</span> <span class="o">+=</span> <span class="mi">1</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="n">card_obj</span><span class="p">)</span>
                <span class="n">var</span> <span class="o">=</span> <span class="n">traceback</span><span class="o">.</span><span class="n">format_exception_only</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">exception</span><span class="p">),</span> <span class="n">exception</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_stored_parse_errors</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">card</span><span class="p">,</span> <span class="n">var</span><span class="p">))</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_iparse_errors</span> <span class="o">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">_nparse_errors</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">pop_parse_errors</span><span class="p">()</span>

            <span class="k">if</span> <span class="n">obj</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="n">add_card_function</span><span class="p">)</span>
                <span class="nb">print</span><span class="p">(</span><span class="n">card</span><span class="p">)</span>
                <span class="nb">print</span><span class="p">(</span><span class="n">card_obj</span><span class="p">)</span>
                <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s1">&#39;_prepare_</span><span class="si">%s</span><span class="s1"> needs to implement obj&#39;</span> <span class="o">%</span> <span class="n">card_name</span><span class="o">.</span><span class="n">lower</span><span class="p">())</span>
            <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
                <span class="k">for</span> <span class="n">obji</span> <span class="ow">in</span> <span class="n">obj</span><span class="p">:</span>
                    <span class="n">obji</span><span class="o">.</span><span class="n">ifile</span> <span class="o">=</span> <span class="n">ifile</span>
            <span class="k">elif</span> <span class="n">obj</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>
                <span class="k">pass</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">obj</span><span class="o">.</span><span class="n">ifile</span> <span class="o">=</span> <span class="n">ifile</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">reject_cards</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">card_obj</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_add_card_helper</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">card_obj</span><span class="p">:</span> <span class="n">BDFCard</span><span class="p">,</span> <span class="n">card</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span>
                         <span class="n">card_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">ifile</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
                         <span class="n">comment</span><span class="p">:</span> <span class="nb">str</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Adds a card object to the BDF object.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        card_object : BDFCard()</span>
<span class="sd">            the card object representation of card</span>
<span class="sd">        card : List[str]</span>
<span class="sd">            the fields of the card object; used for rejection and special cards</span>
<span class="sd">        card_name : str</span>
<span class="sd">            the card_name -&gt; &#39;GRID&#39;</span>
<span class="sd">        ifile : int</span>
<span class="sd">            the file number</span>
<span class="sd">        comment : str</span>
<span class="sd">            an optional the comment for the card</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">card_name</span> <span class="o">==</span> <span class="s1">&#39;ECHOON&#39;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">echo</span> <span class="o">=</span> <span class="kc">True</span>
            <span class="k">return</span>
        <span class="k">elif</span> <span class="n">card_name</span> <span class="o">==</span> <span class="s1">&#39;ECHOOFF&#39;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">echo</span> <span class="o">=</span> <span class="kc">False</span>
            <span class="k">return</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">echo</span> <span class="ow">and</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">force_echo_off</span><span class="p">:</span>
            <span class="n">_echo_card</span><span class="p">(</span><span class="n">card</span><span class="p">,</span> <span class="n">card_obj</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">card_name</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_card_parser</span><span class="p">:</span>
            <span class="n">card_class</span><span class="p">,</span> <span class="n">add_card_function</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_card_parser</span><span class="p">[</span><span class="n">card_name</span><span class="p">]</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">class_instance</span> <span class="o">=</span> <span class="n">card_class</span><span class="o">.</span><span class="n">add_card</span><span class="p">(</span><span class="n">card_obj</span><span class="p">,</span> <span class="n">comment</span><span class="o">=</span><span class="n">comment</span><span class="p">)</span>
                <span class="n">add_card_function</span><span class="p">(</span><span class="n">class_instance</span><span class="p">)</span>
            <span class="k">except</span> <span class="ne">TypeError</span><span class="p">:</span>
                <span class="c1"># this should never be turned on, but is useful for testing</span>
                <span class="n">msg</span> <span class="o">=</span> <span class="s1">&#39;problem adding </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">card_obj</span>
                <span class="nb">print</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
                <span class="k">raise</span>
                <span class="c1">#raise TypeError(msg)</span>
            <span class="k">except</span> <span class="p">(</span><span class="ne">SyntaxError</span><span class="p">,</span> <span class="ne">AssertionError</span><span class="p">,</span> <span class="ne">KeyError</span><span class="p">,</span> <span class="ne">ValueError</span><span class="p">)</span> <span class="k">as</span> <span class="n">exception</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;problem adding </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">card_obj</span><span class="p">)</span>
                <span class="c1">#msg = &#39;problem adding card from %s&#39; % self.active_filenames[ifile]</span>
                <span class="c1">#raise</span>
                <span class="c1"># WARNING: Don&#39;t catch RuntimeErrors or a massive memory leak can occur</span>
                <span class="c1">#tpl/cc451.bdf</span>
                <span class="c1">#raise</span>
                <span class="c1"># NameErrors should be caught</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_iparse_errors</span> <span class="o">+=</span> <span class="mi">1</span>
                <span class="c1">#self.log.error(str(card_obj))</span>
                <span class="n">var</span> <span class="o">=</span> <span class="n">traceback</span><span class="o">.</span><span class="n">format_exception_only</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">exception</span><span class="p">),</span> <span class="n">exception</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_stored_parse_errors</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">card</span><span class="p">,</span> <span class="n">var</span><span class="p">))</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_iparse_errors</span> <span class="o">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">_nparse_errors</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">pop_parse_errors</span><span class="p">()</span>
                <span class="c1">#raise</span>
            <span class="c1">#except AssertionError as exception:</span>
                <span class="c1">#self.log.error(str(card_obj))</span>

        <span class="k">elif</span> <span class="n">card_name</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_card_parser_prepare</span><span class="p">:</span>
            <span class="n">add_card_function</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_card_parser_prepare</span><span class="p">[</span><span class="n">card_name</span><span class="p">]</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">add_card_function</span><span class="p">(</span><span class="n">card</span><span class="p">,</span> <span class="n">card_obj</span><span class="p">,</span> <span class="n">comment</span><span class="o">=</span><span class="n">comment</span><span class="p">)</span>
            <span class="k">except</span> <span class="p">(</span><span class="ne">SyntaxError</span><span class="p">,</span> <span class="ne">AssertionError</span><span class="p">,</span> <span class="ne">KeyError</span><span class="p">,</span> <span class="ne">ValueError</span><span class="p">)</span> <span class="k">as</span> <span class="n">exception</span><span class="p">:</span>
                <span class="c1">#raise</span>
                <span class="c1"># WARNING: Don&#39;t catch RuntimeErrors or a massive memory leak can occur</span>
                <span class="c1">#tpl/cc451.bdf</span>
                <span class="c1">#raise</span>
                <span class="c1"># NameErrors should be caught</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_iparse_errors</span> <span class="o">+=</span> <span class="mi">1</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">card_obj</span><span class="p">))</span>
                <span class="n">var</span> <span class="o">=</span> <span class="n">traceback</span><span class="o">.</span><span class="n">format_exception_only</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">exception</span><span class="p">),</span> <span class="n">exception</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_stored_parse_errors</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">card</span><span class="p">,</span> <span class="n">var</span><span class="p">))</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_iparse_errors</span> <span class="o">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">_nparse_errors</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">pop_parse_errors</span><span class="p">()</span>
            <span class="c1">#except AssertionError as exception:</span>
                <span class="c1">#self.log.error(str(card_obj))</span>
                <span class="c1">#raise</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1">#raise RuntimeError(card_obj)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">reject_cards</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">card_obj</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">get_bdf_stats</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">return_type</span><span class="p">:</span> <span class="nb">str</span><span class="o">=</span><span class="s1">&#39;string&#39;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Print statistics for the BDF</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        return_type : str (default=&#39;string&#39;)</span>
<span class="sd">            the output type (&#39;list&#39;, &#39;string&#39;)</span>
<span class="sd">                &#39;list&#39; : list of strings</span>
<span class="sd">                &#39;string&#39; : single, joined string</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        return_data : str, optional</span>
<span class="sd">            the output data</span>

<span class="sd">        .. note:: if a card is not supported and not added to the proper</span>
<span class="sd">                  lists, this method will fail</span>

<span class="sd">        .. todo:: RBE3s from OP2s can show up as ???s</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">get_bdf_stats</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">return_type</span><span class="o">=</span><span class="n">return_type</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">get_displacement_index_xyz_cp_cd</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">fdtype</span><span class="p">:</span> <span class="nb">str</span><span class="o">=</span><span class="s1">&#39;float64&#39;</span><span class="p">,</span> <span class="n">idtype</span><span class="p">:</span> <span class="nb">str</span><span class="o">=</span><span class="s1">&#39;int32&#39;</span><span class="p">,</span>
                                         <span class="n">sort_ids</span><span class="p">:</span> <span class="nb">bool</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Any</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Get index and transformation matricies for nodes with</span>
<span class="sd">        their output in coordinate systems other than the global.</span>
<span class="sd">        Used in combination with ``OP2.transform_displacements_to_global``</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        fdtype : str; default=&#39;float64&#39;</span>
<span class="sd">            the type of xyz_cp</span>
<span class="sd">        idtype : str; default=&#39;int32&#39;</span>
<span class="sd">            the type of nid_cp_cd</span>
<span class="sd">        sort_ids : bool; default=True</span>
<span class="sd">            sort the ids</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        icd_transform : dict{int cd : (n,) int ndarray}</span>
<span class="sd">            Dictionary from coordinate id to index of the nodes in</span>
<span class="sd">            ``self.point_ids`` that their output (`CD`) in that</span>
<span class="sd">            coordinate system.</span>
<span class="sd">        icp_transform : dict{int cp : (n,) int ndarray}</span>
<span class="sd">            Dictionary from coordinate id to index of the nodes in</span>
<span class="sd">            ``self.point_ids`` that their input (`CP`) in that</span>
<span class="sd">            coordinate system.</span>
<span class="sd">        xyz_cp : (n, 3) float ndarray</span>
<span class="sd">            points in the CP coordinate system</span>
<span class="sd">        nid_cp_cd : (n, 3) int ndarray</span>
<span class="sd">            node id, CP, CD for each node</span>

<span class="sd">        Examples</span>
<span class="sd">        --------</span>
<span class="sd">        # assume GRID 1 has a CD=10, CP=0</span>
<span class="sd">        # assume GRID 2 has a CD=10, CP=0</span>
<span class="sd">        # assume GRID 5 has a CD=50, CP=0</span>
<span class="sd">        &gt;&gt;&gt; model.point_ids</span>
<span class="sd">        [1, 2, 5]</span>
<span class="sd">        &gt;&gt;&gt; out = model.get_displacement_index_xyz_cp_cd()</span>
<span class="sd">        &gt;&gt;&gt; icd_transform, icp_transform, xyz_cp, nid_cp_cd = out</span>
<span class="sd">        &gt;&gt;&gt; nid_cp_cd</span>
<span class="sd">        [</span>
<span class="sd">           [1, 0, 10],</span>
<span class="sd">           [2, 0, 10],</span>
<span class="sd">           [5, 0, 50],</span>
<span class="sd">        ]</span>
<span class="sd">        &gt;&gt;&gt; icd_transform[10]</span>
<span class="sd">        [0, 1]</span>

<span class="sd">        &gt;&gt;&gt; icd_transform[50]</span>
<span class="sd">        [2]</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">nnodes</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nodes</span><span class="p">)</span>
        <span class="n">nspoints</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">nepoints</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">spoints</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="n">epoints</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="n">nrings</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ringaxs</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">spoints</span><span class="p">:</span>
            <span class="n">spoints</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">spoints</span><span class="p">)</span>
            <span class="n">nspoints</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">spoints</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">epoints</span><span class="p">:</span>
            <span class="n">epoints</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">epoints</span><span class="p">)</span>
            <span class="n">nepoints</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">epoints</span><span class="p">)</span>

        <span class="n">ngridb</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">gridb</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">nnodes</span> <span class="o">+</span> <span class="n">nspoints</span> <span class="o">+</span> <span class="n">nepoints</span> <span class="o">+</span> <span class="n">ngridb</span> <span class="o">+</span> <span class="n">nrings</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">msg</span> <span class="o">=</span> <span class="s1">&#39;nnodes=</span><span class="si">%s</span><span class="s1"> nspoints=</span><span class="si">%s</span><span class="s1"> nepoints=</span><span class="si">%s</span><span class="s1"> nrings=</span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span>
                <span class="n">nnodes</span><span class="p">,</span> <span class="n">nspoints</span><span class="p">,</span> <span class="n">nepoints</span><span class="p">,</span> <span class="n">nrings</span><span class="p">)</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">idtype</span> <span class="o">==</span> <span class="s1">&#39;int32&#39;</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">out</span> <span class="o">=</span> <span class="n">_set_nodes</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">spoints</span><span class="p">,</span> <span class="n">epoints</span><span class="p">,</span>
                                 <span class="n">nnodes</span><span class="p">,</span> <span class="n">nspoints</span><span class="p">,</span> <span class="n">nepoints</span><span class="p">,</span> <span class="n">ngridb</span><span class="p">,</span>
                                 <span class="n">idtype</span><span class="p">,</span> <span class="n">fdtype</span><span class="p">)</span>
            <span class="k">except</span> <span class="ne">OverflowError</span><span class="p">:</span>
                <span class="n">out</span> <span class="o">=</span> <span class="n">_set_nodes</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">spoints</span><span class="p">,</span> <span class="n">epoints</span><span class="p">,</span>
                                 <span class="n">nnodes</span><span class="p">,</span> <span class="n">nspoints</span><span class="p">,</span> <span class="n">nepoints</span><span class="p">,</span> <span class="n">ngridb</span><span class="p">,</span>
                                 <span class="s1">&#39;int64&#39;</span><span class="p">,</span> <span class="n">fdtype</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">out</span> <span class="o">=</span> <span class="n">_set_nodes</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">spoints</span><span class="p">,</span> <span class="n">epoints</span><span class="p">,</span>
                             <span class="n">nnodes</span><span class="p">,</span> <span class="n">nspoints</span><span class="p">,</span> <span class="n">nepoints</span><span class="p">,</span> <span class="n">ngridb</span><span class="p">,</span>
                             <span class="n">idtype</span><span class="p">,</span> <span class="n">fdtype</span><span class="p">)</span>
        <span class="n">nid_cp_cd</span><span class="p">,</span> <span class="n">xyz_cp</span><span class="p">,</span> <span class="n">nids_cd_transform</span><span class="p">,</span> <span class="n">nids_cp_transform</span> <span class="o">=</span> <span class="n">out</span>

        <span class="k">if</span> <span class="n">sort_ids</span><span class="p">:</span>
            <span class="n">nids</span> <span class="o">=</span> <span class="n">nid_cp_cd</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]</span>
            <span class="n">isort</span> <span class="o">=</span> <span class="n">nids</span><span class="o">.</span><span class="n">argsort</span><span class="p">()</span>
            <span class="n">nid_cp_cd</span> <span class="o">=</span> <span class="n">nid_cp_cd</span><span class="p">[</span><span class="n">isort</span><span class="p">,</span> <span class="p">:]</span>
            <span class="n">xyz_cp</span> <span class="o">=</span> <span class="n">xyz_cp</span><span class="p">[</span><span class="n">isort</span><span class="p">,</span> <span class="p">:]</span>

        <span class="n">icp_transform</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">icd_transform</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">nids_all</span> <span class="o">=</span> <span class="n">nid_cp_cd</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]</span>

        <span class="c1"># get the indicies of the xyz array where the nodes that</span>
        <span class="c1"># need to be transformed are</span>
        <span class="k">for</span> <span class="n">cd</span><span class="p">,</span> <span class="n">nids</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">nids_cd_transform</span><span class="o">.</span><span class="n">items</span><span class="p">()):</span>
            <span class="k">if</span> <span class="n">cd</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">]:</span>
                <span class="k">continue</span>
            <span class="n">nids</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">nids</span><span class="p">)</span>
            <span class="n">icd_transform</span><span class="p">[</span><span class="n">cd</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">in1d</span><span class="p">(</span><span class="n">nids_all</span><span class="p">,</span> <span class="n">nids</span><span class="p">))[</span><span class="mi">0</span><span class="p">]</span>

        <span class="k">for</span> <span class="n">cp</span><span class="p">,</span> <span class="n">nids</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">nids_cp_transform</span><span class="o">.</span><span class="n">items</span><span class="p">()):</span>
            <span class="k">if</span> <span class="n">cp</span> <span class="ow">in</span> <span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]:</span>
                <span class="k">continue</span>
            <span class="n">nids</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">nids</span><span class="p">)</span>
            <span class="n">icp_transform</span><span class="p">[</span><span class="n">cp</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">in1d</span><span class="p">(</span><span class="n">nids_all</span><span class="p">,</span> <span class="n">nids</span><span class="p">))[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">return</span> <span class="n">icd_transform</span><span class="p">,</span> <span class="n">icp_transform</span><span class="p">,</span> <span class="n">xyz_cp</span><span class="p">,</span> <span class="n">nid_cp_cd</span>

    <span class="k">def</span> <span class="nf">get_xyz_in_coord_array</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">cid</span><span class="p">:</span> <span class="nb">int</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
                               <span class="n">fdtype</span><span class="p">:</span> <span class="nb">str</span><span class="o">=</span><span class="s1">&#39;float64&#39;</span><span class="p">,</span> <span class="n">idtype</span><span class="p">:</span> <span class="nb">str</span><span class="o">=</span><span class="s1">&#39;int32&#39;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">Any</span><span class="p">,</span> <span class="n">Any</span><span class="p">,</span> <span class="n">Any</span><span class="p">,</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="n">Any</span><span class="p">],</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="n">Any</span><span class="p">]]:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Gets the xyzs as an array in an arbitrary coordinate system</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        fdtype : str; default=&#39;float64&#39;</span>
<span class="sd">            the type of xyz_cp</span>
<span class="sd">        idtype : str; default=&#39;int32&#39;</span>
<span class="sd">            the type of nid_cp_cd</span>
<span class="sd">        cid : int; default=0</span>
<span class="sd">            the coordinate system to get xyz in</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        nid_cp_cd : (n, 3) int ndarray</span>
<span class="sd">            node id, CP, CD for each node</span>
<span class="sd">        xyz_cid : (n, 3) float ndarray</span>
<span class="sd">            points in the CID coordinate system</span>
<span class="sd">        xyz_cp : (n, 3) float ndarray</span>
<span class="sd">            points in the CP coordinate system</span>
<span class="sd">        icd_transform : dict{int cd : (n,) int ndarray}</span>
<span class="sd">            Dictionary from coordinate id to index of the nodes in</span>
<span class="sd">            ``self.point_ids`` that their output (`CD`) in that</span>
<span class="sd">            coordinate system.</span>
<span class="sd">        icp_transform : dict{int cp : (n,) int ndarray}</span>
<span class="sd">            Dictionary from coordinate id to index of the nodes in</span>
<span class="sd">            ``self.point_ids`` that their input (`CP`) in that</span>
<span class="sd">            coordinate system.</span>

<span class="sd">        .. todo:: how are SPOINTs/EPOINTs identified?</span>

<span class="sd">        Examples</span>
<span class="sd">        --------</span>
<span class="sd">        &gt;&gt;&gt; out = model.get_xyz_in_coord_array(cid=0, fdtype=&#39;float64&#39;, idtype=&#39;int32&#39;)</span>
<span class="sd">        &gt;&gt;&gt; nid_cp_cd, xyz_cid, xyz_cp, icd_transform, icp_transform = out</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">icd_transform</span><span class="p">,</span> <span class="n">icp_transform</span><span class="p">,</span> <span class="n">xyz_cp</span><span class="p">,</span> <span class="n">nid_cp_cd</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_displacement_index_xyz_cp_cd</span><span class="p">(</span>
            <span class="n">fdtype</span><span class="o">=</span><span class="n">fdtype</span><span class="p">,</span> <span class="n">idtype</span><span class="o">=</span><span class="n">idtype</span><span class="p">,</span> <span class="n">sort_ids</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">nids</span> <span class="o">=</span> <span class="n">nid_cp_cd</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]</span>
        <span class="n">xyz_cid</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">transform_xyzcp_to_xyz_cid</span><span class="p">(</span><span class="n">xyz_cp</span><span class="p">,</span> <span class="n">nids</span><span class="p">,</span> <span class="n">icp_transform</span><span class="p">,</span>
                                                  <span class="n">cid</span><span class="o">=</span><span class="n">cid</span><span class="p">,</span> <span class="n">in_place</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">atol</span><span class="o">=</span><span class="mf">1e-6</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">nid_cp_cd</span><span class="p">,</span> <span class="n">xyz_cid</span><span class="p">,</span> <span class="n">xyz_cp</span><span class="p">,</span> <span class="n">icd_transform</span><span class="p">,</span> <span class="n">icp_transform</span>

    <span class="k">def</span> <span class="nf">transform_xyzcp_to_xyz_cid</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">xyz_cp</span><span class="p">:</span> <span class="n">Any</span><span class="p">,</span> <span class="n">nids</span><span class="p">:</span> <span class="n">Any</span><span class="p">,</span> <span class="n">icp_transform</span><span class="p">:</span> <span class="n">Any</span><span class="p">,</span>
                                   <span class="n">cid</span><span class="p">:</span> <span class="nb">int</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">in_place</span><span class="p">:</span> <span class="nb">bool</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">atol</span><span class="p">:</span> <span class="nb">float</span><span class="o">=</span><span class="mf">1e-6</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Any</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Vectorized method for calculating node locations in an arbitrary</span>
<span class="sd">        coordinate system.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        xyz_cp : (n, 3) float ndarray</span>
<span class="sd">            points in the CP coordinate system</span>
<span class="sd">        nids : (n, ) int ndarray</span>
<span class="sd">            the GRID/SPOINT/EPOINT ids corresponding to xyz_cp</span>
<span class="sd">        icp_transform : dict{int cp : (n,) int ndarray}</span>
<span class="sd">            Dictionary from coordinate id to index of the nodes in</span>
<span class="sd">            ``self.point_ids`` that their input (`CP`) in that</span>
<span class="sd">            coordinate system.</span>
<span class="sd">        cid : int; default=0</span>
<span class="sd">            the coordinate system to get xyz in</span>
<span class="sd">        in_place : bool, default=False</span>
<span class="sd">            If true the original xyz_cp is modified, otherwise a</span>
<span class="sd">            new one is created.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        xyz_cid : (n, 3) float ndarray</span>
<span class="sd">            points in the CID coordinate system</span>

<span class="sd">        Examples</span>
<span class="sd">        --------</span>
<span class="sd">        # assume GRID 1 has a CD=10, CP=0</span>
<span class="sd">        # assume GRID 2 has a CD=10, CP=0</span>
<span class="sd">        # assume GRID 5 has a CD=50, CP=1</span>
<span class="sd">        &gt;&gt;&gt; model.point_ids</span>
<span class="sd">        [1, 2, 5]</span>
<span class="sd">        &gt;&gt;&gt; out = model.get_displacement_index_xyz_cp_cd()</span>
<span class="sd">        &gt;&gt;&gt; icd_transform, icp_transform, xyz_cp, nid_cp_cd = out</span>
<span class="sd">        &gt;&gt;&gt; nids = nid_cp_cd[:, 0]</span>
<span class="sd">        &gt;&gt;&gt; xyz_cid0 = model.transform_xyzcp_to_xyz_cid(</span>
<span class="sd">                xyz_cp, nids, icp_transform,</span>
<span class="sd">                cid=0)</span>
<span class="sd">        &gt;&gt;&gt; xyz_cid1 = model.transform_xyzcp_to_xyz_cid(</span>
<span class="sd">                xyz_cp, nids, icp_transform,</span>
<span class="sd">                cid=1)</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1">#F:\work\pyNastran\examples\femap_examples\Support\nast\tpl\heli112em7.dat</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_bdf_vectorized</span><span class="p">:</span>
            <span class="c1"># this is used when xref=False (only for vectorized=True)</span>
            <span class="c1"># we now require nids, where the other approach</span>
            <span class="c1"># (the one with xref=True) does not</span>
            <span class="n">in_place</span> <span class="o">=</span> <span class="kc">False</span>
            <span class="n">cps_to_check</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">coords</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># this requires xref</span>
            <span class="c1">#cps_to_check = list(icp_transform.keys())</span>
            <span class="c1"># xref allows in_place=True</span>

            <span class="c1"># this is more general and slightly slower</span>
            <span class="c1"># requires in_place=False???</span>
            <span class="n">cps_to_check</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">coords</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
        <span class="n">cps_to_check</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>
        <span class="k">assert</span> <span class="mi">0</span> <span class="ow">in</span> <span class="n">cps_to_check</span><span class="p">,</span> <span class="n">cps_to_check</span>

        <span class="n">nodes</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">nodes</span>
        <span class="n">coord2</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">coords</span><span class="p">[</span><span class="n">cid</span><span class="p">]</span>
        <span class="c1">#assert in_place is False, &#39;in_place=%s&#39; % in_place</span>
        <span class="k">if</span> <span class="n">in_place</span><span class="p">:</span>
            <span class="n">xyz_cid0</span> <span class="o">=</span> <span class="n">xyz_cp</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">xyz_cid0</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">xyz_cp</span><span class="p">)</span>

        <span class="n">do_checks</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="n">xyz_cid0_correct</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">if</span> <span class="n">do_checks</span><span class="p">:</span>
            <span class="c1"># transform the grids to the global coordinate system</span>
            <span class="n">xyz_cid0_correct</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_xyz_in_coord</span><span class="p">(</span><span class="n">fdtype</span><span class="o">=</span><span class="n">xyz_cid0</span><span class="o">.</span><span class="n">dtype</span><span class="p">,</span> <span class="n">cid</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

        <span class="c1">#cps_to_check = list(icp_transform.keys())</span>
        <span class="c1">#ncoords_to_setup = len(icp_transform)</span>
        <span class="n">ncoords_to_setup</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">cps_to_check</span><span class="p">)</span>
        <span class="n">nids_checked</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">while</span> <span class="n">ncoords_to_setup</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="c1">#print(&#39;--------------------------------------------------------------------------&#39;)</span>
            <span class="c1">#print(&#39;ncoords_to_setup = &#39;, ncoords_to_setup)</span>
            <span class="n">ncoords_to_setup</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="n">nids_checkedi</span><span class="p">,</span> <span class="n">cps_checked</span><span class="p">,</span> <span class="n">cps_to_check</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_transform</span><span class="p">(</span>
                <span class="n">cps_to_check</span><span class="p">,</span> <span class="n">icp_transform</span><span class="p">,</span>
                <span class="n">nids</span><span class="p">,</span> <span class="n">xyz_cp</span><span class="p">,</span> <span class="n">xyz_cid0</span><span class="p">,</span> <span class="n">xyz_cid0_correct</span><span class="p">,</span>
                <span class="n">in_place</span><span class="p">,</span> <span class="n">do_checks</span><span class="p">)</span>

            <span class="k">if</span> <span class="n">cps_to_check</span><span class="p">:</span>
                <span class="n">nids_checked</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">nids_checkedi</span><span class="p">)</span>
                <span class="c1">#print(&quot;nids_checkedi =&quot;, nids_checkedi)</span>
                <span class="n">out</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_coords_to_update</span><span class="p">(</span><span class="n">cps_to_check</span><span class="p">,</span> <span class="n">cps_checked</span><span class="p">,</span> <span class="n">nids_checked</span><span class="p">)</span>
                <span class="n">unused_ncoords_to_setup</span><span class="p">,</span> <span class="n">cord1s_to_update</span><span class="p">,</span> <span class="n">cord2s_to_update</span><span class="p">,</span> <span class="n">nids_checked</span> <span class="o">=</span> <span class="n">out</span>
                <span class="c1">#print(&#39;CPs not handled=%s\n  cord1s_to_update=%s\n  cord2s_to_update=%s&#39; % (</span>
                    <span class="c1">#cps_to_check, cord1s_to_update, cord2s_to_update))</span>

                <span class="k">for</span> <span class="n">cp</span> <span class="ow">in</span> <span class="n">cord2s_to_update</span><span class="p">:</span>
                    <span class="n">coord</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">coords</span><span class="p">[</span><span class="n">cp</span><span class="p">]</span>
                    <span class="n">coord</span><span class="o">.</span><span class="n">rid_ref</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">coords</span><span class="p">[</span><span class="n">coord</span><span class="o">.</span><span class="n">rid</span><span class="p">]</span>
                    <span class="n">coord</span><span class="o">.</span><span class="n">setup_no_xref</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>

                <span class="k">for</span> <span class="n">cp</span> <span class="ow">in</span> <span class="n">cord1s_to_update</span><span class="p">:</span>
                    <span class="n">coord</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">coords</span><span class="p">[</span><span class="n">cp</span><span class="p">]</span>
                    <span class="n">nid1</span><span class="p">,</span> <span class="n">nid2</span><span class="p">,</span> <span class="n">nid3</span> <span class="o">=</span> <span class="n">coord</span><span class="o">.</span><span class="n">node_ids</span>
                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_bdf_vectorized</span> <span class="ow">or</span> <span class="mi">1</span><span class="p">:</span>
                        <span class="n">i1</span><span class="p">,</span> <span class="n">i2</span><span class="p">,</span> <span class="n">i3</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">searchsorted</span><span class="p">(</span><span class="n">nids</span><span class="p">,</span> <span class="n">coord</span><span class="o">.</span><span class="n">node_ids</span><span class="p">)</span>
                        <span class="k">assert</span> <span class="n">nids</span><span class="p">[</span><span class="n">i1</span><span class="p">]</span> <span class="o">==</span> <span class="n">nid1</span>
                        <span class="k">assert</span> <span class="n">nids</span><span class="p">[</span><span class="n">i2</span><span class="p">]</span> <span class="o">==</span> <span class="n">nid2</span>
                        <span class="k">assert</span> <span class="n">nids</span><span class="p">[</span><span class="n">i3</span><span class="p">]</span> <span class="o">==</span> <span class="n">nid3</span>
                        <span class="n">coord</span><span class="o">.</span><span class="n">e1</span> <span class="o">=</span> <span class="n">xyz_cid0</span><span class="p">[</span><span class="n">i1</span><span class="p">,</span> <span class="p">:]</span> <span class="c1">#: the origin in the local frame</span>
                        <span class="n">coord</span><span class="o">.</span><span class="n">e2</span> <span class="o">=</span> <span class="n">xyz_cid0</span><span class="p">[</span><span class="n">i2</span><span class="p">,</span> <span class="p">:]</span> <span class="c1">#: a point on the z-axis</span>
                        <span class="n">coord</span><span class="o">.</span><span class="n">e3</span> <span class="o">=</span> <span class="n">xyz_cid0</span><span class="p">[</span><span class="n">i3</span><span class="p">,</span> <span class="p">:]</span> <span class="c1">#: a point on the xz-plane</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">g1_ref</span> <span class="o">=</span> <span class="n">nodes</span><span class="p">[</span><span class="n">nid1</span><span class="p">]</span>
                        <span class="n">g2_ref</span> <span class="o">=</span> <span class="n">nodes</span><span class="p">[</span><span class="n">nid2</span><span class="p">]</span>
                        <span class="n">g3_ref</span> <span class="o">=</span> <span class="n">nodes</span><span class="p">[</span><span class="n">nid3</span><span class="p">]</span>
                        <span class="n">coord</span><span class="o">.</span><span class="n">e1</span> <span class="o">=</span> <span class="n">g1_ref</span><span class="o">.</span><span class="n">get_position</span><span class="p">()</span> <span class="c1">#: the origin in the local frame</span>
                        <span class="n">coord</span><span class="o">.</span><span class="n">e2</span> <span class="o">=</span> <span class="n">g2_ref</span><span class="o">.</span><span class="n">get_position</span><span class="p">()</span> <span class="c1">#: a point on the z-axis</span>
                        <span class="n">coord</span><span class="o">.</span><span class="n">e3</span> <span class="o">=</span> <span class="n">g3_ref</span><span class="o">.</span><span class="n">get_position</span><span class="p">()</span> <span class="c1">#: a point on the xz-plane</span>
                    <span class="n">coord</span><span class="o">.</span><span class="n">setup_no_xref</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
                    <span class="c1">#coord.rid_ref = self.coords[coord.rid]</span>
                    <span class="c1">#coord.setup_no_xref(self)</span>

                <span class="n">ncoords_to_setup</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">cord1s_to_update</span><span class="p">)</span> <span class="o">+</span> <span class="nb">len</span><span class="p">(</span><span class="n">cord2s_to_update</span><span class="p">)</span>
            <span class="c1">#print(&#39;ncoords_next = &#39;, ncoords_to_setup)</span>
        <span class="c1">#print(&#39;--------------------------------------------------------------------------&#39;)</span>
        <span class="c1">#print(&#39;ncoords_to_setup = &#39;, ncoords_to_setup)</span>

        <span class="c1">#if ncoords == 0:</span>
        <span class="k">if</span> <span class="n">cps_to_check</span><span class="p">:</span>
            <span class="n">msg</span> <span class="o">=</span> <span class="s1">&#39;CPs not handled=</span><span class="si">%s</span><span class="s1"> cord1s_to_update=</span><span class="si">%s</span><span class="s1"> cord2s_to_update=</span><span class="si">%s</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span>
                <span class="n">cps_to_check</span><span class="p">,</span> <span class="n">cord1s_to_update</span><span class="p">,</span> <span class="n">cord2s_to_update</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">cp</span> <span class="ow">in</span> <span class="n">cps_to_check</span><span class="p">:</span>
                <span class="n">coord</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">coords</span><span class="p">[</span><span class="n">cp</span><span class="p">]</span>
                <span class="n">msg</span> <span class="o">+=</span> <span class="n">coord</span><span class="o">.</span><span class="n">rstrip</span><span class="p">()</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span>
                <span class="k">if</span> <span class="n">coord</span><span class="o">.</span><span class="n">type</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;CORD2R&#39;</span><span class="p">,</span> <span class="s1">&#39;CORD2C&#39;</span><span class="p">,</span> <span class="s1">&#39;CORD2S&#39;</span><span class="p">]:</span>
                    <span class="n">rid_ref</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">coords</span><span class="p">[</span><span class="n">coord</span><span class="o">.</span><span class="n">rid</span><span class="p">]</span>
                    <span class="n">msg</span> <span class="o">+=</span> <span class="n">rid_ref</span><span class="o">.</span><span class="n">rstrip</span><span class="p">()</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span>
                    <span class="n">msg</span> <span class="o">+=</span> <span class="s1">&#39;  rid=</span><span class="si">%r</span><span class="s1"> origin=</span><span class="si">%s</span><span class="se">\n\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">coord</span><span class="o">.</span><span class="n">rid</span><span class="p">,</span> <span class="n">rid_ref</span><span class="o">.</span><span class="n">origin</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">nid1</span><span class="p">,</span> <span class="n">nid2</span><span class="p">,</span> <span class="n">nid3</span> <span class="o">=</span> <span class="n">coord</span><span class="o">.</span><span class="n">node_ids</span>
                    <span class="c1">#coord.e1 = xyz_cid0[i1, :] #: the origin in the local frame</span>
                    <span class="c1">#coord.e2 = xyz_cid0[i2, :] #: a point on the z-axis</span>
                    <span class="c1">#coord.e3 = xyz_cid0[i3, :] #: a point on the xz-plane</span>
                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_bdf_vectorized</span><span class="p">:</span>
                        <span class="n">i1</span><span class="p">,</span> <span class="n">i2</span><span class="p">,</span> <span class="n">i3</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">searchsorted</span><span class="p">(</span><span class="n">nids</span><span class="p">,</span> <span class="n">coord</span><span class="o">.</span><span class="n">node_ids</span><span class="p">)</span>
                        <span class="n">cp1</span> <span class="o">=</span> <span class="n">nodes</span><span class="o">.</span><span class="n">cp</span><span class="p">[</span><span class="n">i1</span><span class="p">]</span>
                        <span class="n">cp2</span> <span class="o">=</span> <span class="n">nodes</span><span class="o">.</span><span class="n">cp</span><span class="p">[</span><span class="n">i2</span><span class="p">]</span>
                        <span class="n">cp3</span> <span class="o">=</span> <span class="n">nodes</span><span class="o">.</span><span class="n">cp</span><span class="p">[</span><span class="n">i3</span><span class="p">]</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">cp1</span> <span class="o">=</span> <span class="n">nodes</span><span class="p">[</span><span class="n">nid1</span><span class="p">]</span><span class="o">.</span><span class="n">cp</span>
                        <span class="n">cp2</span> <span class="o">=</span> <span class="n">nodes</span><span class="p">[</span><span class="n">nid2</span><span class="p">]</span><span class="o">.</span><span class="n">cp</span>
                        <span class="n">cp3</span> <span class="o">=</span> <span class="n">nodes</span><span class="p">[</span><span class="n">nid3</span><span class="p">]</span><span class="o">.</span><span class="n">cp</span>
                    <span class="n">msg</span> <span class="o">+=</span> <span class="s1">&#39;  g1=</span><span class="si">%s</span><span class="s1"> xyz=</span><span class="si">%s</span><span class="s1"> cp=</span><span class="si">%s</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">nid1</span><span class="p">,</span> <span class="n">coord</span><span class="o">.</span><span class="n">e1</span><span class="p">,</span> <span class="n">cp1</span><span class="p">)</span>
                    <span class="n">msg</span> <span class="o">+=</span> <span class="s1">&#39;  g2=</span><span class="si">%s</span><span class="s1"> xyz=</span><span class="si">%s</span><span class="s1"> cp=</span><span class="si">%s</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">nid2</span><span class="p">,</span> <span class="n">coord</span><span class="o">.</span><span class="n">e2</span><span class="p">,</span> <span class="n">cp2</span><span class="p">)</span>
                    <span class="n">msg</span> <span class="o">+=</span> <span class="s1">&#39;  g3=</span><span class="si">%s</span><span class="s1"> xyz=</span><span class="si">%s</span><span class="s1"> cp=</span><span class="si">%s</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">nid3</span><span class="p">,</span> <span class="n">coord</span><span class="o">.</span><span class="n">e3</span><span class="p">,</span> <span class="n">cp3</span><span class="p">)</span>
                    <span class="c1">#break</span>
            <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">do_checks</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">np</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span><span class="n">xyz_cid0</span><span class="p">,</span> <span class="n">xyz_cid0_correct</span><span class="p">,</span> <span class="n">atol</span><span class="o">=</span><span class="n">atol</span><span class="p">):</span>
            <span class="c1">#np.array_equal(xyz_cid, xyz_cid_alt):</span>
            <span class="n">out</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_displacement_index_xyz_cp_cd</span><span class="p">(</span><span class="n">fdtype</span><span class="o">=</span><span class="n">xyz_cid0</span><span class="o">.</span><span class="n">dtype</span><span class="p">,</span> <span class="n">sort_ids</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
            <span class="n">unused_icd_transform</span><span class="p">,</span> <span class="n">icp_transform</span><span class="p">,</span> <span class="n">xyz_cp</span><span class="p">,</span> <span class="n">nid_cp_cd</span> <span class="o">=</span> <span class="n">out</span>
            <span class="n">msg</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;xyz_cid0:</span><span class="se">\n</span><span class="si">%s</span><span class="se">\n</span><span class="s1">&#39;</span>
                   <span class="s1">&#39;xyz_cid0_correct:</span><span class="se">\n</span><span class="si">%s</span><span class="se">\n</span><span class="s1">&#39;</span>
                   <span class="s1">&#39;nid_cp_cd:</span><span class="se">\n</span><span class="si">%s</span><span class="se">\n</span><span class="s1">&#39;</span>
                   <span class="s1">&#39;xyz_cp:</span><span class="se">\n</span><span class="si">%s</span><span class="s1">&#39;</span><span class="o">%</span> <span class="p">(</span><span class="n">xyz_cid0</span><span class="p">,</span> <span class="n">xyz_cid0_correct</span><span class="p">,</span> <span class="n">nid_cp_cd</span><span class="p">,</span> <span class="n">xyz_cp</span><span class="p">))</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">cid</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">xyz_cid0</span>

        <span class="c1"># transform the grids to the local coordinate system</span>
        <span class="c1">#is_beta = np.diagonal(beta2).min() != 1.</span>
        <span class="c1">#is_origin = np.abs(coord2.origin).max() != 0.</span>
        <span class="c1">#if is_beta and is_origin:</span>
        <span class="n">xyz_cid</span> <span class="o">=</span> <span class="n">coord2</span><span class="o">.</span><span class="n">transform_node_to_local_array</span><span class="p">(</span><span class="n">xyz_cid0</span><span class="p">)</span>
        <span class="c1">#xyz_cid = coord2.xyz_to_coord_array(np.dot(xyz_cid0 - coord2.origin, beta2.T))</span>
        <span class="c1">#elif is_beta:</span>
            <span class="c1">#xyz_cid = coord2.xyz_to_coord_array(xyz_cid0 @ beta2.T)</span>
        <span class="c1">#else:</span>
            <span class="c1">#xyz_cid = coord2.xyz_to_coord_array(xyz_cid0 - coord2.origin)</span>

        <span class="k">if</span> <span class="n">atol</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">xyz_cid_correct</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_xyz_in_coord</span><span class="p">(</span><span class="n">cid</span><span class="o">=</span><span class="n">cid</span><span class="p">)</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">np</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span><span class="n">xyz_cid</span><span class="p">,</span> <span class="n">xyz_cid_correct</span><span class="p">,</span> <span class="n">atol</span><span class="o">=</span><span class="n">atol</span><span class="p">):</span>
                <span class="c1">#np.array_equal(xyz_cid, xyz_cid_correct):</span>
                <span class="n">msg</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;xyz_cid:</span><span class="se">\n</span><span class="si">%s</span><span class="se">\n</span><span class="s1">&#39;</span>
                       <span class="s1">&#39;xyz_cid_correct:</span><span class="se">\n</span><span class="si">%s</span><span class="s1">&#39;</span><span class="o">%</span> <span class="p">(</span><span class="n">xyz_cid</span><span class="p">,</span> <span class="n">xyz_cid_correct</span><span class="p">))</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">xyz_cid</span>

    <span class="k">def</span> <span class="nf">_transform</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">cps_to_check0</span><span class="p">,</span> <span class="n">icp_transform</span><span class="p">,</span>
                   <span class="n">nids</span><span class="p">,</span> <span class="n">xyz_cp</span><span class="p">,</span> <span class="n">xyz_cid0</span><span class="p">,</span> <span class="n">xyz_cid0_correct</span><span class="p">,</span>
                   <span class="n">unused_in_place</span><span class="p">,</span> <span class="n">do_checks</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Transforms coordinates in a vectorized way</span>
<span class="sd">        Helper method for ``transform_xyzcp_to_xyz_cid``</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        cps_to_check0 : List[int]</span>
<span class="sd">            the Cps to check</span>
<span class="sd">        icp_transform : dict{int cp : (n,) int ndarray}</span>
<span class="sd">            Dictionary from coordinate id to index of the nodes in</span>
<span class="sd">            ``self.point_ids`` that their input (`CP`) in that</span>
<span class="sd">            coordinate system.</span>
<span class="sd">        nids : (n, ) int ndarray</span>
<span class="sd">            the GRID/SPOINT/EPOINT ids corresponding to xyz_cp</span>
<span class="sd">        xyz_cp : (n, 3) float ndarray</span>
<span class="sd">            points in the CP coordinate system</span>
<span class="sd">        xyz_cid : (n, 3) float ndarray</span>
<span class="sd">            points in the CID coordinate system</span>
<span class="sd">        xyz_cid_correct : (n, 3) float ndarray</span>
<span class="sd">            points in the CID coordinate system</span>
<span class="sd">        unused_in_place : bool, default=False</span>
<span class="sd">            If true the original xyz_cp is modified, otherwise a</span>
<span class="sd">            new one is created.</span>
<span class="sd">        do_checks : bool; default=False</span>
<span class="sd">            internal value for testing</span>
<span class="sd">            True : makes use of xyz_cid_correct</span>
<span class="sd">            False : xyz_cid_correct is unused</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        nids_checked : (nnodes_checked,) int ndarray</span>
<span class="sd">           the node ids that were checked</span>
<span class="sd">        cps_checked : List[int]</span>
<span class="sd">            the Cps that were checked</span>
<span class="sd">        cps_to_check : List[int]</span>
<span class="sd">            the Cps that are unreferenceable given the current information</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">nids_checked</span><span class="p">,</span> <span class="n">cps_checked</span><span class="p">,</span> <span class="n">cps_to_check</span> <span class="o">=</span> <span class="n">transform_coords_vectorized</span><span class="p">(</span>
            <span class="n">cps_to_check0</span><span class="p">,</span> <span class="n">icp_transform</span><span class="p">,</span>
            <span class="n">nids</span><span class="p">,</span> <span class="n">xyz_cp</span><span class="p">,</span> <span class="n">xyz_cid0</span><span class="p">,</span> <span class="n">xyz_cid0_correct</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">coords</span><span class="p">,</span> <span class="n">do_checks</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">nids_checked</span><span class="p">,</span> <span class="n">cps_checked</span><span class="p">,</span> <span class="n">cps_to_check</span>

    <span class="k">def</span> <span class="nf">_get_coords_to_update</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">cps_to_check</span><span class="p">,</span> <span class="n">cps_checked</span><span class="p">,</span> <span class="n">nids_checked</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;helper method for ``transform_xyzcp_to_xyz_cid``&quot;&quot;&quot;</span>
        <span class="n">cord1s_to_update_temp</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">cord2s_to_update</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">cp</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">cps_to_check</span><span class="p">):</span>
            <span class="n">coord</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">coords</span><span class="p">[</span><span class="n">cp</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">coord</span><span class="o">.</span><span class="n">type</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;CORD2R&#39;</span><span class="p">,</span> <span class="s1">&#39;CORD2C&#39;</span><span class="p">,</span> <span class="s1">&#39;CORD2S&#39;</span><span class="p">]:</span>
                <span class="k">if</span> <span class="n">coord</span><span class="o">.</span><span class="n">rid</span> <span class="ow">in</span> <span class="n">cps_checked</span><span class="p">:</span>
                    <span class="n">cord2s_to_update</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">cp</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">coord</span><span class="o">.</span><span class="n">type</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;CORD1R&#39;</span><span class="p">,</span> <span class="s1">&#39;CORD1C&#39;</span><span class="p">,</span> <span class="s1">&#39;CORD1S&#39;</span><span class="p">]:</span>
                <span class="n">cord1s_to_update_temp</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">cp</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="n">coord</span><span class="o">.</span><span class="n">rstrip</span><span class="p">())</span>

        <span class="n">cord1s_to_update</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">cord1s_to_update_temp</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">nids_checked</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s1">&#39;len(nids_checked)=0...this shouldnt happen.&#39;</span><span class="p">)</span>
            <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">nids_checked</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                <span class="k">pass</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">nids_checked</span> <span class="o">=</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">hstack</span><span class="p">(</span><span class="n">nids_checked</span><span class="p">)]</span>

            <span class="n">nids_checkedi</span> <span class="o">=</span> <span class="n">nids_checked</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">nids_checkedi</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="c1">#print(&quot;no cord1s to check...&quot;)</span>
                <span class="n">cord1s_to_update</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="c1">#print(&#39;nids_checked = &#39;, nids_checkedi)</span>
                <span class="k">for</span> <span class="n">cp</span> <span class="ow">in</span> <span class="n">cord1s_to_update_temp</span><span class="p">:</span>
                    <span class="n">coord</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">coords</span><span class="p">[</span><span class="n">cp</span><span class="p">]</span>
                    <span class="n">nids</span> <span class="o">=</span> <span class="n">coord</span><span class="o">.</span><span class="n">node_ids</span>
                    <span class="c1">#print(&#39;cp=%s nids=%s&#39; % (cp, nids))</span>
                    <span class="k">for</span> <span class="n">nid</span> <span class="ow">in</span> <span class="n">nids</span><span class="p">:</span>
                        <span class="k">if</span> <span class="n">nid</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">nids_checkedi</span><span class="p">:</span>
                            <span class="c1">#print(&#39;  nid=%s break...&#39; % nid)</span>
                            <span class="k">break</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="c1">#print(&#39;  passed&#39;)</span>
                        <span class="c1"># all nids passed</span>
                        <span class="n">cord1s_to_update</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">cp</span><span class="p">)</span>
                <span class="n">cord1s_to_update</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">cord1s_to_update</span><span class="p">)</span>
                <span class="n">cord1s_to_update</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>

        <span class="n">ncoords</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">cord1s_to_update</span><span class="p">)</span> <span class="o">+</span> <span class="nb">len</span><span class="p">(</span><span class="n">cord2s_to_update</span><span class="p">)</span>
        <span class="c1">#if ncoords == 0:</span>
            <span class="c1">#msg = &#39;CPs not handled=%s cord1s_to_update=%s cord2s_to_update=%s\n&#39; % (</span>
                <span class="c1">#cps_to_check, cord1s_to_update, cord2s_to_update)</span>
            <span class="c1">#for cp in (cord1s_to_update + cord2s_to_update):</span>
                <span class="c1">#msg += str(cp)</span>
            <span class="c1">#raise RuntimeError(msg)</span>
        <span class="k">return</span> <span class="n">ncoords</span><span class="p">,</span> <span class="n">cord1s_to_update</span><span class="p">,</span> <span class="n">cord2s_to_update</span><span class="p">,</span> <span class="n">nids_checked</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">is_bdf_vectorized</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Returns False for the ``BDF`` class&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;grid&#39;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">get_displacement_index</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">Any</span><span class="p">,</span> <span class="n">Any</span><span class="p">,</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="n">Any</span><span class="p">]]:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Get index and transformation matricies for nodes with</span>
<span class="sd">        their output in coordinate systems other than the global.</span>
<span class="sd">        Used in combination with ``OP2.transform_displacements_to_global``</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        nids_all : (nnodes,) int ndarray</span>
<span class="sd">            the GRID/SPOINT/EPOINT ids</span>
<span class="sd">        nids_transform : dict[cd] : (nnodesi,) int ndarray</span>
<span class="sd">            the indicies in nids_all that correspond to cd &gt; 0</span>
<span class="sd">            cd : int</span>
<span class="sd">                the CD coordinate system</span>
<span class="sd">            nnodesi : int</span>
<span class="sd">                nnodesi &lt;= nnodes</span>
<span class="sd">        icd_transform : dict{int cid : (n,) int ndarray}</span>
<span class="sd">            Dictionary from coordinate id to index of the nodes in</span>
<span class="sd">            ``self.point_ids`` that their output (`CD`) in that</span>
<span class="sd">            coordinate system.</span>

<span class="sd">        Examples</span>
<span class="sd">        --------</span>
<span class="sd">        # assume GRID 1 has a CD=10</span>
<span class="sd">        # assume GRID 2 has a CD=10</span>
<span class="sd">        # assume GRID 5 has a CD=50</span>
<span class="sd">        &gt;&gt;&gt; model.point_ids</span>
<span class="sd">        [1, 2, 5]</span>
<span class="sd">        &gt;&gt;&gt; icd_transform = model.get_displacement_index()</span>
<span class="sd">        &gt;&gt;&gt; icd_transform[10]</span>
<span class="sd">        [0, 1]</span>

<span class="sd">        &gt;&gt;&gt; icd_transform[50]</span>
<span class="sd">        [2]</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">nids_transform</span> <span class="o">=</span> <span class="n">defaultdict</span><span class="p">(</span><span class="nb">list</span><span class="p">)</span>
        <span class="n">icd_transform</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">coords</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>  <span class="c1"># was ncoords &gt; 2; changed b/c seems dangerous</span>
            <span class="k">return</span> <span class="n">icd_transform</span>

        <span class="k">for</span> <span class="n">nid</span><span class="p">,</span> <span class="n">node</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nodes</span><span class="o">.</span><span class="n">items</span><span class="p">()):</span>
            <span class="n">cid_d</span> <span class="o">=</span> <span class="n">node</span><span class="o">.</span><span class="n">Cd</span><span class="p">()</span>
            <span class="k">if</span> <span class="n">cid_d</span><span class="p">:</span>
                <span class="n">nids_transform</span><span class="p">[</span><span class="n">cid_d</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">nid</span><span class="p">)</span>

        <span class="n">nids_all</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="nb">sorted</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">point_ids</span><span class="p">))</span>
        <span class="k">for</span> <span class="n">cid</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">nids_transform</span><span class="o">.</span><span class="n">keys</span><span class="p">()):</span>
            <span class="n">nids</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">nids_transform</span><span class="p">[</span><span class="n">cid</span><span class="p">])</span>
            <span class="n">icd_transform</span><span class="p">[</span><span class="n">cid</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">in1d</span><span class="p">(</span><span class="n">nids_all</span><span class="p">,</span> <span class="n">nids</span><span class="p">))[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">return</span> <span class="n">nids_all</span><span class="p">,</span> <span class="n">nids_transform</span><span class="p">,</span> <span class="n">icd_transform</span>

    <span class="k">def</span> <span class="nf">increase_card_count</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">card_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">count_num</span><span class="p">:</span> <span class="nb">int</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Used for testing to check that the number of cards going in is the</span>
<span class="sd">        same as each time the model is read verifies proper writing of cards</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        card_name : str</span>
<span class="sd">            the card_name -&gt; &#39;GRID&#39;</span>
<span class="sd">        count_num : int, optional</span>
<span class="sd">            the amount to increment by (default=1)</span>

<span class="sd">        &gt;&gt;&gt; bdf.read_bdf(bdf_filename)</span>
<span class="sd">        &gt;&gt;&gt; bdf.card_count[&#39;GRID&#39;]</span>
<span class="sd">        50</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">assert</span> <span class="s1">&#39;=&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">card_name</span><span class="p">,</span> <span class="n">card_name</span>
        <span class="k">if</span> <span class="n">card_name</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">card_count</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">card_count</span><span class="p">[</span><span class="n">card_name</span><span class="p">]</span> <span class="o">+=</span> <span class="n">count_num</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">card_count</span><span class="p">[</span><span class="n">card_name</span><span class="p">]</span> <span class="o">=</span> <span class="n">count_num</span>

    <span class="k">def</span> <span class="nf">_old_card_fields</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">card_lines</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="n">card_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
                         <span class="n">log</span><span class="p">:</span> <span class="n">Any</span><span class="p">,</span>
                         <span class="n">is_list</span><span class="p">:</span> <span class="nb">bool</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">has_none</span><span class="p">:</span> <span class="nb">bool</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                         <span class="n">is_dynamic_syntax</span><span class="p">:</span> <span class="nb">bool</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">BDFCard</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;replication helper&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">is_list</span><span class="p">:</span>
            <span class="n">fields</span> <span class="o">=</span> <span class="n">card_lines</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">fields</span> <span class="o">=</span> <span class="n">to_fields</span><span class="p">(</span><span class="n">card_lines</span><span class="p">,</span> <span class="n">card_name</span><span class="p">)</span>

        <span class="c1"># apply OPENMDAO syntax</span>
        <span class="k">if</span> <span class="n">is_dynamic_syntax</span><span class="p">:</span>
            <span class="c1">#_parse_dynamic_syntax(key, dict_of_vars, log)</span>
            <span class="n">fields</span> <span class="o">=</span> <span class="p">[</span><span class="n">print_field_16</span><span class="p">(</span><span class="n">_parse_dynamic_syntax</span><span class="p">(</span><span class="n">field</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">dict_of_vars</span><span class="p">,</span> <span class="n">log</span><span class="p">))</span>
                      <span class="k">if</span> <span class="s1">&#39;%&#39;</span> <span class="ow">in</span> <span class="n">field</span><span class="o">.</span><span class="n">strip</span><span class="p">()[</span><span class="mi">0</span><span class="p">:</span><span class="mi">1</span><span class="p">]</span> <span class="k">else</span> <span class="n">print_field_16</span><span class="p">(</span><span class="n">field</span><span class="p">)</span>
                      <span class="k">for</span> <span class="n">field</span> <span class="ow">in</span> <span class="n">fields</span><span class="p">]</span>
            <span class="n">has_none</span> <span class="o">=</span> <span class="kc">False</span>

        <span class="k">if</span> <span class="n">has_none</span><span class="p">:</span>
            <span class="n">card</span> <span class="o">=</span> <span class="n">wipe_empty_fields</span><span class="p">([</span><span class="n">print_field_16</span><span class="p">(</span><span class="n">field</span><span class="p">)</span> <span class="k">for</span> <span class="n">field</span> <span class="ow">in</span> <span class="n">fields</span><span class="p">])</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">card</span> <span class="o">=</span> <span class="n">wipe_empty_fields</span><span class="p">(</span><span class="n">fields</span><span class="p">)</span>
        <span class="n">card_obj</span> <span class="o">=</span> <span class="n">BDFCard</span><span class="p">(</span><span class="n">card</span><span class="p">,</span> <span class="n">has_none</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">card_obj</span>

    <span class="k">def</span> <span class="nf">_expand_replication</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">card_name</span><span class="p">,</span> <span class="n">icard</span><span class="p">,</span> <span class="n">cards_list</span><span class="p">,</span> <span class="n">card_lines_new</span><span class="p">,</span> <span class="n">dig</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;replication helper&quot;&quot;&quot;</span>
        <span class="c1">#dig_str = &#39;  &#39; if dig is False else &#39;&#39;</span>
        <span class="c1">#print(dig_str, &#39;-----------************---------&#39;)</span>
        <span class="c1">#print(dig_str, &#39;--dig=%s--&#39; % dig)</span>
        <span class="c1">#print(dig_str, &#39;card_lines_new=%s&#39; % card_lines_new)</span>
        <span class="n">card</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">cards</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">card_lines_old</span> <span class="o">=</span> <span class="n">cards_list</span><span class="p">[</span><span class="n">icard</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span>

        <span class="n">is_star_lines</span> <span class="o">=</span> <span class="nb">any</span><span class="p">(</span><span class="s1">&#39;*&#39;</span> <span class="ow">in</span> <span class="n">line</span> <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">card_lines_old</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">is_star_lines</span><span class="p">:</span>
            <span class="c1">#new_fields = to_fields_replication(card_lines_old)</span>
            <span class="n">old_card</span> <span class="o">=</span> <span class="n">to_fields_replication</span><span class="p">(</span><span class="n">card_lines_old</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1">#old_card, unused_card = self.create_card_object(</span>
                <span class="c1">#card_lines_old, card_name,</span>
                <span class="c1">#is_list=False, has_none=True)</span>
            <span class="c1">#print(card_lines_old)</span>
            <span class="n">old_card</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_old_card_fields</span><span class="p">(</span><span class="n">card_lines_old</span><span class="p">,</span> <span class="n">card_name</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="p">,</span>
                                             <span class="n">is_list</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">has_none</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                                             <span class="n">is_dynamic_syntax</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_is_dynamic_syntax</span><span class="p">)</span>
            <span class="c1">#print(old_card)</span>
            <span class="c1">#assert &#39;=&#39; not in card_name</span>

        <span class="n">nlines</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">card_lines_new</span><span class="p">)</span>
        <span class="c1">#print(dig_str, &quot;card_lines_new =&quot;, card_lines_new)</span>
        <span class="n">new_card</span> <span class="o">=</span> <span class="n">to_fields_replication</span><span class="p">(</span><span class="n">card_lines_new</span><span class="p">)</span>
        <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">card_lines_new</span><span class="p">)</span> <span class="o">==</span> <span class="n">nlines</span><span class="p">,</span> <span class="n">card_lines_new</span>

        <span class="c1">#print(dig_str, &#39;old_card =&#39;, old_card)</span>
        <span class="c1">#print(dig_str, &#39;card_name = %r&#39; % card_name)</span>
        <span class="n">old_card_real</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">if</span> <span class="n">old_card</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;=&#39;</span><span class="p">:</span>
            <span class="c1">#print(dig_str, &#39;A!!!&#39;)</span>
            <span class="k">if</span> <span class="n">dig</span> <span class="ow">is</span> <span class="kc">False</span><span class="p">:</span>
                <span class="k">raise</span> <span class="n">ReplicationError</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;dig=False...old_card=</span><span class="se">\n</span><span class="si">{</span><span class="n">old_card</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>

            <span class="n">cards2</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_expand_replication</span><span class="p">(</span>
                <span class="n">card_name</span><span class="p">,</span> <span class="n">icard</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">cards_list</span><span class="p">,</span> <span class="n">card_lines_old</span><span class="p">,</span> <span class="n">dig</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
            <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">cards2</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;cards2=</span><span class="si">%s</span><span class="s1">; ncards=</span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">cards2</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">cards2</span><span class="p">))</span>
            <span class="c1">#print(dig_str, &#39;cards_equal =&#39;, cards2)</span>
            <span class="n">old_card_fields</span> <span class="o">=</span> <span class="n">cards2</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">old_card_real</span> <span class="o">=</span> <span class="n">old_card</span>
            <span class="c1">#print(dig_str, &#39;old_card_fields =&#39;, old_card_fields)</span>
            <span class="c1">#print(dig_str, &#39;old_card_real =&#39;, old_card_real)</span>
            <span class="c1">#print(dig_str, &#39;card_lines_old =&#39;, card_lines_old)</span>
            <span class="n">old_card</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_old_card_fields</span><span class="p">(</span><span class="n">old_card_fields</span><span class="p">,</span> <span class="n">card_name</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="p">,</span>
                                             <span class="n">is_list</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">has_none</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                                             <span class="n">is_dynamic_syntax</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_is_dynamic_syntax</span><span class="p">)</span>
        <span class="k">elif</span> <span class="s1">&#39;=&#39;</span> <span class="ow">in</span> <span class="n">card_name</span><span class="p">:</span>
            <span class="c1">#print(dig_str, &#39;B!!!&#39;)</span>
            <span class="c1">#print(dig_str, &#39;old_card =&#39;, old_card)</span>
            <span class="c1">#print(dig_str, &#39;card_lines_new =&#39;, card_lines_new)</span>
            <span class="c1">#print(dig_str, &#39;card_name = %r&#39; % card_name)</span>

            <span class="c1"># good</span>
            <span class="c1">#new_card = [u&#39;=3&#39;]</span>
            <span class="c1">#old_card = [u&#39;CQUAD4&#39;, u&#39;64&#39;, u&#39;1&#39;, u&#39;88&#39;, u&#39;89&#39;, u&#39;101&#39;, u&#39;100&#39;]</span>
            <span class="c1">#old_card_real = [u&#39;=&#39;, u&#39;*1&#39;, u&#39;=&#39;, u&#39;*1&#39;, u&#39;*1&#39;, u&#39;*1&#39;, u&#39;*1&#39;]</span>

            <span class="c1"># bad</span>
            <span class="c1">#card_name = u&#39;=(7)&#39;</span>
            <span class="c1">#new_card = [u&#39;=(7)&#39;, u&#39;*(10)&#39;, u&#39;=&#39;, u&#39;=&#39;, u&#39;=&#39;, u&#39;*(1.0)&#39;]</span>
            <span class="c1">#old_card = [u&#39;grid&#39;, u&#39;1001&#39;, None, u&#39;0.&#39;, u&#39;0.&#39;, u&#39;0.&#39;]</span>
            <span class="c1">#old_card_real = [u&#39;grid&#39;, u&#39;1001&#39;, None, u&#39;0.&#39;, u&#39;0.&#39;, u&#39;0.&#39;]</span>
            <span class="n">old_card_real</span> <span class="o">=</span> <span class="n">new_card</span>
        <span class="c1">#else:</span>
            <span class="c1">#print(&#39;old_card[0] %r&#39; % old_card[0])</span>

        <span class="c1">#print(dig_str, &quot;old_card =&quot;, old_card)</span>
        <span class="c1">#print(dig_str, &quot;new_card =&quot;, new_card)</span>
        <span class="k">for</span> <span class="n">ifield</span><span class="p">,</span> <span class="n">field</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">new_card</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">field</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">field2</span> <span class="o">=</span> <span class="n">old_card</span><span class="o">.</span><span class="n">field</span><span class="p">(</span><span class="n">ifield</span><span class="p">)</span>
                <span class="c1">#print(&#39; %i: %r -&gt; %r&#39; % (ifield, field, field2))</span>
                <span class="c1">#assert field2 is None, &#39;field=%s field2=%s&#39; % (field, field2)</span>
                <span class="n">card</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">field2</span><span class="p">)</span>
                <span class="k">continue</span>

            <span class="c1">#if field == &#39;&#39;:</span>
                <span class="c1">#pass</span>

            <span class="n">field</span> <span class="o">=</span> <span class="n">field</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
            <span class="k">if</span> <span class="n">field</span> <span class="o">==</span> <span class="s1">&#39;=&#39;</span><span class="p">:</span>
                <span class="n">field2</span> <span class="o">=</span> <span class="n">old_card</span><span class="p">[</span><span class="n">ifield</span><span class="p">]</span>
                <span class="c1">#field2 = old_card.field(ifield)</span>
            <span class="k">elif</span> <span class="n">field</span> <span class="o">==</span> <span class="s1">&#39;==&#39;</span><span class="p">:</span>
                <span class="c1"># just append the remaining fields</span>
                <span class="n">card</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">old_card</span><span class="p">[</span><span class="n">ifield</span><span class="p">:])</span>
                <span class="c1">#print(dig_str, &#39; %i : extending %s&#39; % (ifield, old_card[ifield:]))</span>
                <span class="c1">#print(dig_str, &#39; break _expand_replication...&#39;)</span>
                <span class="k">break</span>
            <span class="k">elif</span> <span class="s1">&#39;=&#39;</span> <span class="ow">in</span> <span class="n">field</span><span class="p">:</span>
                <span class="c1"># =4</span>
                <span class="k">assert</span> <span class="n">ifield</span> <span class="o">==</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;ifield=</span><span class="si">%s</span><span class="s1"> field=</span><span class="si">%r</span><span class="s1"> new_card=</span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">ifield</span><span class="p">,</span> <span class="n">field</span><span class="p">,</span> <span class="n">new_card</span><span class="p">)</span>
                <span class="n">nrepeats</span> <span class="o">=</span> <span class="n">get_nrepeats</span><span class="p">(</span><span class="n">field</span><span class="p">,</span> <span class="n">old_card</span><span class="p">,</span> <span class="n">new_card</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">old_card_real</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="c1">#old_card_real = old_card</span>
                    <span class="n">msg</span> <span class="o">=</span> <span class="p">(</span>
                        <span class="s1">&#39;Invalid Replication Syntax (continuations arent supported)</span><span class="se">\n</span><span class="s1">&#39;</span>
                        <span class="s1">&#39;old:</span><span class="se">\n</span><span class="si">%s</span><span class="se">\n</span><span class="s1">&#39;</span>
                        <span class="s1">&#39;new:</span><span class="se">\n</span><span class="si">%s</span><span class="s1">&#39;</span>
                        <span class="o">%</span> <span class="p">(</span><span class="n">old_card</span><span class="p">,</span> <span class="n">new_card</span><span class="p">))</span>
                    <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>

                <span class="c1">#new_card = [u&#39;=3&#39;]</span>
                <span class="c1">#old_card = [u&#39;CQUAD4&#39;, u&#39;64&#39;, u&#39;1&#39;, u&#39;88&#39;, u&#39;89&#39;, u&#39;101&#39;, u&#39;100&#39;]</span>
                <span class="c1">#old_card_real = [u&#39;=&#39;, u&#39;*1&#39;, u&#39;=&#39;, u&#39;*1&#39;, u&#39;*1&#39;, u&#39;*1&#39;, u&#39;*1&#39;]</span>

                <span class="c1">#print(&#39;---&#39;)</span>
                <span class="c1">#print(dig_str, &quot;nrepeats =&quot;, nrepeats)</span>
                <span class="n">new_card</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;=&#39;</span>
                <span class="c1">#print(dig_str, &quot;new_card =&quot;, new_card)</span>
                <span class="c1">#print(dig_str, &quot;old_card =&quot;, old_card)</span>
                <span class="c1">#print(dig_str, &quot;old_card_real =&quot;, old_card_real)</span>
                <span class="k">for</span> <span class="n">unused_irepeat</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nrepeats</span><span class="p">):</span>
                    <span class="n">repeated_cards</span> <span class="o">=</span> <span class="n">repeat_cards</span><span class="p">(</span><span class="n">old_card</span><span class="p">,</span> <span class="n">old_card_real</span><span class="p">)</span>
                    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">repeated_cards</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">1</span><span class="p">:</span>
                        <span class="k">for</span> <span class="n">repeated_card</span> <span class="ow">in</span> <span class="n">repeated_cards</span><span class="p">:</span>
                            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;  repeated_card =&quot;</span><span class="p">,</span> <span class="n">repeated_card</span><span class="p">)</span>
                        <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s1">&#39;too many repeated cards&#39;</span><span class="p">)</span>
                    <span class="c1">#for repeated_card in repeated_cards:</span>
                        <span class="c1">#print(&quot;  repeated_card =&quot;, repeated_card)</span>
                    <span class="n">repeated_card</span> <span class="o">=</span> <span class="n">repeated_cards</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
                    <span class="n">cards</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">repeated_card</span><span class="p">)</span>
                    <span class="n">old_card</span> <span class="o">=</span> <span class="n">repeated_card</span>
                    <span class="c1">#print(dig_str, &quot;  repeated_card =&quot;, repeated_card)</span>
                <span class="c1">#print(dig_str, &#39;breaking...&#39;)</span>
                <span class="k">return</span> <span class="n">cards</span>

            <span class="k">elif</span> <span class="s1">&#39;*&#39;</span> <span class="ow">in</span> <span class="n">field</span><span class="p">:</span>
                <span class="c1"># this is an increment, not multiplication...</span>
                <span class="n">old_field</span> <span class="o">=</span> <span class="n">_field</span><span class="p">(</span><span class="n">old_card</span><span class="p">,</span> <span class="n">ifield</span><span class="p">)</span>
                <span class="k">assert</span> <span class="n">old_field</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">,</span> <span class="sa">f</span><span class="s1">&#39;old_card:</span><span class="si">{</span><span class="n">old_card</span><span class="si">}</span><span class="se">\n</span><span class="s1">new_card:</span><span class="se">\n</span><span class="si">{</span><span class="n">new_card</span><span class="si">}</span><span class="s1">&#39;</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="k">if</span> <span class="s1">&#39;.&#39;</span> <span class="ow">in</span> <span class="n">field</span><span class="p">:</span>
                        <span class="n">field2</span> <span class="o">=</span> <span class="n">float_replication</span><span class="p">(</span><span class="n">field</span><span class="p">,</span> <span class="n">old_field</span><span class="p">)</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">field2</span> <span class="o">=</span> <span class="n">int_replication</span><span class="p">(</span><span class="n">field</span><span class="p">,</span> <span class="n">old_field</span><span class="p">)</span>
                <span class="k">except</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;old_card:</span><span class="si">{</span><span class="n">old_card</span><span class="si">}</span><span class="se">\n</span><span class="s1">new_card:</span><span class="se">\n</span><span class="si">{</span><span class="n">new_card</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
                    <span class="k">raise</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">assert</span> <span class="s1">&#39;(&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">field</span><span class="p">,</span> <span class="s1">&#39;field=</span><span class="si">%r</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">field</span>
                <span class="k">assert</span> <span class="s1">&#39;*&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">field</span><span class="p">,</span> <span class="s1">&#39;field=</span><span class="si">%r</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">field</span>
                <span class="k">assert</span> <span class="s1">&#39;=&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">field</span><span class="p">,</span> <span class="s1">&#39;field=</span><span class="si">%r</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">field</span>
                <span class="n">field2</span> <span class="o">=</span> <span class="n">field</span>
            <span class="c1">#print(dig_str, &#39; %i: %r -&gt; %r&#39; % (ifield, field, field2))</span>
            <span class="n">card</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">field2</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">card</span><span class="p">:</span>
            <span class="n">cards</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">card</span><span class="p">)</span>
            <span class="c1">#print(dig_str, &#39;card_expanded = %s&#39; % card)</span>
        <span class="k">else</span><span class="p">:</span>  <span class="c1"># pragma: no cover</span>
            <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="n">card</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">cards</span>

    <span class="k">def</span> <span class="nf">_parse_cards</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">cards_list</span><span class="p">,</span> <span class="n">cards_dict</span><span class="p">,</span> <span class="n">card_count</span><span class="p">):</span>
        <span class="c1"># type: (List[List[str]], Dict[str, List[str]], Dict[str, int]) -&gt; None</span>
        <span class="sd">&quot;&quot;&quot;creates card objects and adds the parsed cards to the deck&quot;&quot;&quot;</span>
        <span class="c1"># we don&#39;t want replication markers in the card_count</span>
        <span class="n">card_names_to_remove</span> <span class="o">=</span> <span class="p">(</span><span class="n">card_name</span> <span class="k">for</span> <span class="n">card_name</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">card_count</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
                                <span class="k">if</span> <span class="s1">&#39;=&#39;</span> <span class="ow">in</span> <span class="n">card_name</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">card_name</span> <span class="ow">in</span> <span class="n">card_names_to_remove</span><span class="p">:</span>
            <span class="k">del</span> <span class="n">card_count</span><span class="p">[</span><span class="n">card_name</span><span class="p">]</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">echo</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="k">if</span> <span class="n">cards_dict</span><span class="p">:</span> <span class="c1"># self._is_cards_dict = True</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_parse_cards_dict</span><span class="p">(</span><span class="n">cards_dict</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">cards_list</span><span class="p">:</span>
            <span class="c1"># this is the block that actually runs</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_parse_cards_list</span><span class="p">(</span><span class="n">cards_list</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_parse_cards_dict</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">cards_dict</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]])</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;parses the cards that are in dictionary format&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">save_file_structure</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="s1">&#39;save_file_structure=True is not supported</span><span class="se">\n</span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span>
                <span class="nb">list</span><span class="p">(</span><span class="n">cards_dict</span><span class="o">.</span><span class="n">keys</span><span class="p">())))</span>

        <span class="k">for</span> <span class="n">card_name</span><span class="p">,</span> <span class="n">cards</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">cards_dict</span><span class="o">.</span><span class="n">items</span><span class="p">()):</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_reject</span><span class="p">(</span><span class="n">card_name</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s1">&#39;    rejecting card_name = </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">card_name</span><span class="p">)</span>
                <span class="k">for</span> <span class="n">comment</span><span class="p">,</span> <span class="n">card_lines</span><span class="p">,</span> <span class="n">unused_ifile_iline</span> <span class="ow">in</span> <span class="n">cards</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">increase_card_count</span><span class="p">(</span><span class="n">card_name</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">reject_lines</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">_format_comment</span><span class="p">(</span><span class="n">comment</span><span class="p">)]</span> <span class="o">+</span> <span class="n">card_lines</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">comment</span><span class="p">,</span> <span class="n">card_lines</span><span class="p">,</span> <span class="p">(</span><span class="n">ifile</span><span class="p">,</span> <span class="n">unused_iline</span><span class="p">)</span> <span class="ow">in</span> <span class="n">cards</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">add_card</span><span class="p">(</span><span class="n">card_lines</span><span class="p">,</span> <span class="n">card_name</span><span class="p">,</span> <span class="n">comment</span><span class="o">=</span><span class="n">comment</span><span class="p">,</span> <span class="n">ifile</span><span class="o">=</span><span class="n">ifile</span><span class="p">,</span>
                                  <span class="n">is_list</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">has_none</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_parse_cards_list</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">cards_list</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;parses the cards that are in list format&quot;&quot;&quot;</span>
        <span class="n">save_file_structure</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">save_file_structure</span>
        <span class="k">if</span> <span class="n">save_file_structure</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">icard</span><span class="p">,</span> <span class="n">card</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">cards_list</span><span class="p">):</span>
                <span class="n">card_name</span><span class="p">,</span> <span class="n">comment</span><span class="p">,</span> <span class="n">card_lines</span><span class="p">,</span> <span class="p">(</span><span class="n">ifile</span><span class="p">,</span> <span class="n">unused_iline</span><span class="p">)</span> <span class="o">=</span> <span class="n">card</span>
                <span class="k">if</span> <span class="n">card_name</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="n">msg</span> <span class="o">=</span> <span class="s1">&#39;card_name = </span><span class="si">%r</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">card_name</span>
                    <span class="n">msg</span> <span class="o">+=</span> <span class="s1">&#39;card_lines = </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">card_lines</span>
                    <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>

                <span class="k">if</span> <span class="s1">&#39;=&#39;</span> <span class="ow">in</span> <span class="n">card_name</span><span class="p">:</span>
                    <span class="c1">#print(card)</span>
                    <span class="k">try</span><span class="p">:</span>
                        <span class="n">replicated_cards</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_expand_replication</span><span class="p">(</span>
                            <span class="n">card_name</span><span class="p">,</span> <span class="n">icard</span><span class="p">,</span> <span class="n">cards_list</span><span class="p">,</span> <span class="n">card_lines</span><span class="p">)</span>
                    <span class="k">except</span> <span class="n">ReplicationError</span><span class="p">:</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s1">&#39;failed to expand </span><span class="si">%s</span><span class="se">\n</span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">card_name</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">card_lines</span><span class="p">)))</span>
                        <span class="k">raise</span>

                    <span class="n">_check_replicated_cards</span><span class="p">(</span><span class="n">replicated_cards</span><span class="p">)</span>
                    <span class="k">for</span> <span class="n">replicated_card</span> <span class="ow">in</span> <span class="n">replicated_cards</span><span class="p">:</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">add_card_ifile</span><span class="p">(</span><span class="n">ifile</span><span class="p">,</span> <span class="n">replicated_card</span><span class="p">,</span> <span class="n">replicated_card</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
                                            <span class="n">comment</span><span class="o">=</span><span class="n">comment</span><span class="p">,</span> <span class="n">is_list</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">has_none</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
                    <span class="k">continue</span>

                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_reject</span><span class="p">(</span><span class="n">card_name</span><span class="p">):</span>  <span class="c1"># pragma: no cover</span>
                    <span class="n">msg</span> <span class="o">=</span> <span class="s2">&quot;save_file_structure=True doesn&#39;t support </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">card_name</span>
                    <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
                    <span class="c1">#self.reject_card_lines(card_name, card_lines, comment)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">add_card_ifile</span><span class="p">(</span><span class="n">ifile</span><span class="p">,</span> <span class="n">card_lines</span><span class="p">,</span> <span class="n">card_name</span><span class="p">,</span> <span class="n">comment</span><span class="o">=</span><span class="n">comment</span><span class="p">,</span>
                                        <span class="n">is_list</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">has_none</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">icard</span><span class="p">,</span> <span class="n">card</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">cards_list</span><span class="p">):</span>
                <span class="n">card_name</span><span class="p">,</span> <span class="n">comment</span><span class="p">,</span> <span class="n">card_lines</span><span class="p">,</span> <span class="p">(</span><span class="n">ifile</span><span class="p">,</span> <span class="n">unused_iline</span><span class="p">)</span> <span class="o">=</span> <span class="n">card</span>
                <span class="c1">#print(unused_iline, card_lines[0])</span>
                <span class="k">if</span> <span class="n">card_name</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="n">msg</span> <span class="o">=</span> <span class="s1">&#39;card_name = </span><span class="si">%r</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">card_name</span>
                    <span class="n">msg</span> <span class="o">+=</span> <span class="s1">&#39;card_lines = </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">card_lines</span>
                    <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>

                <span class="k">if</span> <span class="s1">&#39;=&#39;</span> <span class="ow">in</span> <span class="n">card_name</span><span class="p">:</span>
                    <span class="c1">#print(card)</span>
                    <span class="k">try</span><span class="p">:</span>
                        <span class="n">replicated_cards</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_expand_replication</span><span class="p">(</span>
                            <span class="n">card_name</span><span class="p">,</span> <span class="n">icard</span><span class="p">,</span> <span class="n">cards_list</span><span class="p">,</span> <span class="n">card_lines</span><span class="p">)</span>
                    <span class="k">except</span> <span class="n">ReplicationError</span><span class="p">:</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s1">&#39;failed to expand </span><span class="si">%s</span><span class="se">\n</span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">card_name</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">card_lines</span><span class="p">)))</span>
                        <span class="k">raise</span>

                    <span class="n">_check_replicated_cards</span><span class="p">(</span><span class="n">replicated_cards</span><span class="p">)</span>
                    <span class="k">for</span> <span class="n">replicated_card</span> <span class="ow">in</span> <span class="n">replicated_cards</span><span class="p">:</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">add_card</span><span class="p">(</span><span class="n">replicated_card</span><span class="p">,</span> <span class="n">replicated_card</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">comment</span><span class="o">=</span><span class="n">comment</span><span class="p">,</span>
                                      <span class="n">is_list</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">has_none</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
                    <span class="k">continue</span>

                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_reject</span><span class="p">(</span><span class="n">card_name</span><span class="p">):</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">reject_card_lines</span><span class="p">(</span><span class="n">card_name</span><span class="p">,</span> <span class="n">card_lines</span><span class="p">,</span> <span class="n">comment</span><span class="o">=</span><span class="n">comment</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">add_card</span><span class="p">(</span><span class="n">card_lines</span><span class="p">,</span> <span class="n">card_name</span><span class="p">,</span> <span class="n">comment</span><span class="o">=</span><span class="n">comment</span><span class="p">,</span> <span class="n">ifile</span><span class="o">=</span><span class="n">ifile</span><span class="p">,</span>
                                  <span class="n">is_list</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">has_none</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

    <span class="c1">#def _is_case_control_deck(self, line):</span>
        <span class="c1">#line_upper = line.upper().strip()</span>
        <span class="c1">#if &#39;CEND&#39; in line.upper():</span>
            <span class="c1">#raise SyntaxError(&#39;invalid Case Control Deck card...CEND...&#39;)</span>
        <span class="c1">#if &#39;=&#39; in line_upper or &#39; &#39; in line_upper:</span>
            <span class="c1">#return True</span>
        <span class="c1">#for card in self.uniqueBulkDataCards:</span>
            <span class="c1">#lenCard = len(card)</span>
            <span class="c1">#if card in line_upper[:lenCard]:</span>
                <span class="c1">#return False</span>
        <span class="c1">#return True</span>

    <span class="k">def</span> <span class="nf">_parse_primary_file_header</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">bdf_filename</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">StringIO</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Extract encoding, nastran_format, and punch from the primary BDF.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        bdf_filename : str</span>
<span class="sd">            the input filename</span>

<span class="sd">        ..code-block :: python</span>

<span class="sd">            $ pyNastran: version=NX</span>
<span class="sd">            $ pyNastran: encoding=latin-1</span>
<span class="sd">            $ pyNastran: punch=True</span>
<span class="sd">            $ pyNastran: dumplines=True</span>
<span class="sd">            $ pyNastran: nnodes=10</span>
<span class="sd">            $ pyNastran: nelements=100</span>
<span class="sd">            $ pyNastran: skip_cards=PBEAM,CBEAM</span>
<span class="sd">            $ pyNastran: units=in,lb,s</span>

<span class="sd">        ..warning :: pyNastran lines must be at the top of the file</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">bdf_filename</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">bdf_file</span><span class="p">:</span>
                <span class="n">lines</span> <span class="o">=</span> <span class="n">bdf_file</span><span class="o">.</span><span class="n">readlines</span><span class="p">()</span>
        <span class="k">except</span> <span class="ne">UnicodeDecodeError</span><span class="p">:</span>
            <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">bdf_filename</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">errors</span><span class="o">=</span><span class="s1">&#39;ignore&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">bdf_file</span><span class="p">:</span>
                <span class="n">line</span> <span class="o">=</span> <span class="n">bdf_file</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span>
                <span class="n">iline</span> <span class="o">=</span> <span class="mi">1</span>
                <span class="k">while</span> <span class="n">line</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Line </span><span class="si">{</span><span class="n">iline</span><span class="si">}</span><span class="s1">: </span><span class="si">{</span><span class="n">line</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
                    <span class="n">line</span> <span class="o">=</span> <span class="n">bdf_file</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span>
                    <span class="n">iline</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="k">except</span> <span class="p">(</span><span class="ne">AttributeError</span><span class="p">,</span> <span class="ne">TypeError</span><span class="p">)</span> <span class="k">as</span> <span class="n">error</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">bdf_filename</span><span class="p">,</span> <span class="s1">&#39;read&#39;</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">bdf_filename</span><span class="p">,</span> <span class="s1">&#39;write&#39;</span><span class="p">):</span>
                <span class="n">lines</span> <span class="o">=</span> <span class="n">bdf_filename</span><span class="o">.</span><span class="n">readlines</span><span class="p">()</span>
                <span class="n">bdf_filename</span><span class="o">.</span><span class="n">seek</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>  <span class="c1"># need to rewind the buffer!</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="n">error</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_check_pynastran_header</span><span class="p">(</span><span class="n">lines</span><span class="p">,</span> <span class="n">check_header</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">nastran_format</span> <span class="o">==</span> <span class="s1">&#39;zona&#39;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">zona</span><span class="o">.</span><span class="n">update_for_zona</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">_check_pynastran_header</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">lines</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="n">check_header</span><span class="p">:</span> <span class="nb">bool</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;updates the $pyNastran: key=value variables&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">check_header</span><span class="p">:</span>
            <span class="k">return</span>
        <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">lines</span><span class="p">:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">line</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;$&#39;</span><span class="p">):</span>
                <span class="k">break</span>

            <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="o">=</span> <span class="n">_parse_pynastran_header</span><span class="p">(</span><span class="n">line</span><span class="p">)</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">key</span><span class="p">:</span>
                <span class="k">break</span>

            <span class="c1"># key/value are lowercase</span>
            <span class="k">if</span> <span class="n">key</span> <span class="o">==</span> <span class="s1">&#39;version&#39;</span><span class="p">:</span>
                <span class="k">assert</span> <span class="n">value</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;msc&#39;</span><span class="p">,</span> <span class="s1">&#39;nx&#39;</span><span class="p">,</span> <span class="s1">&#39;zona&#39;</span><span class="p">,</span> <span class="s1">&#39;nasa95&#39;</span><span class="p">],</span> <span class="sa">f</span><span class="s1">&#39;version=</span><span class="si">{</span><span class="n">value</span><span class="si">!r}</span><span class="s1"> is not supported&#39;</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">nastran_format</span> <span class="o">=</span> <span class="n">value</span>
            <span class="k">elif</span> <span class="n">key</span> <span class="o">==</span> <span class="s1">&#39;encoding&#39;</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_encoding</span> <span class="o">=</span> <span class="n">value</span>
            <span class="k">elif</span> <span class="n">key</span> <span class="o">==</span> <span class="s1">&#39;punch&#39;</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">punch</span> <span class="o">=</span> <span class="n">_bool</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">key</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;nnodes&#39;</span><span class="p">,</span> <span class="s1">&#39;nelements&#39;</span><span class="p">]:</span>
                <span class="k">pass</span>
            <span class="k">elif</span> <span class="n">key</span> <span class="o">==</span> <span class="s1">&#39;dumplines&#39;</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">dumplines</span> <span class="o">=</span> <span class="n">_bool</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">key</span> <span class="o">==</span> <span class="s1">&#39;is_superelements&#39;</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">is_superelements</span> <span class="o">=</span> <span class="n">_bool</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">key</span> <span class="o">==</span> <span class="s1">&#39;skip_cards&#39;</span><span class="p">:</span>
                <span class="n">cards</span> <span class="o">=</span> <span class="p">{</span><span class="n">value</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span> <span class="k">for</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">value</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">)}</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">cards_to_read</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cards_to_read</span> <span class="o">-</span> <span class="n">cards</span>
            <span class="k">elif</span> <span class="s1">&#39;skip &#39;</span> <span class="ow">in</span> <span class="n">key</span><span class="p">:</span>
                <span class="n">type_to_skip</span> <span class="o">=</span> <span class="n">key</span><span class="p">[</span><span class="mi">5</span><span class="p">:]</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
                <span class="c1">#values = [int(value) for value in value.upper().split(&#39;,&#39;)]</span>
                <span class="n">values</span> <span class="o">=</span> <span class="n">parse_patran_syntax</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">type_to_skip</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">object_attributes</span><span class="p">():</span>
                    <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%r</span><span class="s1"> is an invalid key&#39;</span> <span class="o">%</span> <span class="n">type_to_skip</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">type_to_skip</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">values_to_skip</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">values_to_skip</span><span class="p">[</span><span class="n">type_to_skip</span><span class="p">]</span> <span class="o">=</span> <span class="n">values</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">values_to_skip</span><span class="p">[</span><span class="n">type_to_skip</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">hstack</span><span class="p">([</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">values_to_skip</span><span class="p">[</span><span class="n">type_to_skip</span><span class="p">],</span>
                        <span class="n">values</span>
                    <span class="p">])</span>
            <span class="c1">#elif key == &#39;skip_elements&#39;</span>
            <span class="c1">#elif key == &#39;skip_properties&#39;</span>
            <span class="k">elif</span> <span class="n">key</span> <span class="o">==</span> <span class="s1">&#39;units&#39;</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">units</span> <span class="o">=</span> <span class="p">[</span><span class="n">value</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span> <span class="k">for</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">value</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">)]</span>
            <span class="k">elif</span> <span class="n">key</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;code-block&#39;</span><span class="p">,</span> <span class="s1">&#39;code_block&#39;</span><span class="p">]:</span>
                <span class="n">value</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;=&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;code_block&#39;</span><span class="p">):</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">code_block</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
                    <span class="n">char0</span> <span class="o">=</span> <span class="n">value</span><span class="o">.</span><span class="n">lstrip</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
                    <span class="n">indent</span> <span class="o">=</span> <span class="n">value</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">char0</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">code_block</span> <span class="o">+=</span> <span class="n">value</span><span class="p">[</span><span class="n">indent</span><span class="p">:]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>

        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;code_block&#39;</span><span class="p">):</span>
            <span class="n">exec</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">code_block</span><span class="p">)</span>

<span class="c1">#---------------------------------------------------------------------------------------------------</span>
    <span class="c1"># HDF5</span>
    <span class="k">def</span> <span class="nf">_read_bdf_cards</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">bdf_filename</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                        <span class="n">punch</span><span class="p">:</span> <span class="nb">bool</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                        <span class="n">read_includes</span><span class="p">:</span> <span class="nb">bool</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">encoding</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Read method for the bdf files</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        bdf_filename : str / None</span>
<span class="sd">            the input bdf (default=None; popup a dialog)</span>
<span class="sd">        punch : bool; default=False</span>
<span class="sd">            indicates whether the file is a punch file</span>
<span class="sd">        read_includes : bool; default=True</span>
<span class="sd">            indicates whether INCLUDE files should be read</span>
<span class="sd">        encoding : str; default=None -&gt; system default</span>
<span class="sd">            the unicode encoding</span>

<span class="sd">        .. code-block:: python</span>

<span class="sd">           &gt;&gt;&gt; bdf = BDF()</span>
<span class="sd">           &gt;&gt;&gt; bdf.read_bdf(bdf_filename, xref=True)</span>
<span class="sd">           &gt;&gt;&gt; g1 = bdf.Node(1)</span>
<span class="sd">           &gt;&gt;&gt; print(g1.get_position())</span>
<span class="sd">           [10.0, 12.0, 42.0]</span>
<span class="sd">           &gt;&gt;&gt; bdf.write_card(bdf_filename2)</span>
<span class="sd">           &gt;&gt;&gt; print(bdf.card_stats())</span>

<span class="sd">           ---BDF Statistics---</span>
<span class="sd">           SOL 101</span>
<span class="sd">           bdf.nodes = 20</span>
<span class="sd">           bdf.elements = 10</span>
<span class="sd">           etc.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_is_cards_dict</span> <span class="o">=</span> <span class="kc">True</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_read_bdf_helper</span><span class="p">(</span><span class="n">bdf_filename</span><span class="p">,</span> <span class="n">encoding</span><span class="p">,</span> <span class="n">punch</span><span class="p">,</span> <span class="n">read_includes</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s1">&#39;---starting BDF.read_bdf of </span><span class="si">%s</span><span class="s1">---&#39;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">bdf_filename</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_parse_primary_file_header</span><span class="p">(</span><span class="n">bdf_filename</span><span class="p">)</span>

        <span class="n">obj</span> <span class="o">=</span> <span class="n">BDFInputPy</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">read_includes</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">dumplines</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_encoding</span><span class="p">,</span>
                         <span class="n">nastran_format</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">nastran_format</span><span class="p">,</span>
                         <span class="n">log</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="p">,</span> <span class="n">debug</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">debug</span><span class="p">)</span>
        <span class="n">out</span> <span class="o">=</span> <span class="n">obj</span><span class="o">.</span><span class="n">get_lines</span><span class="p">(</span><span class="n">bdf_filename</span><span class="p">,</span> <span class="n">punch</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">punch</span><span class="p">,</span> <span class="n">make_ilines</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="p">(</span><span class="n">system_lines</span><span class="p">,</span> <span class="n">executive_control_lines</span><span class="p">,</span> <span class="n">case_control_lines</span><span class="p">,</span>
         <span class="n">bulk_data_lines</span><span class="p">,</span> <span class="n">bulk_data_ilines</span><span class="p">,</span>
         <span class="n">superelement_lines</span><span class="p">,</span> <span class="n">superelement_ilines</span><span class="p">)</span> <span class="o">=</span> <span class="n">out</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_set_pybdf_attributes</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="n">save_file_structure</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">system_command_lines</span> <span class="o">=</span> <span class="n">system_lines</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">executive_control_lines</span> <span class="o">=</span> <span class="n">executive_control_lines</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">case_control_lines</span> <span class="o">=</span> <span class="n">case_control_lines</span>

        <span class="n">sol</span><span class="p">,</span> <span class="n">method</span><span class="p">,</span> <span class="n">sol_iline</span> <span class="o">=</span> <span class="n">parse_executive_control_deck</span><span class="p">(</span><span class="n">executive_control_lines</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">update_solution</span><span class="p">(</span><span class="n">sol</span><span class="p">,</span> <span class="n">method</span><span class="p">,</span> <span class="n">sol_iline</span><span class="p">)</span>

        <span class="c1">#self._is_cards_dict = True</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_is_cards_dict</span><span class="p">:</span>
            <span class="n">cards</span><span class="p">,</span> <span class="n">card_count</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_bdf_cards_dict</span><span class="p">(</span><span class="n">bulk_data_lines</span><span class="p">,</span> <span class="n">bulk_data_ilines</span><span class="p">)</span>
        <span class="n">cards_out</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parse_cards_hdf5</span><span class="p">(</span><span class="n">cards</span><span class="p">,</span> <span class="n">card_count</span><span class="p">)</span>
        <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">cards_out</span><span class="p">,</span> <span class="nb">dict</span><span class="p">),</span> <span class="n">cards_out</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">case_control_deck</span> <span class="o">=</span> <span class="n">CaseControlDeck</span><span class="p">(</span><span class="n">case_control_lines</span><span class="p">,</span> <span class="n">log</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">case_control_deck</span><span class="o">.</span><span class="n">solmap_to_value</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_solmap_to_value</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">case_control_deck</span><span class="o">.</span><span class="n">rsolmap_to_str</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">rsolmap_to_str</span>

        <span class="k">return</span> <span class="n">cards_out</span>

    <span class="k">def</span> <span class="nf">create_subcases</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">subcase_ids</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="n">List</span><span class="p">[</span><span class="nb">int</span><span class="p">],</span> <span class="kc">None</span><span class="p">]</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="n">Subcase</span><span class="p">]:</span>
        <span class="sd">&quot;&quot;&quot;creates a series of subcases&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">subcase_ids</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">subcase_ids</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">subcase_ids</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>
            <span class="n">subcase_ids</span> <span class="o">=</span> <span class="p">[</span><span class="n">subcase_ids</span><span class="p">]</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">case_control_deck</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">case_control_deck</span> <span class="o">=</span> <span class="n">CaseControlDeck</span><span class="p">([],</span> <span class="n">log</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="p">)</span>

        <span class="n">subcases</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">for</span> <span class="n">subcase_id</span> <span class="ow">in</span> <span class="n">subcase_ids</span><span class="p">:</span>
            <span class="n">subcase</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">case_control_deck</span><span class="o">.</span><span class="n">create_new_subcase</span><span class="p">(</span><span class="n">subcase_id</span><span class="p">)</span>
            <span class="n">subcases</span><span class="p">[</span><span class="n">subcase_id</span><span class="p">]</span> <span class="o">=</span> <span class="n">subcase</span>
        <span class="k">return</span> <span class="n">subcases</span>

    <span class="k">def</span> <span class="nf">_parse_cards_hdf5</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">cards</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">],</span> <span class="n">unused_card_count</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;creates card objects and adds the parsed cards to the deck&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">echo</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="n">cards_out</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">for</span> <span class="n">card_name</span><span class="p">,</span> <span class="n">card</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">cards</span><span class="o">.</span><span class="n">items</span><span class="p">()):</span>
            <span class="n">cards_list</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="n">cards_out</span><span class="p">[</span><span class="n">card_name</span><span class="p">]</span> <span class="o">=</span> <span class="n">cards_list</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_reject</span><span class="p">(</span><span class="n">card_name</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s1">&#39;    rejecting card_name = </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">card_name</span><span class="p">)</span>
                <span class="k">for</span> <span class="n">comment</span><span class="p">,</span> <span class="n">card_lines</span><span class="p">,</span> <span class="n">unused_ifile_iline</span> <span class="ow">in</span> <span class="n">card</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">increase_card_count</span><span class="p">(</span><span class="n">card_name</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">reject_lines</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">_format_comment</span><span class="p">(</span><span class="n">comment</span><span class="p">)]</span> <span class="o">+</span> <span class="n">card_lines</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">comment</span><span class="p">,</span> <span class="n">card_lines</span><span class="p">,</span> <span class="n">unused_ifile_iline</span> <span class="ow">in</span> <span class="n">card</span><span class="p">:</span>
                    <span class="n">class_instance</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_add_card_hdf5</span><span class="p">(</span><span class="n">card_lines</span><span class="p">,</span> <span class="n">card_name</span><span class="p">,</span> <span class="n">comment</span><span class="o">=</span><span class="n">comment</span><span class="p">,</span>
                                                         <span class="n">is_list</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">has_none</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
                    <span class="n">cards_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">class_instance</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">cards_out</span>


    <span class="k">def</span> <span class="nf">_add_card_hdf5</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">card_lines</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="n">card_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
                       <span class="n">comment</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">is_list</span><span class="p">:</span> <span class="nb">bool</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">has_none</span><span class="p">:</span> <span class="nb">bool</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Any</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Creates a BaseCard object that will be used to simplify HDF5 adding.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        card_lines: list[str]</span>
<span class="sd">            the list of the card fields</span>
<span class="sd">        card_name : str</span>
<span class="sd">            the card_name -&gt; &#39;GRID&#39;</span>
<span class="sd">        comment : str</span>
<span class="sd">            an optional the comment for the card</span>
<span class="sd">        is_list : bool, optional</span>
<span class="sd">            False : input is a list of card fields -&gt; [&#39;GRID&#39;, 1, None, 3.0, 4.0, 5.0]</span>
<span class="sd">            True :  input is list of card_lines -&gt; [&#39;GRID, 1,, 3.0, 4.0, 5.0&#39;]</span>
<span class="sd">        has_none : bool; default=True</span>
<span class="sd">            can there be trailing Nones in the card data (e.g. [&#39;GRID&#39;, 1, 2, 3.0, 4.0, 5.0, None])</span>
<span class="sd">            can there be trailing Nones in the card data (e.g. [&#39;GRID, 1, 2, 3.0, 4.0, 5.0, &#39;])</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        class_instance : BaseCard()</span>
<span class="sd">            the card object representation of card</span>

<span class="sd">        .. code-block:: python</span>

<span class="sd">           &gt;&gt;&gt; model = BDF()</span>

<span class="sd">           # is_list is a somewhat misleading name; is it a list of card_lines</span>
<span class="sd">           # where a card_line is an unparsed string</span>
<span class="sd">           &gt;&gt;&gt; card_lines = [&#39;GRID,1,2&#39;]</span>
<span class="sd">           &gt;&gt;&gt; comment = &#39;this is a comment&#39;</span>
<span class="sd">           &gt;&gt;&gt; model.add_card(card_lines, &#39;GRID&#39;, comment, is_list=True)</span>

<span class="sd">           # here is_list=False because it&#39;s been parsed</span>
<span class="sd">           &gt;&gt;&gt; card = [&#39;GRID&#39;, 1, 2,]</span>
<span class="sd">           &gt;&gt;&gt; model.add_card(card_lines, &#39;GRID&#39;, comment, is_list=False)</span>

<span class="sd">           # here is_list=False because it&#39;s been parsed</span>
<span class="sd">           # Note the None at the end of the 1st line, which is there</span>
<span class="sd">           #      because the CONM2 card has a blank field.</span>
<span class="sd">           #      It must be there.</span>
<span class="sd">           # We also set i32 on the 2nd line, so it will default to 0.0</span>
<span class="sd">           &gt;&gt;&gt; card = [</span>
<span class="sd">                   &#39;CONM2&#39;, eid, nid, cid, mass, x1, x2, x3, None,</span>
<span class="sd">                            i11, i21, i22, i31, None, i33,</span>
<span class="sd">               ]</span>
<span class="sd">           &gt;&gt;&gt; model.add_card(card_lines, &#39;CONM2&#39;, comment, is_list=False)</span>

<span class="sd">           # here&#39;s an alternate approach for the CONM2</span>
<span class="sd">           # we use Nastran&#39;s CSV format</span>
<span class="sd">           # There are many blank fields, but it&#39;s parsed exactly like a</span>
<span class="sd">           # standard CONM2.</span>
<span class="sd">           &gt;&gt;&gt; card = [</span>
<span class="sd">                   &#39;CONM2,1,2,3,10.0&#39;,</span>
<span class="sd">                   &#39;,1.0,,5.0&#39;</span>
<span class="sd">               ]</span>
<span class="sd">           &gt;&gt;&gt; model.add_card(card_lines, &#39;CONM2&#39;, comment, is_list=True)</span>

<span class="sd">        Notes</span>
<span class="sd">        -----</span>
<span class="sd">        This is a very useful method for interfacing with the code.</span>

<span class="sd">        The card_object is not a card-type object...so not a GRID</span>
<span class="sd">        card or CQUAD4 object.  It&#39;s a BDFCard Object.  However,</span>
<span class="sd">        you know the type (assuming a GRID), so just call the</span>
<span class="sd">        *mesh.Node(nid)* to get the Node object that was just</span>
<span class="sd">        created.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">card_name</span> <span class="o">=</span> <span class="n">card_name</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span>
        <span class="n">card_obj</span><span class="p">,</span> <span class="n">unused_card</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">create_card_object</span><span class="p">(</span>
            <span class="n">card_lines</span><span class="p">,</span> <span class="n">card_name</span><span class="p">,</span>
            <span class="n">is_list</span><span class="o">=</span><span class="n">is_list</span><span class="p">,</span> <span class="n">has_none</span><span class="o">=</span><span class="n">has_none</span><span class="p">)</span>
        <span class="n">class_instance</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_add_card_helper_hdf5</span><span class="p">(</span><span class="n">card_obj</span><span class="p">,</span> <span class="n">card_name</span><span class="p">,</span> <span class="n">card_name</span><span class="p">,</span> <span class="n">comment</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">class_instance</span>

    <span class="k">def</span> <span class="nf">_add_card_helper_hdf5</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">card_obj</span><span class="p">,</span> <span class="n">card</span><span class="p">,</span> <span class="n">card_name</span><span class="p">,</span> <span class="n">comment</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">):</span>
        <span class="c1"># type: (BDFCard, List[str], str, str) -&gt; None</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Adds a card object to the BDF object.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        card_object : BDFCard()</span>
<span class="sd">            the card object representation of card</span>
<span class="sd">        card : List[str]</span>
<span class="sd">            the fields of the card object; used for rejection and special cards</span>
<span class="sd">        card_name : str</span>
<span class="sd">            the card_name -&gt; &#39;GRID&#39;</span>
<span class="sd">        comment : str</span>
<span class="sd">            an optional the comment for the card</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        class_instance : obj or None</span>
<span class="sd">            obj : GRID, CQUAD4, ...</span>
<span class="sd">            None : ECHOON, ECHOOFF, reject</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">card_name</span> <span class="o">==</span> <span class="s1">&#39;ECHOON&#39;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">echo</span> <span class="o">=</span> <span class="kc">True</span>
            <span class="k">return</span> <span class="kc">None</span>
        <span class="k">elif</span> <span class="n">card_name</span> <span class="o">==</span> <span class="s1">&#39;ECHOOFF&#39;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">echo</span> <span class="o">=</span> <span class="kc">False</span>
            <span class="k">return</span> <span class="kc">None</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">echo</span> <span class="ow">and</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">force_echo_off</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="n">print_card_8</span><span class="p">(</span><span class="n">card_obj</span><span class="p">)</span><span class="o">.</span><span class="n">rstrip</span><span class="p">())</span>
            <span class="k">except</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">card</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;DEQATN&#39;</span><span class="p">]:</span>
                    <span class="nb">print</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">card_obj</span><span class="p">)</span><span class="o">.</span><span class="n">rstrip</span><span class="p">())</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="nb">print</span><span class="p">(</span><span class="n">print_card_16</span><span class="p">(</span><span class="n">card_obj</span><span class="p">)</span><span class="o">.</span><span class="n">rstrip</span><span class="p">())</span>

        <span class="k">if</span> <span class="n">card_name</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_card_parser</span><span class="p">:</span>
            <span class="n">card_class</span><span class="p">,</span> <span class="n">add_card_function</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_card_parser</span><span class="p">[</span><span class="n">card_name</span><span class="p">]</span>

            <span class="c1"># simplified, so no error catching</span>
            <span class="n">class_instance</span> <span class="o">=</span> <span class="n">card_class</span><span class="o">.</span><span class="n">add_card</span><span class="p">(</span><span class="n">card_obj</span><span class="p">,</span> <span class="n">comment</span><span class="o">=</span><span class="n">comment</span><span class="p">)</span>
            <span class="c1">#add_card_function(class_instance)</span>

        <span class="k">elif</span> <span class="n">card_name</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_card_parser_prepare</span><span class="p">:</span>
            <span class="n">add_card_function</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_card_parser_prepare</span><span class="p">[</span><span class="n">card_name</span><span class="p">]</span>
            <span class="c1"># simplified, so no error catching</span>
            <span class="n">class_instance</span> <span class="o">=</span> <span class="n">add_card_function</span><span class="p">(</span><span class="n">card</span><span class="p">,</span> <span class="n">card_obj</span><span class="p">,</span> <span class="n">comment</span><span class="o">=</span><span class="n">comment</span><span class="p">)</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">reject_cards</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">card_obj</span><span class="p">)</span>
            <span class="n">class_instance</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">return</span> <span class="n">class_instance</span>

<div class="viewcode-block" id="BDF"><a class="viewcode-back" href="../../../reference/bdf/pyNastran.bdf.bdf.html#pyNastran.bdf.bdf.BDF">[docs]</a><span class="k">class</span> <span class="nc">BDF</span><span class="p">(</span><span class="n">BDF_</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;NASTRAN BDF Reader/Writer/Editor class.&quot;&quot;&quot;</span>
    <span class="n">_properties</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;is_bdf_vectorized&#39;</span><span class="p">,</span> <span class="s1">&#39;nid_map&#39;</span><span class="p">,</span> <span class="s1">&#39;wtmass&#39;</span><span class="p">,</span> <span class="s1">&#39;type_slot_str&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="p">[</span>
        <span class="s1">&#39;nastran_format&#39;</span><span class="p">,</span> <span class="s1">&#39;is_long_ids&#39;</span><span class="p">,</span> <span class="s1">&#39;sol&#39;</span><span class="p">,</span> <span class="s1">&#39;subcases&#39;</span><span class="p">,</span>
        <span class="s1">&#39;nnodes&#39;</span><span class="p">,</span> <span class="s1">&#39;node_ids&#39;</span><span class="p">,</span> <span class="s1">&#39;point_ids&#39;</span><span class="p">,</span> <span class="s1">&#39;npoints&#39;</span><span class="p">,</span>
        <span class="s1">&#39;nelements&#39;</span><span class="p">,</span> <span class="s1">&#39;element_ids&#39;</span><span class="p">,</span> <span class="s1">&#39;nproperties&#39;</span><span class="p">,</span> <span class="s1">&#39;property_ids&#39;</span><span class="p">,</span>
        <span class="s1">&#39;nmaterials&#39;</span><span class="p">,</span> <span class="s1">&#39;material_ids&#39;</span><span class="p">,</span> <span class="s1">&#39;ncoords&#39;</span><span class="p">,</span> <span class="s1">&#39;coord_ids&#39;</span><span class="p">,</span>
        <span class="s1">&#39;ncaeros&#39;</span><span class="p">,</span> <span class="s1">&#39;caero_ids&#39;</span><span class="p">,</span> <span class="s1">&#39;wtmass&#39;</span><span class="p">,</span> <span class="s1">&#39;is_bdf_vectorized&#39;</span><span class="p">,</span> <span class="s1">&#39;nid_map&#39;</span><span class="p">,</span>
        <span class="c1">#&#39;dmigs&#39;, &#39;dmijs&#39;, &#39;dmiks&#39;, &#39;dmijis&#39;, &#39;dtis&#39;, &#39;dmis&#39;,</span>
    <span class="p">]</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">debug</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">log</span><span class="p">:</span> <span class="n">Any</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">mode</span><span class="p">:</span> <span class="nb">str</span><span class="o">=</span><span class="s1">&#39;msc&#39;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Initializes the BDF object</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        debug : bool/None; default=True</span>
<span class="sd">            used to set the logger if no logger is passed in</span>
<span class="sd">                True:  logs debug/info/warning/error messages</span>
<span class="sd">                False: logs info/warning/error messages</span>
<span class="sd">                None:  logs warning/error messages</span>
<span class="sd">        log : logging module object / None</span>
<span class="sd">            if log is set, debug is ignored and uses the</span>
<span class="sd">            settings the logging object has</span>
<span class="sd">        mode : str; default=&#39;msc&#39;</span>
<span class="sd">            the type of Nastran</span>
<span class="sd">            valid_modes = {&#39;msc&#39;, &#39;nx&#39;}</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">BDF_</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">debug</span><span class="o">=</span><span class="n">debug</span><span class="p">,</span> <span class="n">log</span><span class="o">=</span><span class="n">log</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="n">mode</span><span class="p">)</span>
        <span class="c1">#: stores SPOINT, GRID cards</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">nodes</span> <span class="o">=</span> <span class="p">{}</span>  <span class="c1"># type: Dict[int, Any]</span>

        <span class="c1"># loads</span>
        <span class="c1">#: stores LOAD, FORCE, FORCE1, FORCE2, MOMENT, MOMENT1, MOMENT2,</span>
        <span class="c1">#: PLOAD, PLOAD2, PLOAD4, SLOAD</span>
        <span class="c1">#: GMLOAD, SPCD, DEFORM,</span>
        <span class="c1">#: QVOL</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">loads</span> <span class="o">=</span> <span class="p">{}</span>  <span class="c1"># type: Dict[int, List[Any]]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">load_combinations</span> <span class="o">=</span> <span class="p">{}</span>  <span class="c1"># type: Dict[int, List[Any]]</span>

    <span class="k">def</span> <span class="nf">__deepcopy__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">memo</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]):</span>
        <span class="sd">&quot;&quot;&quot;performs a deepcopy&quot;&quot;&quot;</span>
        <span class="c1">#newone = type(self)()</span>
        <span class="c1">#newone.__dict__.update(self.__dict__)</span>
        <span class="c1">#return newone</span>
        <span class="bp">cls</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span>
        <span class="n">result</span> <span class="o">=</span> <span class="bp">cls</span><span class="o">.</span><span class="fm">__new__</span><span class="p">(</span><span class="bp">cls</span><span class="p">)</span>
        <span class="n">memo</span><span class="p">[</span><span class="nb">id</span><span class="p">(</span><span class="bp">self</span><span class="p">)]</span> <span class="o">=</span> <span class="n">result</span>
        <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__dict__</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="nb">setattr</span><span class="p">(</span><span class="n">result</span><span class="p">,</span> <span class="n">key</span><span class="p">,</span> <span class="n">deepcopy</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">memo</span><span class="p">))</span>
        <span class="k">return</span> <span class="n">result</span>

    <span class="k">def</span> <span class="nf">__copy__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;performs a copy&quot;&quot;&quot;</span>
        <span class="n">newone</span> <span class="o">=</span> <span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)()</span>
        <span class="n">newone</span><span class="o">.</span><span class="vm">__dict__</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="vm">__dict__</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">newone</span>

    <span class="k">def</span> <span class="nf">_add_superelements</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">superelement_lines</span><span class="p">,</span> <span class="n">superelement_ilines</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">superelement_id</span><span class="p">,</span> <span class="n">superelement_line</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">superelement_lines</span><span class="o">.</span><span class="n">items</span><span class="p">()):</span>
            <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">superelement_line</span><span class="p">,</span> <span class="nb">list</span><span class="p">),</span> <span class="n">superelement_line</span>

            <span class="c1"># hack to get rid of extra &#39;BEGIN SUPER=2&#39; lines</span>
            <span class="n">iminus</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">superelement_line</span><span class="p">:</span>
                <span class="n">uline</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="n">uline</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;BEGIN &#39;</span><span class="p">):</span>
                    <span class="k">break</span>
                <span class="n">iminus</span> <span class="o">+=</span> <span class="mi">1</span>

            <span class="n">nlines</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">superelement_line</span><span class="p">)</span> <span class="o">-</span> <span class="n">iminus</span>
            <span class="n">model</span> <span class="o">=</span> <span class="n">BDF</span><span class="p">()</span>
            <span class="n">model</span><span class="o">.</span><span class="n">active_filenames</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">active_filenames</span>
            <span class="n">model</span><span class="o">.</span><span class="n">log</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">log</span>
            <span class="n">model</span><span class="o">.</span><span class="n">punch</span> <span class="o">=</span> <span class="kc">True</span>
            <span class="c1">#model.nastran_format = &#39;&#39;</span>
            <span class="n">superelement_ilines</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">nlines</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="s1">&#39;int32&#39;</span><span class="p">)</span>  <span class="c1">## TODO: calculate this</span>
            <span class="n">model</span><span class="o">.</span><span class="n">_parse_all_cards</span><span class="p">(</span><span class="n">superelement_line</span><span class="p">[</span><span class="n">iminus</span><span class="p">:],</span> <span class="n">superelement_ilines</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">superelement_models</span><span class="p">[</span><span class="n">superelement_id</span><span class="p">]</span> <span class="o">=</span> <span class="n">model</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">initial_superelement_models</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">superelement_id</span><span class="p">)</span></div>


<span class="k">def</span> <span class="nf">_echo_card</span><span class="p">(</span><span class="n">card</span><span class="p">,</span> <span class="n">card_obj</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;echos a card&quot;&quot;&quot;</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">print_card_8</span><span class="p">(</span><span class="n">card_obj</span><span class="p">)</span><span class="o">.</span><span class="n">rstrip</span><span class="p">())</span>
    <span class="k">except</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">card</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;DEQATN&#39;</span><span class="p">]:</span>
            <span class="nb">print</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">card_obj</span><span class="p">)</span><span class="o">.</span><span class="n">rstrip</span><span class="p">())</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">print_card_16</span><span class="p">(</span><span class="n">card_obj</span><span class="p">)</span><span class="o">.</span><span class="n">rstrip</span><span class="p">())</span>

<div class="viewcode-block" id="read_bdf"><a class="viewcode-back" href="../../../reference/bdf/pyNastran.bdf.bdf.html#pyNastran.bdf.bdf.read_bdf">[docs]</a><span class="k">def</span> <span class="nf">read_bdf</span><span class="p">(</span><span class="n">bdf_filename</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">validate</span><span class="p">:</span> <span class="nb">bool</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">xref</span><span class="p">:</span> <span class="nb">bool</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">punch</span><span class="p">:</span> <span class="nb">bool</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
             <span class="n">save_file_structure</span><span class="p">:</span> <span class="nb">bool</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
             <span class="n">skip_cards</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
             <span class="n">read_cards</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
             <span class="n">encoding</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
             <span class="n">log</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
             <span class="n">debug</span><span class="p">:</span> <span class="nb">bool</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">mode</span><span class="p">:</span> <span class="nb">str</span><span class="o">=</span><span class="s1">&#39;msc&#39;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">BDF</span><span class="p">:</span>
    <span class="c1"># Optional[SimpleLogger]</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Creates the BDF object</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    bdf_filename : str (default=None -&gt; popup)</span>
<span class="sd">        the bdf filename</span>
<span class="sd">    debug : bool/None</span>
<span class="sd">        used to set the logger if no logger is passed in</span>
<span class="sd">            True:  logs debug/info/error messages</span>
<span class="sd">            False: logs info/error messages</span>
<span class="sd">            None:  logs error messages</span>
<span class="sd">    log : logging module object / None</span>
<span class="sd">        if log is set, debug is ignored and uses the</span>
<span class="sd">        settings the logging object has</span>
<span class="sd">    validate : bool; default=True</span>
<span class="sd">        runs various checks on the BDF</span>
<span class="sd">    xref :  bool; default=True</span>
<span class="sd">        should the bdf be cross referenced</span>
<span class="sd">    punch : bool; default=False</span>
<span class="sd">        indicates whether the file is a punch file</span>
<span class="sd">    save_file_structure : bool; default=False</span>
<span class="sd">        enables the ``write_bdfs`` method</span>
<span class="sd">    skip_cards : List[str]; default=None</span>
<span class="sd">        None : include all cards</span>
<span class="sd">        list of cards to skip</span>
<span class="sd">    read_cards : List[str]; default=None</span>
<span class="sd">        None : include all cards</span>
<span class="sd">        list of cards to read (all the cards)</span>
<span class="sd">    encoding : str; default=None -&gt; system default</span>
<span class="sd">        the unicode encoding</span>
<span class="sd">    mode : str; default=&#39;msc&#39;</span>
<span class="sd">        the type of Nastran</span>
<span class="sd">        valid_modes = {&#39;msc&#39;, &#39;nx&#39;}</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    model : BDF()</span>
<span class="sd">        an BDF object</span>

<span class="sd">    .. code-block:: python</span>

<span class="sd">       &gt;&gt;&gt; bdf = BDF()</span>
<span class="sd">       &gt;&gt;&gt; bdf.read_bdf(bdf_filename, xref=True)</span>
<span class="sd">       &gt;&gt;&gt; g1 = bdf.Node(1)</span>
<span class="sd">       &gt;&gt;&gt; print(g1.get_position())</span>
<span class="sd">       [10.0, 12.0, 42.0]</span>
<span class="sd">       &gt;&gt;&gt; bdf.write_card(bdf_filename2)</span>
<span class="sd">       &gt;&gt;&gt; print(bdf.card_stats())</span>

<span class="sd">       ---BDF Statistics---</span>
<span class="sd">       SOL 101</span>
<span class="sd">       bdf.nodes = 20</span>
<span class="sd">       bdf.elements = 10</span>
<span class="sd">       etc.</span>

<span class="sd">    .. note :: this method will change in order to return an object that</span>
<span class="sd">               does not have so many methods</span>
<span class="sd">    .. todo:: finish this</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">model</span> <span class="o">=</span> <span class="n">BDF</span><span class="p">(</span><span class="n">log</span><span class="o">=</span><span class="n">log</span><span class="p">,</span> <span class="n">debug</span><span class="o">=</span><span class="n">debug</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="n">mode</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">read_cards</span> <span class="ow">and</span> <span class="n">skip_cards</span><span class="p">:</span>
        <span class="n">msg</span> <span class="o">=</span> <span class="s1">&#39;read_cards=</span><span class="si">%s</span><span class="s1"> skip_cards=</span><span class="si">%s</span><span class="s1"> cannot be used at the same time&#39;</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">skip_cards</span><span class="p">:</span>
        <span class="n">model</span><span class="o">.</span><span class="n">disable_cards</span><span class="p">(</span><span class="n">skip_cards</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">read_cards</span><span class="p">:</span>
        <span class="n">model</span><span class="o">.</span><span class="n">set_cards</span><span class="p">(</span><span class="n">read_cards</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">bdf_filename</span> <span class="ow">and</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">bdf_filename</span><span class="p">,</span> <span class="n">StringIO</span><span class="p">):</span>
        <span class="n">check_path</span><span class="p">(</span><span class="n">bdf_filename</span><span class="p">,</span> <span class="s1">&#39;bdf_filename&#39;</span><span class="p">)</span>
    <span class="n">model</span><span class="o">.</span><span class="n">read_bdf</span><span class="p">(</span><span class="n">bdf_filename</span><span class="o">=</span><span class="n">bdf_filename</span><span class="p">,</span> <span class="n">validate</span><span class="o">=</span><span class="n">validate</span><span class="p">,</span>
                   <span class="n">xref</span><span class="o">=</span><span class="n">xref</span><span class="p">,</span> <span class="n">punch</span><span class="o">=</span><span class="n">punch</span><span class="p">,</span> <span class="n">read_includes</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                   <span class="n">save_file_structure</span><span class="o">=</span><span class="n">save_file_structure</span><span class="p">,</span>
                   <span class="n">encoding</span><span class="o">=</span><span class="n">encoding</span><span class="p">)</span>

    <span class="c1">#if 0:</span>
        <span class="c1">### TODO: remove all the extra methods</span>

        <span class="c1">#keys_to_suppress = []</span>
        <span class="c1">#method_names = model.object_methods(keys_to_skip=keys_to_suppress)</span>

        <span class="c1">#methods_to_remove = [</span>
            <span class="c1">#&#39;_process_card&#39;, &#39;read_bdf&#39;, &#39;disable_cards&#39;, &#39;set_dynamic_syntax&#39;,</span>
            <span class="c1">#&#39;create_card_object&#39;, &#39;create_card_object_fields&#39;, &#39;create_card_object_list&#39;,</span>

            <span class="c1">#&#39;add_AECOMP&#39;, &#39;add_AEFACT&#39;, &#39;add_AELINK&#39;, &#39;add_AELIST&#39;, &#39;add_AEPARM&#39;, &#39;add_AERO&#39;,</span>
            <span class="c1">#&#39;add_AEROS&#39;, &#39;add_AESTAT&#39;, &#39;add_AESURF&#39;, &#39;add_ASET&#39;, &#39;add_BCRPARA&#39;, &#39;add_BCTADD&#39;,</span>
            <span class="c1">#&#39;add_BCTPARA&#39;, &#39;add_BCTSET&#39;, &#39;add_BSET&#39;, &#39;add_BSURF&#39;, &#39;add_BSURFS&#39;, &#39;add_CAERO&#39;,</span>
            <span class="c1">#&#39;add_DIVERG&#39;,</span>
            <span class="c1">#&#39;add_CSET&#39;, &#39;add_CSSCHD&#39;, &#39;add_DAREA&#39;, &#39;add_DCONADD&#39;, &#39;add_DCONSTR&#39;, &#39;add_DDVAL&#39;,</span>
            <span class="c1">#&#39;add_DELAY&#39;, &#39;add_DEQATN&#39;, &#39;add_DESVAR&#39;, &#39;add_DLINK&#39;, &#39;add_DMI&#39;, &#39;add_DMIG&#39;,</span>
            <span class="c1">#&#39;add_DMIJ&#39;, &#39;add_DMIJI&#39;, &#39;add_DMIK&#39;, &#39;add_DPHASE&#39;, &#39;add_DRESP&#39;, &#39;add_DTABLE&#39;,</span>
            <span class="c1">#&#39;add_DVMREL&#39;, &#39;add_DVPREL&#39;, &#39;add_EPOINT&#39;, &#39;add_FLFACT&#39;, &#39;add_FLUTTER&#39;, &#39;add_FREQ&#39;,</span>
            <span class="c1">#&#39;add_GUST&#39;, &#39;add_LSEQ&#39;, &#39;add_MKAERO&#39;, &#39;add_MONPNT&#39;, &#39;add_NLPARM&#39;, &#39;add_NLPCI&#39;,</span>
            <span class="c1">#&#39;add_PAERO&#39;, &#39;add_PARAM&#39;, &#39;add_PBUSHT&#39;, &#39;add_PDAMPT&#39;, &#39;add_PELAST&#39;, &#39;add_PHBDY&#39;,</span>
            <span class="c1">#&#39;add_QSET&#39;, &#39;add_SEBSET&#39;, &#39;add_SECSET&#39;, &#39;add_SEQSET&#39;, &#39;add_SESET&#39;, &#39;add_SET&#39;,</span>
            <span class="c1">#&#39;add_SEUSET&#39;, &#39;add_SPLINE&#39;, &#39;add_spoint&#39;, &#39;add_tempd&#39;, &#39;add_TF&#39;, &#39;add_TRIM&#39;,</span>
            <span class="c1">#&#39;add_TSTEP&#39;, &#39;add_TSTEPNL&#39;, &#39;add_USET&#39;,</span>

            <span class="c1">#&#39;add_card&#39;, &#39;add_card_fields&#39;, &#39;add_card_lines&#39;, &#39;add_cmethod&#39;, &#39;add_constraint&#39;,</span>
            <span class="c1">#&#39;add_constraint_MPC&#39;, &#39;add_constraint_MPCADD&#39;,</span>
            <span class="c1">#&#39;add_constraint_SPC&#39;, &#39;add_constraint_SPCADD&#39;,</span>
            <span class="c1">#&#39;add_convection_property&#39;, &#39;add_coord&#39;, &#39;add_creep_material&#39;, &#39;add_damper&#39;,</span>
            <span class="c1">#&#39;add_dload&#39;, &#39;_add_dload_entry&#39;, &#39;add_element&#39;, &#39;add_hyperelastic_material&#39;,</span>
            <span class="c1">#&#39;add_load&#39;, &#39;add_mass&#39;, &#39;add_material_dependence&#39;, &#39;add_method&#39;, &#39;add_node&#39;,</span>
            <span class="c1">#&#39;add_plotel&#39;, &#39;add_property&#39;, &#39;add_property_mass&#39;, &#39;add_random_table&#39;,</span>
            <span class="c1">#&#39;add_rigid_element&#39;, &#39;add_structural_material&#39;, &#39;add_suport&#39;, &#39;add_suport1&#39;,</span>
            <span class="c1">#&#39;add_table&#39;, &#39;add_table_sdamping&#39;, &#39;add_thermal_BC&#39;, &#39;add_thermal_element&#39;,</span>
            <span class="c1">#&#39;add_thermal_load&#39;, &#39;add_thermal_material&#39;,</span>

            <span class="c1">#&#39;set_as_msc&#39;,</span>
            <span class="c1">#&#39;set_as_nx&#39;,</span>

            <span class="c1">#&#39;pop_parse_errors&#39;,</span>
            <span class="c1">##&#39;pop_xref_errors&#39;,</span>
            <span class="c1">#&#39;set_error_storage&#39;,</span>
            <span class="c1">#&#39;is_reject&#39;,</span>
        <span class="c1">#]</span>
        <span class="c1">#for method_name in method_names:</span>
            <span class="c1">#if method_name not in methods_to_remove + keys_to_suppress:</span>
                <span class="c1">##print(method_name)</span>
                <span class="c1">#pass</span>
            <span class="c1">#else:</span>
                <span class="c1">### TODO: doesn&#39;t work...</span>
                <span class="c1">##delattr(model, method_name)</span>
                <span class="c1">#pass</span>
        <span class="c1">#model.get_bdf_stats()</span>
    <span class="k">return</span> <span class="n">model</span></div>


<span class="k">def</span> <span class="nf">_prep_comment</span><span class="p">(</span><span class="n">comment</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">comment</span><span class="o">.</span><span class="n">rstrip</span><span class="p">()</span>
    <span class="c1">#print(&#39;comment = %r&#39; % comment)</span>
    <span class="c1">#comment = &#39;  this\n  is\n  a comment\n&#39;</span>
    <span class="c1">#print(comment.rstrip(&#39;\n&#39;).split(&#39;\n&#39;))</span>
    <span class="c1">#sline = [comment[1:] if len(comment) and comment[0] == &#39; &#39; else comment</span>
             <span class="c1">#for comment in comment.rstrip().split(&#39;\n&#39;)]</span>
    <span class="c1">#print(&#39;sline = &#39;, sline)</span>

<span class="k">def</span> <span class="nf">_check_for_spaces</span><span class="p">(</span><span class="n">card_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">card_lines</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="n">comment</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">log</span><span class="p">:</span> <span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
    <span class="k">if</span> <span class="s1">&#39; &#39;</span> <span class="ow">in</span> <span class="n">card_name</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">card_name</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="n">EXECUTIVE_CASE_SPACES</span><span class="p">):</span>  <span class="c1"># TODO verify upper</span>
            <span class="n">msg</span> <span class="o">=</span> <span class="p">(</span>
                <span class="s1">&#39;No spaces allowed in card name </span><span class="si">%r</span><span class="s1">.</span><span class="se">\n</span><span class="s1">&#39;</span>
                <span class="s1">&#39;Did you mean to call read_bdf(punch=False) instead of &#39;</span>
                <span class="s1">&#39;read_bdf(punch=True)?</span><span class="se">\n</span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span>
                    <span class="n">card_name</span><span class="p">,</span> <span class="n">card_lines</span><span class="p">))</span>
            <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">card_name</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;BEGIN &#39;</span><span class="p">):</span>
            <span class="n">uline</span> <span class="o">=</span> <span class="n">card_lines</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span>
            <span class="k">if</span> <span class="s1">&#39;SUPER&#39;</span> <span class="ow">in</span> <span class="n">uline</span><span class="p">:</span>
                <span class="n">msg</span> <span class="o">=</span> <span class="p">(</span>
                    <span class="s1">&#39;Misindentified Superelement section.  Use:</span><span class="se">\n</span><span class="s1">&#39;</span>
                    <span class="s1">&#39;$ pyNastran: is_superelements=True</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">msg</span> <span class="o">=</span> <span class="p">(</span>
                    <span class="s1">&#39;Is there a second BEGIN BULK in your deck?</span><span class="se">\n</span><span class="s1">&#39;</span>
                    <span class="s1">&#39;Another possibility is that punch=True and there is a &#39;</span>
                    <span class="s1">&#39;BEGIN BULK in your deck.</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
            <span class="n">msg</span> <span class="o">+=</span> <span class="s1">&#39;</span><span class="si">%s</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">card_lines</span>
            <span class="n">log</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
            <span class="k">raise</span> <span class="n">SuperelementFlagError</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">msg</span> <span class="o">=</span> <span class="p">(</span>
                <span class="s1">&#39;No spaces allowed in card name </span><span class="si">%r</span><span class="s1">.</span><span class="se">\n</span><span class="s1">&#39;</span>
                <span class="s1">&#39;Should this be a comment?</span><span class="se">\n</span><span class="si">%s%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span>
                    <span class="n">card_name</span><span class="p">,</span> <span class="n">comment</span><span class="p">,</span> <span class="n">card_lines</span><span class="p">))</span>
        <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">card_name</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;SUBCASE &#39;</span><span class="p">,</span> <span class="s1">&#39;CEND&#39;</span><span class="p">]:</span>
        <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s1">&#39;No executive/case control deck was defined.&#39;</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">_check_replicated_cards</span><span class="p">(</span><span class="n">replicated_cards</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;helper method for ``parse_cards_list``&quot;&quot;&quot;</span>
    <span class="n">replicated_card_old</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">replicated_card</span> <span class="ow">in</span> <span class="n">replicated_cards</span><span class="p">:</span>
            <span class="k">assert</span> <span class="n">replicated_card</span> <span class="o">!=</span> <span class="n">replicated_card_old</span>
            <span class="n">replicated_card_old</span> <span class="o">=</span> <span class="n">replicated_card</span>
    <span class="k">except</span> <span class="ne">AssertionError</span><span class="p">:</span>
        <span class="c1">#print(&#39;card_list = %s&#39; % card_list)</span>
        <span class="c1">#print(&#39;card_lines = %s&#39; % card_lines)</span>
        <span class="n">replicated_card_old</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">replicated_card</span> <span class="ow">in</span> <span class="n">replicated_cards</span><span class="p">:</span>
            <span class="c1">#print(&#39;adding &#39;, replicated_card)</span>
            <span class="k">assert</span> <span class="n">replicated_card</span> <span class="o">!=</span> <span class="n">replicated_card_old</span>
            <span class="n">replicated_card_old</span> <span class="o">=</span> <span class="n">replicated_card</span>
        <span class="k">raise</span>


<span class="k">def</span> <span class="nf">_set_nodes</span><span class="p">(</span><span class="n">model</span><span class="p">:</span> <span class="n">BDF</span><span class="p">,</span>
               <span class="n">spoints</span><span class="p">,</span> <span class="n">epoints</span><span class="p">,</span>
               <span class="n">nnodes</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">nspoints</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">nepoints</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">ngridb</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
               <span class="n">idtype</span><span class="p">,</span> <span class="n">fdtype</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;helper method for ``get_displacement_index_xyz_cp_cd``&quot;&quot;&quot;</span>
    <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">nids_cd_transform</span> <span class="o">=</span> <span class="n">defaultdict</span><span class="p">(</span><span class="nb">list</span><span class="p">)</span>  <span class="c1"># type: Dict[int, np.ndarray]</span>
    <span class="n">nids_cp_transform</span> <span class="o">=</span> <span class="n">defaultdict</span><span class="p">(</span><span class="nb">list</span><span class="p">)</span>  <span class="c1"># type: Dict[int, np.ndarray]</span>
    <span class="n">nxyz</span> <span class="o">=</span> <span class="n">nnodes</span> <span class="o">+</span> <span class="n">nspoints</span> <span class="o">+</span> <span class="n">nepoints</span> <span class="o">+</span> <span class="n">ngridb</span>
    <span class="n">xyz_cp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">nxyz</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">fdtype</span><span class="p">)</span>
    <span class="n">nid_cp_cd</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">nxyz</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">idtype</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">nid</span><span class="p">,</span> <span class="n">node</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">nodes</span><span class="o">.</span><span class="n">items</span><span class="p">()):</span>
        <span class="n">cd</span> <span class="o">=</span> <span class="n">node</span><span class="o">.</span><span class="n">Cd</span><span class="p">()</span>
        <span class="n">cp</span> <span class="o">=</span> <span class="n">node</span><span class="o">.</span><span class="n">Cp</span><span class="p">()</span>
        <span class="n">nids_cp_transform</span><span class="p">[</span><span class="n">cp</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">nid</span><span class="p">)</span>
        <span class="n">nids_cd_transform</span><span class="p">[</span><span class="n">cd</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">nid</span><span class="p">)</span>
        <span class="n">nid_cp_cd</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="p">:]</span> <span class="o">=</span> <span class="p">[</span><span class="n">nid</span><span class="p">,</span> <span class="n">cp</span><span class="p">,</span> <span class="n">cd</span><span class="p">]</span>
        <span class="n">xyz_cp</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="p">:]</span> <span class="o">=</span> <span class="n">node</span><span class="o">.</span><span class="n">xyz</span>
        <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span>
    <span class="k">if</span> <span class="n">nspoints</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">nid</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">spoints</span><span class="p">):</span>
            <span class="n">nid_cp_cd</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">nid</span>
            <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span>
    <span class="k">if</span> <span class="n">nepoints</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">nid</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">epoints</span><span class="p">):</span>
            <span class="n">nid_cp_cd</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">nid</span>
            <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span>
    <span class="k">if</span> <span class="n">ngridb</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">nid</span><span class="p">,</span> <span class="n">node</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">gridb</span><span class="o">.</span><span class="n">items</span><span class="p">()):</span>
            <span class="n">phi</span> <span class="o">=</span> <span class="n">node</span><span class="o">.</span><span class="n">phi</span>
            <span class="n">cd</span> <span class="o">=</span> <span class="n">node</span><span class="o">.</span><span class="n">cd</span>
            <span class="n">ringfl_id</span> <span class="o">=</span> <span class="n">node</span><span class="o">.</span><span class="n">ringfl</span>
            <span class="n">ringfl</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">ringfl</span><span class="p">[</span><span class="n">ringfl_id</span><span class="p">]</span>
            <span class="n">x</span> <span class="o">=</span> <span class="n">ringfl</span><span class="o">.</span><span class="n">xa</span>  <span class="c1">## TODO: what about xb?</span>
            <span class="n">y</span> <span class="o">=</span> <span class="n">phi</span>  <span class="c1">## TODO: is this really phi?</span>
            <span class="n">z</span> <span class="o">=</span> <span class="mf">0.</span>
            <span class="n">axif</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">axif</span>
            <span class="n">cp</span> <span class="o">=</span> <span class="n">axif</span><span class="o">.</span><span class="n">cid</span>
            <span class="n">nid_cp_cd</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="p">:]</span> <span class="o">=</span> <span class="p">[</span><span class="n">nid</span><span class="p">,</span> <span class="n">cp</span><span class="p">,</span> <span class="n">cd</span><span class="p">]</span>
            <span class="n">xyz_cp</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="p">:]</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span><span class="p">]</span>
            <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span>
    <span class="k">return</span> <span class="n">nid_cp_cd</span><span class="p">,</span> <span class="n">xyz_cp</span><span class="p">,</span> <span class="n">nids_cd_transform</span><span class="p">,</span> <span class="n">nids_cp_transform</span>

<span class="k">def</span> <span class="nf">_bool</span><span class="p">(</span><span class="n">value</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;casts a lower string to a booean&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="kc">True</span> <span class="k">if</span> <span class="n">value</span> <span class="o">==</span> <span class="s1">&#39;true&#39;</span> <span class="k">else</span> <span class="kc">False</span>

<div class="viewcode-block" id="main"><a class="viewcode-back" href="../../../reference/bdf/pyNastran.bdf.bdf.html#pyNastran.bdf.bdf.main">[docs]</a><span class="k">def</span> <span class="nf">main</span><span class="p">():</span>  <span class="c1"># pragma: no cover</span>
    <span class="sd">&quot;&quot;&quot;shows off how unicode works becausee it&#39;s overly complicated&quot;&quot;&quot;</span>
    <span class="kn">import</span> <span class="nn">pyNastran</span>
    <span class="n">pkg_path</span> <span class="o">=</span> <span class="n">pyNastran</span><span class="o">.</span><span class="n">__path__</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">bdf_filename</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">abspath</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span>
        <span class="n">pkg_path</span><span class="p">,</span> <span class="s1">&#39;..&#39;</span><span class="p">,</span> <span class="s1">&#39;models&#39;</span><span class="p">,</span> <span class="s1">&#39;solid_bending&#39;</span><span class="p">,</span> <span class="s1">&#39;solid_bending.bdf&#39;</span><span class="p">))</span>
    <span class="n">model</span> <span class="o">=</span> <span class="n">BDF</span><span class="p">()</span>
    <span class="n">model</span><span class="o">.</span><span class="n">read_bdf</span><span class="p">(</span><span class="n">bdf_filename</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s1">&#39;latin-1&#39;</span><span class="p">)</span>
    <span class="n">node1</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">nodes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>

    <span class="c1"># decode when we receive, encode on send</span>
    <span class="n">note</span> <span class="o">=</span> <span class="s1">&#39;hell wrld from two&#39;</span>  <span class="c1"># must be same encoding as the header (utf-8)</span>
    <span class="c1">#note = b&#39;hell wrld from two\n&#39;.decode(&#39;utf-8&#39;)</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">note</span><span class="p">)</span>

    <span class="c1"># this will be wrong because it&#39;s inconsistent with the header (utf-8)</span>
    <span class="c1">#note = b&#39;&#39;.decode(&#39;latin-1&#39;)</span>

    <span class="c1"># this will work</span>
    <span class="n">note</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>

    <span class="c1"># so will this</span>
    <span class="c1">#note = b&#39;&#39;.decode(&#39;utf-8&#39;)</span>

    <span class="c1"># The encoding that goes into the comment must be consisent with the local</span>
    <span class="c1"># file, so if your print doesn&#39;t work right, your comment will be bad too.</span>
    <span class="c1">#</span>
    <span class="c1"># If the print is correct, assuming all the characters are supported in your</span>
    <span class="c1"># desired encoding, it *should* work.</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">note</span><span class="p">)</span>

    <span class="c1"># Comments are unmodified, so you can inadvertantly add cards/bugs.</span>
    <span class="c1"># A comment is a single string where all lines start with $ and end</span>
    <span class="c1"># with an endline character.</span>
    <span class="n">node1</span><span class="o">.</span><span class="n">comment</span> <span class="o">=</span> <span class="s1">&#39;$ &#39;</span> <span class="o">+</span> <span class="n">note</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span>

    <span class="c1"># in other words, msg is a bad comment:</span>
    <span class="n">msg</span> <span class="o">=</span> <span class="s1">&#39;$ line 1</span><span class="se">\n</span><span class="s1">&#39;</span>
    <span class="n">msg</span> <span class="o">+=</span> <span class="s1">&#39;line 2</span><span class="se">\n</span><span class="s1">&#39;</span>
    <span class="n">msg</span> <span class="o">+=</span> <span class="s1">&#39;$ line 3</span><span class="se">\n</span><span class="s1">&#39;</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
    <span class="n">model</span><span class="o">.</span><span class="n">write_bdf</span><span class="p">(</span><span class="s1">&#39;test.bdf&#39;</span><span class="p">)</span></div>


<span class="c1">#if __name__ == &#39;__main__&#39;:  # pragma: no cover</span>
    <span class="c1">#from pyNastran.bdf.test.test_bdf import main</span>
    <span class="c1">#main()</span>
</pre></div>

           </div>
           
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>
        &#169; Copyright 2021, Steven Doyle.

    </p>
  </div>
    
    
    
    Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>
        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>