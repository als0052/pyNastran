

<!DOCTYPE html>
<html class="writer-html4" lang="en" >
<head>
  <meta charset="utf-8" />
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
  <title>pyNastran.bdf.cards.optimization &mdash; pyNastran 1.4-dev 1.4-dev documentation</title>
  

  
  <link rel="stylesheet" href="../../../../_static/css/my_theme.css" type="text/css" />
  <link rel="stylesheet" href="../../../../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../../../../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../../../../_static/css/my_theme.css" type="text/css" />
  <link rel="stylesheet" href="../../../../_static/graphviz.css" type="text/css" />

  
  

  
  

  

  
  <!--[if lt IE 9]>
    <script src="../../../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../../../" src="../../../../_static/documentation_options.js"></script>
        <script data-url_root="../../../../" id="documentation_options" src="../../../../_static/documentation_options.js"></script>
        <script src="../../../../_static/jquery.js"></script>
        <script src="../../../../_static/underscore.js"></script>
        <script src="../../../../_static/doctools.js"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    
    <script type="text/javascript" src="../../../../_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="../../../../genindex.html" />
    <link rel="search" title="Search" href="../../../../search.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../../../../index.html" class="icon icon-home"> pyNastran 1.4-dev
          

          
            
            <img src="../../../../_static/logo.png" class="logo" alt="Logo"/>
          
          </a>

          
            
            
              <div class="version">
                1.4-dev
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul>
<li class="toctree-l1"><a class="reference internal" href="../../../../installation/index.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../quick_start/index.html">Quick Start</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../how_to/index.html">How To: pyNastran</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../reference/pyNastran.html">pyNastran Package</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../manual/index.html">pyNastran Manual</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../../index.html">pyNastran 1.4-dev</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          

















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../../../index.html" class="icon icon-home"></a> &raquo;</li>
        
          <li><a href="../../../index.html">Module code</a> &raquo;</li>
        
      <li>pyNastran.bdf.cards.optimization</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <h1>Source code for pyNastran.bdf.cards.optimization</h1><div class="highlight"><pre>
<span></span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">All optimization cards are defined in this file.  This includes:</span>

<span class="sd">* dconstrs - DCONSTR</span>
<span class="sd">* dconadds - DCONADD</span>
<span class="sd">* ddvals - DDVAL</span>
<span class="sd">* dlinks - DLINK</span>
<span class="sd">* dresps - DRESP1, DRESP2, DRESP3</span>
<span class="sd">* dscreen - DSCREEN</span>
<span class="sd">* dvgrids - DVGRID</span>
<span class="sd">* desvars - DESVAR</span>
<span class="sd">* dvcrels - DVCREL1, DVCREL2</span>
<span class="sd">* dvmrels - DVMREL1, DVMREL2</span>
<span class="sd">* dvprels - DVPREL1, DVPREL2</span>
<span class="sd">* doptprm - DOPTPRM</span>

<span class="sd">some missing optimization flags</span>
<span class="sd">http://mscnastrannovice.blogspot.com/2014/06/msc-nastran-design-optimization-quick.html&quot;&quot;&quot;</span>
<span class="c1"># pylint: disable=C0103,R0902,R0904,R0914</span>
<span class="kn">from</span> <span class="nn">__future__</span> <span class="kn">import</span> <span class="n">annotations</span>
<span class="kn">from</span> <span class="nn">typing</span> <span class="kn">import</span> <span class="n">TYPE_CHECKING</span>
<span class="kn">from</span> <span class="nn">itertools</span> <span class="kn">import</span> <span class="n">cycle</span><span class="p">,</span> <span class="n">count</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="kn">from</span> <span class="nn">pyNastran.utils.numpy_utils</span> <span class="kn">import</span> <span class="n">integer_types</span><span class="p">,</span> <span class="n">float_types</span>
<span class="kn">from</span> <span class="nn">pyNastran.bdf.field_writer_8</span> <span class="kn">import</span> <span class="n">set_blank_if_default</span>
<span class="kn">from</span> <span class="nn">pyNastran.bdf.cards.base_card</span> <span class="kn">import</span> <span class="p">(</span>
    <span class="n">BaseCard</span><span class="p">,</span> <span class="n">expand_thru_by</span><span class="p">,</span> <span class="n">break_word_by_trailing_integer</span><span class="p">,</span>
    <span class="n">break_word_by_trailing_parentheses_integer_ab</span><span class="p">)</span>
<span class="kn">from</span> <span class="nn">pyNastran.bdf.cards.deqatn</span> <span class="kn">import</span> <span class="n">fortran_to_python_short</span>
    <span class="c1">#collapse_thru_by_float, condense, build_thru_float)</span>
<span class="kn">from</span> <span class="nn">pyNastran.bdf.cards.properties.beam</span> <span class="kn">import</span> <span class="n">update_pbeam_negative_integer</span>
<span class="kn">from</span> <span class="nn">pyNastran.bdf.bdf_interface.assign_type</span> <span class="kn">import</span> <span class="p">(</span>
    <span class="n">integer</span><span class="p">,</span> <span class="n">integer_or_blank</span><span class="p">,</span> <span class="n">integer_or_string</span><span class="p">,</span> <span class="n">integer_string_or_blank</span><span class="p">,</span>
    <span class="n">double</span><span class="p">,</span> <span class="n">double_or_blank</span><span class="p">,</span> <span class="n">string</span><span class="p">,</span> <span class="n">string_or_blank</span><span class="p">,</span>
    <span class="n">integer_double_or_blank</span><span class="p">,</span> <span class="n">integer_double_string_or_blank</span><span class="p">,</span>
    <span class="n">double_string_or_blank</span><span class="p">,</span> <span class="n">interpret_value</span><span class="p">,</span> <span class="n">check_string</span><span class="p">)</span>
<span class="kn">from</span> <span class="nn">pyNastran.bdf.field_writer_8</span> <span class="kn">import</span> <span class="n">print_card_8</span>
<span class="kn">from</span> <span class="nn">pyNastran.bdf.field_writer_16</span> <span class="kn">import</span> <span class="n">print_card_16</span>
<span class="kn">from</span> <span class="nn">pyNastran.bdf.field_writer_double</span> <span class="kn">import</span> <span class="n">print_card_double</span>
<span class="kn">from</span> <span class="nn">pyNastran.bdf.cards.utils</span> <span class="kn">import</span> <span class="n">build_table_lines</span>
<span class="k">if</span> <span class="n">TYPE_CHECKING</span><span class="p">:</span>  <span class="c1"># pragma: no cover</span>
    <span class="kn">from</span> <span class="nn">pyNastran.bdf.bdf</span> <span class="kn">import</span> <span class="n">BDF</span>

<span class="c1">#TODO: replace this with formula</span>
<span class="n">valid_pcomp_codes</span> <span class="o">=</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="c1">#3-z0</span>
                     <span class="c1">#&#39;Z0&#39;,</span>
                     <span class="c1"># 13-t1, 14-theta1, 17-t2, 18-theta2</span>
                     <span class="mi">13</span><span class="p">,</span> <span class="mi">14</span><span class="p">,</span> <span class="mi">17</span><span class="p">,</span> <span class="mi">18</span><span class="p">,</span>
                     <span class="mi">23</span><span class="p">,</span> <span class="mi">24</span><span class="p">,</span> <span class="mi">27</span><span class="p">,</span> <span class="mi">28</span><span class="p">,</span>
                     <span class="mi">33</span><span class="p">,</span> <span class="mi">34</span><span class="p">,</span> <span class="mi">37</span><span class="p">,</span> <span class="mi">38</span><span class="p">,</span>
                     <span class="mi">43</span><span class="p">,</span> <span class="mi">44</span><span class="p">,</span> <span class="mi">47</span><span class="p">,</span> <span class="mi">48</span><span class="p">,</span>
                     <span class="mi">53</span><span class="p">,</span> <span class="mi">54</span><span class="p">,</span> <span class="mi">57</span><span class="p">,</span> <span class="mi">58</span><span class="p">,</span>
                     <span class="mi">63</span><span class="p">,</span> <span class="mi">64</span><span class="p">,</span> <span class="mi">67</span><span class="p">,</span> <span class="mi">68</span><span class="p">]</span>

<div class="viewcode-block" id="validate_dvcrel"><a class="viewcode-back" href="../../../../reference/bdf/cards/pyNastran.bdf.cards.optimization.html#pyNastran.bdf.cards.optimization.validate_dvcrel">[docs]</a><span class="k">def</span> <span class="nf">validate_dvcrel</span><span class="p">(</span><span class="n">validate</span><span class="p">,</span> <span class="n">element_type</span><span class="p">,</span> <span class="n">cp_name</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Valdiates the DVCREL1/2</span>

<span class="sd">    .. note:: words that start with integers (e.g., 12I/T**3) doesn&#39;t</span>
<span class="sd">              support strings</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">validate</span><span class="p">:</span>
        <span class="k">return</span>
    <span class="n">msg</span> <span class="o">=</span> <span class="s1">&#39;DVCRELx: element_type=</span><span class="si">%r</span><span class="s1"> cp_name=</span><span class="si">%r</span><span class="s1"> is invalid&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">element_type</span><span class="p">,</span> <span class="n">cp_name</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">element_type</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;CQUAD4&#39;</span><span class="p">]:</span>
        <span class="n">options</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;T1&#39;</span><span class="p">,</span> <span class="s1">&#39;T2&#39;</span><span class="p">,</span> <span class="s1">&#39;T3&#39;</span><span class="p">,</span> <span class="s1">&#39;T4&#39;</span><span class="p">]</span> <span class="c1"># &#39;ZOFFS&#39;,</span>
        <span class="n">_check_dvcrel_options</span><span class="p">(</span><span class="n">cp_name</span><span class="p">,</span> <span class="n">element_type</span><span class="p">,</span> <span class="n">options</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">element_type</span> <span class="o">==</span> <span class="s1">&#39;CTRIA3&#39;</span><span class="p">:</span>
        <span class="n">options</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;T1&#39;</span><span class="p">,</span> <span class="s1">&#39;T2&#39;</span><span class="p">,</span> <span class="s1">&#39;T3&#39;</span><span class="p">]</span>
        <span class="n">_check_dvcrel_options</span><span class="p">(</span><span class="n">cp_name</span><span class="p">,</span> <span class="n">element_type</span><span class="p">,</span> <span class="n">options</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">element_type</span> <span class="o">==</span> <span class="s1">&#39;CONM2&#39;</span><span class="p">:</span>
        <span class="n">options</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;M&#39;</span><span class="p">,</span> <span class="s1">&#39;X1&#39;</span><span class="p">,</span> <span class="s1">&#39;X2&#39;</span><span class="p">,</span> <span class="s1">&#39;X3&#39;</span><span class="p">]</span>
        <span class="n">_check_dvcrel_options</span><span class="p">(</span><span class="n">cp_name</span><span class="p">,</span> <span class="n">element_type</span><span class="p">,</span> <span class="n">options</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">element_type</span> <span class="o">==</span> <span class="s1">&#39;CBAR&#39;</span><span class="p">:</span>
        <span class="n">options</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;X1&#39;</span><span class="p">,</span> <span class="s1">&#39;X2&#39;</span><span class="p">,</span> <span class="s1">&#39;X3&#39;</span><span class="p">,</span> <span class="s1">&#39;W1A&#39;</span><span class="p">,</span> <span class="s1">&#39;W2A&#39;</span><span class="p">,</span> <span class="s1">&#39;W3A&#39;</span><span class="p">,</span> <span class="s1">&#39;W1B&#39;</span><span class="p">,</span> <span class="s1">&#39;W2B&#39;</span><span class="p">,</span> <span class="s1">&#39;W3B&#39;</span><span class="p">]</span>
        <span class="n">_check_dvcrel_options</span><span class="p">(</span><span class="n">cp_name</span><span class="p">,</span> <span class="n">element_type</span><span class="p">,</span> <span class="n">options</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">element_type</span> <span class="o">==</span> <span class="s1">&#39;CBEAM&#39;</span><span class="p">:</span>
        <span class="n">options</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;X1&#39;</span><span class="p">,</span> <span class="s1">&#39;X2&#39;</span><span class="p">,</span> <span class="s1">&#39;X3&#39;</span><span class="p">]</span>
        <span class="n">_check_dvcrel_options</span><span class="p">(</span><span class="n">cp_name</span><span class="p">,</span> <span class="n">element_type</span><span class="p">,</span> <span class="n">options</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">element_type</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;CELAS1&#39;</span><span class="p">]:</span>
        <span class="n">options</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">_check_dvcrel_options</span><span class="p">(</span><span class="n">cp_name</span><span class="p">,</span> <span class="n">element_type</span><span class="p">,</span> <span class="n">options</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">element_type</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;CBUSH&#39;</span><span class="p">]:</span>
        <span class="n">options</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;X1&#39;</span><span class="p">,</span> <span class="s1">&#39;X2&#39;</span><span class="p">,</span> <span class="s1">&#39;X3&#39;</span><span class="p">,</span> <span class="s1">&#39;S&#39;</span><span class="p">,</span> <span class="s1">&#39;S1&#39;</span><span class="p">,</span> <span class="s1">&#39;S2&#39;</span><span class="p">,</span> <span class="s1">&#39;S3&#39;</span><span class="p">]</span>
        <span class="n">_check_dvcrel_options</span><span class="p">(</span><span class="n">cp_name</span><span class="p">,</span> <span class="n">element_type</span><span class="p">,</span> <span class="n">options</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">element_type</span> <span class="o">==</span> <span class="s1">&#39;CVISC&#39;</span><span class="p">:</span>
        <span class="n">options</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">_check_dvcrel_options</span><span class="p">(</span><span class="n">cp_name</span><span class="p">,</span> <span class="n">element_type</span><span class="p">,</span> <span class="n">options</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">element_type</span> <span class="o">==</span> <span class="s1">&#39;CGAP&#39;</span><span class="p">:</span>
        <span class="n">options</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">_check_dvcrel_options</span><span class="p">(</span><span class="n">cp_name</span><span class="p">,</span> <span class="n">element_type</span><span class="p">,</span> <span class="n">options</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">element_type</span> <span class="o">==</span> <span class="s1">&#39;CBUSH1D&#39;</span><span class="p">:</span>
        <span class="n">options</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">_check_dvcrel_options</span><span class="p">(</span><span class="n">cp_name</span><span class="p">,</span> <span class="n">element_type</span><span class="p">,</span> <span class="n">options</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span></div>


<div class="viewcode-block" id="validate_dvmrel"><a class="viewcode-back" href="../../../../reference/bdf/cards/pyNastran.bdf.cards.optimization.html#pyNastran.bdf.cards.optimization.validate_dvmrel">[docs]</a><span class="k">def</span> <span class="nf">validate_dvmrel</span><span class="p">(</span><span class="n">validate</span><span class="p">,</span> <span class="n">mat_type</span><span class="p">,</span> <span class="n">mp_name</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Valdiates the DVMREL1/2</span>

<span class="sd">    .. note::  words that start with integers (e.g., 12I/T**3) doesn&#39;t</span>
<span class="sd">               support strings</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">validate</span><span class="p">:</span>
        <span class="k">return</span>
    <span class="n">msg</span> <span class="o">=</span> <span class="s1">&#39;DVMRELx: mat_type=</span><span class="si">%r</span><span class="s1"> mp_name=</span><span class="si">%r</span><span class="s1"> is invalid&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">mat_type</span><span class="p">,</span> <span class="n">mp_name</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">mat_type</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;MAT1&#39;</span><span class="p">]:</span>
        <span class="k">assert</span> <span class="n">mp_name</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;E&#39;</span><span class="p">,</span> <span class="s1">&#39;G&#39;</span><span class="p">,</span> <span class="s1">&#39;NU&#39;</span><span class="p">,</span> <span class="s1">&#39;GE&#39;</span><span class="p">,</span> <span class="s1">&#39;RHO&#39;</span><span class="p">,</span> <span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;TREF&#39;</span><span class="p">],</span> <span class="n">msg</span>
    <span class="k">elif</span> <span class="n">mat_type</span> <span class="o">==</span> <span class="s1">&#39;MAT2&#39;</span><span class="p">:</span>
        <span class="k">assert</span> <span class="n">mp_name</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;G11&#39;</span><span class="p">,</span> <span class="s1">&#39;G12&#39;</span><span class="p">,</span> <span class="s1">&#39;G22&#39;</span><span class="p">,</span> <span class="s1">&#39;G33&#39;</span><span class="p">,</span> <span class="s1">&#39;GE&#39;</span><span class="p">,</span> <span class="s1">&#39;RHO&#39;</span><span class="p">,</span>
                           <span class="s1">&#39;A1&#39;</span><span class="p">,</span> <span class="s1">&#39;A2&#39;</span><span class="p">,</span> <span class="s1">&#39;A3&#39;</span><span class="p">,</span> <span class="s1">&#39;TREF&#39;</span><span class="p">],</span> <span class="n">msg</span>
    <span class="k">elif</span> <span class="n">mat_type</span> <span class="o">==</span> <span class="s1">&#39;MAT3&#39;</span><span class="p">:</span>
        <span class="k">assert</span> <span class="n">mp_name</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;EX&#39;</span><span class="p">,</span> <span class="s1">&#39;ETH&#39;</span><span class="p">,</span> <span class="s1">&#39;EZ&#39;</span><span class="p">,</span> <span class="s1">&#39;NUTH&#39;</span><span class="p">,</span> <span class="s1">&#39;NUXTH&#39;</span><span class="p">,</span> <span class="s1">&#39;NUTHZ&#39;</span><span class="p">,</span> <span class="s1">&#39;NUZX&#39;</span><span class="p">,</span> <span class="s1">&#39;RHO&#39;</span><span class="p">],</span> <span class="n">msg</span>
    <span class="k">elif</span> <span class="n">mat_type</span> <span class="o">==</span> <span class="s1">&#39;MAT8&#39;</span><span class="p">:</span>
        <span class="k">assert</span> <span class="n">mp_name</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;E1&#39;</span><span class="p">,</span> <span class="s1">&#39;E2&#39;</span><span class="p">,</span> <span class="s1">&#39;G12&#39;</span><span class="p">,</span> <span class="s1">&#39;G1Z&#39;</span><span class="p">,</span> <span class="s1">&#39;G2Z&#39;</span><span class="p">,</span> <span class="s1">&#39;NU12&#39;</span><span class="p">,</span> <span class="s1">&#39;RHO&#39;</span><span class="p">,</span> <span class="s1">&#39;A1&#39;</span><span class="p">,</span> <span class="s1">&#39;A2&#39;</span><span class="p">],</span> <span class="n">msg</span>
    <span class="k">elif</span> <span class="n">mat_type</span> <span class="o">==</span> <span class="s1">&#39;MAT9&#39;</span><span class="p">:</span>
        <span class="k">assert</span> <span class="n">mp_name</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;G11&#39;</span><span class="p">,</span> <span class="s1">&#39;G22&#39;</span><span class="p">,</span> <span class="s1">&#39;G33&#39;</span><span class="p">,</span> <span class="s1">&#39;G44&#39;</span><span class="p">,</span> <span class="s1">&#39;G55&#39;</span><span class="p">,</span> <span class="s1">&#39;G66&#39;</span><span class="p">,</span> <span class="s1">&#39;RHO&#39;</span><span class="p">],</span> <span class="n">msg</span>
    <span class="k">elif</span> <span class="n">mat_type</span> <span class="o">==</span> <span class="s1">&#39;MAT10&#39;</span><span class="p">:</span>
        <span class="k">assert</span> <span class="n">mp_name</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;BULK&#39;</span><span class="p">,</span> <span class="s1">&#39;RHO&#39;</span><span class="p">],</span> <span class="n">msg</span>
    <span class="k">elif</span> <span class="n">mat_type</span> <span class="o">==</span> <span class="s1">&#39;MAT11&#39;</span><span class="p">:</span>
        <span class="k">assert</span> <span class="n">mp_name</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;E1&#39;</span><span class="p">,</span> <span class="s1">&#39;E2&#39;</span><span class="p">,</span> <span class="s1">&#39;E3&#39;</span><span class="p">,</span> <span class="s1">&#39;G12&#39;</span><span class="p">,</span> <span class="s1">&#39;G13&#39;</span><span class="p">,</span> <span class="s1">&#39;G23&#39;</span><span class="p">,</span> <span class="s1">&#39;RHO&#39;</span><span class="p">],</span> <span class="n">msg</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span></div>


<div class="viewcode-block" id="validate_dvprel"><a class="viewcode-back" href="../../../../reference/bdf/cards/pyNastran.bdf.cards.optimization.html#pyNastran.bdf.cards.optimization.validate_dvprel">[docs]</a><span class="k">def</span> <span class="nf">validate_dvprel</span><span class="p">(</span><span class="n">prop_type</span><span class="p">,</span> <span class="n">pname_fid</span><span class="p">,</span> <span class="n">validate</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Valdiates the DVPREL1/2</span>

<span class="sd">    .. note:: words that start with integers (e.g., 12I/T**3) doesn&#39;t</span>
<span class="sd">              support strings</span>
<span class="sd">    .. note:: FID &gt; 0 --&gt; references the Property Card</span>
<span class="sd">    .. note:: FID &lt; 0 --&gt; references the EPT card</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">validate</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">pname_fid</span>
    <span class="n">msg</span> <span class="o">=</span> <span class="s1">&#39;DVPREL1: prop_type=</span><span class="si">%r</span><span class="s1"> pname_fid=</span><span class="si">%r</span><span class="s1"> is invalid&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">prop_type</span><span class="p">,</span> <span class="n">pname_fid</span><span class="p">)</span>
    <span class="c1">#if prop_type == &#39;CELAS2&#39;:</span>
        <span class="c1">#assert pname_fid in [&#39;K&#39;, &#39;GE&#39;, &#39;S&#39;], msg</span>
    <span class="c1">#elif prop_type == &#39;CELAS4&#39;:</span>
        <span class="c1">#assert pname_fid in [&#39;K&#39;], msg</span>
    <span class="k">if</span> <span class="n">prop_type</span> <span class="o">==</span> <span class="s1">&#39;PELAS&#39;</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">pname_fid</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;K1&#39;</span><span class="p">,</span> <span class="mi">3</span><span class="p">]:</span>
            <span class="n">pname_fid</span> <span class="o">=</span> <span class="s1">&#39;K1&#39;</span>
        <span class="k">elif</span> <span class="n">pname_fid</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;GE1&#39;</span><span class="p">,</span> <span class="mi">4</span><span class="p">]:</span>
            <span class="n">pname_fid</span> <span class="o">=</span> <span class="s1">&#39;GE1&#39;</span>
        <span class="k">elif</span> <span class="n">pname_fid</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;S1&#39;</span><span class="p">,</span> <span class="mi">5</span><span class="p">]:</span>
            <span class="n">pname_fid</span> <span class="o">=</span> <span class="s1">&#39;S1&#39;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="s1">&#39;PELAS pname_fid=</span><span class="si">%r</span><span class="s1"> is invalid&#39;</span> <span class="o">%</span> <span class="n">pname_fid</span><span class="p">)</span>

    <span class="k">elif</span> <span class="n">prop_type</span> <span class="o">==</span> <span class="s1">&#39;PELAST&#39;</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">pname_fid</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;TKID&#39;</span><span class="p">,</span> <span class="mi">3</span><span class="p">]:</span>
            <span class="n">pname_fid</span> <span class="o">=</span> <span class="s1">&#39;TKID&#39;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="s1">&#39;PELAST pname_fid=</span><span class="si">%r</span><span class="s1"> is invalid&#39;</span> <span class="o">%</span> <span class="n">pname_fid</span><span class="p">)</span>
        <span class="k">assert</span> <span class="n">pname_fid</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="s1">&#39;TKID&#39;</span><span class="p">],</span> <span class="n">msg</span>

    <span class="k">elif</span> <span class="n">prop_type</span> <span class="o">==</span> <span class="s1">&#39;PROD&#39;</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">pname_fid</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="mi">4</span><span class="p">]:</span>
            <span class="n">pname_fid</span> <span class="o">=</span> <span class="s1">&#39;A&#39;</span>
        <span class="k">elif</span> <span class="n">pname_fid</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;J&#39;</span><span class="p">,</span> <span class="mi">5</span><span class="p">]:</span>
            <span class="n">pname_fid</span> <span class="o">=</span> <span class="s1">&#39;J&#39;</span>
        <span class="c1">#elif pname_fid in [&#39;C&#39;, 6]:</span>
            <span class="c1">#pname_fid = &#39;C&#39;</span>
        <span class="k">elif</span> <span class="n">pname_fid</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;NSM&#39;</span><span class="p">,</span> <span class="mi">7</span><span class="p">]:</span>
            <span class="n">pname_fid</span> <span class="o">=</span> <span class="s1">&#39;NSM&#39;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="s1">&#39;PROD pname_fid=</span><span class="si">%r</span><span class="s1"> is invalid&#39;</span> <span class="o">%</span> <span class="n">pname_fid</span><span class="p">)</span>
        <span class="k">assert</span> <span class="n">pname_fid</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="s1">&#39;J&#39;</span><span class="p">,</span> <span class="s1">&#39;NSM&#39;</span><span class="p">],</span> <span class="n">msg</span>

    <span class="k">elif</span> <span class="n">prop_type</span> <span class="o">==</span> <span class="s1">&#39;PTUBE&#39;</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">pname_fid</span> <span class="o">==</span> <span class="mi">4</span><span class="p">:</span>
            <span class="n">pname_fid</span> <span class="o">=</span> <span class="s1">&#39;OD&#39;</span>
        <span class="k">elif</span> <span class="n">pname_fid</span> <span class="o">==</span> <span class="mi">5</span><span class="p">:</span>
            <span class="n">pname_fid</span> <span class="o">=</span> <span class="s1">&#39;T&#39;</span>
        <span class="c1">#options = [4, 5, &#39;T&#39;]</span>
        <span class="n">options</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;T&#39;</span><span class="p">,</span> <span class="s1">&#39;OD&#39;</span><span class="p">]</span>
        <span class="n">_check_dvprel_options</span><span class="p">(</span><span class="n">pname_fid</span><span class="p">,</span> <span class="n">prop_type</span><span class="p">,</span> <span class="n">options</span><span class="p">)</span>

    <span class="c1">#elif prop_type == &#39;CBAR&#39;:</span>
        <span class="c1">#assert pname_fid in [&#39;X1&#39;, &#39;X2&#39;], msg</span>
    <span class="k">elif</span> <span class="n">prop_type</span> <span class="o">==</span> <span class="s1">&#39;PBAR&#39;</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">pname_fid</span> <span class="o">==</span> <span class="mi">4</span><span class="p">:</span>
            <span class="n">pname_fid</span> <span class="o">=</span> <span class="s1">&#39;A&#39;</span> <span class="c1"># I1 I2 J</span>
        <span class="k">elif</span> <span class="n">pname_fid</span> <span class="o">==</span> <span class="mi">5</span><span class="p">:</span>
            <span class="n">pname_fid</span> <span class="o">=</span> <span class="s1">&#39;I1&#39;</span>
        <span class="k">elif</span> <span class="n">pname_fid</span> <span class="o">==</span> <span class="mi">6</span><span class="p">:</span>
            <span class="n">pname_fid</span> <span class="o">=</span> <span class="s1">&#39;I2&#39;</span>
        <span class="k">elif</span> <span class="n">pname_fid</span> <span class="o">==</span> <span class="mi">7</span><span class="p">:</span>
            <span class="n">pname_fid</span> <span class="o">=</span> <span class="s1">&#39;J&#39;</span>
        <span class="c1">#options = [4, 5, 6, 7, 12, 13, 14, 15, 16, 17, 18, 19, &#39;A&#39;, &#39;I1&#39;, &#39;J&#39;]</span>
        <span class="n">options</span> <span class="o">=</span> <span class="p">[</span><span class="mi">12</span><span class="p">,</span> <span class="mi">13</span><span class="p">,</span> <span class="mi">14</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="mi">16</span><span class="p">,</span> <span class="mi">17</span><span class="p">,</span> <span class="mi">18</span><span class="p">,</span> <span class="mi">19</span><span class="p">,</span> <span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;I1&#39;</span><span class="p">,</span> <span class="s1">&#39;I2&#39;</span><span class="p">,</span> <span class="s1">&#39;I12&#39;</span><span class="p">,</span> <span class="s1">&#39;J&#39;</span><span class="p">]</span>
        <span class="n">_check_dvprel_options</span><span class="p">(</span><span class="n">pname_fid</span><span class="p">,</span> <span class="n">prop_type</span><span class="p">,</span> <span class="n">options</span><span class="p">)</span>

    <span class="k">elif</span> <span class="n">prop_type</span> <span class="o">==</span> <span class="s1">&#39;PBARL&#39;</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">pname_fid</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">12</span><span class="p">,</span> <span class="mi">13</span><span class="p">,</span> <span class="mi">14</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="mi">16</span><span class="p">,</span> <span class="mi">17</span><span class="p">,</span> <span class="mi">18</span><span class="p">,</span> <span class="mi">19</span><span class="p">]:</span>
            <span class="c1"># field 12 = DIM1 (10 values per line)</span>
            <span class="n">iline</span> <span class="o">=</span> <span class="n">pname_fid</span> <span class="o">//</span> <span class="mi">10</span>
            <span class="n">ifield</span> <span class="o">=</span> <span class="n">pname_fid</span> <span class="o">%</span> <span class="mi">10</span>
            <span class="k">if</span> <span class="n">ifield</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">ifield</span> <span class="o">&gt;</span> <span class="mi">8</span><span class="p">:</span>
                <span class="n">msg</span> <span class="o">=</span> <span class="s1">&#39;iline=</span><span class="si">%s</span><span class="s1"> ifield=</span><span class="si">%s</span><span class="s1"> pname_fid=</span><span class="si">%s</span><span class="s1"> PBARL&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">iline</span><span class="p">,</span> <span class="n">ifield</span><span class="p">,</span> <span class="n">pname_fid</span><span class="p">)</span>
                <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
            <span class="n">pname_fid</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;DIM</span><span class="si">%i</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">pname_fid</span> <span class="o">-</span> <span class="mi">11</span><span class="p">))</span>

        <span class="n">options</span> <span class="o">=</span> <span class="p">[</span>
            <span class="mi">12</span><span class="p">,</span> <span class="mi">13</span><span class="p">,</span> <span class="mi">14</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="mi">16</span><span class="p">,</span> <span class="mi">17</span><span class="p">,</span>
            <span class="s1">&#39;DIM1&#39;</span><span class="p">,</span> <span class="s1">&#39;DIM2&#39;</span><span class="p">,</span> <span class="s1">&#39;DIM3&#39;</span><span class="p">,</span> <span class="s1">&#39;DIM4&#39;</span><span class="p">,</span> <span class="s1">&#39;DIM5&#39;</span><span class="p">,</span> <span class="s1">&#39;DIM6&#39;</span><span class="p">,</span> <span class="s1">&#39;DIM7&#39;</span><span class="p">,</span> <span class="s1">&#39;DIM8&#39;</span><span class="p">,</span> <span class="s1">&#39;DIM9&#39;</span><span class="p">,</span> <span class="s1">&#39;DIM10&#39;</span><span class="p">]</span>
        <span class="n">_check_dvprel_options</span><span class="p">(</span><span class="n">pname_fid</span><span class="p">,</span> <span class="n">prop_type</span><span class="p">,</span> <span class="n">options</span><span class="p">)</span>

    <span class="c1">#elif prop_type == &#39;CBEAM&#39;:</span>
        <span class="c1">#assert pname_fid in [&#39;X1&#39;, &#39;X2&#39;, &#39;X3&#39;, &#39;W1A&#39;, &#39;W2A&#39;, &#39;W3A&#39;, &#39;W1B&#39;, &#39;W2B&#39;, &#39;W3B&#39;], msg</span>
    <span class="k">elif</span> <span class="n">prop_type</span> <span class="o">==</span> <span class="s1">&#39;PBEAM&#39;</span><span class="p">:</span>
        <span class="n">options_station_a</span> <span class="o">=</span> <span class="p">[</span>
            <span class="s1">&#39;I1&#39;</span><span class="p">,</span> <span class="s1">&#39;I2&#39;</span><span class="p">,</span> <span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;I12&#39;</span><span class="p">,</span> <span class="s1">&#39;J&#39;</span><span class="p">,</span>
            <span class="s1">&#39;C1&#39;</span><span class="p">,</span> <span class="s1">&#39;C2&#39;</span><span class="p">,</span> <span class="s1">&#39;D1&#39;</span><span class="p">,</span> <span class="s1">&#39;D2&#39;</span><span class="p">,</span> <span class="s1">&#39;E1&#39;</span><span class="p">,</span> <span class="s1">&#39;E2&#39;</span><span class="p">,</span> <span class="s1">&#39;F1&#39;</span><span class="p">,</span> <span class="s1">&#39;F2&#39;</span><span class="p">,</span>
            <span class="c1">#-8, -9, -10, -14, -15, -16, -17, -18, -19, -20, -21,</span>
            <span class="c1">#-168, -169, -170, -174, -175, -176, -177, -178, -179,</span>
            <span class="c1">#-180, -181,</span>
        <span class="p">]</span>
        <span class="n">options</span> <span class="o">=</span> <span class="p">[</span>
            <span class="s1">&#39;I1&#39;</span><span class="p">,</span> <span class="s1">&#39;I2&#39;</span><span class="p">,</span> <span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;I12&#39;</span><span class="p">,</span> <span class="s1">&#39;J&#39;</span><span class="p">,</span>
            <span class="s1">&#39;I1(A)&#39;</span><span class="p">,</span> <span class="s1">&#39;I1(B)&#39;</span><span class="p">,</span> <span class="s1">&#39;I2(B)&#39;</span><span class="p">,</span>
            <span class="s1">&#39;C1&#39;</span><span class="p">,</span> <span class="s1">&#39;C2&#39;</span><span class="p">,</span> <span class="s1">&#39;D1&#39;</span><span class="p">,</span> <span class="s1">&#39;D2&#39;</span><span class="p">,</span> <span class="s1">&#39;E1&#39;</span><span class="p">,</span> <span class="s1">&#39;E2&#39;</span><span class="p">,</span> <span class="s1">&#39;F1&#39;</span><span class="p">,</span> <span class="s1">&#39;F2&#39;</span><span class="p">,</span>
            <span class="c1">#-8, -9, -10, -14, -15, -16, -17, -18, -19, -20, -21,</span>
            <span class="c1">#-168, -169, -170, -174, -175, -176, -177, -178, -179,</span>
            <span class="c1">#-180, -181,</span>
        <span class="p">]</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">pname_fid</span><span class="p">,</span> <span class="n">integer_types</span><span class="p">)</span> <span class="ow">and</span> <span class="n">pname_fid</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">pname_fid</span> <span class="o">=</span> <span class="n">update_pbeam_negative_integer</span><span class="p">(</span><span class="n">pname_fid</span><span class="p">)</span>

        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">pname_fid</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">pname_fid</span> <span class="ow">in</span> <span class="n">options_station_a</span><span class="p">:</span>
                <span class="n">word</span> <span class="o">=</span> <span class="n">pname_fid</span>
                <span class="n">num</span> <span class="o">=</span> <span class="s1">&#39;A&#39;</span>
                <span class="n">pname_fid</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">%s</span><span class="s1">(</span><span class="si">%s</span><span class="s1">)&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">pname_fid</span><span class="p">,</span> <span class="n">num</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">word</span><span class="p">,</span> <span class="n">num</span> <span class="o">=</span> <span class="n">break_word_by_trailing_parentheses_integer_ab</span><span class="p">(</span>
                    <span class="n">pname_fid</span><span class="p">)</span>

        <span class="n">_check_dvprel_options</span><span class="p">(</span><span class="n">word</span><span class="p">,</span> <span class="n">prop_type</span><span class="p">,</span> <span class="n">options</span><span class="p">)</span>

    <span class="k">elif</span> <span class="n">prop_type</span> <span class="o">==</span> <span class="s1">&#39;PBEAML&#39;</span><span class="p">:</span>
        <span class="n">options</span> <span class="o">=</span> <span class="p">[</span>
            <span class="s1">&#39;DIM1&#39;</span><span class="p">,</span> <span class="s1">&#39;DIM2&#39;</span><span class="p">,</span> <span class="s1">&#39;DIM3&#39;</span><span class="p">,</span> <span class="s1">&#39;DIM4&#39;</span><span class="p">,</span> <span class="s1">&#39;DIM5&#39;</span><span class="p">,</span> <span class="s1">&#39;DIM6&#39;</span><span class="p">,</span> <span class="s1">&#39;DIM7&#39;</span><span class="p">,</span> <span class="s1">&#39;DIM8&#39;</span><span class="p">,</span> <span class="s1">&#39;DIM9&#39;</span><span class="p">,</span> <span class="s1">&#39;DIM10&#39;</span><span class="p">,</span>
            <span class="s1">&#39;DIM1(A)&#39;</span><span class="p">,</span>
            <span class="s1">&#39;DIM1(B)&#39;</span><span class="p">,</span> <span class="s1">&#39;DIM2(B)&#39;</span><span class="p">,</span> <span class="s1">&#39;I1(B)&#39;</span><span class="p">,</span> <span class="s1">&#39;I2(B)&#39;</span><span class="p">,</span>
            <span class="s1">&#39;NSM&#39;</span><span class="p">]</span> <span class="c1"># &#39;DIM(B)&#39;</span>
        <span class="n">_check_dvprel_options</span><span class="p">(</span><span class="n">pname_fid</span><span class="p">,</span> <span class="n">prop_type</span><span class="p">,</span> <span class="n">options</span><span class="p">)</span>

    <span class="c1">#elif prop_type == &#39;CQUAD4&#39;:</span>
        <span class="c1">#assert pname_fid in [&#39;T1&#39;, &#39;T2&#39;, &#39;T3&#39;, &#39;T4&#39;], msg</span>
    <span class="k">elif</span> <span class="n">prop_type</span> <span class="o">==</span> <span class="s1">&#39;PSHELL&#39;</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">pname_fid</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;T&#39;</span><span class="p">,</span> <span class="mi">4</span><span class="p">]:</span>
            <span class="n">pname_fid</span> <span class="o">=</span> <span class="s1">&#39;T&#39;</span>
        <span class="k">elif</span> <span class="n">pname_fid</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">6</span><span class="p">]:</span>  <span class="c1"># 12I/T**3 doesn&#39;t support strings</span>
            <span class="k">pass</span>
        <span class="k">elif</span> <span class="n">pname_fid</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">8</span><span class="p">]:</span>  <span class="c1"># TS/T doesn&#39;t support strings?</span>
            <span class="k">pass</span>
        <span class="k">elif</span> <span class="n">pname_fid</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;Z1&#39;</span><span class="p">]:</span>
            <span class="n">pname_fid</span> <span class="o">=</span> <span class="s1">&#39;Z1&#39;</span>
        <span class="k">elif</span> <span class="n">pname_fid</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;Z2&#39;</span><span class="p">]:</span>
            <span class="n">pname_fid</span> <span class="o">=</span> <span class="s1">&#39;Z2&#39;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">allowed</span> <span class="o">=</span> <span class="p">(</span><span class="s2">&quot;[&#39;T&#39;, 4, </span><span class="se">\n</span><span class="s2">&quot;</span>
                       <span class="s2">&quot;6 # 12I/T^3, </span><span class="se">\n</span><span class="s2">&quot;</span>
                       <span class="s2">&quot;8 # TS/T]</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="n">msg</span> <span class="o">=</span> <span class="s1">&#39;PSHELL pname_fid=</span><span class="si">%r</span><span class="s1"> is invalid</span><span class="se">\n</span><span class="s1">must be in:</span><span class="se">\n</span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">pname_fid</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">allowed</span><span class="p">))</span>
            <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
        <span class="c1">#if cp_name in &#39;12I/T**3&#39;:</span>
            <span class="c1">#cp_name =</span>
        <span class="c1">#assert pname_fid in [&#39;T&#39;, 4, 6], msg</span>
    <span class="k">elif</span> <span class="n">prop_type</span> <span class="o">==</span> <span class="s1">&#39;PCOMP&#39;</span><span class="p">:</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">pname_fid</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">pname_fid</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;Z0&#39;</span><span class="p">,</span> <span class="s1">&#39;SB&#39;</span><span class="p">,</span> <span class="s1">&#39;TREF&#39;</span><span class="p">,</span> <span class="s1">&#39;GE&#39;</span><span class="p">,</span> <span class="s1">&#39;NSM&#39;</span><span class="p">]:</span>
                <span class="k">pass</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">word</span><span class="p">,</span> <span class="n">num</span> <span class="o">=</span> <span class="n">break_word_by_trailing_integer</span><span class="p">(</span><span class="n">pname_fid</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">word</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;T&#39;</span><span class="p">,</span> <span class="s1">&#39;THETA&#39;</span><span class="p">]:</span>
                    <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s1">&#39;word=</span><span class="si">%r</span><span class="se">\n</span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">word</span><span class="p">,</span> <span class="n">msg</span><span class="p">))</span>
                <span class="nb">int</span><span class="p">(</span><span class="n">num</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">pname_fid</span> <span class="o">==</span> <span class="mi">4</span><span class="p">:</span>
                <span class="n">pname_fid</span> <span class="o">=</span> <span class="s1">&#39;NSM&#39;</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="c1">#PID Z0 NSM SB FT TREF GE LAM</span>
                <span class="k">assert</span> <span class="n">pname_fid</span> <span class="ow">in</span> <span class="n">valid_pcomp_codes</span><span class="p">,</span> <span class="n">msg</span>
    <span class="k">elif</span> <span class="n">prop_type</span> <span class="o">==</span> <span class="s1">&#39;PCOMPG&#39;</span><span class="p">:</span>
        <span class="c1">#if pname_fid in [&#39;T&#39;, 4]:</span>
            <span class="c1">#pname_fid = &#39;T&#39;</span>
        <span class="c1">#elif pname_fid in [6]:  # 12I/T**3 doesn&#39;t support strings</span>
            <span class="c1">#pass</span>
        <span class="c1">#else:</span>
            <span class="c1">#raise NotImplementedError(&#39;PSHELL pname_fid=%r is invalid&#39; % pname_fid)</span>
        <span class="c1">#if cp_name in &#39;12I/T**3&#39;:</span>
        <span class="n">options</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Z0&#39;</span><span class="p">,</span> <span class="s1">&#39;SB&#39;</span><span class="p">,</span>
                   <span class="mi">14</span><span class="p">,</span> <span class="mi">24</span><span class="p">,</span> <span class="mi">34</span><span class="p">,</span> <span class="mi">44</span><span class="p">,</span>
                   <span class="mi">15</span><span class="p">,</span> <span class="mi">25</span><span class="p">,</span> <span class="mi">75</span><span class="p">,</span> <span class="mi">85</span><span class="p">]</span>
        <span class="n">_check_dvprel_options</span><span class="p">(</span><span class="n">pname_fid</span><span class="p">,</span> <span class="n">prop_type</span><span class="p">,</span> <span class="n">options</span><span class="p">)</span>

    <span class="c1">#elif prop_type == &#39;CBUSH&#39;:</span>
        <span class="c1">#assert pname_fid in [&#39;X1&#39;, &#39;X2&#39;, &#39;X3&#39;, &#39;S&#39;, &#39;S1&#39;], msg</span>
    <span class="k">elif</span> <span class="n">prop_type</span> <span class="o">==</span> <span class="s1">&#39;PBUSH&#39;</span><span class="p">:</span>
        <span class="n">options</span> <span class="o">=</span> <span class="p">[</span><span class="mi">18</span><span class="p">,</span>
                   <span class="s1">&#39;K1&#39;</span><span class="p">,</span> <span class="s1">&#39;K2&#39;</span><span class="p">,</span> <span class="s1">&#39;K3&#39;</span><span class="p">,</span> <span class="s1">&#39;K4&#39;</span><span class="p">,</span> <span class="s1">&#39;K5&#39;</span><span class="p">,</span> <span class="s1">&#39;K6&#39;</span><span class="p">,</span>
                   <span class="s1">&#39;B1&#39;</span><span class="p">,</span> <span class="s1">&#39;B2&#39;</span><span class="p">,</span> <span class="s1">&#39;B3&#39;</span><span class="p">,</span> <span class="s1">&#39;B4&#39;</span><span class="p">,</span> <span class="s1">&#39;B5&#39;</span><span class="p">,</span> <span class="s1">&#39;B6&#39;</span><span class="p">,</span>
                   <span class="s1">&#39;M1&#39;</span><span class="p">,</span> <span class="s1">&#39;M2&#39;</span><span class="p">,</span> <span class="s1">&#39;M3&#39;</span><span class="p">,</span> <span class="s1">&#39;M4&#39;</span><span class="p">,</span> <span class="s1">&#39;M5&#39;</span><span class="p">,</span> <span class="s1">&#39;M6&#39;</span><span class="p">,</span>
                   <span class="s1">&#39;GE1&#39;</span><span class="p">,</span> <span class="s1">&#39;GE3&#39;</span><span class="p">,</span> <span class="s1">&#39;GE4&#39;</span><span class="p">,</span> <span class="s1">&#39;GE5&#39;</span><span class="p">,</span> <span class="s1">&#39;GE6&#39;</span><span class="p">,</span>
                   <span class="o">-</span><span class="mi">13</span><span class="p">]</span>
        <span class="n">_check_dvprel_options</span><span class="p">(</span><span class="n">pname_fid</span><span class="p">,</span> <span class="n">prop_type</span><span class="p">,</span> <span class="n">options</span><span class="p">)</span>

    <span class="k">elif</span> <span class="n">prop_type</span> <span class="o">==</span> <span class="s1">&#39;PBUSH1D&#39;</span><span class="p">:</span>
        <span class="n">options</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;K&#39;</span><span class="p">,</span> <span class="s1">&#39;C&#39;</span><span class="p">,</span> <span class="s1">&#39;M&#39;</span><span class="p">]</span>
        <span class="n">_check_dvprel_options</span><span class="p">(</span><span class="n">pname_fid</span><span class="p">,</span> <span class="n">prop_type</span><span class="p">,</span> <span class="n">options</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">prop_type</span> <span class="o">==</span> <span class="s1">&#39;PBUSHT&#39;</span><span class="p">:</span>
        <span class="n">options</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;TBID1&#39;</span><span class="p">,</span> <span class="s1">&#39;TGEID1&#39;</span><span class="p">,</span> <span class="s1">&#39;TGEID2&#39;</span><span class="p">]</span>
        <span class="n">_check_dvprel_options</span><span class="p">(</span><span class="n">pname_fid</span><span class="p">,</span> <span class="n">prop_type</span><span class="p">,</span> <span class="n">options</span><span class="p">)</span>

    <span class="c1"># CGAP</span>
    <span class="k">elif</span> <span class="n">prop_type</span> <span class="o">==</span> <span class="s1">&#39;PGAP&#39;</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">pname_fid</span> <span class="o">==</span> <span class="mi">5</span><span class="p">:</span>
            <span class="n">pname_fid</span> <span class="o">=</span> <span class="s1">&#39;KA&#39;</span>
        <span class="n">options</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;KA&#39;</span><span class="p">]</span>
        <span class="c1">#options = [5]</span>
        <span class="n">_check_dvprel_options</span><span class="p">(</span><span class="n">pname_fid</span><span class="p">,</span> <span class="n">prop_type</span><span class="p">,</span> <span class="n">options</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">prop_type</span> <span class="o">==</span> <span class="s1">&#39;PVISC&#39;</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">pname_fid</span> <span class="o">==</span> <span class="mi">3</span><span class="p">:</span>
            <span class="n">pname_fid</span> <span class="o">=</span> <span class="s1">&#39;CE1&#39;</span>
        <span class="n">options</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;CE1&#39;</span><span class="p">]</span>
        <span class="n">_check_dvprel_options</span><span class="p">(</span><span class="n">pname_fid</span><span class="p">,</span> <span class="n">prop_type</span><span class="p">,</span> <span class="n">options</span><span class="p">)</span>

    <span class="c1">#elif prop_type == &#39;CDAMP2&#39;:</span>
        <span class="c1">#assert pname_fid in [&#39;B&#39;], msg</span>
    <span class="k">elif</span> <span class="n">prop_type</span> <span class="o">==</span> <span class="s1">&#39;PDAMP&#39;</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">pname_fid</span> <span class="o">==</span> <span class="mi">3</span><span class="p">:</span>
            <span class="n">pname_fid</span> <span class="o">=</span> <span class="s1">&#39;B1&#39;</span>
        <span class="c1">#options = [3, &#39;B1&#39;]</span>
        <span class="n">options</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;B1&#39;</span><span class="p">]</span>
        <span class="n">_check_dvprel_options</span><span class="p">(</span><span class="n">pname_fid</span><span class="p">,</span> <span class="n">prop_type</span><span class="p">,</span> <span class="n">options</span><span class="p">)</span>

    <span class="c1">#elif prop_type == &#39;CMASS2&#39;:</span>
        <span class="c1">#assert pname_fid in [&#39;M&#39;], msg</span>
    <span class="c1">#elif prop_type == &#39;CMASS4&#39;:</span>
        <span class="c1">#assert pname_fid in [&#39;M&#39;], msg</span>
    <span class="k">elif</span> <span class="n">prop_type</span> <span class="o">==</span> <span class="s1">&#39;PMASS&#39;</span><span class="p">:</span>
        <span class="n">options</span> <span class="o">=</span> <span class="p">[</span><span class="mi">3</span><span class="p">]</span>
        <span class="n">_check_dvprel_options</span><span class="p">(</span><span class="n">pname_fid</span><span class="p">,</span> <span class="n">prop_type</span><span class="p">,</span> <span class="n">options</span><span class="p">)</span>

    <span class="c1">#elif prop_type == &#39;CONM2&#39;:</span>
        <span class="c1">#assert pname_fid in [&#39;M&#39;, &#39;X1&#39;, &#39;X2&#39;, &#39;I11&#39;, &#39;I22&#39;], msg</span>

    <span class="k">elif</span> <span class="n">prop_type</span> <span class="o">==</span> <span class="s1">&#39;PSHEAR&#39;</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">pname_fid</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;T&#39;</span><span class="p">,</span> <span class="mi">4</span><span class="p">]:</span>
            <span class="n">pname_fid</span> <span class="o">=</span> <span class="s1">&#39;T&#39;</span>
        <span class="k">elif</span> <span class="n">pname_fid</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;NSM&#39;</span><span class="p">,</span> <span class="mi">5</span><span class="p">]:</span>
            <span class="n">pname_fid</span> <span class="o">=</span> <span class="s1">&#39;NSM&#39;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="s1">&#39;PSHEAR pname_fid=</span><span class="si">%r</span><span class="s1"> is invalid&#39;</span> <span class="o">%</span> <span class="n">pname_fid</span><span class="p">)</span>

    <span class="k">elif</span> <span class="n">prop_type</span> <span class="o">==</span> <span class="s1">&#39;PWELD&#39;</span><span class="p">:</span>
        <span class="n">options</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;D&#39;</span><span class="p">]</span>
        <span class="n">_check_dvprel_options</span><span class="p">(</span><span class="n">pname_fid</span><span class="p">,</span> <span class="n">prop_type</span><span class="p">,</span> <span class="n">options</span><span class="p">)</span>

    <span class="k">elif</span> <span class="n">prop_type</span> <span class="o">==</span> <span class="s1">&#39;PFAST&#39;</span><span class="p">:</span>
        <span class="n">options</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;KT1&#39;</span><span class="p">,</span> <span class="s1">&#39;KT2&#39;</span><span class="p">,</span> <span class="s1">&#39;KT3&#39;</span><span class="p">,</span> <span class="s1">&#39;KR1&#39;</span><span class="p">,</span> <span class="s1">&#39;KR2&#39;</span><span class="p">,</span> <span class="s1">&#39;KR3&#39;</span><span class="p">,</span> <span class="s1">&#39;MASS&#39;</span><span class="p">]</span>
        <span class="n">_check_dvprel_options</span><span class="p">(</span><span class="n">pname_fid</span><span class="p">,</span> <span class="n">prop_type</span><span class="p">,</span> <span class="n">options</span><span class="p">)</span>

    <span class="k">elif</span> <span class="n">prop_type</span> <span class="o">==</span> <span class="s1">&#39;PBRSECT&#39;</span><span class="p">:</span>
        <span class="n">options</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;T&#39;</span><span class="p">,</span> <span class="s1">&#39;W&#39;</span><span class="p">,</span> <span class="s1">&#39;H&#39;</span><span class="p">]</span>
        <span class="n">_check_dvprel_options</span><span class="p">(</span><span class="n">pname_fid</span><span class="p">,</span> <span class="n">prop_type</span><span class="p">,</span> <span class="n">options</span><span class="p">)</span>

    <span class="k">elif</span> <span class="n">prop_type</span> <span class="o">==</span> <span class="s1">&#39;PBMSECT&#39;</span><span class="p">:</span>
        <span class="n">options</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;T&#39;</span><span class="p">,</span> <span class="s1">&#39;W&#39;</span><span class="p">,</span> <span class="s1">&#39;H&#39;</span><span class="p">,</span> <span class="s1">&#39;T(1)&#39;</span><span class="p">,</span> <span class="s1">&#39;T(2)&#39;</span><span class="p">,</span> <span class="s1">&#39;T(3)&#39;</span><span class="p">,</span> <span class="s1">&#39;T(4)&#39;</span><span class="p">,</span> <span class="s1">&#39;T(5)&#39;</span><span class="p">,</span> <span class="s1">&#39;T(6)&#39;</span><span class="p">,</span> <span class="s1">&#39;T(7)&#39;</span><span class="p">]</span>
        <span class="n">_check_dvprel_options</span><span class="p">(</span><span class="n">pname_fid</span><span class="p">,</span> <span class="n">prop_type</span><span class="p">,</span> <span class="n">options</span><span class="p">)</span>

    <span class="k">elif</span> <span class="n">prop_type</span> <span class="o">==</span> <span class="s1">&#39;PBEND&#39;</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s1">&#39;Nastran does not support the PBEND&#39;</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">pname_fid</span></div>

<div class="viewcode-block" id="_check_dvcrel_options"><a class="viewcode-back" href="../../../../reference/bdf/cards/pyNastran.bdf.cards.optimization.html#pyNastran.bdf.cards.optimization._check_dvcrel_options">[docs]</a><span class="k">def</span> <span class="nf">_check_dvcrel_options</span><span class="p">(</span><span class="n">cp_name</span><span class="p">,</span> <span class="n">element_type</span><span class="p">,</span> <span class="n">options</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">cp_name</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">options</span><span class="p">:</span>
        <span class="n">soptions</span> <span class="o">=</span> <span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">val</span><span class="p">)</span> <span class="k">for</span> <span class="n">val</span> <span class="ow">in</span> <span class="n">options</span><span class="p">]</span>
        <span class="n">msg</span> <span class="o">=</span> <span class="p">(</span>
            <span class="s1">&#39;</span><span class="si">%r</span><span class="s1"> is an invalid option for </span><span class="si">%s</span><span class="se">\n</span><span class="s1">&#39;</span>
            <span class="s1">&#39;valid: [</span><span class="si">%s</span><span class="s1">]&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">cp_name</span><span class="p">,</span> <span class="n">element_type</span><span class="p">,</span> <span class="s1">&#39;, &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">soptions</span><span class="p">)))</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span></div>

<div class="viewcode-block" id="_check_dvmrel_options"><a class="viewcode-back" href="../../../../reference/bdf/cards/pyNastran.bdf.cards.optimization.html#pyNastran.bdf.cards.optimization._check_dvmrel_options">[docs]</a><span class="k">def</span> <span class="nf">_check_dvmrel_options</span><span class="p">(</span><span class="n">mp_name</span><span class="p">,</span> <span class="n">material_type</span><span class="p">,</span> <span class="n">options</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">mp_name</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">options</span><span class="p">:</span>
        <span class="n">soptions</span> <span class="o">=</span> <span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">val</span><span class="p">)</span> <span class="k">for</span> <span class="n">val</span> <span class="ow">in</span> <span class="n">options</span><span class="p">]</span>
        <span class="n">msg</span> <span class="o">=</span> <span class="p">(</span>
            <span class="s1">&#39;</span><span class="si">%r</span><span class="s1"> is an invalid option for </span><span class="si">%s</span><span class="se">\n</span><span class="s1">&#39;</span>
            <span class="s1">&#39;valid: [</span><span class="si">%s</span><span class="s1">]&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">mp_name</span><span class="p">,</span> <span class="n">material_type</span><span class="p">,</span> <span class="s1">&#39;, &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">soptions</span><span class="p">)))</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span></div>

<div class="viewcode-block" id="_check_dvprel_options"><a class="viewcode-back" href="../../../../reference/bdf/cards/pyNastran.bdf.cards.optimization.html#pyNastran.bdf.cards.optimization._check_dvprel_options">[docs]</a><span class="k">def</span> <span class="nf">_check_dvprel_options</span><span class="p">(</span><span class="n">pname_fid</span><span class="p">,</span> <span class="n">prop_type</span><span class="p">,</span> <span class="n">options</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">pname_fid</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">options</span><span class="p">:</span>
        <span class="n">soptions</span> <span class="o">=</span> <span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">val</span><span class="p">)</span> <span class="k">for</span> <span class="n">val</span> <span class="ow">in</span> <span class="n">options</span><span class="p">]</span>
        <span class="n">msg</span> <span class="o">=</span> <span class="p">(</span>
            <span class="s1">&#39;</span><span class="si">%r</span><span class="s1"> is an invalid option for </span><span class="si">%s</span><span class="se">\n</span><span class="s1">&#39;</span>
            <span class="s1">&#39;valid: [</span><span class="si">%s</span><span class="s1">]&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">pname_fid</span><span class="p">,</span> <span class="n">prop_type</span><span class="p">,</span> <span class="s1">&#39;, &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">soptions</span><span class="p">)))</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span></div>


<div class="viewcode-block" id="OptConstraint"><a class="viewcode-back" href="../../../../reference/bdf/cards/pyNastran.bdf.cards.optimization.html#pyNastran.bdf.cards.optimization.OptConstraint">[docs]</a><span class="k">class</span> <span class="nc">OptConstraint</span><span class="p">(</span><span class="n">BaseCard</span><span class="p">):</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">BaseCard</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span></div>

<div class="viewcode-block" id="DVXREL1"><a class="viewcode-back" href="../../../../reference/bdf/cards/pyNastran.bdf.cards.optimization.html#pyNastran.bdf.cards.optimization.DVXREL1">[docs]</a><span class="k">class</span> <span class="nc">DVXREL1</span><span class="p">(</span><span class="n">BaseCard</span><span class="p">):</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">oid</span><span class="p">,</span> <span class="n">dvids</span><span class="p">,</span> <span class="n">coeffs</span><span class="p">,</span> <span class="n">c0</span><span class="p">,</span> <span class="n">comment</span><span class="p">):</span>
        <span class="n">BaseCard</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">comment</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">comment</span> <span class="o">=</span> <span class="n">comment</span>

        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">dvids</span><span class="p">,</span> <span class="n">integer_types</span><span class="p">):</span>
            <span class="n">dvids</span> <span class="o">=</span> <span class="p">[</span><span class="n">dvids</span><span class="p">]</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">coeffs</span><span class="p">,</span> <span class="nb">float</span><span class="p">):</span>
            <span class="n">coeffs</span> <span class="o">=</span> <span class="p">[</span><span class="n">coeffs</span><span class="p">]</span>

        <span class="c1"># optimization id</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">oid</span> <span class="o">=</span> <span class="n">oid</span>

        <span class="c1"># DESVAR ids</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dvids</span> <span class="o">=</span> <span class="n">dvids</span>

        <span class="c1"># scale factors for DESVARs</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">coeffs</span> <span class="o">=</span> <span class="n">coeffs</span>

        <span class="c1"># offset coefficient</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">c0</span> <span class="o">=</span> <span class="n">c0</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">dvids_ref</span> <span class="o">=</span> <span class="kc">None</span>

<div class="viewcode-block" id="DVXREL1.validate"><a class="viewcode-back" href="../../../../reference/bdf/cards/pyNastran.bdf.cards.optimization.html#pyNastran.bdf.cards.optimization.DVXREL1.validate">[docs]</a>    <span class="k">def</span> <span class="nf">validate</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">msg</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
        <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dvids</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">coeffs</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">desvar_id</span><span class="p">,</span> <span class="n">coeff</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">count</span><span class="p">(),</span> <span class="bp">self</span><span class="o">.</span><span class="n">dvids</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">coeffs</span><span class="p">):</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">desvar_id</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>
                <span class="n">msg</span> <span class="o">+=</span> <span class="s1">&#39;  desvar_id[</span><span class="si">%i</span><span class="s1">]=</span><span class="si">%s</span><span class="s1"> is not an integer; type=</span><span class="si">%s</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span>
                    <span class="n">i</span><span class="p">,</span> <span class="n">desvar_id</span><span class="p">,</span> <span class="nb">type</span><span class="p">(</span><span class="n">desvar_id</span><span class="p">))</span>

            <span class="k">if</span> <span class="n">coeff</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;PVAL&#39;</span><span class="p">]:</span>
                <span class="k">pass</span>
            <span class="k">elif</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">coeff</span><span class="p">,</span> <span class="nb">float</span><span class="p">):</span>
                <span class="n">msg</span> <span class="o">+=</span> <span class="s1">&#39;  coeff[</span><span class="si">%i</span><span class="s1">]=</span><span class="si">%s</span><span class="s1"> is not a float; type=</span><span class="si">%s</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">coeff</span><span class="p">,</span> <span class="nb">type</span><span class="p">(</span><span class="n">coeff</span><span class="p">))</span>
        <span class="k">if</span> <span class="n">msg</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s1">&#39;Invalid </span><span class="si">%s</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">type</span> <span class="o">+</span> <span class="n">msg</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="p">))</span></div>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">desvar_ids</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">dvids_ref</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">dvids</span>
        <span class="k">return</span> <span class="p">[</span><span class="n">desvar</span><span class="o">.</span><span class="n">desvar_id</span> <span class="k">for</span> <span class="n">desvar</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">dvids_ref</span><span class="p">]</span></div>


<div class="viewcode-block" id="DVXREL2"><a class="viewcode-back" href="../../../../reference/bdf/cards/pyNastran.bdf.cards.optimization.html#pyNastran.bdf.cards.optimization.DVXREL2">[docs]</a><span class="k">class</span> <span class="nc">DVXREL2</span><span class="p">(</span><span class="n">BaseCard</span><span class="p">):</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">oid</span><span class="p">,</span> <span class="n">dvids</span><span class="p">,</span> <span class="n">labels</span><span class="p">,</span> <span class="n">deqation</span><span class="p">,</span> <span class="n">comment</span><span class="p">):</span>
        <span class="n">BaseCard</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">comment</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">comment</span> <span class="o">=</span> <span class="n">comment</span>
        <span class="k">if</span> <span class="n">dvids</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">dvids</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">dvids</span><span class="p">,</span> <span class="n">integer_types</span><span class="p">):</span>
            <span class="n">dvids</span> <span class="o">=</span> <span class="p">[</span><span class="n">dvids</span><span class="p">]</span>

        <span class="k">if</span> <span class="n">labels</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">labels</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">labels</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
            <span class="n">labels</span> <span class="o">=</span> <span class="p">[</span><span class="n">labels</span><span class="p">]</span>

        <span class="c1">#: Unique identification number</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">oid</span> <span class="o">=</span> <span class="n">oid</span>

        <span class="c1"># DESVAR ids</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dvids</span> <span class="o">=</span> <span class="n">dvids</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">labels</span> <span class="o">=</span> <span class="n">labels</span>

        <span class="c1">#: DEQATN entry identification number. (Integer &gt; 0)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dequation</span> <span class="o">=</span> <span class="n">deqation</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">dvids_ref</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dtable_ref</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dequation_ref</span> <span class="o">=</span> <span class="kc">None</span>

<div class="viewcode-block" id="DVXREL2.validate"><a class="viewcode-back" href="../../../../reference/bdf/cards/pyNastran.bdf.cards.optimization.html#pyNastran.bdf.cards.optimization.DVXREL2.validate">[docs]</a>    <span class="k">def</span> <span class="nf">validate</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">msg</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
        <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dvids</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">desvar_id</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dvids</span><span class="p">):</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">desvar_id</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>
                <span class="n">msg</span> <span class="o">+=</span> <span class="s1">&#39;  desvar_id[</span><span class="si">%i</span><span class="s1">]=</span><span class="si">%s</span><span class="s1"> is not an integer; type=</span><span class="si">%s</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span>
                    <span class="n">i</span><span class="p">,</span> <span class="n">desvar_id</span><span class="p">,</span> <span class="nb">type</span><span class="p">(</span><span class="n">desvar_id</span><span class="p">))</span>
        <span class="k">if</span> <span class="n">msg</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s1">&#39;Invalid </span><span class="si">%s</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">type</span> <span class="o">+</span> <span class="n">msg</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="p">))</span>
        <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">labels</span><span class="p">,</span> <span class="nb">list</span><span class="p">),</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span></div>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">desvar_ids</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">dvids_ref</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">dvids</span>
        <span class="k">return</span> <span class="p">[</span><span class="n">desvar</span><span class="o">.</span><span class="n">desvar_id</span> <span class="k">for</span> <span class="n">desvar</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">dvids_ref</span><span class="p">]</span>

<div class="viewcode-block" id="DVXREL2._check_args"><a class="viewcode-back" href="../../../../reference/bdf/cards/pyNastran.bdf.cards.optimization.html#pyNastran.bdf.cards.optimization.DVXREL2._check_args">[docs]</a>    <span class="k">def</span> <span class="nf">_check_args</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;checks the number of DEQATN args&quot;&quot;&quot;</span>
        <span class="n">nargs</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dvids</span><span class="p">)</span> <span class="o">+</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">labels</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">dequation_ref</span><span class="o">.</span><span class="n">nargs</span> <span class="o">!=</span> <span class="n">nargs</span><span class="p">:</span>
            <span class="n">msg</span> <span class="o">=</span> <span class="p">(</span><span class="sa">f</span><span class="s1">&#39;nargs_expected=</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">dequation_ref</span><span class="o">.</span><span class="n">nargs</span><span class="si">}</span><span class="s1">; actual=</span><span class="si">{</span><span class="n">nargs</span><span class="si">}</span><span class="se">\n</span><span class="s1">&#39;</span>
                   <span class="sa">f</span><span class="s1">&#39;desvars=</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">dvids</span><span class="si">}</span><span class="s1">; n=</span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dvids</span><span class="p">)</span><span class="si">}</span><span class="se">\n</span><span class="s1">&#39;</span>
                   <span class="sa">f</span><span class="s1">&#39;labels=</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">labels</span><span class="si">}</span><span class="s1">; n=</span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">labels</span><span class="p">)</span><span class="si">}</span><span class="se">\n</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">dequation_ref</span><span class="si">}{</span><span class="bp">self</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
            <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span></div></div>


<div class="viewcode-block" id="DCONSTR"><a class="viewcode-back" href="../../../../reference/bdf/cards/pyNastran.bdf.cards.optimization.html#pyNastran.bdf.cards.optimization.DCONSTR">[docs]</a><span class="k">class</span> <span class="nc">DCONSTR</span><span class="p">(</span><span class="n">OptConstraint</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    +---------+------+-----+------------+------------+-------+--------+</span>
<span class="sd">    |    1    |   2  |  3  |     4      |      5     |   6   |   7    |</span>
<span class="sd">    +=========+======+=====+============+============+=======+========+</span>
<span class="sd">    | DCONSTR | DCID | RID | LALLOW/LID | UALLOW/UID | LOWFQ | HIGHFQ |</span>
<span class="sd">    +---------+------+-----+------------+------------+-------+--------+</span>
<span class="sd">    | DCONSTR |  10  |  4  |    1.25    |            |       |        |</span>
<span class="sd">    +---------+------+-----+------------+------------+-------+--------+</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="nb">type</span> <span class="o">=</span> <span class="s1">&#39;DCONSTR&#39;</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">oid</span><span class="p">,</span> <span class="n">dresp_id</span><span class="p">,</span> <span class="n">lid</span><span class="o">=-</span><span class="mf">1.e20</span><span class="p">,</span> <span class="n">uid</span><span class="o">=</span><span class="mf">1.e20</span><span class="p">,</span>
                 <span class="n">lowfq</span><span class="o">=</span><span class="mf">0.</span><span class="p">,</span> <span class="n">highfq</span><span class="o">=</span><span class="mf">1.e20</span><span class="p">,</span> <span class="n">comment</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Creates a DCONSTR card</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        oid : int</span>
<span class="sd">            unique optimization id</span>
<span class="sd">        dresp_id : int</span>
<span class="sd">            DRESP1/2 id</span>
<span class="sd">        lid / uid : int/float; default=-1.e20 / 1.e20</span>
<span class="sd">            int: f() defined by TABLED1-4</span>
<span class="sd">            float: lower/upper bound</span>
<span class="sd">        lowfq / highfq : float; default=0. / 1.e20</span>
<span class="sd">            lower/upper end of the frequency range</span>
<span class="sd">        comment : str; default=&#39;&#39;</span>
<span class="sd">            a comment for the card</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">OptConstraint</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">comment</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">comment</span> <span class="o">=</span> <span class="n">comment</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">oid</span> <span class="o">=</span> <span class="n">oid</span>
        <span class="c1"># DRESP entry</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dresp_id</span> <span class="o">=</span> <span class="n">dresp_id</span>
        <span class="c1"># lower bound</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">lid</span> <span class="o">=</span> <span class="n">lid</span>
        <span class="c1"># upper bound</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">uid</span> <span class="o">=</span> <span class="n">uid</span>
        <span class="c1"># low end of frequency range (Hz)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">lowfq</span> <span class="o">=</span> <span class="n">lowfq</span>
        <span class="c1"># high end of frequency range (Hz)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">highfq</span> <span class="o">=</span> <span class="n">highfq</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">lid_ref</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">uid_ref</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dresp_id_ref</span> <span class="o">=</span> <span class="kc">None</span>

<div class="viewcode-block" id="DCONSTR.export_to_hdf5"><a class="viewcode-back" href="../../../../reference/bdf/cards/pyNastran.bdf.cards.optimization.html#pyNastran.bdf.cards.optimization.DCONSTR.export_to_hdf5">[docs]</a>    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">export_to_hdf5</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">hdf5_file</span><span class="p">,</span> <span class="n">dconstrs</span><span class="p">,</span> <span class="n">encoding</span><span class="p">):</span>
        <span class="n">oid</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">dresp_id</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">lid</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">uid</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">lowfq</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">highfq</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">dconstr</span> <span class="ow">in</span> <span class="n">dconstrs</span><span class="p">:</span>
            <span class="n">oid</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">dconstr</span><span class="o">.</span><span class="n">oid</span><span class="p">)</span>
            <span class="n">dresp_id</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">dconstr</span><span class="o">.</span><span class="n">dresp_id</span><span class="p">)</span>
            <span class="n">lid</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">dconstr</span><span class="o">.</span><span class="n">lid</span><span class="p">)</span>
            <span class="n">uid</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">dconstr</span><span class="o">.</span><span class="n">uid</span><span class="p">)</span>
            <span class="n">lowfq</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">dconstr</span><span class="o">.</span><span class="n">lowfq</span><span class="p">)</span>
            <span class="n">highfq</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">dconstr</span><span class="o">.</span><span class="n">highfq</span><span class="p">)</span>
        <span class="n">hdf5_file</span><span class="o">.</span><span class="n">create_dataset</span><span class="p">(</span><span class="s1">&#39;oid&#39;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">oid</span><span class="p">)</span>
        <span class="n">hdf5_file</span><span class="o">.</span><span class="n">create_dataset</span><span class="p">(</span><span class="s1">&#39;dresp_id&#39;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">dresp_id</span><span class="p">)</span>
        <span class="n">hdf5_file</span><span class="o">.</span><span class="n">create_dataset</span><span class="p">(</span><span class="s1">&#39;lid&#39;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">lid</span><span class="p">)</span>
        <span class="n">hdf5_file</span><span class="o">.</span><span class="n">create_dataset</span><span class="p">(</span><span class="s1">&#39;uid&#39;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">uid</span><span class="p">)</span>
        <span class="n">hdf5_file</span><span class="o">.</span><span class="n">create_dataset</span><span class="p">(</span><span class="s1">&#39;lowfq&#39;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">lowfq</span><span class="p">)</span>
        <span class="n">hdf5_file</span><span class="o">.</span><span class="n">create_dataset</span><span class="p">(</span><span class="s1">&#39;highfq&#39;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">highfq</span><span class="p">)</span></div>

<div class="viewcode-block" id="DCONSTR.add_card"><a class="viewcode-back" href="../../../../reference/bdf/cards/pyNastran.bdf.cards.optimization.html#pyNastran.bdf.cards.optimization.DCONSTR.add_card">[docs]</a>    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">add_card</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">card</span><span class="p">,</span> <span class="n">comment</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Adds a DCONSTR card from ``BDF.add_card(...)``</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        card : BDFCard()</span>
<span class="sd">            a BDFCard object</span>
<span class="sd">        comment : str; default=&#39;&#39;</span>
<span class="sd">            a comment for the card</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">oid</span> <span class="o">=</span> <span class="n">integer</span><span class="p">(</span><span class="n">card</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;oid&#39;</span><span class="p">)</span>
        <span class="n">dresp_id</span> <span class="o">=</span> <span class="n">integer</span><span class="p">(</span><span class="n">card</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;dresp_id&#39;</span><span class="p">)</span>
        <span class="n">lid</span> <span class="o">=</span> <span class="n">integer_double_or_blank</span><span class="p">(</span><span class="n">card</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="s1">&#39;lid&#39;</span><span class="p">,</span> <span class="o">-</span><span class="mf">1e20</span><span class="p">)</span>
        <span class="n">uid</span> <span class="o">=</span> <span class="n">integer_double_or_blank</span><span class="p">(</span><span class="n">card</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="s1">&#39;uid&#39;</span><span class="p">,</span> <span class="mf">1e20</span><span class="p">)</span>
        <span class="n">lowfq</span> <span class="o">=</span> <span class="n">double_or_blank</span><span class="p">(</span><span class="n">card</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="s1">&#39;lowfq&#39;</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">)</span>
        <span class="n">highfq</span> <span class="o">=</span> <span class="n">double_or_blank</span><span class="p">(</span><span class="n">card</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="s1">&#39;highfq&#39;</span><span class="p">,</span> <span class="mf">1e20</span><span class="p">)</span>
        <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">card</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="mi">7</span><span class="p">,</span> <span class="s1">&#39;len(DCONSTR card) = </span><span class="si">%i</span><span class="se">\n</span><span class="s1">card=</span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">card</span><span class="p">),</span> <span class="n">card</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">DCONSTR</span><span class="p">(</span><span class="n">oid</span><span class="p">,</span> <span class="n">dresp_id</span><span class="p">,</span> <span class="n">lid</span><span class="p">,</span> <span class="n">uid</span><span class="p">,</span> <span class="n">lowfq</span><span class="p">,</span> <span class="n">highfq</span><span class="p">,</span> <span class="n">comment</span><span class="o">=</span><span class="n">comment</span><span class="p">)</span></div>

    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">add_op2_data</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">comment</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Adds a DCONSTR card from the OP2</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        data : List[varies]</span>
<span class="sd">            a list of fields defined in OP2 format</span>
<span class="sd">        comment : str; default=&#39;&#39;</span>
<span class="sd">            a comment for the card</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">oid</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">rid</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">lid</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
        <span class="n">uid</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span>
        <span class="n">lowfq</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span>
        <span class="n">highfq</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span>
        <span class="k">return</span> <span class="n">DCONSTR</span><span class="p">(</span><span class="n">oid</span><span class="p">,</span> <span class="n">rid</span><span class="p">,</span> <span class="n">lid</span><span class="p">,</span> <span class="n">uid</span><span class="p">,</span> <span class="n">lowfq</span><span class="p">,</span> <span class="n">highfq</span><span class="p">,</span> <span class="n">comment</span><span class="o">=</span><span class="n">comment</span><span class="p">)</span>

<div class="viewcode-block" id="DCONSTR.DRespID"><a class="viewcode-back" href="../../../../reference/bdf/cards/pyNastran.bdf.cards.optimization.html#pyNastran.bdf.cards.optimization.DCONSTR.DRespID">[docs]</a>    <span class="k">def</span> <span class="nf">DRespID</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">dresp_id_ref</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">dresp_id</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">dresp_id_ref</span><span class="o">.</span><span class="n">dresp_id</span></div>

<div class="viewcode-block" id="DCONSTR.Rid"><a class="viewcode-back" href="../../../../reference/bdf/cards/pyNastran.bdf.cards.optimization.html#pyNastran.bdf.cards.optimization.DCONSTR.Rid">[docs]</a>    <span class="k">def</span> <span class="nf">Rid</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">DRespID</span><span class="p">()</span></div>

<div class="viewcode-block" id="DCONSTR.Lid"><a class="viewcode-back" href="../../../../reference/bdf/cards/pyNastran.bdf.cards.optimization.html#pyNastran.bdf.cards.optimization.DCONSTR.Lid">[docs]</a>    <span class="k">def</span> <span class="nf">Lid</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">lid_ref</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">lid</span>  <span class="c1"># int/float</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">lid_ref</span><span class="o">.</span><span class="n">tid</span></div>

<div class="viewcode-block" id="DCONSTR.Uid"><a class="viewcode-back" href="../../../../reference/bdf/cards/pyNastran.bdf.cards.optimization.html#pyNastran.bdf.cards.optimization.DCONSTR.Uid">[docs]</a>    <span class="k">def</span> <span class="nf">Uid</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">uid_ref</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">uid</span>  <span class="c1"># int/float</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">uid_ref</span><span class="o">.</span><span class="n">tid</span></div>

<div class="viewcode-block" id="DCONSTR.cross_reference"><a class="viewcode-back" href="../../../../reference/bdf/cards/pyNastran.bdf.cards.optimization.html#pyNastran.bdf.cards.optimization.DCONSTR.cross_reference">[docs]</a>    <span class="k">def</span> <span class="nf">cross_reference</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">model</span><span class="p">:</span> <span class="n">BDF</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Cross links the card so referenced cards can be extracted directly</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        model : BDF()</span>
<span class="sd">            the BDF object</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">msg</span> <span class="o">=</span> <span class="s1">&#39;, which is required by DCONSTR oid=</span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">oid</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dresp_id_ref</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">DResp</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dresp_id</span><span class="p">,</span> <span class="n">msg</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">lid</span><span class="p">,</span> <span class="n">integer_types</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">lid_ref</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">TableD</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">lid</span><span class="p">,</span> <span class="n">msg</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">uid</span><span class="p">,</span> <span class="n">integer_types</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">uid_ref</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">TableD</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">uid</span><span class="p">,</span> <span class="n">msg</span><span class="p">)</span></div>

<div class="viewcode-block" id="DCONSTR.uncross_reference"><a class="viewcode-back" href="../../../../reference/bdf/cards/pyNastran.bdf.cards.optimization.html#pyNastran.bdf.cards.optimization.DCONSTR.uncross_reference">[docs]</a>    <span class="k">def</span> <span class="nf">uncross_reference</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Removes cross-reference links&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dresp_id</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">DRespID</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">lid</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">Lid</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">uid</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">Uid</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">lid_ref</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">uid_ref</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dresp_id_ref</span> <span class="o">=</span> <span class="kc">None</span></div>

<div class="viewcode-block" id="DCONSTR.raw_fields"><a class="viewcode-back" href="../../../../reference/bdf/cards/pyNastran.bdf.cards.optimization.html#pyNastran.bdf.cards.optimization.DCONSTR.raw_fields">[docs]</a>    <span class="k">def</span> <span class="nf">raw_fields</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">list_fields</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;DCONSTR&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">oid</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">DRespID</span><span class="p">(),</span> <span class="bp">self</span><span class="o">.</span><span class="n">Lid</span><span class="p">(),</span>
                       <span class="bp">self</span><span class="o">.</span><span class="n">Uid</span><span class="p">(),</span> <span class="bp">self</span><span class="o">.</span><span class="n">lowfq</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">highfq</span><span class="p">]</span>
        <span class="k">return</span> <span class="n">list_fields</span></div>

<div class="viewcode-block" id="DCONSTR.repr_fields"><a class="viewcode-back" href="../../../../reference/bdf/cards/pyNastran.bdf.cards.optimization.html#pyNastran.bdf.cards.optimization.DCONSTR.repr_fields">[docs]</a>    <span class="k">def</span> <span class="nf">repr_fields</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">lid</span> <span class="o">=</span> <span class="n">set_blank_if_default</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Lid</span><span class="p">(),</span> <span class="o">-</span><span class="mf">1e20</span><span class="p">)</span>
        <span class="n">uid</span> <span class="o">=</span> <span class="n">set_blank_if_default</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Uid</span><span class="p">(),</span> <span class="mf">1e20</span><span class="p">)</span>
        <span class="n">lowfq</span> <span class="o">=</span> <span class="n">set_blank_if_default</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">lowfq</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">)</span>
        <span class="n">highfq</span> <span class="o">=</span> <span class="n">set_blank_if_default</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">highfq</span><span class="p">,</span> <span class="mf">1e20</span><span class="p">)</span>
        <span class="n">list_fields</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;DCONSTR&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">oid</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">DRespID</span><span class="p">(),</span> <span class="n">lid</span><span class="p">,</span> <span class="n">uid</span><span class="p">,</span> <span class="n">lowfq</span><span class="p">,</span> <span class="n">highfq</span><span class="p">]</span>
        <span class="k">return</span> <span class="n">list_fields</span></div>

<div class="viewcode-block" id="DCONSTR.write_card"><a class="viewcode-back" href="../../../../reference/bdf/cards/pyNastran.bdf.cards.optimization.html#pyNastran.bdf.cards.optimization.DCONSTR.write_card">[docs]</a>    <span class="k">def</span> <span class="nf">write_card</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">size</span><span class="p">:</span> <span class="nb">int</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span> <span class="n">is_double</span><span class="p">:</span> <span class="nb">bool</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="n">card</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">repr_fields</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">size</span> <span class="o">==</span> <span class="mi">8</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">comment</span> <span class="o">+</span> <span class="n">print_card_8</span><span class="p">(</span><span class="n">card</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">is_double</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">comment</span> <span class="o">+</span> <span class="n">print_card_double</span><span class="p">(</span><span class="n">card</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">comment</span> <span class="o">+</span> <span class="n">print_card_16</span><span class="p">(</span><span class="n">card</span><span class="p">)</span></div></div>


<div class="viewcode-block" id="DESVAR"><a class="viewcode-back" href="../../../../reference/bdf/cards/pyNastran.bdf.cards.optimization.html#pyNastran.bdf.cards.optimization.DESVAR">[docs]</a><span class="k">class</span> <span class="nc">DESVAR</span><span class="p">(</span><span class="n">OptConstraint</span><span class="p">):</span>
    <span class="nb">type</span> <span class="o">=</span> <span class="s1">&#39;DESVAR&#39;</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    +--------+-----+-------+-------+-----+-----+-------+-------+</span>
<span class="sd">    |    1   |  2  |    3  |   4   |  5  |  6  |    7  |   8   |</span>
<span class="sd">    +========+=====+=======+=======+=====+=====+=======+=======+</span>
<span class="sd">    | DESVAR | OID | LABEL | XINIT | XLB | XUB | DELXV | DDVAL |</span>
<span class="sd">    +--------+-----+-------+-------+-----+-----+-------+-------+</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">_properties</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;value&#39;</span><span class="p">]</span>

    <span class="c1">#@classmethod</span>
    <span class="c1">#def _init_from_empty(cls):</span>
        <span class="c1">#desvar_id = 1</span>
        <span class="c1">#label = &#39;name&#39;</span>
        <span class="c1">#xinit = 0.5</span>
        <span class="c1">#return DESVAR(desvar_id, label, xinit,</span>
                      <span class="c1">#xlb=-1e20, xub=1e20, delx=None, ddval=None, comment=&#39;&#39;)</span>

<div class="viewcode-block" id="DESVAR.export_to_hdf5"><a class="viewcode-back" href="../../../../reference/bdf/cards/pyNastran.bdf.cards.optimization.html#pyNastran.bdf.cards.optimization.DESVAR.export_to_hdf5">[docs]</a>    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">export_to_hdf5</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">h5_file</span><span class="p">,</span> <span class="n">model</span><span class="p">,</span> <span class="n">desvar_ids</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;exports the elements in a vectorized way&quot;&quot;&quot;</span>
        <span class="c1">#comments = []</span>
        <span class="n">encoding</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">get_encoding</span><span class="p">()</span>
        <span class="n">ndesvars</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">desvar_ids</span><span class="p">)</span>
        <span class="n">label</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">xinit</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">xlb</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">xub</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">delx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">full</span><span class="p">(</span><span class="n">ndesvars</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">)</span>
        <span class="n">ddval</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">full</span><span class="p">(</span><span class="n">ndesvars</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">desvar_id</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">desvar_ids</span><span class="p">):</span>
            <span class="n">desvar</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">desvars</span><span class="p">[</span><span class="n">desvar_id</span><span class="p">]</span>
            <span class="c1">#comments.append(element.comment)</span>
            <span class="n">label</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">desvar</span><span class="o">.</span><span class="n">label</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="n">encoding</span><span class="p">))</span>
            <span class="n">xinit</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">desvar</span><span class="o">.</span><span class="n">xinit</span><span class="p">)</span>
            <span class="n">xlb</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">desvar</span><span class="o">.</span><span class="n">xlb</span><span class="p">)</span>
            <span class="n">xub</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">desvar</span><span class="o">.</span><span class="n">xub</span><span class="p">)</span>
            <span class="n">delx</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">desvar</span><span class="o">.</span><span class="n">delx</span>
            <span class="n">ddval</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">desvar</span><span class="o">.</span><span class="n">ddval</span>
        <span class="c1">#h5_file.create_dataset(&#39;_comment&#39;, data=comments)</span>
        <span class="n">h5_file</span><span class="o">.</span><span class="n">create_dataset</span><span class="p">(</span><span class="s1">&#39;desvar&#39;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">desvar_ids</span><span class="p">)</span>
        <span class="n">h5_file</span><span class="o">.</span><span class="n">create_dataset</span><span class="p">(</span><span class="s1">&#39;label&#39;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">label</span><span class="p">)</span>
        <span class="n">h5_file</span><span class="o">.</span><span class="n">create_dataset</span><span class="p">(</span><span class="s1">&#39;xinit&#39;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">xinit</span><span class="p">)</span>
        <span class="n">h5_file</span><span class="o">.</span><span class="n">create_dataset</span><span class="p">(</span><span class="s1">&#39;xlb&#39;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">xlb</span><span class="p">)</span>
        <span class="n">h5_file</span><span class="o">.</span><span class="n">create_dataset</span><span class="p">(</span><span class="s1">&#39;xub&#39;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">xub</span><span class="p">)</span>
        <span class="n">h5_file</span><span class="o">.</span><span class="n">create_dataset</span><span class="p">(</span><span class="s1">&#39;delx&#39;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">delx</span><span class="p">)</span>
        <span class="n">h5_file</span><span class="o">.</span><span class="n">create_dataset</span><span class="p">(</span><span class="s1">&#39;ddval&#39;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">ddval</span><span class="p">)</span></div>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">desvar_id</span><span class="p">,</span> <span class="n">label</span><span class="p">,</span> <span class="n">xinit</span><span class="p">,</span> <span class="n">xlb</span><span class="o">=-</span><span class="mf">1e20</span><span class="p">,</span> <span class="n">xub</span><span class="o">=</span><span class="mf">1e20</span><span class="p">,</span>
                 <span class="n">delx</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">ddval</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">comment</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Creates a DESVAR card</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        desvar_id : int</span>
<span class="sd">            design variable id</span>
<span class="sd">        label : str</span>
<span class="sd">            name of the design variable</span>
<span class="sd">        xinit : float</span>
<span class="sd">            the starting point value for the variable</span>
<span class="sd">        xlb : float; default=-1.e20</span>
<span class="sd">            the lower bound</span>
<span class="sd">        xub : float; default=1.e20</span>
<span class="sd">            the lower bound</span>
<span class="sd">        delx : float; default=1.e20</span>
<span class="sd">            fractional change allowed for design variables during</span>
<span class="sd">            approximate optimization</span>
<span class="sd">            NX  if blank : take from DOPTPRM; otherwise 1.0</span>
<span class="sd">            MSC if blank : take from DOPTPRM; otherwise 0.5</span>
<span class="sd">        ddval : int; default=None</span>
<span class="sd">            int : DDVAL id</span>
<span class="sd">                  allows you to set discrete values</span>
<span class="sd">            None : continuous</span>
<span class="sd">        comment : str; default=&#39;&#39;</span>
<span class="sd">            a comment for the card</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">OptConstraint</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">comment</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">comment</span> <span class="o">=</span> <span class="n">comment</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">desvar_id</span> <span class="o">=</span> <span class="n">desvar_id</span>
        <span class="c1">#: user-defined name for printing purposes</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">label</span> <span class="o">=</span> <span class="n">label</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">xinit</span> <span class="o">=</span> <span class="n">xinit</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">xlb</span> <span class="o">=</span> <span class="n">xlb</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">xub</span> <span class="o">=</span> <span class="n">xub</span>
        <span class="k">assert</span> <span class="n">xlb</span> <span class="o">&lt;=</span> <span class="n">xub</span><span class="p">,</span> <span class="s1">&#39;desvar_id=</span><span class="si">%s</span><span class="s1"> xlb=</span><span class="si">%s</span><span class="s1"> xub=</span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">desvar_id</span><span class="p">,</span> <span class="n">xlb</span><span class="p">,</span> <span class="n">xub</span><span class="p">)</span>
        <span class="k">assert</span> <span class="n">xinit</span> <span class="o">&gt;=</span> <span class="n">xlb</span><span class="p">,</span> <span class="s1">&#39;desvar_id=</span><span class="si">%s</span><span class="s1"> xlb=</span><span class="si">%s</span><span class="s1"> xub=</span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">desvar_id</span><span class="p">,</span> <span class="n">xlb</span><span class="p">,</span> <span class="n">xub</span><span class="p">)</span>
        <span class="k">assert</span> <span class="n">xinit</span> <span class="o">&lt;=</span> <span class="n">xub</span><span class="p">,</span> <span class="s1">&#39;desvar_id=</span><span class="si">%s</span><span class="s1"> xlb=</span><span class="si">%s</span><span class="s1"> xub=</span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">desvar_id</span><span class="p">,</span> <span class="n">xlb</span><span class="p">,</span> <span class="n">xub</span><span class="p">)</span>

        <span class="c1"># controls change for a single optimization cycle</span>
        <span class="c1"># taken from DOPTPRM if None; else default=1.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">delx</span> <span class="o">=</span> <span class="n">delx</span>
        <span class="c1"># DDVAL id if you want discrete values</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ddval</span> <span class="o">=</span> <span class="n">ddval</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ddval_ref</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="k">def</span> <span class="nf">_verify</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">xref</span><span class="p">):</span>
        <span class="k">pass</span>

<div class="viewcode-block" id="DESVAR.add_card"><a class="viewcode-back" href="../../../../reference/bdf/cards/pyNastran.bdf.cards.optimization.html#pyNastran.bdf.cards.optimization.DESVAR.add_card">[docs]</a>    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">add_card</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">card</span><span class="p">,</span> <span class="n">comment</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Adds a DESVAR card from ``BDF.add_card(...)``</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        card : BDFCard()</span>
<span class="sd">            a BDFCard object</span>
<span class="sd">        comment : str; default=&#39;&#39;</span>
<span class="sd">            a comment for the card</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">desvar_id</span> <span class="o">=</span> <span class="n">integer</span><span class="p">(</span><span class="n">card</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;desvar_id&#39;</span><span class="p">)</span>
        <span class="n">label</span> <span class="o">=</span> <span class="n">string</span><span class="p">(</span><span class="n">card</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;label&#39;</span><span class="p">)</span>
        <span class="n">xinit</span> <span class="o">=</span> <span class="n">double</span><span class="p">(</span><span class="n">card</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="s1">&#39;xinit&#39;</span><span class="p">)</span>
        <span class="n">xlb</span> <span class="o">=</span> <span class="n">double_or_blank</span><span class="p">(</span><span class="n">card</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="s1">&#39;xlb&#39;</span><span class="p">,</span> <span class="o">-</span><span class="mf">1e20</span><span class="p">)</span>
        <span class="n">xub</span> <span class="o">=</span> <span class="n">double_or_blank</span><span class="p">(</span><span class="n">card</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="s1">&#39;xub&#39;</span><span class="p">,</span> <span class="mf">1e20</span><span class="p">)</span>
        <span class="n">delx</span> <span class="o">=</span> <span class="n">double_or_blank</span><span class="p">(</span><span class="n">card</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="s1">&#39;delx&#39;</span><span class="p">)</span>
        <span class="n">ddval</span> <span class="o">=</span> <span class="n">integer_or_blank</span><span class="p">(</span><span class="n">card</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="s1">&#39;ddval&#39;</span><span class="p">)</span>
        <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">card</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="mi">8</span><span class="p">,</span> <span class="s1">&#39;len(DESVAR card) = </span><span class="si">%i</span><span class="se">\n</span><span class="s1">card=</span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">card</span><span class="p">),</span> <span class="n">card</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">DESVAR</span><span class="p">(</span><span class="n">desvar_id</span><span class="p">,</span> <span class="n">label</span><span class="p">,</span> <span class="n">xinit</span><span class="p">,</span> <span class="n">xlb</span><span class="o">=</span><span class="n">xlb</span><span class="p">,</span> <span class="n">xub</span><span class="o">=</span><span class="n">xub</span><span class="p">,</span>
                      <span class="n">delx</span><span class="o">=</span><span class="n">delx</span><span class="p">,</span> <span class="n">ddval</span><span class="o">=</span><span class="n">ddval</span><span class="p">,</span> <span class="n">comment</span><span class="o">=</span><span class="n">comment</span><span class="p">)</span></div>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">value</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;gets the actual value for the DESVAR&quot;&quot;&quot;</span>
        <span class="n">value</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="nb">max</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">xinit</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">xlb</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">xub</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">value</span>

<div class="viewcode-block" id="DESVAR.raw_fields"><a class="viewcode-back" href="../../../../reference/bdf/cards/pyNastran.bdf.cards.optimization.html#pyNastran.bdf.cards.optimization.DESVAR.raw_fields">[docs]</a>    <span class="k">def</span> <span class="nf">raw_fields</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">list_fields</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;DESVAR&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">desvar_id</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">label</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">xinit</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">xlb</span><span class="p">,</span>
                       <span class="bp">self</span><span class="o">.</span><span class="n">xub</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">delx</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">ddval</span><span class="p">]</span>
        <span class="k">return</span> <span class="n">list_fields</span></div>

<div class="viewcode-block" id="DESVAR.cross_reference"><a class="viewcode-back" href="../../../../reference/bdf/cards/pyNastran.bdf.cards.optimization.html#pyNastran.bdf.cards.optimization.DESVAR.cross_reference">[docs]</a>    <span class="k">def</span> <span class="nf">cross_reference</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">model</span><span class="p">:</span> <span class="n">BDF</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Cross links the card so referenced cards can be extracted directly</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        model : BDF()</span>
<span class="sd">            the BDF object</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">ddval</span><span class="p">:</span>
            <span class="n">msg</span> <span class="o">=</span> <span class="s1">&#39;, which is required by DESVAR desvar_id=</span><span class="si">%r</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">desvar_id</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ddval_ref</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">DDVal</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ddval</span><span class="p">,</span> <span class="n">msg</span><span class="o">=</span><span class="n">msg</span><span class="p">)</span></div>

<div class="viewcode-block" id="DESVAR.safe_cross_reference"><a class="viewcode-back" href="../../../../reference/bdf/cards/pyNastran.bdf.cards.optimization.html#pyNastran.bdf.cards.optimization.DESVAR.safe_cross_reference">[docs]</a>    <span class="k">def</span> <span class="nf">safe_cross_reference</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">model</span><span class="p">):</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">cross_reference</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s1">&#39;cant cross reference DESVAR </span><span class="si">{self.desvar_id}</span><span class="s1"> with DDVAL </span><span class="si">{self.ddval}</span><span class="s1">&#39;</span><span class="p">)</span></div>

<div class="viewcode-block" id="DESVAR.uncross_reference"><a class="viewcode-back" href="../../../../reference/bdf/cards/pyNastran.bdf.cards.optimization.html#pyNastran.bdf.cards.optimization.DESVAR.uncross_reference">[docs]</a>    <span class="k">def</span> <span class="nf">uncross_reference</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Removes cross-reference links&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ddval</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">DDVal</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ddval_ref</span> <span class="o">=</span> <span class="kc">None</span></div>

<div class="viewcode-block" id="DESVAR.DDVal"><a class="viewcode-back" href="../../../../reference/bdf/cards/pyNastran.bdf.cards.optimization.html#pyNastran.bdf.cards.optimization.DESVAR.DDVal">[docs]</a>    <span class="k">def</span> <span class="nf">DDVal</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">ddval_ref</span> <span class="ow">is</span>  <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">ddval_ref</span><span class="o">.</span><span class="n">oid</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">ddval</span></div>

<div class="viewcode-block" id="DESVAR.repr_fields"><a class="viewcode-back" href="../../../../reference/bdf/cards/pyNastran.bdf.cards.optimization.html#pyNastran.bdf.cards.optimization.DESVAR.repr_fields">[docs]</a>    <span class="k">def</span> <span class="nf">repr_fields</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Gets the fields in their simplified form</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        fields : List[varies]</span>
<span class="sd">            the fields that define the card</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">xlb</span> <span class="o">=</span> <span class="n">set_blank_if_default</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">xlb</span><span class="p">,</span> <span class="o">-</span><span class="mf">1e20</span><span class="p">)</span>
        <span class="n">xub</span> <span class="o">=</span> <span class="n">set_blank_if_default</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">xub</span><span class="p">,</span> <span class="mf">1e20</span><span class="p">)</span>

        <span class="n">label</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">label</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">label</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="mi">6</span><span class="p">:</span>
            <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39; </span><span class="si">%6s</span><span class="s1"> &#39;</span> <span class="o">%</span> <span class="n">label</span>
        <span class="n">list_fields</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;DESVAR&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">desvar_id</span><span class="p">,</span> <span class="n">label</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">xinit</span><span class="p">,</span> <span class="n">xlb</span><span class="p">,</span>
                       <span class="n">xub</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">delx</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">DDVal</span><span class="p">()]</span>
        <span class="k">return</span> <span class="n">list_fields</span></div>

<div class="viewcode-block" id="DESVAR.write_card"><a class="viewcode-back" href="../../../../reference/bdf/cards/pyNastran.bdf.cards.optimization.html#pyNastran.bdf.cards.optimization.DESVAR.write_card">[docs]</a>    <span class="k">def</span> <span class="nf">write_card</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">size</span><span class="p">:</span> <span class="nb">int</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span> <span class="n">is_double</span><span class="p">:</span> <span class="nb">bool</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="n">card</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">repr_fields</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">size</span> <span class="o">==</span> <span class="mi">8</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">comment</span> <span class="o">+</span> <span class="n">print_card_8</span><span class="p">(</span><span class="n">card</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">comment</span> <span class="o">+</span> <span class="n">print_card_16</span><span class="p">(</span><span class="n">card</span><span class="p">)</span></div></div>

<div class="viewcode-block" id="TOPVAR"><a class="viewcode-back" href="../../../../reference/bdf/cards/pyNastran.bdf.cards.optimization.html#pyNastran.bdf.cards.optimization.TOPVAR">[docs]</a><span class="k">class</span> <span class="nc">TOPVAR</span><span class="p">(</span><span class="n">BaseCard</span><span class="p">):</span>
    <span class="nb">type</span> <span class="o">=</span> <span class="s1">&#39;TOPVAR&#39;</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">opt_id</span><span class="p">,</span> <span class="n">label</span><span class="p">,</span> <span class="n">prop_type</span><span class="p">,</span> <span class="n">xinit</span><span class="p">,</span> <span class="n">pid</span><span class="p">,</span> <span class="n">xlb</span><span class="o">=</span><span class="mf">0.001</span><span class="p">,</span> <span class="n">delxv</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">power</span><span class="o">=</span><span class="mf">3.0</span><span class="p">,</span>
                 <span class="n">options</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">comment</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">comment</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">comment</span> <span class="o">=</span> <span class="n">comment</span>
        <span class="k">if</span> <span class="n">options</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">options</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">opt_id</span> <span class="o">=</span> <span class="n">opt_id</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">label</span> <span class="o">=</span> <span class="n">label</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">prop_type</span> <span class="o">=</span> <span class="n">prop_type</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">xinit</span> <span class="o">=</span> <span class="n">xinit</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pid</span> <span class="o">=</span> <span class="n">pid</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">xlb</span> <span class="o">=</span> <span class="n">xlb</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">delxv</span> <span class="o">=</span> <span class="n">delxv</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">power</span> <span class="o">=</span> <span class="n">power</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">options</span> <span class="o">=</span> <span class="n">options</span>

<div class="viewcode-block" id="TOPVAR.add_card"><a class="viewcode-back" href="../../../../reference/bdf/cards/pyNastran.bdf.cards.optimization.html#pyNastran.bdf.cards.optimization.TOPVAR.add_card">[docs]</a>    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">add_card</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">card</span><span class="p">,</span> <span class="n">comment</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Adds a DESVAR card from ``BDF.add_card(...)``</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        card : BDFCard()</span>
<span class="sd">            a BDFCard object</span>
<span class="sd">        comment : str; default=&#39;&#39;</span>
<span class="sd">            a comment for the card</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">opt_id</span> <span class="o">=</span> <span class="n">integer</span><span class="p">(</span><span class="n">card</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;opt_id&#39;</span><span class="p">)</span>
        <span class="n">label</span> <span class="o">=</span> <span class="n">string</span><span class="p">(</span><span class="n">card</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;label&#39;</span><span class="p">)</span>
        <span class="n">prop_type</span> <span class="o">=</span> <span class="n">string</span><span class="p">(</span><span class="n">card</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="s1">&#39;prop_type&#39;</span><span class="p">)</span>
        <span class="n">xinit</span> <span class="o">=</span> <span class="n">double_or_blank</span><span class="p">(</span><span class="n">card</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="s1">&#39;xinit&#39;</span><span class="p">)</span>
        <span class="n">xlb</span> <span class="o">=</span> <span class="n">double_or_blank</span><span class="p">(</span><span class="n">card</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="s1">&#39;xlb&#39;</span><span class="p">,</span> <span class="mf">0.001</span><span class="p">)</span>
        <span class="n">delxv</span> <span class="o">=</span> <span class="n">double_or_blank</span><span class="p">(</span><span class="n">card</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="s1">&#39;delxv&#39;</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">)</span>
        <span class="n">power</span> <span class="o">=</span> <span class="n">double_or_blank</span><span class="p">(</span><span class="n">card</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="s1">&#39;power&#39;</span><span class="p">,</span> <span class="mf">3.0</span><span class="p">)</span>
        <span class="n">pid</span> <span class="o">=</span> <span class="n">integer</span><span class="p">(</span><span class="n">card</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="s1">&#39;pid&#39;</span><span class="p">)</span>
        <span class="n">options</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">card</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">8</span><span class="p">:</span>
            <span class="n">name</span> <span class="o">=</span> <span class="n">string_or_blank</span><span class="p">(</span><span class="n">card</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="s1">&#39;SYM&#39;</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">name</span> <span class="o">==</span> <span class="s1">&#39;SYM&#39;</span><span class="p">:</span>
                <span class="c1"># CID MSi MSi MSi CS NCS</span>
                <span class="n">cid</span> <span class="o">=</span> <span class="n">integer_or_blank</span><span class="p">(</span><span class="n">card</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="s1">&#39;cid&#39;</span><span class="p">)</span>
                <span class="n">mirror_symmetry1</span> <span class="o">=</span> <span class="n">string_or_blank</span><span class="p">(</span><span class="n">card</span><span class="p">,</span> <span class="mi">11</span><span class="p">,</span> <span class="s1">&#39;mirror_symmetry1&#39;</span><span class="p">)</span> <span class="c1"># Character, XY, YZ, or ZX</span>
                <span class="n">mirror_symmetry2</span> <span class="o">=</span> <span class="n">string_or_blank</span><span class="p">(</span><span class="n">card</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="s1">&#39;mirror_symmetry2&#39;</span><span class="p">)</span>
                <span class="n">mirror_symmetry3</span> <span class="o">=</span> <span class="n">string_or_blank</span><span class="p">(</span><span class="n">card</span><span class="p">,</span> <span class="mi">13</span><span class="p">,</span> <span class="s1">&#39;mirror_symmetry3&#39;</span><span class="p">)</span>
                <span class="n">cyclic_symmetry</span> <span class="o">=</span> <span class="n">string_or_blank</span><span class="p">(</span><span class="n">card</span><span class="p">,</span> <span class="mi">14</span><span class="p">,</span> <span class="s1">&#39;cyclic_symmetry&#39;</span><span class="p">)</span>  <span class="c1"># X, Y, Z</span>
                <span class="c1">#  Number of cyclic symmetric segments in 360 degrees</span>
                <span class="n">num_cyclic_symmetries</span> <span class="o">=</span> <span class="n">integer_or_blank</span><span class="p">(</span><span class="n">card</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="s1">&#39;num_cyclic_symmetries&#39;</span><span class="p">)</span>
                <span class="n">options</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
                    <span class="s1">&#39;cid&#39;</span> <span class="p">:</span> <span class="n">cid</span><span class="p">,</span>
                    <span class="s1">&#39;mirror_symmetry1&#39;</span> <span class="p">:</span> <span class="n">mirror_symmetry1</span><span class="p">,</span>
                    <span class="s1">&#39;mirror_symmetry2&#39;</span> <span class="p">:</span> <span class="n">mirror_symmetry2</span><span class="p">,</span>
                    <span class="s1">&#39;mirror_symmetry3&#39;</span> <span class="p">:</span> <span class="n">mirror_symmetry3</span><span class="p">,</span>
                    <span class="s1">&#39;cyclic_symmetry&#39;</span> <span class="p">:</span> <span class="n">cyclic_symmetry</span><span class="p">,</span>
                    <span class="s1">&#39;num_cyclic_symmetries&#39;</span> <span class="p">:</span> <span class="n">num_cyclic_symmetries</span><span class="p">,</span>
                <span class="p">}</span>
                <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">card</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="mi">16</span><span class="p">,</span> <span class="s1">&#39;len(TOPVAR card) = </span><span class="si">%i</span><span class="se">\n</span><span class="s1">card=</span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">card</span><span class="p">),</span> <span class="n">card</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">name</span> <span class="o">==</span> <span class="s1">&#39;STRESS&#39;</span><span class="p">:</span>
                <span class="n">allowable</span> <span class="o">=</span> <span class="n">double</span><span class="p">(</span><span class="n">card</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="s1">&#39;allowable?&#39;</span><span class="p">)</span>
                <span class="n">options</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;allowable&#39;</span> <span class="p">:</span> <span class="n">allowable</span><span class="p">,}</span>
                <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">card</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="mi">11</span><span class="p">,</span> <span class="s1">&#39;len(TOPVAR card) = </span><span class="si">%i</span><span class="se">\n</span><span class="s1">card=</span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">card</span><span class="p">),</span> <span class="n">card</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">card</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="mi">9</span><span class="p">,</span> <span class="s1">&#39;len(TOPVAR card) = </span><span class="si">%i</span><span class="se">\n</span><span class="s1">card=</span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">card</span><span class="p">),</span> <span class="n">card</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">TOPVAR</span><span class="p">(</span><span class="n">opt_id</span><span class="p">,</span> <span class="n">label</span><span class="p">,</span> <span class="n">prop_type</span><span class="p">,</span> <span class="n">xinit</span><span class="p">,</span> <span class="n">pid</span><span class="p">,</span> <span class="n">xlb</span><span class="o">=</span><span class="n">xlb</span><span class="p">,</span>
                      <span class="n">delxv</span><span class="o">=</span><span class="n">delxv</span><span class="p">,</span> <span class="n">power</span><span class="o">=</span><span class="n">power</span><span class="p">,</span> <span class="n">options</span><span class="o">=</span><span class="n">options</span><span class="p">,</span> <span class="n">comment</span><span class="o">=</span><span class="n">comment</span><span class="p">)</span></div>

<div class="viewcode-block" id="TOPVAR.repr_fields"><a class="viewcode-back" href="../../../../reference/bdf/cards/pyNastran.bdf.cards.optimization.html#pyNastran.bdf.cards.optimization.TOPVAR.repr_fields">[docs]</a>    <span class="k">def</span> <span class="nf">repr_fields</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Gets the fields in their simplified form</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        fields : List[varies]</span>
<span class="sd">            the fields that define the card</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">power</span> <span class="o">=</span> <span class="n">set_blank_if_default</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">power</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
        <span class="n">xlb</span> <span class="o">=</span> <span class="n">set_blank_if_default</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">xlb</span><span class="p">,</span> <span class="mf">0.001</span><span class="p">)</span>
        <span class="n">delxv</span> <span class="o">=</span> <span class="n">set_blank_if_default</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">delxv</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">)</span>

        <span class="n">label</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">label</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">label</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="mi">6</span><span class="p">:</span>
            <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39; </span><span class="si">%6s</span><span class="s1"> &#39;</span> <span class="o">%</span> <span class="n">label</span>
        <span class="n">list_fields</span> <span class="o">=</span> <span class="p">[</span>
            <span class="s1">&#39;TOPVAR&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">opt_id</span><span class="p">,</span> <span class="n">label</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">prop_type</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">xinit</span><span class="p">,</span> <span class="n">xlb</span><span class="p">,</span> <span class="n">delxv</span><span class="p">,</span> <span class="n">power</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">pid</span><span class="p">]</span>
        <span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">option</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">options</span><span class="o">.</span><span class="n">items</span><span class="p">()):</span>
            <span class="k">if</span> <span class="n">name</span> <span class="o">==</span> <span class="s1">&#39;STRESS&#39;</span><span class="p">:</span>
                <span class="n">list_fields</span> <span class="o">+=</span> <span class="p">[</span><span class="n">name</span><span class="p">,</span> <span class="n">option</span><span class="p">[</span><span class="s1">&#39;allowable&#39;</span><span class="p">],</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">]</span>
            <span class="k">elif</span> <span class="n">name</span> <span class="o">==</span> <span class="s1">&#39;SYM&#39;</span><span class="p">:</span>
                <span class="n">list_fields</span> <span class="o">+=</span> <span class="p">[</span>
                    <span class="n">name</span><span class="p">,</span>
                    <span class="n">option</span><span class="p">[</span><span class="s1">&#39;cid&#39;</span><span class="p">],</span>
                    <span class="n">option</span><span class="p">[</span><span class="s1">&#39;mirror_symmetry1&#39;</span><span class="p">],</span>
                    <span class="n">option</span><span class="p">[</span><span class="s1">&#39;mirror_symmetry2&#39;</span><span class="p">],</span>
                    <span class="n">option</span><span class="p">[</span><span class="s1">&#39;mirror_symmetry3&#39;</span><span class="p">],</span>
                    <span class="n">option</span><span class="p">[</span><span class="s1">&#39;cyclic_symmetry&#39;</span><span class="p">],</span>
                    <span class="n">option</span><span class="p">[</span><span class="s1">&#39;num_cyclic_symmetries&#39;</span><span class="p">],</span>
                    <span class="kc">None</span><span class="p">,</span>
                <span class="p">]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">list_fields</span></div>

<div class="viewcode-block" id="TOPVAR.uncross_reference"><a class="viewcode-back" href="../../../../reference/bdf/cards/pyNastran.bdf.cards.optimization.html#pyNastran.bdf.cards.optimization.TOPVAR.uncross_reference">[docs]</a>    <span class="k">def</span> <span class="nf">uncross_reference</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">pass</span></div>

<div class="viewcode-block" id="TOPVAR.write_card"><a class="viewcode-back" href="../../../../reference/bdf/cards/pyNastran.bdf.cards.optimization.html#pyNastran.bdf.cards.optimization.TOPVAR.write_card">[docs]</a>    <span class="k">def</span> <span class="nf">write_card</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">size</span><span class="p">:</span> <span class="nb">int</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span> <span class="n">is_double</span><span class="p">:</span> <span class="nb">bool</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="n">card</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">repr_fields</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">size</span> <span class="o">==</span> <span class="mi">8</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">comment</span> <span class="o">+</span> <span class="n">print_card_8</span><span class="p">(</span><span class="n">card</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">comment</span> <span class="o">+</span> <span class="n">print_card_16</span><span class="p">(</span><span class="n">card</span><span class="p">)</span></div></div>

<div class="viewcode-block" id="DDVAL"><a class="viewcode-back" href="../../../../reference/bdf/cards/pyNastran.bdf.cards.optimization.html#pyNastran.bdf.cards.optimization.DDVAL">[docs]</a><span class="k">class</span> <span class="nc">DDVAL</span><span class="p">(</span><span class="n">OptConstraint</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    +-------+-----+-------+-------+-------+-------+-------+-------+-------+</span>
<span class="sd">    |   1   |  2  |   3   |   4   |   5   |   6   |   7   |   8   |   9   |</span>
<span class="sd">    +=======+=====+=======+=======+=======+=======+=======+=======+=======+</span>
<span class="sd">    | DDVAL | ID  | DVAL1 | DVAL2 | DVAL3 | DVAL4 | DVAL5 | DVAL6 | DVAL7 |</span>
<span class="sd">    +-------+-----+-------+-------+-------+-------+-------+-------+-------+</span>
<span class="sd">    | DDVAL | ID  | DVAL1 | THRU  | DVAL2 | BY    |  INC  |       |       |</span>
<span class="sd">    +-------+-----+-------+-------+-------+-------+-------+-------+-------+</span>

<span class="sd">    +-------+-----+-------+-------+-------+-------+-------+-------+-------+</span>
<span class="sd">    | DDVAL | 110 |  0.1  |  0.2  |  0.3  |  0.5  |  0.6  |  0.4  |       |</span>
<span class="sd">    +-------+-----+-------+-------+-------+-------+-------+-------+-------+</span>
<span class="sd">    |       | .7  | THRU  |  1.0  |  BY   | 0.05  |       |       |       |</span>
<span class="sd">    +-------+-----+-------+-------+-------+-------+-------+-------+-------+</span>
<span class="sd">    |       | 1.5 |  2.0  |       |       |       |       |       |       |</span>
<span class="sd">    +-------+-----+-------+-------+-------+-------+-------+-------+-------+</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="nb">type</span> <span class="o">=</span> <span class="s1">&#39;DDVAL&#39;</span>

<div class="viewcode-block" id="DDVAL._init_from_empty"><a class="viewcode-back" href="../../../../reference/bdf/cards/pyNastran.bdf.cards.optimization.html#pyNastran.bdf.cards.optimization.DDVAL._init_from_empty">[docs]</a>    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">_init_from_empty</span><span class="p">(</span><span class="bp">cls</span><span class="p">):</span>
        <span class="n">oid</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="n">ddvals</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span>
        <span class="k">return</span> <span class="n">DDVAL</span><span class="p">(</span><span class="n">oid</span><span class="p">,</span> <span class="n">ddvals</span><span class="p">,</span> <span class="n">comment</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">)</span></div>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">oid</span><span class="p">,</span> <span class="n">ddvals</span><span class="p">,</span> <span class="n">comment</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">):</span>
        <span class="n">OptConstraint</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">comment</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">comment</span> <span class="o">=</span> <span class="n">comment</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">ddvals</span><span class="p">,</span> <span class="nb">float</span><span class="p">):</span>
            <span class="n">ddvals</span> <span class="o">=</span> <span class="p">[</span><span class="n">ddvals</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">ddvals</span> <span class="o">=</span> <span class="n">expand_thru_by</span><span class="p">(</span><span class="n">ddvals</span><span class="p">,</span> <span class="n">require_int</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
            <span class="n">ddvals</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">oid</span> <span class="o">=</span> <span class="n">oid</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ddvals</span> <span class="o">=</span> <span class="n">ddvals</span>

<div class="viewcode-block" id="DDVAL.validate"><a class="viewcode-back" href="../../../../reference/bdf/cards/pyNastran.bdf.cards.optimization.html#pyNastran.bdf.cards.optimization.DDVAL.validate">[docs]</a>    <span class="k">def</span> <span class="nf">validate</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c1">#if not isinstance(self.ddvals, list):</span>
            <span class="c1">#raise TypeError(&#39;ddvals=%s must be a list&#39; % self.ddvals)</span>
        <span class="n">msg</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
        <span class="k">for</span> <span class="n">iddval</span><span class="p">,</span> <span class="n">ddval</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ddvals</span><span class="p">):</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">ddval</span><span class="p">,</span> <span class="nb">float</span><span class="p">):</span>
                <span class="n">msg</span> <span class="o">+=</span> <span class="s1">&#39;ddval[</span><span class="si">%i</span><span class="s1">]=</span><span class="si">%s</span><span class="s1"> is not a float; type=</span><span class="si">%s</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">iddval</span><span class="p">,</span> <span class="n">ddval</span><span class="p">,</span> <span class="nb">type</span><span class="p">(</span><span class="n">ddval</span><span class="p">))</span>
        <span class="k">if</span> <span class="n">msg</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span></div>

<div class="viewcode-block" id="DDVAL.add_card"><a class="viewcode-back" href="../../../../reference/bdf/cards/pyNastran.bdf.cards.optimization.html#pyNastran.bdf.cards.optimization.DDVAL.add_card">[docs]</a>    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">add_card</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">card</span><span class="p">,</span> <span class="n">comment</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Adds a DDVAL card from ``BDF.add_card(...)``</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        card : BDFCard()</span>
<span class="sd">            a BDFCard object</span>
<span class="sd">        comment : str; default=&#39;&#39;</span>
<span class="sd">            a comment for the card</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">oid</span> <span class="o">=</span> <span class="n">integer</span><span class="p">(</span><span class="n">card</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;oid&#39;</span><span class="p">)</span>
        <span class="n">n</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="n">ddvals</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">card</span><span class="p">)):</span>
            <span class="n">ddval</span> <span class="o">=</span> <span class="n">double_string_or_blank</span><span class="p">(</span><span class="n">card</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="s1">&#39;DDVAL</span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">n</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">ddval</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">ddvals</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ddval</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">DDVAL</span><span class="p">(</span><span class="n">oid</span><span class="p">,</span> <span class="n">ddvals</span><span class="p">,</span> <span class="n">comment</span><span class="o">=</span><span class="n">comment</span><span class="p">)</span></div>

<div class="viewcode-block" id="DDVAL.raw_fields"><a class="viewcode-back" href="../../../../reference/bdf/cards/pyNastran.bdf.cards.optimization.html#pyNastran.bdf.cards.optimization.DDVAL.raw_fields">[docs]</a>    <span class="k">def</span> <span class="nf">raw_fields</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ddvals</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>
        <span class="n">list_fields</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;DDVAL&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">oid</span><span class="p">]</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">ddvals</span>
        <span class="k">return</span> <span class="n">list_fields</span></div>

<div class="viewcode-block" id="DDVAL.write_card"><a class="viewcode-back" href="../../../../reference/bdf/cards/pyNastran.bdf.cards.optimization.html#pyNastran.bdf.cards.optimization.DDVAL.write_card">[docs]</a>    <span class="k">def</span> <span class="nf">write_card</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">size</span><span class="p">:</span> <span class="nb">int</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span> <span class="n">is_double</span><span class="p">:</span> <span class="nb">bool</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="n">card</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">repr_fields</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">size</span> <span class="o">==</span> <span class="mi">8</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">comment</span> <span class="o">+</span> <span class="n">print_card_8</span><span class="p">(</span><span class="n">card</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">is_double</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">comment</span> <span class="o">+</span> <span class="n">print_card_double</span><span class="p">(</span><span class="n">card</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">comment</span> <span class="o">+</span> <span class="n">print_card_16</span><span class="p">(</span><span class="n">card</span><span class="p">)</span></div></div>


<span class="n">DOPTPRM_INTS</span> <span class="o">=</span> <span class="nb">set</span><span class="p">([])</span>
<span class="n">DOPTPRM_FLOATS</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;DABOBJ&#39;</span><span class="p">,</span> <span class="s1">&#39;DOBJ2&#39;</span><span class="p">,</span> <span class="s1">&#39;DX2&#39;</span><span class="p">,</span>
<span class="p">}</span>
<span class="n">DOPTPRM_INT_FLOATS</span> <span class="o">=</span> <span class="nb">set</span><span class="p">([])</span>
<span class="n">DOPTPRM_DEFAULTS</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;APRCOD&#39;</span> <span class="p">:</span> <span class="mi">2</span><span class="p">,</span>
    <span class="s1">&#39;AUTOSE&#39;</span> <span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
    <span class="c1">#&#39;CONV1&#39; : 0.001,</span>
    <span class="s1">&#39;CONV1&#39;</span> <span class="p">:</span> <span class="mf">0.0001</span><span class="p">,</span>  <span class="c1"># NX 2019.2</span>
    <span class="s1">&#39;CONV2&#39;</span> <span class="p">:</span> <span class="mf">1e-20</span><span class="p">,</span>
    <span class="s1">&#39;CONVDV&#39;</span> <span class="p">:</span> <span class="mf">0.001</span><span class="p">,</span>  <span class="c1"># 0.0001 for topology optimization</span>
    <span class="s1">&#39;CONVPR&#39;</span> <span class="p">:</span> <span class="mf">0.001</span><span class="p">,</span>
    <span class="s1">&#39;CT&#39;</span> <span class="p">:</span> <span class="o">-</span><span class="mf">0.03</span><span class="p">,</span>
    <span class="s1">&#39;CTMIN&#39;</span> <span class="p">:</span> <span class="mf">0.003</span><span class="p">,</span>
    <span class="s1">&#39;DELB&#39;</span> <span class="p">:</span> <span class="mf">0.0001</span><span class="p">,</span>
    <span class="s1">&#39;DELP&#39;</span> <span class="p">:</span> <span class="mf">0.2</span><span class="p">,</span>
    <span class="s1">&#39;DELX&#39;</span> <span class="p">:</span> <span class="mf">0.5</span><span class="p">,</span>  <span class="c1"># 0.2 for topology optimization</span>
    <span class="s1">&#39;DLXESL&#39;</span> <span class="p">:</span> <span class="mf">0.5</span><span class="p">,</span>
    <span class="s1">&#39;DESMAX&#39;</span> <span class="p">:</span> <span class="mi">5</span><span class="p">,</span>  <span class="c1"># 30 for topology optimization</span>
    <span class="s1">&#39;DELOBJ&#39;</span> <span class="p">:</span> <span class="mf">0.001</span><span class="p">,</span>
    <span class="s1">&#39;DOBJ1&#39;</span> <span class="p">:</span> <span class="mf">0.1</span><span class="p">,</span>
    <span class="s1">&#39;DOBJ2&#39;</span> <span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
    <span class="s1">&#39;DX1&#39;</span> <span class="p">:</span> <span class="mf">0.01</span><span class="p">,</span>
    <span class="s1">&#39;DX2&#39;</span> <span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
    <span class="s1">&#39;DISCOD&#39;</span> <span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
    <span class="s1">&#39;DISBEG&#39;</span> <span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
    <span class="s1">&#39;DPMAX&#39;</span> <span class="p">:</span> <span class="mf">0.5</span><span class="p">,</span>
    <span class="s1">&#39;DPMIN&#39;</span> <span class="p">:</span> <span class="mf">0.01</span><span class="p">,</span>
    <span class="s1">&#39;DRATIO&#39;</span> <span class="p">:</span> <span class="mf">0.1</span><span class="p">,</span>
    <span class="s1">&#39;DSMXESL&#39;</span> <span class="p">:</span> <span class="mi">20</span><span class="p">,</span>
    <span class="s1">&#39;DXMAX&#39;</span> <span class="p">:</span> <span class="mf">1.0</span><span class="p">,</span>
    <span class="s1">&#39;DXMIN&#39;</span> <span class="p">:</span> <span class="mf">0.05</span><span class="p">,</span>  <span class="c1"># 1e-5 for topology optimization</span>
    <span class="s1">&#39;DPMIN&#39;</span> <span class="p">:</span> <span class="mf">0.01</span><span class="p">,</span>

    <span class="s1">&#39;ETA1&#39;</span> <span class="p">:</span> <span class="mf">0.01</span><span class="p">,</span>
    <span class="s1">&#39;ETA2&#39;</span> <span class="p">:</span> <span class="mf">0.25</span><span class="p">,</span>
    <span class="s1">&#39;ETA3&#39;</span> <span class="p">:</span> <span class="mf">0.7</span><span class="p">,</span>
    <span class="s1">&#39;EDVOUT&#39;</span><span class="p">:</span> <span class="mf">0.001</span><span class="p">,</span>
    <span class="s1">&#39;FSDALP&#39;</span> <span class="p">:</span> <span class="mf">0.9</span><span class="p">,</span>
    <span class="s1">&#39;FSDMAX&#39;</span> <span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
    <span class="s1">&#39;GMAX&#39;</span> <span class="p">:</span> <span class="mf">0.005</span><span class="p">,</span>
    <span class="s1">&#39;GSCAL&#39;</span> <span class="p">:</span> <span class="mf">0.001</span><span class="p">,</span>

    <span class="s1">&#39;IGMAX&#39;</span> <span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
    <span class="s1">&#39;IPRINT&#39;</span> <span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
    <span class="s1">&#39;IPRNT1&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
    <span class="s1">&#39;IPRNT2&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
    <span class="s1">&#39;ISCAL&#39;</span> <span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
    <span class="s1">&#39;ITMAX&#39;</span><span class="p">:</span> <span class="mi">40</span><span class="p">,</span>
    <span class="s1">&#39;ITRMOP&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span>
    <span class="s1">&#39;ITRMST&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span>
    <span class="s1">&#39;IWRITE&#39;</span><span class="p">:</span> <span class="mi">6</span><span class="p">,</span> <span class="c1"># or system(2)</span>

    <span class="s1">&#39;JPRINT&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
    <span class="s1">&#39;JTMAX&#39;</span><span class="p">:</span> <span class="mi">20</span><span class="p">,</span>
    <span class="s1">&#39;JWRITE&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>

    <span class="s1">&#39;MXCRTRSP&#39;</span><span class="p">:</span> <span class="mi">5</span><span class="p">,</span>
    <span class="c1">#&#39;METHOD&#39; : 0, # ???</span>
    <span class="s1">&#39;METHOD&#39;</span> <span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="c1"># NX 2019</span>

    <span class="s1">&#39;NASPRO&#39;</span> <span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
    <span class="s1">&#39;OBJMOD&#39;</span> <span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
    <span class="s1">&#39;OPTCOD&#39;</span> <span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
    <span class="s1">&#39;P1&#39;</span> <span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
    <span class="s1">&#39;P2&#39;</span> <span class="p">:</span> <span class="mi">1</span><span class="p">,</span>

    <span class="s1">&#39;P2CALL&#39;</span> <span class="p">:</span> <span class="kc">None</span><span class="p">,</span>  <span class="c1">#: .. todo:: DEFAULT PRINTS ALL???</span>
    <span class="s1">&#39;P2CBL&#39;</span> <span class="p">:</span> <span class="kc">None</span><span class="p">,</span>   <span class="c1">#: .. todo:: DEFAULT PRINTS ALL???</span>
    <span class="s1">&#39;P2CC&#39;</span> <span class="p">:</span> <span class="kc">None</span><span class="p">,</span>    <span class="c1">#: .. todo:: DEFAULT PRINTS ALL???</span>
    <span class="s1">&#39;P2CDDV&#39;</span> <span class="p">:</span> <span class="kc">None</span><span class="p">,</span>  <span class="c1">#: .. todo:: DEFAULT PRINTS ALL???</span>
    <span class="s1">&#39;P2CM&#39;</span> <span class="p">:</span> <span class="kc">None</span><span class="p">,</span>    <span class="c1">#: .. todo:: DEFAULT PRINTS ALL???</span>
    <span class="s1">&#39;P2CP&#39;</span> <span class="p">:</span> <span class="kc">None</span><span class="p">,</span>    <span class="c1">#: .. todo:: DEFAULT PRINTS ALL???</span>
    <span class="s1">&#39;P2CR&#39;</span> <span class="p">:</span> <span class="kc">None</span><span class="p">,</span>    <span class="c1">#: .. todo:: DEFAULT PRINTS ALL???</span>
    <span class="s1">&#39;P2RSET&#39;</span> <span class="p">:</span> <span class="mi">0</span><span class="p">,</span>     <span class="c1"># default=0 -&gt; ALL</span>
    <span class="s1">&#39;PENAL&#39;</span> <span class="p">:</span> <span class="mf">0.0</span><span class="p">,</span>
    <span class="s1">&#39;PLVIOL&#39;</span> <span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
    <span class="s1">&#39;PTOL&#39;</span> <span class="p">:</span> <span class="mf">1e35</span><span class="p">,</span>
    <span class="s1">&#39;STPSCL&#39;</span> <span class="p">:</span> <span class="mf">1.0</span><span class="p">,</span>
    <span class="s1">&#39;TCHECK&#39;</span> <span class="p">:</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span>
    <span class="s1">&#39;TDMIN&#39;</span> <span class="p">:</span> <span class="kc">None</span><span class="p">,</span>  <span class="c1">#: .. todo:: ???</span>
    <span class="s1">&#39;TREGION&#39;</span> <span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
    <span class="s1">&#39;UPDFAC1&#39;</span> <span class="p">:</span> <span class="mf">2.0</span><span class="p">,</span>
    <span class="s1">&#39;UPDFAC2&#39;</span> <span class="p">:</span> <span class="mf">0.5</span><span class="p">,</span>
<span class="p">}</span>

<span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">DOPTPRM_DEFAULTS</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>
        <span class="n">DOPTPRM_INTS</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="nb">float</span><span class="p">):</span>
        <span class="n">DOPTPRM_FLOATS</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">value</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">DOPTPRM_INT_FLOATS</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">((</span><span class="n">key</span><span class="p">,</span> <span class="n">value</span><span class="p">))</span>

<div class="viewcode-block" id="DOPTPRM"><a class="viewcode-back" href="../../../../reference/bdf/cards/pyNastran.bdf.cards.optimization.html#pyNastran.bdf.cards.optimization.DOPTPRM">[docs]</a><span class="k">class</span> <span class="nc">DOPTPRM</span><span class="p">(</span><span class="n">OptConstraint</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;causes a Nastran core dump if FSDMAX is nonzero and there is no stress case&quot;&quot;&quot;</span>
    <span class="nb">type</span> <span class="o">=</span> <span class="s1">&#39;DOPTPRM&#39;</span>
    <span class="n">defaults</span> <span class="o">=</span> <span class="n">DOPTPRM_DEFAULTS</span>

<div class="viewcode-block" id="DOPTPRM._init_from_empty"><a class="viewcode-back" href="../../../../reference/bdf/cards/pyNastran.bdf.cards.optimization.html#pyNastran.bdf.cards.optimization.DOPTPRM._init_from_empty">[docs]</a>    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">_init_from_empty</span><span class="p">(</span><span class="bp">cls</span><span class="p">):</span>
        <span class="n">params</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;TCHECK&#39;</span> <span class="p">:</span> <span class="o">-</span><span class="mi">1</span><span class="p">}</span>
        <span class="k">return</span> <span class="n">DOPTPRM</span><span class="p">(</span><span class="n">params</span><span class="p">,</span> <span class="n">comment</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">)</span></div>

<div class="viewcode-block" id="DOPTPRM._finalize_hdf5"><a class="viewcode-back" href="../../../../reference/bdf/cards/pyNastran.bdf.cards.optimization.html#pyNastran.bdf.cards.optimization.DOPTPRM._finalize_hdf5">[docs]</a>    <span class="k">def</span> <span class="nf">_finalize_hdf5</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">encoding</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;hdf5 helper function&quot;&quot;&quot;</span>
        <span class="n">keys</span><span class="p">,</span> <span class="n">values</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">params</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">params</span> <span class="o">=</span> <span class="p">{</span><span class="n">key</span> <span class="p">:</span> <span class="n">value</span> <span class="k">if</span> <span class="ow">not</span> <span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">value</span><span class="p">)</span> <span class="k">else</span> <span class="kc">None</span>
                       <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">keys</span><span class="p">,</span> <span class="n">values</span><span class="p">)}</span></div>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">params</span><span class="p">,</span> <span class="n">comment</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Design Optimization Parameters</span>
<span class="sd">        Overrides default values of parameters used in design optimization</span>

<span class="sd">        +---------+--------+------+--------+------+--------+------+--------+------+</span>
<span class="sd">        |    1    |    2   |   3  |   4    |  5   |    6   |   7  |    8   |   9  |</span>
<span class="sd">        +=========+========+======+========+======+========+======+========+======+</span>
<span class="sd">        | DOPTPRM | PARAM1 | VAL1 | PARAM2 | VAL2 | PARAM3 | VAL3 | PARAM4 | VAL4 |</span>
<span class="sd">        +---------+--------+------+--------+------+--------+------+--------+------+</span>
<span class="sd">        |         | PARAM5 | VAL5 |  etc.  |      |        |      |        |      |</span>
<span class="sd">        +---------+--------+------+--------+------+--------+------+--------+------+</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">OptConstraint</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">comment</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">comment</span> <span class="o">=</span> <span class="n">comment</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">params</span> <span class="o">=</span> <span class="n">params</span>

<div class="viewcode-block" id="DOPTPRM.add_card"><a class="viewcode-back" href="../../../../reference/bdf/cards/pyNastran.bdf.cards.optimization.html#pyNastran.bdf.cards.optimization.DOPTPRM.add_card">[docs]</a>    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">add_card</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">card</span><span class="p">,</span> <span class="n">comment</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Adds a DOPTPRM card from ``BDF.add_card(...)``</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        card : BDFCard()</span>
<span class="sd">            a BDFCard object</span>
<span class="sd">        comment : str; default=&#39;&#39;</span>
<span class="sd">            a comment for the card</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">nfields</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">card</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span>
        <span class="n">params</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">nfields</span><span class="p">,</span> <span class="mi">2</span><span class="p">):</span>
            <span class="n">param</span> <span class="o">=</span> <span class="n">string_or_blank</span><span class="p">(</span><span class="n">card</span><span class="p">,</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;param&#39;</span><span class="p">)</span>
            <span class="n">default_value</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="k">if</span> <span class="n">param</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">continue</span>
            <span class="k">if</span> <span class="n">param</span> <span class="ow">in</span> <span class="bp">cls</span><span class="o">.</span><span class="n">defaults</span><span class="p">:</span>
                <span class="n">default_value</span> <span class="o">=</span> <span class="bp">cls</span><span class="o">.</span><span class="n">defaults</span><span class="p">[</span><span class="n">param</span><span class="p">]</span>

            <span class="k">if</span> <span class="n">param</span> <span class="ow">in</span> <span class="n">DOPTPRM_INTS</span><span class="p">:</span>
                <span class="n">val</span> <span class="o">=</span> <span class="n">integer_or_blank</span><span class="p">(</span><span class="n">card</span><span class="p">,</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;</span><span class="si">%s</span><span class="s1">_value&#39;</span> <span class="o">%</span> <span class="n">param</span><span class="p">,</span> <span class="n">default_value</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">param</span> <span class="ow">in</span> <span class="n">DOPTPRM_FLOATS</span><span class="p">:</span>
                <span class="n">val</span> <span class="o">=</span> <span class="n">double_or_blank</span><span class="p">(</span><span class="n">card</span><span class="p">,</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;</span><span class="si">%s</span><span class="s1">_value&#39;</span> <span class="o">%</span> <span class="n">param</span><span class="p">,</span> <span class="n">default_value</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">val</span> <span class="o">=</span> <span class="n">integer_double_string_or_blank</span><span class="p">(</span><span class="n">card</span><span class="p">,</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;</span><span class="si">%s</span><span class="s1">_value&#39;</span> <span class="o">%</span> <span class="n">param</span><span class="p">,</span> <span class="n">default_value</span><span class="p">)</span>
            <span class="n">params</span><span class="p">[</span><span class="n">param</span><span class="p">]</span> <span class="o">=</span> <span class="n">val</span>
        <span class="k">return</span> <span class="n">DOPTPRM</span><span class="p">(</span><span class="n">params</span><span class="p">,</span> <span class="n">comment</span><span class="o">=</span><span class="n">comment</span><span class="p">)</span></div>

<div class="viewcode-block" id="DOPTPRM.raw_fields"><a class="viewcode-back" href="../../../../reference/bdf/cards/pyNastran.bdf.cards.optimization.html#pyNastran.bdf.cards.optimization.DOPTPRM.raw_fields">[docs]</a>    <span class="k">def</span> <span class="nf">raw_fields</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">list_fields</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;DOPTPRM&#39;</span><span class="p">]</span>
        <span class="k">for</span> <span class="n">param</span><span class="p">,</span> <span class="n">val</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="o">.</span><span class="n">items</span><span class="p">()):</span>
            <span class="n">list_fields</span> <span class="o">+=</span> <span class="p">[</span><span class="n">param</span><span class="p">,</span> <span class="n">val</span><span class="p">]</span>
        <span class="k">return</span> <span class="n">list_fields</span></div>

<div class="viewcode-block" id="DOPTPRM.write_card"><a class="viewcode-back" href="../../../../reference/bdf/cards/pyNastran.bdf.cards.optimization.html#pyNastran.bdf.cards.optimization.DOPTPRM.write_card">[docs]</a>    <span class="k">def</span> <span class="nf">write_card</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">size</span><span class="p">:</span> <span class="nb">int</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span> <span class="n">is_double</span><span class="p">:</span> <span class="nb">bool</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="n">card</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">repr_fields</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">size</span> <span class="o">==</span> <span class="mi">8</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">comment</span> <span class="o">+</span> <span class="n">print_card_8</span><span class="p">(</span><span class="n">card</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">is_double</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">comment</span> <span class="o">+</span> <span class="n">print_card_double</span><span class="p">(</span><span class="n">card</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">comment</span> <span class="o">+</span> <span class="n">print_card_16</span><span class="p">(</span><span class="n">card</span><span class="p">)</span></div></div>


<div class="viewcode-block" id="DLINK"><a class="viewcode-back" href="../../../../reference/bdf/cards/pyNastran.bdf.cards.optimization.html#pyNastran.bdf.cards.optimization.DLINK">[docs]</a><span class="k">class</span> <span class="nc">DLINK</span><span class="p">(</span><span class="n">OptConstraint</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Multiple Design Variable Linking</span>
<span class="sd">    Relates one design variable to one or more other design variables.</span>

<span class="sd">    +-------+------+-------+--------+-------+------+----+------+----+</span>
<span class="sd">    |   1   |   2  |   3   |   4    |   5   |   6  |  7 |   8  | 9  |</span>
<span class="sd">    +=======+======+=======+========+=======+======+====+======+====+</span>
<span class="sd">    | DLINK |  ID  | DDVID |   C0   | CMULT | IDV1 | C1 | IDV2 | C2 |</span>
<span class="sd">    +-------+------+-------+--------+-------+------+----+------+----+</span>
<span class="sd">    |       | IDV3 |   C3  |  etc.  |       |      |    |      |    |</span>
<span class="sd">    +-------+------+-------+--------+-------+------+----+------+----+</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="nb">type</span> <span class="o">=</span> <span class="s1">&#39;DLINK&#39;</span>

<div class="viewcode-block" id="DLINK._init_from_empty"><a class="viewcode-back" href="../../../../reference/bdf/cards/pyNastran.bdf.cards.optimization.html#pyNastran.bdf.cards.optimization.DLINK._init_from_empty">[docs]</a>    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">_init_from_empty</span><span class="p">(</span><span class="bp">cls</span><span class="p">):</span>
        <span class="n">oid</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="n">dependent_desvar</span> <span class="o">=</span> <span class="mi">1</span>

        <span class="n">independent_desvars</span> <span class="o">=</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">]</span>
        <span class="n">coeffs</span> <span class="o">=</span> <span class="p">[</span><span class="mf">1.</span><span class="p">,</span> <span class="mf">2.</span><span class="p">]</span>
        <span class="k">return</span> <span class="n">DLINK</span><span class="p">(</span><span class="n">oid</span><span class="p">,</span> <span class="n">dependent_desvar</span><span class="p">,</span> <span class="n">independent_desvars</span><span class="p">,</span> <span class="n">coeffs</span><span class="p">,</span>
                     <span class="n">c0</span><span class="o">=</span><span class="mf">0.</span><span class="p">,</span> <span class="n">cmult</span><span class="o">=</span><span class="mf">1.</span><span class="p">,</span> <span class="n">comment</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">)</span></div>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">oid</span><span class="p">,</span> <span class="n">dependent_desvar</span><span class="p">,</span>
                 <span class="n">independent_desvars</span><span class="p">,</span> <span class="n">coeffs</span><span class="p">,</span> <span class="n">c0</span><span class="o">=</span><span class="mf">0.</span><span class="p">,</span> <span class="n">cmult</span><span class="o">=</span><span class="mf">1.</span><span class="p">,</span> <span class="n">comment</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Creates a DLINK card, which creates a variable that is a lienar</span>
<span class="sd">        ccombination of other design variables</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        oid : int</span>
<span class="sd">            optimization id</span>
<span class="sd">        dependent_desvar : int</span>
<span class="sd">            the DESVAR to link</span>
<span class="sd">        independent_desvars : List[int]</span>
<span class="sd">            the DESVARs to combine</span>
<span class="sd">        coeffs : List[int]</span>
<span class="sd">            the linear combination coefficients</span>
<span class="sd">        c0 : float; default=0.0</span>
<span class="sd">            an offset</span>
<span class="sd">        cmult : float; default=1.0</span>
<span class="sd">            an scale factor</span>
<span class="sd">        comment : str; default=&#39;&#39;</span>
<span class="sd">            a comment for the card</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">OptConstraint</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">comment</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">comment</span> <span class="o">=</span> <span class="n">comment</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">oid</span> <span class="o">=</span> <span class="n">oid</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dependent_desvar</span> <span class="o">=</span> <span class="n">dependent_desvar</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">c0</span> <span class="o">=</span> <span class="n">c0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">cmult</span> <span class="o">=</span> <span class="n">cmult</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">independent_desvars</span><span class="p">,</span> <span class="n">integer_types</span><span class="p">):</span>
            <span class="n">independent_desvars</span> <span class="o">=</span> <span class="p">[</span><span class="n">independent_desvars</span><span class="p">]</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">coeffs</span><span class="p">,</span> <span class="n">float_types</span><span class="p">):</span>
            <span class="n">coeffs</span> <span class="o">=</span> <span class="p">[</span><span class="n">coeffs</span><span class="p">]</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">independent_desvars</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">independent_desvars</span> <span class="o">=</span> <span class="n">independent_desvars</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">coeffs</span> <span class="o">=</span> <span class="n">coeffs</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">ddvid</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">dependent_desvar</span>

    <span class="nd">@ddvid</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">ddvid</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dependent_desvar</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dependent_desvar</span> <span class="o">=</span> <span class="n">dependent_desvar</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">IDv</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">independent_desvars</span>

    <span class="nd">@IDv</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">IDv</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">independent_desvars</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">independent_desvars</span> <span class="o">=</span> <span class="n">independent_desvars</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">Ci</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">coeffs</span>

    <span class="nd">@Ci</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">Ci</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">coeffs</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">coeffs</span> <span class="o">=</span> <span class="n">coeffs</span>

<div class="viewcode-block" id="DLINK.add_card"><a class="viewcode-back" href="../../../../reference/bdf/cards/pyNastran.bdf.cards.optimization.html#pyNastran.bdf.cards.optimization.DLINK.add_card">[docs]</a>    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">add_card</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">card</span><span class="p">,</span> <span class="n">comment</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Adds a DLINK card from ``BDF.add_card(...)``</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        card : BDFCard()</span>
<span class="sd">            a BDFCard object</span>
<span class="sd">        comment : str; default=&#39;&#39;</span>
<span class="sd">            a comment for the card</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">oid</span> <span class="o">=</span> <span class="n">integer</span><span class="p">(</span><span class="n">card</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;oid&#39;</span><span class="p">)</span>
        <span class="n">dependent_desvar</span> <span class="o">=</span> <span class="n">integer</span><span class="p">(</span><span class="n">card</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;dependent_desvar&#39;</span><span class="p">)</span>
        <span class="n">c0</span> <span class="o">=</span> <span class="n">double_or_blank</span><span class="p">(</span><span class="n">card</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="s1">&#39;c0&#39;</span><span class="p">,</span> <span class="mf">0.</span><span class="p">)</span>
        <span class="n">cmult</span> <span class="o">=</span> <span class="n">double_or_blank</span><span class="p">(</span><span class="n">card</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="s1">&#39;cmult&#39;</span><span class="p">,</span> <span class="mf">1.</span><span class="p">)</span>

        <span class="n">nfields</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">card</span><span class="p">)</span> <span class="o">-</span> <span class="mi">4</span>
        <span class="n">n</span> <span class="o">=</span> <span class="n">nfields</span> <span class="o">//</span> <span class="mi">2</span>
        <span class="n">independent_desvars</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">coeffs</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
            <span class="n">j</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">5</span>
            <span class="n">desvar</span> <span class="o">=</span> <span class="n">integer</span><span class="p">(</span><span class="n">card</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="s1">&#39;independent_desvar_</span><span class="si">%i</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">i</span><span class="p">)</span>
            <span class="n">coeff</span> <span class="o">=</span> <span class="n">double</span><span class="p">(</span><span class="n">card</span><span class="p">,</span> <span class="n">j</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;coeff_</span><span class="si">%i</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">i</span><span class="p">)</span>
            <span class="n">independent_desvars</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">desvar</span><span class="p">)</span>
            <span class="n">coeffs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">coeff</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">DLINK</span><span class="p">(</span><span class="n">oid</span><span class="p">,</span> <span class="n">dependent_desvar</span><span class="p">,</span> <span class="n">independent_desvars</span><span class="p">,</span> <span class="n">coeffs</span><span class="p">,</span>
                     <span class="n">c0</span><span class="o">=</span><span class="n">c0</span><span class="p">,</span> <span class="n">cmult</span><span class="o">=</span><span class="n">cmult</span><span class="p">,</span> <span class="n">comment</span><span class="o">=</span><span class="n">comment</span><span class="p">)</span></div>

<div class="viewcode-block" id="DLINK.raw_fields"><a class="viewcode-back" href="../../../../reference/bdf/cards/pyNastran.bdf.cards.optimization.html#pyNastran.bdf.cards.optimization.DLINK.raw_fields">[docs]</a>    <span class="k">def</span> <span class="nf">raw_fields</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">list_fields</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;DLINK&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">oid</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">dependent_desvar</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">c0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">cmult</span><span class="p">]</span>
        <span class="k">for</span> <span class="p">(</span><span class="n">idv</span><span class="p">,</span> <span class="n">coeff</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">independent_desvars</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">coeffs</span><span class="p">):</span>
            <span class="n">list_fields</span> <span class="o">+=</span> <span class="p">[</span><span class="n">idv</span><span class="p">,</span> <span class="n">coeff</span><span class="p">]</span>
        <span class="k">return</span> <span class="n">list_fields</span></div>

<div class="viewcode-block" id="DLINK.repr_fields"><a class="viewcode-back" href="../../../../reference/bdf/cards/pyNastran.bdf.cards.optimization.html#pyNastran.bdf.cards.optimization.DLINK.repr_fields">[docs]</a>    <span class="k">def</span> <span class="nf">repr_fields</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">c0</span> <span class="o">=</span> <span class="n">set_blank_if_default</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">c0</span><span class="p">,</span> <span class="mf">0.</span><span class="p">)</span>
        <span class="n">cmult</span> <span class="o">=</span> <span class="n">set_blank_if_default</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">cmult</span><span class="p">,</span> <span class="mf">1.</span><span class="p">)</span>
        <span class="n">list_fields</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;DLINK&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">oid</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">dependent_desvar</span><span class="p">,</span> <span class="n">c0</span><span class="p">,</span> <span class="n">cmult</span><span class="p">]</span>
        <span class="k">for</span> <span class="p">(</span><span class="n">idv</span><span class="p">,</span> <span class="n">ci</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">independent_desvars</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">coeffs</span><span class="p">):</span>
            <span class="n">list_fields</span> <span class="o">+=</span> <span class="p">[</span><span class="n">idv</span><span class="p">,</span> <span class="n">ci</span><span class="p">]</span>
        <span class="k">return</span> <span class="n">list_fields</span></div>

<div class="viewcode-block" id="DLINK.write_card"><a class="viewcode-back" href="../../../../reference/bdf/cards/pyNastran.bdf.cards.optimization.html#pyNastran.bdf.cards.optimization.DLINK.write_card">[docs]</a>    <span class="k">def</span> <span class="nf">write_card</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">size</span><span class="p">:</span> <span class="nb">int</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span> <span class="n">is_double</span><span class="p">:</span> <span class="nb">bool</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="n">card</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">repr_fields</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">size</span> <span class="o">==</span> <span class="mi">8</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">comment</span> <span class="o">+</span> <span class="n">print_card_8</span><span class="p">(</span><span class="n">card</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">is_double</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">comment</span> <span class="o">+</span> <span class="n">print_card_double</span><span class="p">(</span><span class="n">card</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">comment</span> <span class="o">+</span> <span class="n">print_card_16</span><span class="p">(</span><span class="n">card</span><span class="p">)</span></div></div>


<div class="viewcode-block" id="validate_dresp1"><a class="viewcode-back" href="../../../../reference/bdf/cards/pyNastran.bdf.cards.optimization.html#pyNastran.bdf.cards.optimization.validate_dresp1">[docs]</a><span class="k">def</span> <span class="nf">validate_dresp1</span><span class="p">(</span><span class="n">property_type</span><span class="p">,</span> <span class="n">response_type</span><span class="p">,</span> <span class="n">atta</span><span class="p">,</span> <span class="n">attb</span><span class="p">,</span> <span class="n">atti</span><span class="p">):</span>
    <span class="n">property_types</span> <span class="o">=</span> <span class="p">[</span>
        <span class="s1">&#39;ELEM&#39;</span><span class="p">,</span>
        <span class="c1">#&#39;PELAS&#39;,</span>
        <span class="s1">&#39;PROD&#39;</span><span class="p">,</span>
        <span class="c1"># &#39;PTUBE&#39;,</span>
        <span class="s1">&#39;PBAR&#39;</span><span class="p">,</span> <span class="s1">&#39;PBARL&#39;</span><span class="p">,</span>
        <span class="s1">&#39;PBEAM&#39;</span><span class="p">,</span> <span class="c1">#&#39;PBEAML&#39;,</span>
        <span class="c1">#&#39;PSHEAR&#39;,</span>
        <span class="s1">&#39;PSHELL&#39;</span><span class="p">,</span> <span class="s1">&#39;PCOMP&#39;</span><span class="p">,</span>
        <span class="c1">#&#39;PSOLID&#39;,</span>
        <span class="c1">#&#39;PKNL&#39;,</span>
        <span class="kc">None</span><span class="p">,</span>
    <span class="p">]</span>
    <span class="c1">#stress_types = [&#39;PBARL&#39;]</span>

    <span class="n">unused_response_types</span> <span class="o">=</span> <span class="p">[</span>
        <span class="c1">#&#39;WEIGHT&#39;, &#39;VOLUME&#39;,</span>

        <span class="c1"># static</span>
        <span class="c1">#&#39;DISP&#39;, &#39;STRESS&#39;, &#39;COMP&#39;, &#39;SPCFORCE&#39;, &#39;ESE&#39;, &#39;GPFORCP&#39;,</span>

        <span class="c1"># aero</span>
        <span class="c1">#&#39;FLUTTER&#39;, &#39;STABDER&#39;, &#39;TRIM&#39;, &#39;DIVERG&#39;,</span>

        <span class="c1"># ???</span>
        <span class="c1">#&#39;CEIG&#39;, &#39;CSTRAT&#39;,</span>

        <span class="c1"># modal</span>
        <span class="c1">#&#39;EIGN&#39;, &#39;LAMA&#39;,</span>

        <span class="c1"># time</span>
        <span class="c1">#&#39;TDISP&#39;, &#39;TVELO&#39;, &#39;TACCL&#39;, &#39;TFORC&#39;, &#39;TSPCF&#39;,</span>

        <span class="c1"># frequency</span>
        <span class="c1">#&#39;FREQ&#39;,</span>
        <span class="c1">#&#39;FRDISP&#39;, &#39;FRVELO&#39;, &#39;FRACCL&#39;,</span>
        <span class="c1">#&#39;FRSPCF&#39;, &#39;FRMASS&#39;, &#39;FRFORC&#39;, &#39;FRSTRE&#39;,</span>

        <span class="c1"># random</span>
        <span class="c1">#&#39;PSDDISP&#39;, &#39;PSDACCL&#39;,</span>
        <span class="c1">#&#39;RMSDISP&#39;, &#39;RMSVELO&#39;, &#39;RMSACCL&#39;,</span>

        <span class="c1">#&#39;CFAILURE&#39;, &#39;TOTSE&#39;,</span>
    <span class="p">]</span>
    <span class="n">msg</span> <span class="o">=</span> <span class="s1">&#39;DRESP1 ptype=</span><span class="si">%s</span><span class="s1"> rtype=</span><span class="si">%s</span><span class="s1"> atta=</span><span class="si">%s</span><span class="s1"> attb=</span><span class="si">%s</span><span class="s1"> atti=</span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span>
        <span class="n">property_type</span><span class="p">,</span> <span class="n">response_type</span><span class="p">,</span> <span class="n">atta</span><span class="p">,</span> <span class="n">attb</span><span class="p">,</span> <span class="n">atti</span><span class="p">)</span>
    <span class="c1">#print(msg)</span>
    <span class="k">if</span> <span class="n">property_type</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">property_types</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">property_type</span> <span class="o">==</span> <span class="s1">&#39;ELEM&#39;</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">response_type</span> <span class="o">==</span> <span class="s1">&#39;CFAILURE&#39;</span><span class="p">:</span>
                <span class="k">pass</span>
            <span class="k">elif</span> <span class="n">response_type</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;STRESS&#39;</span><span class="p">,</span> <span class="s1">&#39;STRAIN&#39;</span><span class="p">]:</span>
                <span class="k">pass</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
        <span class="c1">#elif property_type is stress_properties:</span>
            <span class="c1">#raise RuntimeError(msg)</span>
        <span class="c1">#else:</span>
            <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">response_type</span> <span class="o">==</span> <span class="s1">&#39;FLUTTER&#39;</span><span class="p">:</span>
        <span class="k">assert</span> <span class="n">property_type</span> <span class="ow">in</span> <span class="p">[</span><span class="kc">None</span><span class="p">,</span> <span class="s1">&#39;PKNL&#39;</span><span class="p">],</span> <span class="n">msg</span>
        <span class="k">assert</span> <span class="n">atta</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">,</span> <span class="n">msg</span>
        <span class="k">assert</span> <span class="n">attb</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">,</span> <span class="n">msg</span>
        <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">atti</span><span class="p">)</span> <span class="o">==</span> <span class="mi">4</span><span class="p">,</span> <span class="n">msg</span>
    <span class="k">elif</span> <span class="n">property_type</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">atta</span><span class="p">,</span> <span class="n">atti</span> <span class="o">=</span> <span class="n">_validate_dresp_property_none</span><span class="p">(</span><span class="n">property_type</span><span class="p">,</span> <span class="n">response_type</span><span class="p">,</span> <span class="n">atta</span><span class="p">,</span> <span class="n">attb</span><span class="p">,</span> <span class="n">atti</span><span class="p">)</span>

    <span class="k">elif</span> <span class="n">response_type</span> <span class="o">==</span> <span class="s1">&#39;CFAILURE&#39;</span><span class="p">:</span>
        <span class="c1"># attb is the lamina number</span>
        <span class="k">if</span> <span class="n">attb</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">attb</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="n">msg</span> <span class="o">=</span> <span class="s1">&#39;DRESP1 ptype=</span><span class="si">%s</span><span class="s1"> rtype=</span><span class="si">%s</span><span class="s1"> atta=</span><span class="si">%s</span><span class="s1"> attb=</span><span class="si">%s</span><span class="s1"> atti=</span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span>
            <span class="n">property_type</span><span class="p">,</span> <span class="n">response_type</span><span class="p">,</span> <span class="n">atta</span><span class="p">,</span> <span class="n">attb</span><span class="p">,</span> <span class="n">atti</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">property_type</span> <span class="o">==</span> <span class="s1">&#39;ELEM&#39;</span><span class="p">:</span>
            <span class="k">assert</span> <span class="n">atta</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">5</span><span class="p">,</span> <span class="mi">7</span><span class="p">],</span> <span class="n">msg</span>
        <span class="k">elif</span> <span class="n">property_type</span> <span class="o">==</span> <span class="s1">&#39;PCOMP&#39;</span><span class="p">:</span>
            <span class="k">assert</span> <span class="n">atta</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">],</span> <span class="n">msg</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>

        <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">attb</span><span class="p">,</span> <span class="n">integer_types</span><span class="p">),</span> <span class="n">msg</span>
        <span class="k">assert</span> <span class="n">attb</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">,</span> <span class="n">msg</span>
        <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">atti</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">,</span> <span class="n">msg</span>
    <span class="k">elif</span> <span class="n">response_type</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;CSTRAIN&#39;</span><span class="p">,</span> <span class="s1">&#39;CSTRESS&#39;</span><span class="p">]:</span>
        <span class="c1"># attb is the lamina number</span>
        <span class="k">if</span> <span class="n">attb</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">attb</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="n">msg</span> <span class="o">=</span> <span class="s1">&#39;DRESP1 ptype=</span><span class="si">%s</span><span class="s1"> rtype=</span><span class="si">%s</span><span class="s1"> atta=</span><span class="si">%s</span><span class="s1"> attb=</span><span class="si">%s</span><span class="s1"> atti=</span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span>
            <span class="n">property_type</span><span class="p">,</span> <span class="n">response_type</span><span class="p">,</span> <span class="n">atta</span><span class="p">,</span> <span class="n">attb</span><span class="p">,</span> <span class="n">atti</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">property_type</span> <span class="o">==</span> <span class="s1">&#39;PCOMP&#39;</span><span class="p">:</span>
            <span class="c1"># 11 - max shear stress/strain</span>
            <span class="k">assert</span> <span class="n">atta</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">11</span><span class="p">],</span> <span class="n">msg</span>
            <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">atti</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">,</span> <span class="n">msg</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
        <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">attb</span><span class="p">,</span> <span class="n">integer_types</span><span class="p">),</span> <span class="n">msg</span>
        <span class="k">assert</span> <span class="n">attb</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">,</span> <span class="n">msg</span>
        <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">atti</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">,</span> <span class="n">msg</span>

    <span class="k">elif</span> <span class="n">response_type</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;STRESS&#39;</span><span class="p">,</span> <span class="s1">&#39;STRAIN&#39;</span><span class="p">]:</span>
        <span class="n">_validate_dresp1_stress_strain</span><span class="p">(</span><span class="n">property_type</span><span class="p">,</span> <span class="n">response_type</span><span class="p">,</span> <span class="n">atta</span><span class="p">,</span> <span class="n">attb</span><span class="p">,</span> <span class="n">atti</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">response_type</span> <span class="o">==</span> <span class="s1">&#39;FORCE&#39;</span><span class="p">:</span>
        <span class="n">_validate_dresp1_force</span><span class="p">(</span><span class="n">property_type</span><span class="p">,</span> <span class="n">response_type</span><span class="p">,</span> <span class="n">atta</span><span class="p">,</span> <span class="n">attb</span><span class="p">,</span> <span class="n">atti</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">response_type</span> <span class="o">==</span> <span class="s1">&#39;ELEM&#39;</span><span class="p">:</span>
        <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">atti</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">,</span> <span class="n">msg</span>
        <span class="k">for</span> <span class="n">eid</span> <span class="ow">in</span> <span class="n">atti</span><span class="p">:</span>
            <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">eid</span><span class="p">,</span> <span class="nb">int</span><span class="p">),</span> <span class="n">msg</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">msg</span> <span class="o">=</span> <span class="s1">&#39;DRESP1 ptype=</span><span class="si">%s</span><span class="s1"> rtype=</span><span class="si">%s</span><span class="s1"> atta=</span><span class="si">%s</span><span class="s1"> attb=</span><span class="si">%s</span><span class="s1"> atti=</span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span>
            <span class="n">property_type</span><span class="p">,</span> <span class="n">response_type</span><span class="p">,</span> <span class="n">atta</span><span class="p">,</span> <span class="n">attb</span><span class="p">,</span> <span class="n">atti</span><span class="p">)</span>
        <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">atta</span><span class="p">,</span> <span class="n">attb</span><span class="p">,</span> <span class="n">atti</span></div>

<div class="viewcode-block" id="_blank_or_mode"><a class="viewcode-back" href="../../../../reference/bdf/cards/pyNastran.bdf.cards.optimization.html#pyNastran.bdf.cards.optimization._blank_or_mode">[docs]</a><span class="k">def</span> <span class="nf">_blank_or_mode</span><span class="p">(</span><span class="n">attb</span><span class="p">,</span> <span class="n">msg</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;if it&#39;s blank, it&#39;s a static result, otherwise it&#39;s a mode id&quot;&quot;&quot;</span>
    <span class="k">assert</span> <span class="n">attb</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">attb</span><span class="p">,</span> <span class="n">integer_types</span><span class="p">),</span> <span class="n">msg</span></div>

<div class="viewcode-block" id="_validate_dresp_property_none"><a class="viewcode-back" href="../../../../reference/bdf/cards/pyNastran.bdf.cards.optimization.html#pyNastran.bdf.cards.optimization._validate_dresp_property_none">[docs]</a><span class="k">def</span> <span class="nf">_validate_dresp_property_none</span><span class="p">(</span><span class="n">property_type</span><span class="p">,</span> <span class="n">response_type</span><span class="p">,</span> <span class="n">atta</span><span class="p">,</span> <span class="n">attb</span><span class="p">,</span> <span class="n">atti</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;helper for ``validate_dresp``&quot;&quot;&quot;</span>
    <span class="n">msg</span> <span class="o">=</span> <span class="s1">&#39;DRESP1 ptype=</span><span class="si">%s</span><span class="s1"> rtype=</span><span class="si">%s</span><span class="s1"> atta=</span><span class="si">%s</span><span class="s1"> attb=</span><span class="si">%s</span><span class="s1"> atti=</span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span>
        <span class="n">property_type</span><span class="p">,</span> <span class="n">response_type</span><span class="p">,</span> <span class="n">atta</span><span class="p">,</span> <span class="n">attb</span><span class="p">,</span> <span class="n">atti</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">response_type</span> <span class="o">==</span> <span class="s1">&#39;WEIGHT&#39;</span><span class="p">:</span>
        <span class="k">assert</span> <span class="n">atta</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="kc">None</span><span class="p">],</span> <span class="n">msg</span>
        <span class="k">assert</span> <span class="n">attb</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="kc">None</span><span class="p">],</span> <span class="n">msg</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">atti</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">atti</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;ALL&#39;</span><span class="p">]</span>
        <span class="k">for</span> <span class="n">attii</span> <span class="ow">in</span> <span class="n">atti</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">attii</span> <span class="o">!=</span> <span class="s1">&#39;ALL&#39;</span><span class="p">:</span>
                <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">attii</span><span class="p">,</span> <span class="n">integer_types</span><span class="p">),</span> <span class="n">msg</span>
                <span class="k">assert</span> <span class="n">attii</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">msg</span>

    <span class="k">elif</span> <span class="n">response_type</span> <span class="o">==</span> <span class="s1">&#39;VOLUME&#39;</span><span class="p">:</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">atti</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">atti</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;ALL&#39;</span><span class="p">]</span>
        <span class="n">msg</span> <span class="o">=</span> <span class="s1">&#39;DRESP1 ptype=</span><span class="si">%s</span><span class="s1"> rtype=</span><span class="si">%s</span><span class="s1"> atta=</span><span class="si">%s</span><span class="s1"> attb=</span><span class="si">%s</span><span class="s1"> atti=</span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span>
            <span class="n">property_type</span><span class="p">,</span> <span class="n">response_type</span><span class="p">,</span> <span class="n">atta</span><span class="p">,</span> <span class="n">attb</span><span class="p">,</span> <span class="n">atti</span><span class="p">)</span>
        <span class="k">assert</span> <span class="n">atta</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">,</span> <span class="n">msg</span>
        <span class="k">assert</span> <span class="n">attb</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">,</span> <span class="n">msg</span>
        <span class="k">for</span> <span class="n">attii</span> <span class="ow">in</span> <span class="n">atti</span><span class="p">:</span>
            <span class="k">assert</span> <span class="n">attii</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;ALL&#39;</span><span class="p">],</span> <span class="n">msg</span>

    <span class="k">elif</span> <span class="n">response_type</span> <span class="o">==</span> <span class="s1">&#39;DISP&#39;</span><span class="p">:</span>
        <span class="n">atta</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">atta</span><span class="p">)</span>
        <span class="n">msg</span> <span class="o">=</span> <span class="s1">&#39;DRESP1 ptype=</span><span class="si">%s</span><span class="s1"> rtype=</span><span class="si">%s</span><span class="s1"> atta=</span><span class="si">%s</span><span class="s1"> attb=</span><span class="si">%s</span><span class="s1"> atti=</span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span>
            <span class="n">property_type</span><span class="p">,</span> <span class="n">response_type</span><span class="p">,</span> <span class="n">atta</span><span class="p">,</span> <span class="n">attb</span><span class="p">,</span> <span class="n">atti</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">attai</span> <span class="ow">in</span> <span class="n">atta</span><span class="p">:</span>
            <span class="k">assert</span> <span class="n">atta</span> <span class="ow">in</span> <span class="s1">&#39;123456&#39;</span><span class="p">,</span> <span class="n">msg</span>  <span class="c1"># 8???</span>
        <span class="n">_blank_or_mode</span><span class="p">(</span><span class="n">attb</span><span class="p">,</span> <span class="n">msg</span><span class="p">)</span>
        <span class="c1">#assert len(atti) == 1, msg</span>

    <span class="k">elif</span> <span class="n">response_type</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;FRDISP&#39;</span><span class="p">,</span> <span class="s1">&#39;FRVELO&#39;</span><span class="p">,</span> <span class="s1">&#39;FRACCL&#39;</span><span class="p">,</span> <span class="s1">&#39;FRSPCF&#39;</span><span class="p">]:</span>  <span class="c1"># frequency displacement</span>
        <span class="k">assert</span> <span class="n">atta</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">9</span><span class="p">],</span> <span class="n">msg</span>

        <span class="k">if</span> <span class="n">attb</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">attb</span><span class="p">,</span> <span class="n">float_types</span><span class="p">):</span>
            <span class="c1"># blank is all frequencies</span>
            <span class="c1"># float is a specific frequency</span>
            <span class="k">pass</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">assert</span> <span class="n">attb</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;SUM&#39;</span><span class="p">,</span> <span class="s1">&#39;AVG&#39;</span><span class="p">,</span> <span class="s1">&#39;SSQ&#39;</span><span class="p">,</span> <span class="s1">&#39;RSS&#39;</span><span class="p">,</span> <span class="s1">&#39;MAX&#39;</span><span class="p">,</span> <span class="s1">&#39;MIN&#39;</span><span class="p">,</span> <span class="s1">&#39;AVE&#39;</span><span class="p">],</span> <span class="n">msg</span>  <span class="c1"># remove AVE?</span>

        <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">atti</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">msg</span>
        <span class="k">for</span> <span class="n">attii</span> <span class="ow">in</span> <span class="n">atti</span><span class="p">:</span>
            <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">attii</span><span class="p">,</span> <span class="n">integer_types</span><span class="p">),</span> <span class="n">msg</span>
            <span class="k">assert</span> <span class="n">attii</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">,</span> <span class="n">msg</span>

    <span class="k">elif</span> <span class="n">response_type</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;TDISP&#39;</span><span class="p">,</span> <span class="s1">&#39;TVELO&#39;</span><span class="p">,</span> <span class="s1">&#39;TACCL&#39;</span><span class="p">,</span> <span class="s1">&#39;TSPCF&#39;</span><span class="p">]:</span>  <span class="c1"># time displacement</span>
        <span class="n">atta</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">atta</span><span class="p">)</span>
        <span class="n">msg</span> <span class="o">=</span> <span class="s1">&#39;DRESP1 ptype=</span><span class="si">%s</span><span class="s1"> rtype=</span><span class="si">%s</span><span class="s1"> atta=</span><span class="si">%s</span><span class="s1"> attb=</span><span class="si">%s</span><span class="s1"> atti=</span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span>
            <span class="n">property_type</span><span class="p">,</span> <span class="n">response_type</span><span class="p">,</span> <span class="n">atta</span><span class="p">,</span> <span class="n">attb</span><span class="p">,</span> <span class="n">atti</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">attai</span> <span class="ow">in</span> <span class="n">atta</span><span class="p">:</span>
            <span class="k">assert</span> <span class="n">atta</span> <span class="ow">in</span> <span class="s1">&#39;123456&#39;</span><span class="p">,</span> <span class="n">msg</span>  <span class="c1"># 8???</span>

        <span class="k">if</span> <span class="n">attb</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">attb</span><span class="p">,</span> <span class="n">float_types</span><span class="p">):</span>
            <span class="c1"># blank is all times</span>
            <span class="c1"># float is a specific times</span>
            <span class="k">pass</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">assert</span> <span class="n">attb</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;SUM&#39;</span><span class="p">,</span> <span class="s1">&#39;AVG&#39;</span><span class="p">,</span> <span class="s1">&#39;SSQ&#39;</span><span class="p">,</span> <span class="s1">&#39;RSS&#39;</span><span class="p">,</span> <span class="s1">&#39;MAX&#39;</span><span class="p">,</span> <span class="s1">&#39;MIN&#39;</span><span class="p">],</span> <span class="n">msg</span>

        <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">atti</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">msg</span>
        <span class="k">for</span> <span class="n">attii</span> <span class="ow">in</span> <span class="n">atti</span><span class="p">:</span>
            <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">attii</span><span class="p">,</span> <span class="n">integer_types</span><span class="p">),</span> <span class="n">msg</span>
            <span class="k">assert</span> <span class="n">attii</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">,</span> <span class="n">msg</span>

    <span class="k">elif</span> <span class="n">response_type</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;RMSDISP&#39;</span><span class="p">,</span> <span class="s1">&#39;RMSACCL&#39;</span><span class="p">]:</span>
        <span class="k">assert</span> <span class="n">atta</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="n">msg</span>
        <span class="k">assert</span> <span class="n">attb</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">140</span><span class="p">,</span> <span class="mi">1000</span><span class="p">],</span> <span class="n">msg</span>
        <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">atti</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">,</span> <span class="n">msg</span>

    <span class="k">elif</span> <span class="n">response_type</span> <span class="o">==</span> <span class="s1">&#39;CEIG&#39;</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">attb</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">attb</span> <span class="o">=</span> <span class="s1">&#39;ALPHA&#39;</span>
        <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">atta</span><span class="p">,</span> <span class="n">integer_types</span><span class="p">),</span> <span class="n">msg</span>
        <span class="k">assert</span> <span class="n">atta</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">,</span> <span class="n">msg</span>
        <span class="k">assert</span> <span class="n">attb</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;ALPHA&#39;</span><span class="p">,</span> <span class="s1">&#39;OMEGA&#39;</span><span class="p">],</span> <span class="n">msg</span>
        <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">atti</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">,</span> <span class="n">msg</span>

    <span class="k">elif</span> <span class="n">response_type</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;EIGN&#39;</span><span class="p">,</span> <span class="s1">&#39;LAMA&#39;</span><span class="p">]:</span> <span class="c1"># EIGEN as well?</span>
        <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">atta</span><span class="p">,</span> <span class="n">integer_types</span><span class="p">),</span> <span class="n">msg</span>
        <span class="k">assert</span> <span class="n">atta</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">,</span> <span class="n">msg</span>
        <span class="c1"># LAMA:</span>
        <span class="c1">#   blank/1 -&gt; direct linerization (default)</span>
        <span class="c1">#   2 -&gt; inverse linearization</span>
        <span class="c1"># EIGN:</span>
        <span class="c1">#   blank -&gt; Rayleigh Quotient Approximation (default)</span>
        <span class="c1">#   1 -&gt; direct linerization</span>
        <span class="c1">#   2 -&gt; inverse approximation</span>
        <span class="k">assert</span> <span class="n">attb</span> <span class="ow">in</span> <span class="p">[</span><span class="kc">None</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="n">msg</span>
        <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">atti</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">,</span> <span class="n">msg</span>
    <span class="k">elif</span> <span class="n">response_type</span> <span class="o">==</span> <span class="s1">&#39;FREQ&#39;</span><span class="p">:</span>
        <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">atta</span><span class="p">,</span> <span class="n">integer_types</span><span class="p">),</span> <span class="n">msg</span>
        <span class="k">assert</span> <span class="n">atta</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">,</span> <span class="n">msg</span>
        <span class="c1"># EIGN:</span>
        <span class="c1">#   blank -&gt; Rayleigh Quotient Approximation (default)</span>
        <span class="c1">#   1 -&gt; direct linerization</span>
        <span class="c1">#   2 -&gt; inverse approximation</span>
        <span class="k">assert</span> <span class="n">attb</span> <span class="ow">in</span> <span class="p">[</span><span class="kc">None</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="n">msg</span>
        <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">atti</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">,</span> <span class="n">msg</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">atta</span><span class="p">,</span> <span class="n">atti</span></div>

<div class="viewcode-block" id="_validate_dresp1_stress_strain"><a class="viewcode-back" href="../../../../reference/bdf/cards/pyNastran.bdf.cards.optimization.html#pyNastran.bdf.cards.optimization._validate_dresp1_stress_strain">[docs]</a><span class="k">def</span> <span class="nf">_validate_dresp1_stress_strain</span><span class="p">(</span><span class="n">property_type</span><span class="p">,</span> <span class="n">response_type</span><span class="p">,</span> <span class="n">atta</span><span class="p">,</span> <span class="n">attb</span><span class="p">,</span> <span class="n">atti</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;helper for ``validate_dresp``&quot;&quot;&quot;</span>
    <span class="n">msg</span> <span class="o">=</span> <span class="s1">&#39;DRESP1 ptype=</span><span class="si">%s</span><span class="s1"> rtype=</span><span class="si">%s</span><span class="s1"> atta=</span><span class="si">%s</span><span class="s1"> attb=</span><span class="si">%s</span><span class="s1"> atti=</span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span>
        <span class="n">property_type</span><span class="p">,</span> <span class="n">response_type</span><span class="p">,</span> <span class="n">atta</span><span class="p">,</span> <span class="n">attb</span><span class="p">,</span> <span class="n">atti</span><span class="p">)</span>

    <span class="n">_blank_or_mode</span><span class="p">(</span><span class="n">attb</span><span class="p">,</span> <span class="n">msg</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">property_type</span> <span class="o">==</span> <span class="s1">&#39;ELEM&#39;</span><span class="p">:</span>
        <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">atta</span><span class="p">,</span> <span class="nb">int</span><span class="p">),</span> <span class="n">msg</span>
    <span class="k">elif</span> <span class="n">property_type</span> <span class="o">==</span> <span class="s1">&#39;PBARL&#39;</span><span class="p">:</span>
        <span class="k">assert</span> <span class="n">atta</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">8</span><span class="p">],</span> <span class="n">msg</span>
    <span class="k">elif</span> <span class="n">property_type</span> <span class="o">==</span> <span class="s1">&#39;PBAR&#39;</span><span class="p">:</span>
        <span class="k">assert</span> <span class="n">atta</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">14</span><span class="p">,</span> <span class="mi">15</span><span class="p">],</span> <span class="n">msg</span>
    <span class="k">elif</span> <span class="n">property_type</span> <span class="o">==</span> <span class="s1">&#39;PBEAM&#39;</span><span class="p">:</span>
        <span class="k">assert</span> <span class="n">atta</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">6</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">31</span><span class="p">,</span> <span class="mi">59</span><span class="p">,</span> <span class="mi">108</span><span class="p">],</span> <span class="n">msg</span>
    <span class="k">elif</span> <span class="n">property_type</span> <span class="o">==</span> <span class="s1">&#39;PROD&#39;</span><span class="p">:</span>
        <span class="k">assert</span> <span class="n">atta</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">7</span><span class="p">],</span> <span class="n">msg</span>

    <span class="k">elif</span> <span class="n">property_type</span> <span class="o">==</span> <span class="s1">&#39;PSHELL&#39;</span><span class="p">:</span>
        <span class="k">assert</span> <span class="n">atta</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="mi">16</span><span class="p">,</span> <span class="mi">17</span><span class="p">,</span> <span class="mi">19</span><span class="p">,</span> <span class="mi">26</span><span class="p">,</span> <span class="mi">28</span><span class="p">,</span> <span class="mi">35</span><span class="p">,</span> <span class="mi">36</span><span class="p">],</span> <span class="n">msg</span>
    <span class="k">elif</span> <span class="n">property_type</span> <span class="o">==</span> <span class="s1">&#39;PCOMP&#39;</span><span class="p">:</span>
        <span class="c1"># this is a SMEAR PCOMP, which is basically a PSHELL</span>
        <span class="k">assert</span> <span class="n">atta</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">9</span><span class="p">,</span> <span class="mi">11</span><span class="p">,</span> <span class="mi">17</span><span class="p">],</span> <span class="n">msg</span>
    <span class="c1">#elif property_type in stress_types:</span>
        <span class="c1">#if not isinstance(atta, integer_types):</span>
            <span class="c1">#msg = &#39;DRESP1 ptype=%s rtype=%s atta=%s attb=%s atti=%s; atta should be an integer&#39; % (</span>
                <span class="c1">#property_type, response_type, atta, attb, atti)</span>
            <span class="c1">#raise TypeError(msg)</span>
        <span class="c1">#assert attb is None, &#39;DRESP1 ptype=%s rtype=%s atta=%s attb=%s atti=%s&#39; % (</span>
            <span class="c1">#property_type, response_type, atta, attb, atti)</span>
    <span class="c1">#elif property_type == &#39;PSOLID&#39;:</span>

    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;property_type=</span><span class="si">{</span><span class="n">property_type</span><span class="si">}</span><span class="s1"> is not supported</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">+</span> <span class="n">msg</span><span class="p">)</span>

    <span class="k">assert</span> <span class="n">attb</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">,</span> <span class="s1">&#39;</span><span class="si">%s</span><span class="s1">; atta should be an integer&#39;</span> <span class="o">%</span> <span class="n">msg</span>
    <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">atti</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">,</span> <span class="n">msg</span></div>

<div class="viewcode-block" id="_validate_dresp1_force"><a class="viewcode-back" href="../../../../reference/bdf/cards/pyNastran.bdf.cards.optimization.html#pyNastran.bdf.cards.optimization._validate_dresp1_force">[docs]</a><span class="k">def</span> <span class="nf">_validate_dresp1_force</span><span class="p">(</span><span class="n">property_type</span><span class="p">,</span> <span class="n">response_type</span><span class="p">,</span> <span class="n">atta</span><span class="p">,</span> <span class="n">attb</span><span class="p">,</span> <span class="n">atti</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;helper for ``validate_dresp``&quot;&quot;&quot;</span>
    <span class="n">msg</span> <span class="o">=</span> <span class="s1">&#39;DRESP1 ptype=</span><span class="si">%s</span><span class="s1"> rtype=</span><span class="si">%s</span><span class="s1"> atta=</span><span class="si">%s</span><span class="s1"> attb=</span><span class="si">%s</span><span class="s1"> atti=</span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span>
        <span class="n">property_type</span><span class="p">,</span> <span class="n">response_type</span><span class="p">,</span> <span class="n">atta</span><span class="p">,</span> <span class="n">attb</span><span class="p">,</span> <span class="n">atti</span><span class="p">)</span>
    <span class="n">_blank_or_mode</span><span class="p">(</span><span class="n">attb</span><span class="p">,</span> <span class="n">msg</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">property_type</span> <span class="o">==</span> <span class="s1">&#39;PROD&#39;</span><span class="p">:</span>
        <span class="k">assert</span> <span class="n">atta</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">msg</span>
    <span class="k">elif</span> <span class="n">response_type</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;FRSTRE&#39;</span><span class="p">]:</span>
        <span class="k">if</span> <span class="n">property_type</span> <span class="o">==</span> <span class="s1">&#39;PROD&#39;</span><span class="p">:</span>
            <span class="k">assert</span> <span class="n">atta</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">4</span><span class="p">],</span> <span class="n">msg</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
        <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">atti</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">,</span> <span class="n">msg</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
    <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">atti</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">,</span> <span class="n">msg</span></div>


<span class="n">DRESP_PROPERTIES</span> <span class="o">=</span> <span class="p">[</span>
    <span class="s1">&#39;PSHELL&#39;</span><span class="p">,</span> <span class="s1">&#39;PBAR&#39;</span><span class="p">,</span> <span class="s1">&#39;PROD&#39;</span><span class="p">,</span> <span class="s1">&#39;PCOMP&#39;</span><span class="p">,</span> <span class="s1">&#39;PCOMPG&#39;</span><span class="p">,</span>
    <span class="s1">&#39;PSOLID&#39;</span><span class="p">,</span> <span class="s1">&#39;PELAS&#39;</span><span class="p">,</span> <span class="s1">&#39;PBARL&#39;</span><span class="p">,</span> <span class="s1">&#39;PBEAM&#39;</span><span class="p">,</span>
    <span class="s1">&#39;PBEAML&#39;</span><span class="p">,</span> <span class="s1">&#39;PSHEAR&#39;</span><span class="p">,</span> <span class="s1">&#39;PTUBE&#39;</span><span class="p">,</span> <span class="s1">&#39;PBMSECT&#39;</span><span class="p">]</span>

<div class="viewcode-block" id="DRESP1"><a class="viewcode-back" href="../../../../reference/bdf/cards/pyNastran.bdf.cards.optimization.html#pyNastran.bdf.cards.optimization.DRESP1">[docs]</a><span class="k">class</span> <span class="nc">DRESP1</span><span class="p">(</span><span class="n">OptConstraint</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    +--------+-------+---------+---------+--------+--------+-------+------+-------+</span>
<span class="sd">    |   1    |  2    |    3    |    4    |   5    |   6    |   7   |   8  |   9   |</span>
<span class="sd">    +========+=======+=========+=========+========+========+=======+======+=======+</span>
<span class="sd">    | DRESP1 |  OID  | LABEL   | RTYPE   | PTYPE  | REGION | ATTA  | ATTB | ATTI  |</span>
<span class="sd">    +--------+-------+---------+---------+--------+--------+-------+------+-------+</span>
<span class="sd">    | DRESP1 |  103  | STRESS2 |  STRESS | PSHELL |        |   9   |      |   3   |</span>
<span class="sd">    +--------+-------+---------+---------+--------+--------+-------+------+-------+</span>
<span class="sd">    | DRESP1 |  1S1  | CSTRAN3 | CSTRAIN |  PCOMP |        |   1   |  1   | 10000 |</span>
<span class="sd">    +--------+-------+---------+---------+--------+--------+-------+------+-------+</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="nb">type</span> <span class="o">=</span> <span class="s1">&#39;DRESP1&#39;</span>

    <span class="c1">#@classmethod</span>
    <span class="c1">#def _init_from_empty(cls):</span>
        <span class="c1">#dresp_id = 103</span>
        <span class="c1">#label = &#39;resp1&#39;</span>
        <span class="c1">#response_type = &#39;STRESS&#39;</span>
        <span class="c1">#property_type = &#39;PSHELL&#39;</span>
        <span class="c1">#pid = 3</span>
        <span class="c1">#atta = 9 # von mises upper surface stress</span>
        <span class="c1">#region = None</span>
        <span class="c1">#attb = None</span>
        <span class="c1">#atti = [pid]</span>
        <span class="c1">#return DRESP1(dresp_id, label, response_type, property_type,</span>
                      <span class="c1">#region, atta, attb, atti, comment=&#39;&#39;, validate=False)</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dresp_id</span><span class="p">,</span> <span class="n">label</span><span class="p">,</span> <span class="n">response_type</span><span class="p">,</span> <span class="n">property_type</span><span class="p">,</span> <span class="n">region</span><span class="p">,</span>
                 <span class="n">atta</span><span class="p">,</span> <span class="n">attb</span><span class="p">,</span> <span class="n">atti</span><span class="p">,</span> <span class="n">comment</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">validate</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Creates a DRESP1 card.</span>

<span class="sd">        A DRESP1 is used to define a &quot;simple&quot; output result that may be</span>
<span class="sd">        optimized on.  A simple result is a result like stress, strain,</span>
<span class="sd">        force, displacement, eigenvalue, etc. for a node/element that</span>
<span class="sd">        may be found in a non-optimization case.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        dresp_id : int</span>
<span class="sd">            response id</span>
<span class="sd">        lable : str</span>
<span class="sd">            Name of the response</span>
<span class="sd">        response_type : str</span>
<span class="sd">            Response type</span>
<span class="sd">        property_type : str</span>
<span class="sd">            Element flag (PTYPE = &#39;ELEM&#39;), or property entry name, or panel</span>
<span class="sd">            flag for ERP responses (PTYPE = &#39;PANEL&#39; - See Remark 34), or</span>
<span class="sd">            RANDPS ID. Blank for grid point responses. &#39;ELEM&#39; or property</span>
<span class="sd">            name used only with element type responses (stress, strain,</span>
<span class="sd">            force, etc.) to identify the relevant element IDs, or the property</span>
<span class="sd">            type and relevant property IDs.</span>

<span class="sd">            Must be {ELEM, PBAR, PSHELL, PCOMP, PANEL, etc.)</span>
<span class="sd">            PTYPE = RANDPS ID when RTYPE=PSDDISP, PSDVELO, or PSDACCL.</span>
<span class="sd">        region : int</span>
<span class="sd">            Region identifier for constraint screening</span>
<span class="sd">        atta : int / float / str / blank</span>
<span class="sd">            Response attribute</span>
<span class="sd">        attb : int / float / str / blank</span>
<span class="sd">            Response attribute</span>
<span class="sd">        atti : List[int / float / str]</span>
<span class="sd">            the response values to pull from</span>
<span class="sd">            List[int]:</span>
<span class="sd">                list of grid ids</span>
<span class="sd">                list of property ids</span>
<span class="sd">            List[str]</span>
<span class="sd">                &#39;ALL&#39;</span>
<span class="sd">        comment : str; default=&#39;&#39;</span>
<span class="sd">            a comment for the card</span>
<span class="sd">        validate : bool; default=False</span>
<span class="sd">            should the card be validated when it&#39;s created</span>

<span class="sd">        Examples</span>
<span class="sd">        --------</span>
<span class="sd">        **stress/PSHELL**</span>

<span class="sd">        &gt;&gt;&gt; dresp_id = 103</span>
<span class="sd">        &gt;&gt;&gt; label = &#39;resp1&#39;</span>
<span class="sd">        &gt;&gt;&gt; response_type = &#39;STRESS&#39;</span>
<span class="sd">        &gt;&gt;&gt; property_type = &#39;PSHELL&#39;</span>
<span class="sd">        &gt;&gt;&gt; pid = 3</span>
<span class="sd">        &gt;&gt;&gt; atta = 9 # von mises upper surface stress</span>
<span class="sd">        &gt;&gt;&gt; region = None</span>
<span class="sd">        &gt;&gt;&gt; attb = None</span>
<span class="sd">        &gt;&gt;&gt; atti = [pid]</span>
<span class="sd">        &gt;&gt;&gt; DRESP1(dresp_id, label, response_type, property_type, region, atta, attb, atti)</span>


<span class="sd">        **stress/PCOMP**</span>

<span class="sd">        &gt;&gt;&gt; dresp_id = 104</span>
<span class="sd">        &gt;&gt;&gt; label = &#39;resp2&#39;</span>
<span class="sd">        &gt;&gt;&gt; response_type = &#39;STRESS&#39;</span>
<span class="sd">        &gt;&gt;&gt; property_type = &#39;PCOMP&#39;</span>
<span class="sd">        &gt;&gt;&gt; pid = 3</span>
<span class="sd">        &gt;&gt;&gt; layer = 4</span>
<span class="sd">        &gt;&gt;&gt; atta = 9 # von mises upper surface stress</span>
<span class="sd">        &gt;&gt;&gt; region = None</span>
<span class="sd">        &gt;&gt;&gt; attb = layer</span>
<span class="sd">        &gt;&gt;&gt; atti = [pid]</span>
<span class="sd">        &gt;&gt;&gt; DRESP1(dresp_id, label, response_type, property_type, region, atta, attb, atti)</span>


<span class="sd">        **displacement - not done**</span>

<span class="sd">        &gt;&gt;&gt; dresp_id = 105</span>
<span class="sd">        &gt;&gt;&gt; label = &#39;resp3&#39;</span>
<span class="sd">        &gt;&gt;&gt; response_type = &#39;DISP&#39;</span>
<span class="sd">        &gt;&gt;&gt; #atta = ???</span>
<span class="sd">        &gt;&gt;&gt; #region = ???</span>
<span class="sd">        &gt;&gt;&gt; #attb = ???</span>
<span class="sd">        &gt;&gt;&gt; atti = [nid]</span>
<span class="sd">        &gt;&gt;&gt; DRESP1(dresp_id, label, response_type, property_type, region, atta, attb, atti)</span>


<span class="sd">        **not done**</span>
<span class="sd">        &gt;&gt;&gt; dresp_id = 105</span>
<span class="sd">        &gt;&gt;&gt; label = &#39;resp3&#39;</span>
<span class="sd">        &gt;&gt;&gt; response_type = &#39;ELEM&#39;</span>
<span class="sd">        &gt;&gt;&gt; #atta = ???</span>
<span class="sd">        &gt;&gt;&gt; #region = ???</span>
<span class="sd">        &gt;&gt;&gt; #attb = ???</span>
<span class="sd">        &gt;&gt;&gt; atti = [eid???]</span>
<span class="sd">        &gt;&gt;&gt; DRESP1(dresp_id, label, response_type, property_type, region, atta, attb, atti)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">OptConstraint</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">comment</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">comment</span> <span class="o">=</span> <span class="n">comment</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dresp_id</span> <span class="o">=</span> <span class="n">dresp_id</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">label</span> <span class="o">=</span> <span class="n">label</span>

        <span class="c1"># DISP, VONMISES, 14</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">response_type</span> <span class="o">=</span> <span class="n">response_type</span>

        <span class="c1"># PSHELL, PCOMP, PBAR, etc.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">property_type</span> <span class="o">=</span> <span class="n">property_type</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">region</span> <span class="o">=</span> <span class="n">region</span>
        <span class="k">if</span> <span class="n">atti</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">atti</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">atti</span><span class="p">,</span> <span class="n">integer_types</span><span class="p">):</span>
            <span class="n">atti</span> <span class="o">=</span> <span class="p">[</span><span class="n">atti</span><span class="p">]</span>
        <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">atti</span><span class="p">,</span> <span class="nb">list</span><span class="p">),</span> <span class="s1">&#39;atti=</span><span class="si">%s</span><span class="s1"> type=</span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">atti</span><span class="p">,</span> <span class="nb">type</span><span class="p">(</span><span class="n">atti</span><span class="p">))</span>

        <span class="k">if</span> <span class="n">validate</span><span class="p">:</span>
            <span class="n">atta</span><span class="p">,</span> <span class="n">attb</span><span class="p">,</span> <span class="n">atti</span> <span class="o">=</span> <span class="n">validate_dresp1</span><span class="p">(</span><span class="n">property_type</span><span class="p">,</span> <span class="n">response_type</span><span class="p">,</span> <span class="n">atta</span><span class="p">,</span> <span class="n">attb</span><span class="p">,</span> <span class="n">atti</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">atta</span> <span class="o">=</span> <span class="n">atta</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">attb</span> <span class="o">=</span> <span class="n">attb</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">atti</span> <span class="o">=</span> <span class="n">atti</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">atta_ref</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">atti_ref</span> <span class="o">=</span> <span class="kc">None</span>

<div class="viewcode-block" id="DRESP1.export_to_hdf5"><a class="viewcode-back" href="../../../../reference/bdf/cards/pyNastran.bdf.cards.optimization.html#pyNastran.bdf.cards.optimization.DRESP1.export_to_hdf5">[docs]</a>    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">export_to_hdf5</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">h5_file</span><span class="p">,</span> <span class="n">model</span><span class="p">,</span> <span class="n">encoding</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;exports the dresps in a vectorized way&quot;&quot;&quot;</span>
        <span class="n">_export_dresps_to_hdf5</span><span class="p">(</span><span class="n">h5_file</span><span class="p">,</span> <span class="n">model</span><span class="p">,</span> <span class="n">encoding</span><span class="p">)</span></div>

<div class="viewcode-block" id="DRESP1.object_attributes"><a class="viewcode-back" href="../../../../reference/bdf/cards/pyNastran.bdf.cards.optimization.html#pyNastran.bdf.cards.optimization.DRESP1.object_attributes">[docs]</a>    <span class="k">def</span> <span class="nf">object_attributes</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;public&#39;</span><span class="p">,</span> <span class="n">keys_to_skip</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                          <span class="n">filter_properties</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;.. seealso:: `pyNastran.utils.object_attributes(...)`&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">keys_to_skip</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">keys_to_skip</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="n">my_keys_to_skip</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;rtype&#39;</span><span class="p">,</span> <span class="s1">&#39;ptype&#39;</span><span class="p">]</span>
        <span class="k">return</span> <span class="nb">super</span><span class="p">(</span><span class="n">DRESP1</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">object_attributes</span><span class="p">(</span>
            <span class="n">mode</span><span class="o">=</span><span class="n">mode</span><span class="p">,</span> <span class="n">keys_to_skip</span><span class="o">=</span><span class="n">keys_to_skip</span><span class="o">+</span><span class="n">my_keys_to_skip</span><span class="p">,</span>
            <span class="n">filter_properties</span><span class="o">=</span><span class="n">filter_properties</span><span class="p">)</span></div>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">rtype</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">response_type</span>

    <span class="nd">@rtype</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">rtype</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">response_type</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">response_type</span> <span class="o">=</span> <span class="n">response_type</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">ptype</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">property_type</span>

    <span class="nd">@ptype</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">ptype</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">property_type</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">property_type</span> <span class="o">=</span> <span class="n">property_type</span>

<div class="viewcode-block" id="DRESP1.add_card"><a class="viewcode-back" href="../../../../reference/bdf/cards/pyNastran.bdf.cards.optimization.html#pyNastran.bdf.cards.optimization.DRESP1.add_card">[docs]</a>    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">add_card</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">card</span><span class="p">,</span> <span class="n">comment</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Adds a DRESP1 card from ``BDF.add_card(...)``</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        card : BDFCard()</span>
<span class="sd">            a BDFCard object</span>
<span class="sd">        comment : str; default=&#39;&#39;</span>
<span class="sd">            a comment for the card</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">oid</span> <span class="o">=</span> <span class="n">integer</span><span class="p">(</span><span class="n">card</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;oid&#39;</span><span class="p">)</span>
        <span class="n">label</span> <span class="o">=</span> <span class="n">string</span><span class="p">(</span><span class="n">card</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;label&#39;</span><span class="p">)</span>
        <span class="n">response_type</span> <span class="o">=</span> <span class="n">string</span><span class="p">(</span><span class="n">card</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="s1">&#39;rtype&#39;</span><span class="p">)</span>

        <span class="c1"># elem, pbar, pshell, etc. (ELEM flag or Prop Name)</span>
        <span class="n">property_type</span> <span class="o">=</span> <span class="n">integer_string_or_blank</span><span class="p">(</span><span class="n">card</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="s1">&#39;ptype&#39;</span><span class="p">)</span>
        <span class="n">region</span> <span class="o">=</span> <span class="n">integer_or_blank</span><span class="p">(</span><span class="n">card</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="s1">&#39;region&#39;</span><span class="p">)</span>
        <span class="n">atta</span> <span class="o">=</span> <span class="n">integer_double_string_or_blank</span><span class="p">(</span><span class="n">card</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="s1">&#39;atta&#39;</span><span class="p">)</span>
        <span class="n">attb</span> <span class="o">=</span> <span class="n">integer_double_string_or_blank</span><span class="p">(</span><span class="n">card</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="s1">&#39;attb&#39;</span><span class="p">)</span>

        <span class="n">atti</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">card</span><span class="p">)):</span>
            <span class="n">attii</span> <span class="o">=</span> <span class="n">integer_double_string_or_blank</span><span class="p">(</span><span class="n">card</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="s1">&#39;atti_</span><span class="si">%i</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))</span>
            <span class="n">atti</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">attii</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">DRESP1</span><span class="p">(</span><span class="n">oid</span><span class="p">,</span> <span class="n">label</span><span class="p">,</span> <span class="n">response_type</span><span class="p">,</span> <span class="n">property_type</span><span class="p">,</span> <span class="n">region</span><span class="p">,</span> <span class="n">atta</span><span class="p">,</span> <span class="n">attb</span><span class="p">,</span> <span class="n">atti</span><span class="p">,</span>
                      <span class="n">comment</span><span class="o">=</span><span class="n">comment</span><span class="p">,</span> <span class="n">validate</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></div>

    <span class="k">def</span> <span class="nf">_verify</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">model</span><span class="p">:</span> <span class="n">BDF</span><span class="p">,</span> <span class="n">xref</span><span class="p">):</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">xref</span><span class="p">:</span>
            <span class="k">return</span>
        <span class="n">node_types</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;DISP&#39;</span><span class="p">,</span> <span class="s1">&#39;FRDISP&#39;</span><span class="p">,</span> <span class="s1">&#39;PSDDISP&#39;</span><span class="p">,</span> <span class="s1">&#39;RMSDISP&#39;</span><span class="p">,</span> <span class="s1">&#39;TDISP&#39;</span><span class="p">,</span> <span class="c1"># &#39;RFDISP&#39;,</span>
            <span class="s1">&#39;FRVELO&#39;</span><span class="p">,</span> <span class="s1">&#39;RMSVELO&#39;</span><span class="p">,</span> <span class="s1">&#39;PSDVELO&#39;</span><span class="p">,</span> <span class="s1">&#39;TVELO&#39;</span><span class="p">,</span>
            <span class="s1">&#39;FRACCL&#39;</span><span class="p">,</span> <span class="s1">&#39;RMSACCL&#39;</span><span class="p">,</span> <span class="s1">&#39;PSDACCL&#39;</span><span class="p">,</span> <span class="s1">&#39;TACCL&#39;</span><span class="p">,</span>
            <span class="s1">&#39;FRSPCF&#39;</span><span class="p">,</span>
            <span class="s1">&#39;SPCFORCE&#39;</span><span class="p">,</span> <span class="s1">&#39;TSPCF&#39;</span><span class="p">,</span>
        <span class="p">}</span>
        <span class="n">no_validate</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;FRMASS&#39;</span><span class="p">,</span> <span class="s1">&#39;WEIGHT&#39;</span><span class="p">,</span> <span class="s1">&#39;EIGN&#39;</span><span class="p">,</span> <span class="s1">&#39;LAMA&#39;</span><span class="p">,</span> <span class="s1">&#39;VOLUME&#39;</span><span class="p">,</span> <span class="s1">&#39;FREQ&#39;</span><span class="p">,</span> <span class="s1">&#39;ERP&#39;</span><span class="p">,</span>
            <span class="s1">&#39;FLUTTER&#39;</span><span class="p">,</span> <span class="s1">&#39;CFAILURE&#39;</span><span class="p">,</span> <span class="s1">&#39;CSTRAT&#39;</span><span class="p">,</span> <span class="s1">&#39;CEIG&#39;</span><span class="p">,</span> <span class="s1">&#39;DIVERG&#39;</span><span class="p">,</span> <span class="s1">&#39;STABDER&#39;</span><span class="p">,</span> <span class="s1">&#39;TRIM&#39;</span><span class="p">,</span>
            <span class="s1">&#39;ESE&#39;</span><span class="p">,</span> <span class="s1">&#39;TOTSE&#39;</span><span class="p">,</span>
            <span class="s1">&#39;GPFORCE&#39;</span><span class="p">,</span> <span class="s1">&#39;GPFORCP&#39;</span><span class="p">,}</span>
        <span class="n">not_implemented</span> <span class="o">=</span> <span class="n">no_validate</span>
        <span class="n">no_validate</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">not_implemented</span><span class="p">)</span>
        <span class="n">no_validate</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">node_types</span><span class="p">)</span>

        <span class="n">elem_props</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;STRESS&#39;</span><span class="p">,</span> <span class="s1">&#39;TSTRE&#39;</span><span class="p">,</span> <span class="s1">&#39;FRSTRE&#39;</span><span class="p">,</span> <span class="s1">&#39;CSTRESS&#39;</span><span class="p">,</span>
                      <span class="s1">&#39;STRAIN&#39;</span><span class="p">,</span> <span class="s1">&#39;CSTRAIN&#39;</span><span class="p">,</span>
                      <span class="s1">&#39;FORCE&#39;</span><span class="p">,</span> <span class="s1">&#39;TFORC&#39;</span><span class="p">,</span> <span class="s1">&#39;FRFORC&#39;</span><span class="p">,</span>
                      <span class="p">}</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">response_type</span> <span class="ow">in</span> <span class="n">no_validate</span><span class="p">:</span>
            <span class="k">return</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">response_type</span> <span class="ow">in</span> <span class="n">elem_props</span><span class="p">:</span>
            <span class="n">property_type</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">property_type</span>
            <span class="c1">#if property_type is None:</span>
                <span class="c1">#continue</span>
            <span class="n">_dresp_verify_eids</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">model</span><span class="p">,</span> <span class="n">property_type</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get_stats</span><span class="p">())</span>
            <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">response_type</span><span class="p">)</span>

<div class="viewcode-block" id="DRESP1.calculate"><a class="viewcode-back" href="../../../../reference/bdf/cards/pyNastran.bdf.cards.optimization.html#pyNastran.bdf.cards.optimization.DRESP1.calculate">[docs]</a>    <span class="k">def</span> <span class="nf">calculate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">op2_model</span><span class="p">,</span> <span class="n">subcase_id</span><span class="p">):</span>
        <span class="n">rtype</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">rtype</span>
        <span class="n">property_type</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">property_type</span>
        <span class="k">if</span> <span class="n">rtype</span> <span class="o">==</span> <span class="s1">&#39;DISP&#39;</span> <span class="ow">and</span> <span class="n">property_type</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">msg</span> <span class="o">=</span> <span class="s1">&#39;fields=</span><span class="si">%s</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">raw_fields</span><span class="p">())</span>
            <span class="n">msg</span> <span class="o">+=</span> <span class="s1">&#39;rtype=</span><span class="si">%r</span><span class="s1"> ptype=</span><span class="si">%r</span><span class="s1"> region=</span><span class="si">%s</span><span class="s1"> A=</span><span class="si">%r</span><span class="s1"> B=</span><span class="si">%r</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">rtype</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">property_type</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">region</span><span class="p">,</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">atta</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">attb</span><span class="p">)</span>
            <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">atta</span><span class="p">,</span> <span class="n">integer_types</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">atta</span>
            <span class="k">assert</span> <span class="bp">self</span><span class="o">.</span><span class="n">attb</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">attb</span>
            <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">atti</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">atti</span>
            <span class="c1">#msg += str(self)</span>
            <span class="c1">#raise NotImplementedError(msg)</span>
            <span class="n">comp</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">atta</span>
            <span class="k">assert</span> <span class="n">comp</span> <span class="o">&lt;</span> <span class="mi">7</span><span class="p">,</span> <span class="n">comp</span>
            <span class="n">case</span> <span class="o">=</span> <span class="n">op2_model</span><span class="o">.</span><span class="n">displacements</span><span class="p">[</span><span class="n">subcase_id</span><span class="p">]</span>
            <span class="n">nids</span> <span class="o">=</span> <span class="n">case</span><span class="o">.</span><span class="n">node_gridtype</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]</span>
            <span class="n">nidsi</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span>
                <span class="p">[</span><span class="n">node</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">node</span><span class="p">,</span> <span class="n">integer_types</span><span class="p">)</span> <span class="k">else</span> <span class="n">node</span><span class="o">.</span><span class="n">nid</span>
                 <span class="k">for</span> <span class="n">node</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">atti</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="s1">&#39;int32&#39;</span><span class="p">)</span>
            <span class="n">inid</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">searchsorted</span><span class="p">(</span><span class="n">nids</span><span class="p">,</span> <span class="n">nidsi</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">itime</span> <span class="o">=</span> <span class="mi">0</span> <span class="c1">#  TODO:  ???</span>
            <span class="c1">#print(&#39;atti = &#39;, self.atti)</span>
            <span class="n">unused_atti</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">atti</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">out</span> <span class="o">=</span> <span class="n">case</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">itime</span><span class="p">,</span> <span class="n">inid</span><span class="p">,</span> <span class="n">comp</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span>
            <span class="c1">#print(&#39; DISP[itime=%s, nid=%s, comp=%i] = %s&#39; % (itime, str(nidsi), comp, out))</span>
        <span class="k">elif</span> <span class="n">property_type</span> <span class="o">==</span> <span class="s1">&#39;ELEM&#39;</span> <span class="ow">and</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">pass</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">msg</span> <span class="o">=</span> <span class="s1">&#39;fields=</span><span class="si">%s</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">raw_fields</span><span class="p">())</span>
            <span class="n">msg</span> <span class="o">+=</span> <span class="s1">&#39;response_type=</span><span class="si">%r</span><span class="s1"> property_type=</span><span class="si">%r</span><span class="s1"> region=</span><span class="si">%s</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">response_type</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">property_type</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">region</span><span class="p">)</span>
            <span class="n">msg</span> <span class="o">+=</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
            <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">out</span></div>

<div class="viewcode-block" id="DRESP1.OptID"><a class="viewcode-back" href="../../../../reference/bdf/cards/pyNastran.bdf.cards.optimization.html#pyNastran.bdf.cards.optimization.DRESP1.OptID">[docs]</a>    <span class="k">def</span> <span class="nf">OptID</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">DRespID</span><span class="p">()</span></div>

<div class="viewcode-block" id="DRESP1.DRespID"><a class="viewcode-back" href="../../../../reference/bdf/cards/pyNastran.bdf.cards.optimization.html#pyNastran.bdf.cards.optimization.DRESP1.DRespID">[docs]</a>    <span class="k">def</span> <span class="nf">DRespID</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">dresp_id</span></div>

<div class="viewcode-block" id="DRESP1.cross_reference"><a class="viewcode-back" href="../../../../reference/bdf/cards/pyNastran.bdf.cards.optimization.html#pyNastran.bdf.cards.optimization.DRESP1.cross_reference">[docs]</a>    <span class="k">def</span> <span class="nf">cross_reference</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">model</span><span class="p">:</span> <span class="n">BDF</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Cross links the card so referenced cards can be extracted directly</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        model : BDF()</span>
<span class="sd">            the BDF object</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">msg</span> <span class="o">=</span> <span class="s1">&#39;, which is required by DRESP1 dresp_id=</span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dresp_id</span><span class="p">)</span>
        <span class="n">msg</span> <span class="o">+=</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>

        <span class="n">op2_results</span> <span class="o">=</span> <span class="p">[</span>
            <span class="s1">&#39;VOLUME&#39;</span><span class="p">,</span> <span class="s1">&#39;LAMA&#39;</span><span class="p">,</span> <span class="s1">&#39;FRSPCF&#39;</span><span class="p">,</span> <span class="s1">&#39;TRIM&#39;</span><span class="p">,</span> <span class="s1">&#39;ESE&#39;</span><span class="p">,</span> <span class="s1">&#39;SPCFORCE&#39;</span><span class="p">,</span> <span class="s1">&#39;FRMASS&#39;</span><span class="p">,</span>
            <span class="s1">&#39;CFAILURE&#39;</span><span class="p">,</span> <span class="s1">&#39;CSTRAT&#39;</span><span class="p">,</span> <span class="s1">&#39;STRESS&#39;</span><span class="p">,</span> <span class="s1">&#39;DIVERG&#39;</span><span class="p">,</span> <span class="s1">&#39;TOTSE&#39;</span><span class="p">,</span> <span class="s1">&#39;COMP&#39;</span><span class="p">,</span>
            <span class="s1">&#39;TACCL&#39;</span><span class="p">,</span> <span class="s1">&#39;RMSACCL&#39;</span><span class="p">,</span>
            <span class="s1">&#39;RMSVELO&#39;</span><span class="p">,</span>
            <span class="s1">&#39;PSDDISP&#39;</span><span class="p">,</span> <span class="s1">&#39;RMSDISP&#39;</span><span class="p">,</span>
            <span class="s1">&#39;TFORC&#39;</span><span class="p">,</span> <span class="s1">&#39;FRFORC&#39;</span><span class="p">,</span>
            <span class="s1">&#39;TSPCF&#39;</span><span class="p">,</span>
        <span class="p">]</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">property_type</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;ELEM&#39;</span><span class="p">]:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">atti_ref</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">Elements</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">atti</span><span class="p">,</span> <span class="n">msg</span><span class="o">=</span><span class="n">msg</span><span class="p">)</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">property_type</span> <span class="ow">in</span> <span class="n">DRESP_PROPERTIES</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">atti_ref</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">Properties</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">atti</span><span class="p">,</span> <span class="n">msg</span><span class="o">=</span><span class="n">msg</span><span class="p">)</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">response_type</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;FRSTRE&#39;</span><span class="p">]:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">atti_ref</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">Properties</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">atti</span><span class="p">,</span> <span class="n">msg</span><span class="o">=</span><span class="n">msg</span><span class="p">)</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">response_type</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;WEIGHT&#39;</span><span class="p">,</span> <span class="s1">&#39;STABDER&#39;</span><span class="p">,</span> <span class="s1">&#39;CEIG&#39;</span><span class="p">,</span> <span class="s1">&#39;EIGN&#39;</span><span class="p">,</span> <span class="s1">&#39;FREQ&#39;</span><span class="p">]:</span>
            <span class="k">pass</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">response_type</span> <span class="o">==</span> <span class="s1">&#39;FLUTTER&#39;</span><span class="p">:</span>
            <span class="c1"># TODO: SOL-200; add check that FLFACT values exist in the FLFACT card</span>
            <span class="c1">#       referenced by the FLUTTER card for the given subcase</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">property_type</span> <span class="o">==</span> <span class="s1">&#39;PKNL&#39;</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">atti_ref</span> <span class="o">=</span> <span class="p">[</span>
                    <span class="n">model</span><span class="o">.</span><span class="n">Set</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">atti</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">msg</span><span class="o">=</span><span class="n">msg</span><span class="p">),</span>
                    <span class="n">model</span><span class="o">.</span><span class="n">FLFACT</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">atti</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">msg</span><span class="o">=</span><span class="n">msg</span><span class="p">),</span>
                    <span class="n">model</span><span class="o">.</span><span class="n">FLFACT</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">atti</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">msg</span><span class="o">=</span><span class="n">msg</span><span class="p">),</span>
                    <span class="n">model</span><span class="o">.</span><span class="n">FLFACT</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">atti</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span> <span class="n">msg</span><span class="o">=</span><span class="n">msg</span><span class="p">),</span>
                <span class="p">]</span>
                <span class="c1">#msgi = &#39;max density=%s mach=%s velocity=%s&#39; % (</span>
                    <span class="c1">#self.atti[1].max(), self.atti[2].max(), self.atti[3].max())</span>
                <span class="c1">#print(msgi)</span>
            <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">property_type</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">pass</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">msg</span> <span class="o">=</span> <span class="s1">&#39;PropertyType=</span><span class="si">%r</span><span class="s1"> is not supported</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">property_type</span>
                <span class="n">msg</span> <span class="o">+=</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
                <span class="nb">print</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">response_type</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;DISP&#39;</span><span class="p">,</span>
                                    <span class="s1">&#39;TDISP&#39;</span><span class="p">,</span>
                                    <span class="s1">&#39;TVELO&#39;</span><span class="p">,</span>
                                    <span class="s1">&#39;FRDISP&#39;</span><span class="p">,</span> <span class="s1">&#39;FRVELO&#39;</span><span class="p">,</span> <span class="s1">&#39;FRACCL&#39;</span><span class="p">,</span>
                                    <span class="s1">&#39;PSDVELO&#39;</span><span class="p">,</span> <span class="s1">&#39;PSDACCL&#39;</span><span class="p">]:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">atti_ref</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">Nodes</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">atti</span><span class="p">,</span> <span class="n">msg</span><span class="o">=</span><span class="n">msg</span><span class="p">)</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">response_type</span> <span class="ow">in</span> <span class="n">op2_results</span><span class="p">:</span>
            <span class="k">pass</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">response_type</span> <span class="o">==</span> <span class="s1">&#39;ERP&#39;</span><span class="p">:</span>
            <span class="k">assert</span> <span class="bp">self</span><span class="o">.</span><span class="n">property_type</span> <span class="o">==</span> <span class="s1">&#39;PANEL&#39;</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">response_type</span> <span class="o">==</span> <span class="s1">&#39;GPFORCP&#39;</span><span class="p">:</span>
            <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">atti</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;atti=</span><span class="si">%r</span><span class="se">\n</span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">atti</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">atta_ref</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">Node</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">atta</span><span class="p">,</span> <span class="n">msg</span><span class="o">=</span><span class="n">msg</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">atti_ref</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">Nodes</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">atti</span><span class="p">,</span> <span class="n">msg</span><span class="o">=</span><span class="n">msg</span><span class="p">)</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">response_type</span> <span class="o">==</span> <span class="s1">&#39;GPFORCE&#39;</span><span class="p">:</span>
            <span class="c1">#self.atta = component</span>
            <span class="n">eids</span> <span class="o">=</span> <span class="p">[</span><span class="n">eid</span> <span class="k">for</span> <span class="n">eid</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">atti</span> <span class="k">if</span> <span class="n">eid</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">atti_ref</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">Elements</span><span class="p">(</span><span class="n">eids</span><span class="p">,</span> <span class="n">msg</span><span class="o">=</span><span class="n">msg</span><span class="p">)</span>
        <span class="k">elif</span>  <span class="bp">self</span><span class="o">.</span><span class="n">response_type</span> <span class="o">==</span> <span class="s1">&#39;ABSTRESS&#39;</span><span class="p">:</span>
            <span class="c1"># atta - Arbitrary Beam Stress Item Code</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">atti_ref</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">Properties</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">atti</span><span class="p">,</span> <span class="n">msg</span><span class="o">=</span><span class="n">msg</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">msg</span> <span class="o">=</span> <span class="s1">&#39;response_type=</span><span class="si">%r</span><span class="s1"> ptype=</span><span class="si">%r</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">response_type</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">property_type</span><span class="p">)</span>
            <span class="n">msg</span> <span class="o">+=</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
            <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span></div>

<div class="viewcode-block" id="DRESP1.safe_cross_reference"><a class="viewcode-back" href="../../../../reference/bdf/cards/pyNastran.bdf.cards.optimization.html#pyNastran.bdf.cards.optimization.DRESP1.safe_cross_reference">[docs]</a>    <span class="k">def</span> <span class="nf">safe_cross_reference</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">model</span><span class="p">,</span> <span class="n">xref_errors</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Cross links the card so referenced cards can be extracted directly</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        model : BDF()</span>
<span class="sd">            the BDF object</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">msg</span> <span class="o">=</span> <span class="s1">&#39;, which is required by DRESP1 dresp_id=</span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dresp_id</span><span class="p">)</span>
        <span class="n">msg</span> <span class="o">+=</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>

        <span class="n">op2_results</span> <span class="o">=</span> <span class="p">[</span>
            <span class="s1">&#39;VOLUME&#39;</span><span class="p">,</span> <span class="s1">&#39;LAMA&#39;</span><span class="p">,</span> <span class="s1">&#39;FRSPCF&#39;</span><span class="p">,</span> <span class="s1">&#39;TRIM&#39;</span><span class="p">,</span> <span class="s1">&#39;ESE&#39;</span><span class="p">,</span> <span class="s1">&#39;SPCFORCE&#39;</span><span class="p">,</span> <span class="s1">&#39;FRMASS&#39;</span><span class="p">,</span>
            <span class="s1">&#39;CFAILURE&#39;</span><span class="p">,</span> <span class="s1">&#39;CSTRAT&#39;</span><span class="p">,</span> <span class="s1">&#39;STRESS&#39;</span><span class="p">,</span> <span class="s1">&#39;DIVERG&#39;</span><span class="p">,</span> <span class="s1">&#39;TOTSE&#39;</span><span class="p">,</span> <span class="s1">&#39;COMP&#39;</span><span class="p">,</span>
            <span class="s1">&#39;TACCL&#39;</span><span class="p">,</span> <span class="s1">&#39;RMSACCL&#39;</span><span class="p">,</span>
            <span class="s1">&#39;RMSVELO&#39;</span><span class="p">,</span>
            <span class="s1">&#39;PSDDISP&#39;</span><span class="p">,</span> <span class="s1">&#39;RMSDISP&#39;</span><span class="p">,</span>
            <span class="s1">&#39;TFORC&#39;</span><span class="p">,</span> <span class="s1">&#39;FRFORC&#39;</span><span class="p">,</span>
            <span class="s1">&#39;TSPCF&#39;</span><span class="p">,</span>
        <span class="p">]</span>
        <span class="n">ref_id</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dresp_id</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">property_type</span> <span class="o">==</span> <span class="s1">&#39;ELEM&#39;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">atti_ref</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">safe_elements</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">atti</span><span class="p">,</span> <span class="n">ref_id</span><span class="p">,</span> <span class="n">xref_errors</span><span class="p">,</span> <span class="n">msg</span><span class="o">=</span><span class="n">msg</span><span class="p">)</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">property_type</span> <span class="ow">in</span> <span class="n">DRESP_PROPERTIES</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">atti_ref</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">Properties</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">atti</span><span class="p">,</span> <span class="n">msg</span><span class="o">=</span><span class="n">msg</span><span class="p">)</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">response_type</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;FRSTRE&#39;</span><span class="p">]:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">atti_ref</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">Properties</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">atti</span><span class="p">,</span> <span class="n">msg</span><span class="o">=</span><span class="n">msg</span><span class="p">)</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">response_type</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;WEIGHT&#39;</span><span class="p">,</span> <span class="s1">&#39;STABDER&#39;</span><span class="p">,</span> <span class="s1">&#39;CEIG&#39;</span><span class="p">,</span> <span class="s1">&#39;EIGN&#39;</span><span class="p">,</span> <span class="s1">&#39;FREQ&#39;</span><span class="p">]:</span>
            <span class="k">pass</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">response_type</span> <span class="o">==</span> <span class="s1">&#39;FLUTTER&#39;</span><span class="p">:</span>
            <span class="c1"># TODO: SOL-200; add check that FLFACT values exist in the FLFACT card</span>
            <span class="c1">#       referenced by the FLUTTER card for the given subcase</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">property_type</span> <span class="o">==</span> <span class="s1">&#39;PKNL&#39;</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">atti_ref</span> <span class="o">=</span> <span class="p">[</span>
                    <span class="n">model</span><span class="o">.</span><span class="n">Set</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">atti</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">msg</span><span class="o">=</span><span class="n">msg</span><span class="p">),</span>
                    <span class="n">model</span><span class="o">.</span><span class="n">FLFACT</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">atti</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">msg</span><span class="o">=</span><span class="n">msg</span><span class="p">),</span>
                    <span class="n">model</span><span class="o">.</span><span class="n">FLFACT</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">atti</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">msg</span><span class="o">=</span><span class="n">msg</span><span class="p">),</span>
                    <span class="n">model</span><span class="o">.</span><span class="n">FLFACT</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">atti</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span> <span class="n">msg</span><span class="o">=</span><span class="n">msg</span><span class="p">),</span>
                <span class="p">]</span>
                <span class="c1">#msgi = &#39;max density=%s mach=%s velocity=%s&#39; % (</span>
                    <span class="c1">#self.atti[1].max(), self.atti[2].max(), self.atti[3].max())</span>
                <span class="c1">#print(msgi)</span>
            <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">property_type</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">pass</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">msg</span> <span class="o">=</span> <span class="s1">&#39;PropertyType=</span><span class="si">%r</span><span class="s1"> is not supported</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">property_type</span>
                <span class="n">msg</span> <span class="o">+=</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
                <span class="nb">print</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">response_type</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;DISP&#39;</span><span class="p">,</span>
                                    <span class="s1">&#39;TDISP&#39;</span><span class="p">,</span>
                                    <span class="s1">&#39;TVELO&#39;</span><span class="p">,</span>
                                    <span class="s1">&#39;FRDISP&#39;</span><span class="p">,</span> <span class="s1">&#39;FRVELO&#39;</span><span class="p">,</span> <span class="s1">&#39;FRACCL&#39;</span><span class="p">,</span>
                                    <span class="s1">&#39;PSDVELO&#39;</span><span class="p">,</span> <span class="s1">&#39;PSDACCL&#39;</span><span class="p">]:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">atti_ref</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">Nodes</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">atti</span><span class="p">,</span> <span class="n">msg</span><span class="o">=</span><span class="n">msg</span><span class="p">)</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">response_type</span> <span class="ow">in</span> <span class="n">op2_results</span><span class="p">:</span>
            <span class="k">pass</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">response_type</span> <span class="o">==</span> <span class="s1">&#39;ERP&#39;</span><span class="p">:</span>
            <span class="k">assert</span> <span class="bp">self</span><span class="o">.</span><span class="n">property_type</span> <span class="o">==</span> <span class="s1">&#39;PANEL&#39;</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">response_type</span> <span class="o">==</span> <span class="s1">&#39;GPFORCP&#39;</span><span class="p">:</span>
            <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">atti</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;atti=</span><span class="si">%r</span><span class="se">\n</span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">atti</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">atta_ref</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">Node</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">atta</span><span class="p">,</span> <span class="n">msg</span><span class="o">=</span><span class="n">msg</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">atti_ref</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">Nodes</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">atti</span><span class="p">,</span> <span class="n">msg</span><span class="o">=</span><span class="n">msg</span><span class="p">)</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">response_type</span> <span class="o">==</span> <span class="s1">&#39;GPFORCE&#39;</span><span class="p">:</span>
            <span class="c1">#self.atta = component</span>
            <span class="n">eids</span> <span class="o">=</span> <span class="p">[</span><span class="n">eid</span> <span class="k">for</span> <span class="n">eid</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">atti</span> <span class="k">if</span> <span class="n">eid</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">atti_ref</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">Elements</span><span class="p">(</span><span class="n">eids</span><span class="p">,</span> <span class="n">msg</span><span class="o">=</span><span class="n">msg</span><span class="p">)</span>
        <span class="k">elif</span>  <span class="bp">self</span><span class="o">.</span><span class="n">response_type</span> <span class="o">==</span> <span class="s1">&#39;ABSTRESS&#39;</span><span class="p">:</span>
            <span class="c1"># atta - Arbitrary Beam Stress Item Code</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">atti_ref</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">Properties</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">atti</span><span class="p">,</span> <span class="n">msg</span><span class="o">=</span><span class="n">msg</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">msg</span> <span class="o">=</span> <span class="s1">&#39;response_type=</span><span class="si">%r</span><span class="s1"> ptype=</span><span class="si">%r</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">response_type</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">property_type</span><span class="p">)</span>
            <span class="n">msg</span> <span class="o">+=</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
            <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span></div>

<div class="viewcode-block" id="DRESP1.uncross_reference"><a class="viewcode-back" href="../../../../reference/bdf/cards/pyNastran.bdf.cards.optimization.html#pyNastran.bdf.cards.optimization.DRESP1.uncross_reference">[docs]</a>    <span class="k">def</span> <span class="nf">uncross_reference</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Removes cross-reference links&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">atti</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">atti_values</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">atta</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">Atta</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">atta_ref</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">atti_ref</span> <span class="o">=</span> <span class="kc">None</span></div>

<div class="viewcode-block" id="DRESP1.Atta"><a class="viewcode-back" href="../../../../reference/bdf/cards/pyNastran.bdf.cards.optimization.html#pyNastran.bdf.cards.optimization.DRESP1.Atta">[docs]</a>    <span class="k">def</span> <span class="nf">Atta</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;returns the values of ATTa&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">response_type</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;GPFORCE&#39;</span><span class="p">,</span> <span class="s1">&#39;GPFORCP&#39;</span><span class="p">]:</span>
            <span class="n">atta</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">atta_ref</span><span class="o">.</span><span class="n">nid</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">atta_ref</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">atta</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">assert</span>  <span class="bp">self</span><span class="o">.</span><span class="n">atta_ref</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_stats</span><span class="p">()</span>
            <span class="n">atta</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">atta</span>
        <span class="k">return</span> <span class="n">atta</span></div>

<div class="viewcode-block" id="DRESP1.atti_values"><a class="viewcode-back" href="../../../../reference/bdf/cards/pyNastran.bdf.cards.optimization.html#pyNastran.bdf.cards.optimization.DRESP1.atti_values">[docs]</a>    <span class="k">def</span> <span class="nf">atti_values</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;returns the values of ATTi&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">atti_ref</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">atti</span>

        <span class="c1">#return self.atti</span>
        <span class="c1">#if self.response_type in [&#39;ELEM&#39;]:</span>
            <span class="c1">#self.atti = model.Elements(self.atti, msg=msg)</span>
            <span class="c1">#pass</span>
        <span class="n">op2_results</span> <span class="o">=</span> <span class="p">[</span>
            <span class="s1">&#39;VOLUME&#39;</span><span class="p">,</span> <span class="s1">&#39;CEIG&#39;</span><span class="p">,</span> <span class="s1">&#39;LAMA&#39;</span><span class="p">,</span> <span class="s1">&#39;FREQ&#39;</span><span class="p">,</span> <span class="s1">&#39;FRSPCF&#39;</span><span class="p">,</span> <span class="s1">&#39;TRIM&#39;</span><span class="p">,</span> <span class="s1">&#39;ESE&#39;</span><span class="p">,</span> <span class="s1">&#39;SPCFORCE&#39;</span><span class="p">,</span> <span class="s1">&#39;FRMASS&#39;</span><span class="p">,</span>
            <span class="s1">&#39;CFAILURE&#39;</span><span class="p">,</span> <span class="s1">&#39;CSTRAT&#39;</span><span class="p">,</span> <span class="s1">&#39;STRESS&#39;</span><span class="p">,</span> <span class="s1">&#39;DIVERG&#39;</span><span class="p">,</span> <span class="s1">&#39;TOTSE&#39;</span><span class="p">,</span> <span class="s1">&#39;COMP&#39;</span><span class="p">,</span>
            <span class="s1">&#39;TACCL&#39;</span><span class="p">,</span> <span class="s1">&#39;RMSACCL&#39;</span><span class="p">,</span>
            <span class="s1">&#39;PSDDISP&#39;</span><span class="p">,</span> <span class="s1">&#39;RMSDISP&#39;</span><span class="p">,</span>
            <span class="s1">&#39;TVELO&#39;</span><span class="p">,</span> <span class="s1">&#39;RMSVELO&#39;</span><span class="p">,</span>
            <span class="s1">&#39;TFORC&#39;</span><span class="p">,</span> <span class="s1">&#39;FRFORC&#39;</span><span class="p">,</span>
            <span class="s1">&#39;TSPCF&#39;</span><span class="p">,</span>
        <span class="p">]</span>
        <span class="c1">#print(&#39;self.atti_ref =&#39;, self.atti_ref)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">property_type</span> <span class="o">==</span> <span class="s1">&#39;ELEM&#39;</span><span class="p">:</span>
            <span class="n">data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_elements</span><span class="p">()</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">property_type</span> <span class="ow">in</span> <span class="n">DRESP_PROPERTIES</span><span class="p">:</span>
            <span class="n">data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_properties</span><span class="p">()</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">response_type</span> <span class="o">==</span> <span class="s1">&#39;FRSTRE&#39;</span><span class="p">:</span>
            <span class="n">data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_properties</span><span class="p">()</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">response_type</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;WEIGHT&#39;</span><span class="p">,</span> <span class="s1">&#39;STABDER&#39;</span><span class="p">,</span> <span class="s1">&#39;EIGN&#39;</span><span class="p">,</span> <span class="s1">&#39;FREQ&#39;</span><span class="p">]:</span>
            <span class="n">data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">atti</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">response_type</span> <span class="o">==</span> <span class="s1">&#39;FLUTTER&#39;</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">property_type</span> <span class="o">==</span> <span class="s1">&#39;PKNL&#39;</span><span class="p">:</span>
                <span class="n">data</span> <span class="o">=</span> <span class="p">[</span><span class="n">atti</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">atti</span><span class="p">,</span> <span class="n">integer_types</span><span class="p">)</span> <span class="k">else</span> <span class="n">atti</span><span class="o">.</span><span class="n">sid</span>
                        <span class="k">for</span> <span class="n">atti</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">atti_ref</span><span class="p">]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">atti</span>
                <span class="c1">#msg = &#39;PropertyType=%r is not supported\n&#39; % self.property_type</span>
                <span class="c1">#msg += str(self)</span>
                <span class="c1">#print(msg)</span>
                <span class="c1">#raise NotImplementedError(msg)</span>

        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">response_type</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;DISP&#39;</span><span class="p">,</span>
                                    <span class="s1">&#39;TDISP&#39;</span><span class="p">,</span> <span class="s1">&#39;TVELO&#39;</span><span class="p">,</span>
                                    <span class="s1">&#39;FRDISP&#39;</span><span class="p">,</span> <span class="s1">&#39;FRVELO&#39;</span><span class="p">,</span> <span class="s1">&#39;FRACCL&#39;</span><span class="p">,</span>
                                    <span class="s1">&#39;PSDVELO&#39;</span><span class="p">,</span> <span class="s1">&#39;PSDACCL&#39;</span><span class="p">]:</span>
            <span class="n">data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_nodes</span><span class="p">()</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">response_type</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;FRFORC&#39;</span><span class="p">,</span> <span class="s1">&#39;TFORC&#39;</span><span class="p">,</span>
                                    <span class="s1">&#39;STRESS&#39;</span><span class="p">,</span> <span class="s1">&#39;STRAIN&#39;</span><span class="p">,</span> <span class="s1">&#39;ESE&#39;</span><span class="p">,</span> <span class="s1">&#39;CFAILURE&#39;</span><span class="p">,</span> <span class="s1">&#39;CSTRAIN&#39;</span><span class="p">]:</span>
            <span class="n">data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_elements</span><span class="p">()</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">response_type</span> <span class="ow">in</span> <span class="n">op2_results</span><span class="p">:</span>
            <span class="n">data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">atti</span>
            <span class="k">for</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">data</span><span class="p">:</span>
                <span class="k">assert</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">BaseCard</span><span class="p">),</span> <span class="s1">&#39;response_type=</span><span class="si">%s</span><span class="s1"> value=</span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">response_type</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">response_type</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;GPFORCP&#39;</span><span class="p">]:</span>
            <span class="c1"># MSC Nastran specific</span>
            <span class="n">data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_nodes</span><span class="p">()</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">response_type</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;GPFORCE&#39;</span><span class="p">]:</span>
            <span class="c1"># MSC</span>
            <span class="n">data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_elements</span><span class="p">()</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">response_type</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;ERP&#39;</span><span class="p">]:</span>
            <span class="n">msg</span> <span class="o">=</span> <span class="s1">&#39;response_type=</span><span class="si">%r</span><span class="s1"> property_type=</span><span class="si">%r</span><span class="s1"> atta=</span><span class="si">%r</span><span class="s1"> attb=</span><span class="si">%r</span><span class="s1"> atti=</span><span class="si">%r</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">response_type</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">property_type</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">atta</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">attb</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">atti</span><span class="p">)</span>
            <span class="k">assert</span> <span class="bp">self</span><span class="o">.</span><span class="n">property_type</span> <span class="o">==</span> <span class="s1">&#39;PANEL&#39;</span><span class="p">,</span> <span class="n">msg</span>
            <span class="c1"># atta=None attb=3000.0 atti=[555]</span>
            <span class="n">data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">atti</span>
        <span class="k">elif</span>  <span class="bp">self</span><span class="o">.</span><span class="n">response_type</span> <span class="o">==</span> <span class="s1">&#39;ABSTRESS&#39;</span><span class="p">:</span>
            <span class="c1">## atta - Arbitrary Beam Stress Item Code</span>
            <span class="c1">#ids = [idi for idi in self.atti if idi is not None]</span>
            <span class="n">data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_properties</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">msg</span> <span class="o">=</span> <span class="s1">&#39;response_type=</span><span class="si">%r</span><span class="s1"> property_type=</span><span class="si">%r</span><span class="s1"> atta=</span><span class="si">%r</span><span class="s1"> attb=</span><span class="si">%r</span><span class="s1"> atti=</span><span class="si">%r</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">response_type</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">property_type</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">atta</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">attb</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">atti</span><span class="p">)</span>
            <span class="c1">#msg += str(self)</span>
            <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">data</span></div>

<div class="viewcode-block" id="DRESP1._nodes"><a class="viewcode-back" href="../../../../reference/bdf/cards/pyNastran.bdf.cards.optimization.html#pyNastran.bdf.cards.optimization.DRESP1._nodes">[docs]</a>    <span class="k">def</span> <span class="nf">_nodes</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;helper method&quot;&quot;&quot;</span>
        <span class="n">data</span> <span class="o">=</span> <span class="p">[</span><span class="n">node</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">node</span><span class="p">,</span> <span class="n">integer_types</span><span class="p">)</span> <span class="k">else</span> <span class="n">node</span><span class="o">.</span><span class="n">nid</span>
                <span class="k">for</span> <span class="n">node</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">atti_ref</span><span class="p">]</span>
        <span class="c1">#self.atti = data</span>
        <span class="k">return</span> <span class="n">data</span></div>

<div class="viewcode-block" id="DRESP1._elements"><a class="viewcode-back" href="../../../../reference/bdf/cards/pyNastran.bdf.cards.optimization.html#pyNastran.bdf.cards.optimization.DRESP1._elements">[docs]</a>    <span class="k">def</span> <span class="nf">_elements</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;helper method&quot;&quot;&quot;</span>
        <span class="n">data</span> <span class="o">=</span> <span class="p">[</span><span class="n">eid</span> <span class="k">if</span> <span class="n">elem</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">elem</span><span class="o">.</span><span class="n">eid</span>
                <span class="k">for</span> <span class="p">(</span><span class="n">eid</span><span class="p">,</span> <span class="n">elem</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">atti</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">atti_ref</span><span class="p">)]</span>
        <span class="c1">#self.atti = data</span>
        <span class="k">return</span> <span class="n">data</span></div>

<div class="viewcode-block" id="DRESP1._properties"><a class="viewcode-back" href="../../../../reference/bdf/cards/pyNastran.bdf.cards.optimization.html#pyNastran.bdf.cards.optimization.DRESP1._properties">[docs]</a>    <span class="k">def</span> <span class="nf">_properties</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;helper method&quot;&quot;&quot;</span>
        <span class="n">data</span> <span class="o">=</span> <span class="p">[</span><span class="n">pid</span> <span class="k">if</span> <span class="n">prop</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">prop</span><span class="o">.</span><span class="n">pid</span>
                <span class="k">for</span> <span class="p">(</span><span class="n">pid</span><span class="p">,</span> <span class="n">prop</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">atti</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">atti_ref</span><span class="p">)]</span>
        <span class="c1">#self.atti = data</span>
        <span class="c1">#self.atti_ref = None</span>
        <span class="k">return</span> <span class="n">data</span></div>

<div class="viewcode-block" id="DRESP1.raw_fields"><a class="viewcode-back" href="../../../../reference/bdf/cards/pyNastran.bdf.cards.optimization.html#pyNastran.bdf.cards.optimization.DRESP1.raw_fields">[docs]</a>    <span class="k">def</span> <span class="nf">raw_fields</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">list_fields</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;DRESP1&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">dresp_id</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">label</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">response_type</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">property_type</span><span class="p">,</span>
                       <span class="bp">self</span><span class="o">.</span><span class="n">region</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">Atta</span><span class="p">(),</span> <span class="bp">self</span><span class="o">.</span><span class="n">attb</span><span class="p">]</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">atti_values</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">list_fields</span></div>

<div class="viewcode-block" id="DRESP1.repr_fields"><a class="viewcode-back" href="../../../../reference/bdf/cards/pyNastran.bdf.cards.optimization.html#pyNastran.bdf.cards.optimization.DRESP1.repr_fields">[docs]</a>    <span class="k">def</span> <span class="nf">repr_fields</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Gets the fields in their simplified form</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        fields : List[varies]</span>
<span class="sd">            the fields that define the card</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">label</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">label</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">label</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="mi">6</span><span class="p">:</span>
            <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39; </span><span class="si">%6s</span><span class="s1"> &#39;</span> <span class="o">%</span> <span class="n">label</span>
        <span class="n">list_fields</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;DRESP1&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">dresp_id</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">label</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">response_type</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">property_type</span><span class="p">,</span>
                       <span class="bp">self</span><span class="o">.</span><span class="n">region</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">Atta</span><span class="p">(),</span> <span class="bp">self</span><span class="o">.</span><span class="n">attb</span><span class="p">]</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">atti_values</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">list_fields</span></div>

<div class="viewcode-block" id="DRESP1.write_card"><a class="viewcode-back" href="../../../../reference/bdf/cards/pyNastran.bdf.cards.optimization.html#pyNastran.bdf.cards.optimization.DRESP1.write_card">[docs]</a>    <span class="k">def</span> <span class="nf">write_card</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">size</span><span class="p">:</span> <span class="nb">int</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span> <span class="n">is_double</span><span class="p">:</span> <span class="nb">bool</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="n">card</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">repr_fields</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">size</span> <span class="o">==</span> <span class="mi">8</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">comment</span> <span class="o">+</span> <span class="n">print_card_8</span><span class="p">(</span><span class="n">card</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">is_double</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">comment</span> <span class="o">+</span> <span class="n">print_card_double</span><span class="p">(</span><span class="n">card</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">comment</span> <span class="o">+</span> <span class="n">print_card_16</span><span class="p">(</span><span class="n">card</span><span class="p">)</span></div></div>

<div class="viewcode-block" id="_dresp_verify_eids"><a class="viewcode-back" href="../../../../reference/bdf/cards/pyNastran.bdf.cards.optimization.html#pyNastran.bdf.cards.optimization._dresp_verify_eids">[docs]</a><span class="k">def</span> <span class="nf">_dresp_verify_eids</span><span class="p">(</span><span class="n">dresp</span><span class="p">:</span> <span class="n">DRESP1</span><span class="p">,</span> <span class="n">model</span><span class="p">:</span> <span class="n">BDF</span><span class="p">,</span> <span class="n">property_type</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">property_type</span> <span class="o">==</span> <span class="s1">&#39;ELEM&#39;</span><span class="p">:</span>
        <span class="n">eids2</span> <span class="o">=</span> <span class="n">dresp</span><span class="o">.</span><span class="n">atti</span>
        <span class="n">valid_etypes</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;CROD&#39;</span><span class="p">,</span> <span class="s1">&#39;CONROD&#39;</span><span class="p">,</span>
            <span class="s1">&#39;CELAS&#39;</span><span class="p">,</span>
            <span class="s1">&#39;CBAR&#39;</span><span class="p">,</span> <span class="s1">&#39;CBEAM&#39;</span><span class="p">,</span>
            <span class="s1">&#39;CTRIA3&#39;</span><span class="p">,</span> <span class="s1">&#39;CQUAD4&#39;</span><span class="p">,</span> <span class="s1">&#39;CTRIA6&#39;</span><span class="p">,</span> <span class="s1">&#39;CQUAD8&#39;</span><span class="p">,</span> <span class="s1">&#39;CSHEAR&#39;</span><span class="p">,</span>
            <span class="s1">&#39;CHEXA&#39;</span><span class="p">,</span> <span class="s1">&#39;CTETRA&#39;</span><span class="p">,</span> <span class="s1">&#39;CPENTA&#39;</span><span class="p">,</span> <span class="s1">&#39;CPYRAM&#39;</span><span class="p">,</span>
            <span class="s1">&#39;CFAST&#39;</span><span class="p">,</span>
        <span class="p">}</span>
        <span class="k">for</span> <span class="n">eid</span> <span class="ow">in</span> <span class="n">eids2</span><span class="p">:</span>
            <span class="n">element</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">elements</span><span class="p">[</span><span class="n">eid</span><span class="p">]</span>
            <span class="k">assert</span> <span class="n">element</span><span class="o">.</span><span class="n">type</span> <span class="ow">in</span> <span class="n">valid_etypes</span><span class="p">,</span> <span class="sa">f</span><span class="s1">&#39;valid=</span><span class="si">{</span><span class="n">valid_etypes</span><span class="si">}</span><span class="se">\n</span><span class="si">{</span><span class="n">element</span><span class="o">.</span><span class="n">get_stats</span><span class="p">()</span><span class="si">}</span><span class="s1">&#39;</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">valid_properties_map</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;PSOLID&#39;</span> <span class="p">:</span> <span class="p">{</span><span class="s1">&#39;PSOLID&#39;</span><span class="p">},</span>
            <span class="s1">&#39;PSHELL&#39;</span> <span class="p">:</span> <span class="p">{</span><span class="s1">&#39;PSHELL&#39;</span><span class="p">},</span>
            <span class="s1">&#39;PBAR&#39;</span> <span class="p">:</span> <span class="p">{</span><span class="s1">&#39;PBAR&#39;</span><span class="p">,</span> <span class="s1">&#39;PBARL&#39;</span><span class="p">},</span>
            <span class="s1">&#39;PBARL&#39;</span> <span class="p">:</span> <span class="p">{</span><span class="s1">&#39;PBARL&#39;</span><span class="p">},</span>
            <span class="s1">&#39;PBEAM&#39;</span> <span class="p">:</span> <span class="p">{</span><span class="s1">&#39;PBEAM&#39;</span><span class="p">,</span> <span class="s1">&#39;PBEAML&#39;</span><span class="p">},</span>
            <span class="s1">&#39;PBEAML&#39;</span> <span class="p">:</span> <span class="p">{</span><span class="s1">&#39;PBEAML&#39;</span><span class="p">},</span>
            <span class="s1">&#39;PROD&#39;</span> <span class="p">:</span> <span class="p">{</span><span class="s1">&#39;PROD&#39;</span><span class="p">},</span>
            <span class="s1">&#39;PELAS&#39;</span> <span class="p">:</span> <span class="p">{</span><span class="s1">&#39;PELAS&#39;</span><span class="p">},</span>
            <span class="c1">#&#39;PDAMP&#39; : {&#39;PDAMP&#39;},</span>
            <span class="s1">&#39;PSHEAR&#39;</span> <span class="p">:</span> <span class="p">{</span><span class="s1">&#39;PSHEAR&#39;</span><span class="p">},</span>
            <span class="s1">&#39;PCOMP&#39;</span> <span class="p">:</span> <span class="p">{</span><span class="s1">&#39;PCOMP&#39;</span><span class="p">},</span> <span class="c1"># &#39;PCOMPG&#39;},</span>
            <span class="s1">&#39;PTUBE&#39;</span> <span class="p">:</span> <span class="p">{</span><span class="s1">&#39;PTUBE&#39;</span><span class="p">},</span>
            <span class="s1">&#39;PBMSECT&#39;</span> <span class="p">:</span> <span class="p">{</span><span class="s1">&#39;PBMSECT&#39;</span><span class="p">},</span>
            <span class="s1">&#39;PBRSECT&#39;</span> <span class="p">:</span> <span class="p">{</span><span class="s1">&#39;PBRSECT&#39;</span><span class="p">},</span>
        <span class="p">}</span>
        <span class="n">properties</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">valid_properties_map</span><span class="p">)</span>
        <span class="n">property_to_etypes_map</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;PSOLID&#39;</span> <span class="p">:</span> <span class="p">{</span><span class="s1">&#39;CHEXA&#39;</span><span class="p">,</span> <span class="s1">&#39;CTETRA&#39;</span><span class="p">,</span> <span class="s1">&#39;CPENTA&#39;</span><span class="p">,</span> <span class="s1">&#39;CPYRAM&#39;</span><span class="p">},</span>
            <span class="s1">&#39;PSHELL&#39;</span> <span class="p">:</span> <span class="p">{</span><span class="s1">&#39;CTRIA3&#39;</span><span class="p">,</span> <span class="s1">&#39;CQUAD4&#39;</span><span class="p">,</span> <span class="s1">&#39;CTRIA6&#39;</span><span class="p">,</span> <span class="s1">&#39;CQUAD8&#39;</span><span class="p">,</span> <span class="s1">&#39;CQUADR&#39;</span><span class="p">},</span>
            <span class="s1">&#39;PBAR&#39;</span> <span class="p">:</span> <span class="p">{</span><span class="s1">&#39;CBAR&#39;</span><span class="p">},</span>
            <span class="s1">&#39;PBARL&#39;</span> <span class="p">:</span> <span class="p">{</span><span class="s1">&#39;CBAR&#39;</span><span class="p">},</span>
            <span class="s1">&#39;PROD&#39;</span> <span class="p">:</span> <span class="p">{</span><span class="s1">&#39;CROD&#39;</span><span class="p">},</span>
            <span class="s1">&#39;PELAS&#39;</span> <span class="p">:</span> <span class="p">{</span><span class="s1">&#39;CELAS1&#39;</span><span class="p">},</span>  <span class="c1"># no CELAS4</span>
            <span class="c1">#&#39;PDAMP&#39; : {},  # no CDAMP4</span>
            <span class="s1">&#39;PSHEAR&#39;</span> <span class="p">:</span> <span class="p">{</span><span class="s1">&#39;CSHEAR&#39;</span><span class="p">},</span>
            <span class="s1">&#39;PCOMP&#39;</span> <span class="p">:</span> <span class="p">{</span><span class="s1">&#39;CTRIA3&#39;</span><span class="p">,</span> <span class="s1">&#39;CQUAD4&#39;</span><span class="p">,</span> <span class="s1">&#39;CTRIA6&#39;</span><span class="p">,</span> <span class="s1">&#39;CQUAD8&#39;</span><span class="p">},</span>
            <span class="s1">&#39;PBEAM&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;CBEAM&#39;</span><span class="p">},</span>
            <span class="s1">&#39;PBEAML&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;CBEAM&#39;</span><span class="p">},</span>
            <span class="s1">&#39;PTUBE&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;CTUBE&#39;</span><span class="p">},</span>
            <span class="s1">&#39;PCOMPG&#39;</span><span class="p">:</span> <span class="p">{},</span>
            <span class="s1">&#39;PLPLANE&#39;</span><span class="p">:</span> <span class="p">{},</span>
            <span class="c1">#&#39;PPPLANE&#39;: {},</span>
            <span class="s1">&#39;PBRSECT&#39;</span> <span class="p">:</span> <span class="p">{</span><span class="s1">&#39;CBAR&#39;</span><span class="p">},</span>
            <span class="s1">&#39;PBMSECT&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;CBEAM&#39;</span><span class="p">},</span>
        <span class="p">}</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="n">valid_properties</span> <span class="o">=</span> <span class="n">valid_properties_map</span><span class="p">[</span><span class="n">property_type</span><span class="p">]</span>
            <span class="n">valid_etypes</span> <span class="o">=</span> <span class="n">property_to_etypes_map</span><span class="p">[</span><span class="n">property_type</span><span class="p">]</span>
        <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">dresp</span><span class="o">.</span><span class="n">get_stats</span><span class="p">())</span>
            <span class="k">raise</span>

        <span class="k">if</span> <span class="n">property_type</span> <span class="ow">in</span> <span class="n">properties</span><span class="p">:</span>
            <span class="k">assert</span> <span class="n">dresp</span><span class="o">.</span><span class="n">atti_ref</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">,</span> <span class="n">dresp</span><span class="o">.</span><span class="n">get_stats</span><span class="p">()</span>
            <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">dresp</span><span class="o">.</span><span class="n">atti_ref</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">,</span> <span class="n">dresp</span><span class="o">.</span><span class="n">get_stats</span><span class="p">()</span>
            <span class="n">props</span> <span class="o">=</span> <span class="n">dresp</span><span class="o">.</span><span class="n">atti_ref</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">dresp</span><span class="o">.</span><span class="n">get_stats</span><span class="p">())</span>
            <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="n">property_type</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">prop</span> <span class="ow">in</span> <span class="n">props</span><span class="p">:</span>
            <span class="k">assert</span> <span class="n">prop</span><span class="o">.</span><span class="n">type</span> <span class="ow">in</span> <span class="n">valid_properties</span><span class="p">,</span> <span class="sa">f</span><span class="s1">&#39;prop.type=</span><span class="si">{</span><span class="n">prop</span><span class="o">.</span><span class="n">type</span><span class="si">!r}</span><span class="s1"> property_type=</span><span class="si">{</span><span class="n">property_type</span><span class="si">!r}</span><span class="s1"> valid_properties=</span><span class="si">{</span><span class="n">valid_properties</span><span class="si">}</span><span class="se">\n</span><span class="s1">property=</span><span class="se">\n</span><span class="si">{</span><span class="n">prop</span><span class="o">.</span><span class="n">get_stats</span><span class="p">()</span><span class="si">}</span><span class="s1">&#39;</span>
            <span class="n">pid</span> <span class="o">=</span> <span class="n">prop</span><span class="o">.</span><span class="n">pid</span>
            <span class="n">eids1</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">get_element_ids_list_with_pids</span><span class="p">(</span><span class="n">pid</span><span class="p">)</span>
            <span class="n">eids_dict</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">get_element_ids_dict_with_pids</span><span class="p">()</span>
            <span class="k">assert</span> <span class="n">pid</span> <span class="ow">in</span> <span class="n">eids_dict</span><span class="p">,</span> <span class="sa">f</span><span class="s1">&#39;pid=</span><span class="si">{</span><span class="n">pid</span><span class="si">}</span><span class="s1"> actual_properties=</span><span class="si">{</span><span class="nb">list</span><span class="p">(</span><span class="n">eids_dict</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span><span class="si">}</span><span class="s1">&#39;</span>
            <span class="n">eids2</span> <span class="o">=</span> <span class="n">eids_dict</span><span class="p">[</span><span class="n">pid</span><span class="p">]</span>
            <span class="n">eids1</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>
            <span class="n">eids2</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>
            <span class="k">assert</span> <span class="n">eids1</span> <span class="o">==</span> <span class="n">eids2</span>
            <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">eids2</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">,</span> <span class="n">eids2</span>

            <span class="k">for</span> <span class="n">eid</span> <span class="ow">in</span> <span class="n">eids2</span><span class="p">:</span>
                <span class="n">element</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">elements</span><span class="p">[</span><span class="n">eid</span><span class="p">]</span>
                <span class="k">assert</span> <span class="n">element</span><span class="o">.</span><span class="n">type</span> <span class="ow">in</span> <span class="n">valid_etypes</span><span class="p">,</span> <span class="sa">f</span><span class="s1">&#39;valid=</span><span class="si">{</span><span class="n">valid_etypes</span><span class="si">}</span><span class="se">\n</span><span class="si">{</span><span class="n">element</span><span class="o">.</span><span class="n">get_stats</span><span class="p">()</span><span class="si">}</span><span class="s1">&#39;</span></div>

<div class="viewcode-block" id="DRESP2"><a class="viewcode-back" href="../../../../reference/bdf/cards/pyNastran.bdf.cards.optimization.html#pyNastran.bdf.cards.optimization.DRESP2">[docs]</a><span class="k">class</span> <span class="nc">DRESP2</span><span class="p">(</span><span class="n">OptConstraint</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Design Sensitivity Equation Response Quantities</span>
<span class="sd">    Defines equation responses that are used in the design, either as</span>
<span class="sd">    constraints or as an objective.</span>

<span class="sd">    +--------+---------+--------+-----------+--------+--------+--------+--------+--------+</span>
<span class="sd">    |   1    |    2    |    3   |     4     |    5   |    6   |    7   |    8   |    9   |</span>
<span class="sd">    +========+=========+========+===========+========+========+========+========+========+</span>
<span class="sd">    | DRESP2 |   ID    |  LABEL | EQID/FUNC | REGION | METHOD |   C1   |   C2   |   C3   |</span>
<span class="sd">    +--------+---------+--------+-----------+--------+--------+--------+--------+--------+</span>
<span class="sd">    |        | DESVAR  | DVID1  |   DVID2   |  DVID3 |  DVID4 |  DVID5 |  DVID6 |  DVID7 |</span>
<span class="sd">    +--------+---------+--------+-----------+--------+--------+--------+--------+--------+</span>
<span class="sd">    |        |         | DVID8  |   etc.    |        |        |        |        |        |</span>
<span class="sd">    +--------+---------+--------+-----------+--------+--------+--------+--------+--------+</span>
<span class="sd">    |        | DTABLE  | LABL1  |  LABL2    |  LABL3 |  LABL4 |  LABL5 |  LABL6 |  LABL7 |</span>
<span class="sd">    +--------+---------+--------+-----------+--------+--------+--------+--------+--------+</span>
<span class="sd">    |        |         | LABL8  |  etc.     |        |        |        |        |        |</span>
<span class="sd">    +--------+---------+--------+-----------+--------+--------+--------+--------+--------+</span>
<span class="sd">    |        | DRESP1  |  NR1   |    NR2    |   NR3  |   NR4  |   NR5  |   NR6  |  NR7   |</span>
<span class="sd">    +--------+---------+--------+-----------+--------+--------+--------+--------+--------+</span>
<span class="sd">    |        |         |  NR8   |   etc.    |        |        |        |        |        |</span>
<span class="sd">    +--------+---------+--------+-----------+--------+--------+--------+--------+--------+</span>
<span class="sd">    |        | DNODE   |   G1   |    C1     |   G2   |   C2   |   G3   |   C3   |        |</span>
<span class="sd">    +--------+---------+--------+-----------+--------+--------+--------+--------+--------+</span>
<span class="sd">    |        |         |   G4   |    C4     |  etc.  |        |        |        |        |</span>
<span class="sd">    +--------+---------+--------+-----------+--------+--------+--------+--------+--------+</span>
<span class="sd">    |        | DVPREL1 | DPIP1  |   DPIP2   | DPIP3  | DPIP4  | DPIP5  | DPIP6  | DPIP7  |</span>
<span class="sd">    +--------+---------+--------+-----------+--------+--------+--------+--------+--------+</span>
<span class="sd">    |        |         | DPIP8  |   DPIP9   |  etc.  |        |        |        |        |</span>
<span class="sd">    +--------+---------+--------+-----------+--------+--------+--------+--------+--------+</span>
<span class="sd">    |        | DVCREL1 | DCIC1  |   DCIC2   | DCIC3  | DCIC4  | DCIC5  | DCIC6  | DCIC7  |</span>
<span class="sd">    +--------+---------+--------+-----------+--------+--------+--------+--------+--------+</span>
<span class="sd">    |        |         | DCIC8  |   DCIC9   |  etc.  |        |        |        |        |</span>
<span class="sd">    +--------+---------+--------+-----------+--------+--------+--------+--------+--------+</span>
<span class="sd">    |        | DVMREL1 | DMIM1  |   DMIM2   | DMIM3  | DMIM4  | DMIM5  | DMIM6  | DMIM7  |</span>
<span class="sd">    +--------+---------+--------+-----------+--------+--------+--------+--------+--------+</span>
<span class="sd">    |        |         | DMIM8  |   DMIM9   |  etc.  |        |        |        |        |</span>
<span class="sd">    +--------+---------+--------+-----------+--------+--------+--------+--------+--------+</span>
<span class="sd">    |        | DVPREL2 | DPI2P1 |   DPI2P2  | DPI2P3 | DPI2P4 | DPI2P5 | DPI2P6 | DPI2P7 |</span>
<span class="sd">    +--------+---------+--------+-----------+--------+--------+--------+--------+--------+</span>
<span class="sd">    |        |         | DPI2P8 |   DPI2P9  |  etc.  |        |        |        |        |</span>
<span class="sd">    +--------+---------+--------+-----------+--------+--------+--------+--------+--------+</span>
<span class="sd">    |        | DVCREL2 | DCI2C1 |   DCI2C2  | DCI2C3 | DCI2C4 | DCI2C5 | DCI2C6 | DCI2C7 |</span>
<span class="sd">    +--------+---------+--------+-----------+--------+--------+--------+--------+--------+</span>
<span class="sd">    |        |         | DCI2C8 |   DCI2C9  |   etc. |        |        |        |        |</span>
<span class="sd">    +--------+---------+--------+-----------+--------+--------+--------+--------+--------+</span>
<span class="sd">    |        | DVMREL2 | DMI2M1 |   DMI2M2  | DMI2M3 | DMI2M4 | DMI2M5 | DMI2M6 | DMI2M7 |</span>
<span class="sd">    +--------+---------+--------+-----------+--------+--------+--------+--------+--------+</span>
<span class="sd">    |        |         | DMI2M8 |   DMI2M9  |   etc. |        |        |        |        |</span>
<span class="sd">    +--------+---------+--------+-----------+--------+--------+--------+--------+--------+</span>
<span class="sd">    |        | DRESP2  | NRR1   |   NRR2    |  NRR3  |  NRR4  |  NRR5  |  NRR6  |  NRR7  |</span>
<span class="sd">    +--------+---------+--------+-----------+--------+--------+--------+--------+--------+</span>
<span class="sd">    |        |         | NRR8   |   etc.    |        |        |        |        |        |</span>
<span class="sd">    +--------+---------+--------+-----------+--------+--------+--------+--------+--------+</span>
<span class="sd">    |        | DVLREL1 | DLIL1  |   DLIL2   |  DLIL3 |  DLIL4 |  DLIL5 |  DLIL6 |  DLIL7 |</span>
<span class="sd">    +--------+---------+--------+-----------+--------+--------+--------+--------+--------+</span>
<span class="sd">    |        |         | DLIL8  |   etc.    |        |        |        |        |        |</span>
<span class="sd">    +--------+---------+--------+-----------+--------+--------+--------+--------+--------+</span>

<span class="sd">    C1, C2, C3 are MSC specific</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="nb">type</span> <span class="o">=</span> <span class="s1">&#39;DRESP2&#39;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dresp_id</span><span class="p">,</span> <span class="n">label</span><span class="p">,</span> <span class="n">dequation</span><span class="p">,</span> <span class="n">region</span><span class="p">,</span> <span class="n">params</span><span class="p">,</span>
                 <span class="n">method</span><span class="o">=</span><span class="s1">&#39;MIN&#39;</span><span class="p">,</span> <span class="n">c1</span><span class="o">=</span><span class="mf">1.</span><span class="p">,</span> <span class="n">c2</span><span class="o">=</span><span class="mf">0.005</span><span class="p">,</span> <span class="n">c3</span><span class="o">=</span><span class="mf">10.</span><span class="p">,</span> <span class="n">comment</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span>
                 <span class="n">validate</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Creates a DRESP2 card.</span>

<span class="sd">        A DRESP2 is used to define a &quot;complex&quot; output result that may be</span>
<span class="sd">        optimized on.  A complex result is a result that uses:</span>
<span class="sd">          - simple (DRESP1) results</span>
<span class="sd">          - complex (DRESP2) results</span>
<span class="sd">          - default values (DTABLE)</span>
<span class="sd">          - DVCRELx values</span>
<span class="sd">          - DVMRELx values</span>
<span class="sd">          - DVPRELx values</span>
<span class="sd">          - DESVAR values</span>
<span class="sd">          - DNODE values</span>
<span class="sd">        Then, an equation (DEQATN) is used to formulate an output response.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        dresp_id : int</span>
<span class="sd">            response id</span>
<span class="sd">        label : str</span>
<span class="sd">            Name of the response</span>
<span class="sd">        dequation : int / str</span>
<span class="sd">            int : DEQATN id</span>
<span class="sd">            str : an equation</span>
<span class="sd">        region : int</span>
<span class="sd">            Region identifier for constraint screening</span>
<span class="sd">        params : dict[(index, card_type)] = values</span>
<span class="sd">            the storage table for the response function</span>
<span class="sd">            index : int</span>
<span class="sd">                a counter</span>
<span class="sd">            card_type : str</span>
<span class="sd">                the type of card to pull from</span>
<span class="sd">                DESVAR, DVPREL1, DRESP2, etc.</span>
<span class="sd">            values : List[int]</span>
<span class="sd">                the values for this response</span>
<span class="sd">        method : str; default=MIN</span>
<span class="sd">            flag used for FUNC=BETA/MATCH</span>
<span class="sd">            FUNC = BETA</span>
<span class="sd">                valid options are {MIN, MAX}</span>
<span class="sd">            FUNC = MATCH</span>
<span class="sd">                valid options are {LS, BETA}</span>
<span class="sd">        c1 / c2 / c3 : float; default=1. / 0.005 / 10.0</span>
<span class="sd">            constants for FUNC=BETA or FUNC=MATCH</span>
<span class="sd">        comment : str; default=&#39;&#39;</span>
<span class="sd">            a comment for the card</span>
<span class="sd">        validate : bool; default=False</span>
<span class="sd">            should the card be validated when it&#39;s created</span>

<span class="sd">        params = {</span>
<span class="sd">           (0, &#39;DRESP1&#39;) = [10, 20],</span>
<span class="sd">           (1, &#39;DESVAR&#39;) = [30],</span>
<span class="sd">           (2, &#39;DRESP1&#39;) = [40],</span>
<span class="sd">        }</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">OptConstraint</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">comment</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">comment</span> <span class="o">=</span> <span class="n">comment</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">func</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dequation_str</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dresp_id</span> <span class="o">=</span> <span class="n">dresp_id</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">label</span> <span class="o">=</span> <span class="n">label</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dequation</span> <span class="o">=</span> <span class="n">dequation</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">region</span> <span class="o">=</span> <span class="n">region</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">method</span> <span class="o">=</span> <span class="n">method</span>

        <span class="c1"># Constants used when FUNC = BETA or FUNC = MATCH in combination with METHOD = BETA</span>
        <span class="c1"># MSC 2016.1 Defaults: C1 = 1.0, C2=0.005, and C3=10.0)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">c1</span> <span class="o">=</span> <span class="n">c1</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">c2</span> <span class="o">=</span> <span class="n">c2</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">c3</span> <span class="o">=</span> <span class="n">c3</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">params</span> <span class="o">=</span> <span class="n">params</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">params_ref</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dequation_ref</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dtable_ref</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">if</span> <span class="n">validate</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_validate</span><span class="p">()</span>
            <span class="c1">#atta, attb, atti = validate_dresp1(</span>
                <span class="c1">#property_type, response_type, atta, attb, atti)</span>

<div class="viewcode-block" id="DRESP2.export_to_hdf5"><a class="viewcode-back" href="../../../../reference/bdf/cards/pyNastran.bdf.cards.optimization.html#pyNastran.bdf.cards.optimization.DRESP2.export_to_hdf5">[docs]</a>    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">export_to_hdf5</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">h5_file</span><span class="p">,</span> <span class="n">model</span><span class="p">,</span> <span class="n">encoding</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;exports the dresps in a vectorized way&quot;&quot;&quot;</span>
        <span class="n">_export_dresps_to_hdf5</span><span class="p">(</span><span class="n">h5_file</span><span class="p">,</span> <span class="n">model</span><span class="p">,</span> <span class="n">encoding</span><span class="p">)</span></div>

<div class="viewcode-block" id="DRESP2._validate"><a class="viewcode-back" href="../../../../reference/bdf/cards/pyNastran.bdf.cards.optimization.html#pyNastran.bdf.cards.optimization.DRESP2._validate">[docs]</a>    <span class="k">def</span> <span class="nf">_validate</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="p">,</span> <span class="nb">dict</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">params</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">msg</span> <span class="o">=</span> <span class="p">(</span>
                <span class="s1">&#39;params should be of the form: params[(index, card_type)] = values</span><span class="se">\n</span><span class="s1">&#39;</span>
                <span class="s1">&#39;For example:</span><span class="se">\n</span><span class="s1">&#39;</span>
                <span class="s1">&#39;   params = {</span><span class="se">\n</span><span class="s1">&#39;</span>
                <span class="s2">&quot;   (0, &#39;DRESP1&#39;): [1, 2, 3]</span><span class="se">\n</span><span class="s2">&quot;</span>
                <span class="s2">&quot;   (1, &#39;DTABLE&#39;): [&#39;X&#39;, &#39;X2&#39;, &#39;X3&#39;]</span><span class="se">\n</span><span class="s2">&quot;</span>
                <span class="s2">&quot;   (2, &#39;DRESP1&#39;): [4, 5]</span><span class="se">\n</span><span class="s2">&quot;</span>
                <span class="s1">&#39;}&#39;</span><span class="p">)</span>
            <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>

        <span class="n">ifield</span> <span class="o">=</span> <span class="mi">9</span>
        <span class="n">ikey</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">values</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="n">nvalues</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">values</span><span class="p">)</span>

            <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">),</span> <span class="sa">f</span><span class="s1">&#39;key=</span><span class="si">{</span><span class="n">key</span><span class="si">}</span><span class="s1">&#39;</span>
            <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">key</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span><span class="p">,</span> <span class="sa">f</span><span class="s1">&#39;key=</span><span class="si">{</span><span class="n">key</span><span class="si">}</span><span class="s1">&#39;</span>
            <span class="n">iorder</span><span class="p">,</span> <span class="n">name</span> <span class="o">=</span> <span class="n">key</span>
            <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">iorder</span><span class="p">,</span> <span class="nb">int</span><span class="p">),</span> <span class="sa">f</span><span class="s1">&#39;iorder=</span><span class="si">{</span><span class="n">iorder</span><span class="si">}</span><span class="s1"> key=</span><span class="si">{</span><span class="n">key</span><span class="si">}</span><span class="s1">&#39;</span>
            <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="nb">str</span><span class="p">),</span> <span class="sa">f</span><span class="s1">&#39;name=</span><span class="si">{</span><span class="n">name</span><span class="si">!r}</span><span class="s1"> key=</span><span class="si">{</span><span class="n">key</span><span class="si">}</span><span class="s1">&#39;</span>
            <span class="k">if</span> <span class="n">name</span> <span class="o">==</span> <span class="s1">&#39;DNODE&#39;</span><span class="p">:</span>
                <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">values</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span><span class="p">,</span> <span class="sa">f</span><span class="s1">&#39;name=</span><span class="si">{</span><span class="n">name</span><span class="si">!r}</span><span class="s1"> must be a tuple of length 2 (nids, components); values=</span><span class="si">{</span><span class="n">values</span><span class="si">}</span><span class="s1">&#39;</span>
                <span class="n">nids</span><span class="p">,</span> <span class="n">components</span> <span class="o">=</span> <span class="n">values</span>
                <span class="k">for</span> <span class="n">nid</span> <span class="ow">in</span> <span class="n">nids</span><span class="p">:</span>
                    <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">nid</span><span class="p">,</span> <span class="nb">int</span><span class="p">),</span> <span class="sa">f</span><span class="s1">&#39;name=</span><span class="si">{</span><span class="n">name</span><span class="si">!r}</span><span class="s1"> nid=</span><span class="si">{</span><span class="n">nid</span><span class="si">!r}</span><span class="s1"> is not an int; values=</span><span class="si">{</span><span class="n">values</span><span class="si">}</span><span class="s1">&#39;</span>
                <span class="k">for</span> <span class="n">comp</span> <span class="ow">in</span> <span class="n">components</span><span class="p">:</span>
                    <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">comp</span><span class="p">,</span> <span class="nb">int</span><span class="p">),</span> <span class="sa">f</span><span class="s1">&#39;name=</span><span class="si">{</span><span class="n">name</span><span class="si">!r}</span><span class="s1"> comp=</span><span class="si">{</span><span class="n">comp</span><span class="si">!r}</span><span class="s1"> is not an int; values=</span><span class="si">{</span><span class="n">values</span><span class="si">}</span><span class="s1">&#39;</span>
            <span class="k">elif</span> <span class="n">name</span> <span class="o">==</span> <span class="s1">&#39;DTABLE&#39;</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">ival</span><span class="p">,</span> <span class="n">svalue</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">values</span><span class="p">):</span>
                    <span class="n">fieldname</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">key</span><span class="si">}</span><span class="s1">_i=</span><span class="si">{</span><span class="n">ival</span><span class="o">+</span><span class="mi">1</span><span class="si">}</span><span class="s1">&#39;</span>
                    <span class="c1">#assert isinstance(svalue, str), f&#39;name={name!r} val={val!r} is not a string; values={values}&#39;</span>
                    <span class="n">check_string</span><span class="p">(</span><span class="n">svalue</span><span class="p">,</span> <span class="n">ifield</span><span class="p">,</span> <span class="n">fieldname</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">val</span> <span class="ow">in</span> <span class="n">values</span><span class="p">:</span>
                    <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">val</span><span class="p">,</span> <span class="nb">int</span><span class="p">),</span> <span class="sa">f</span><span class="s1">&#39;name=</span><span class="si">{</span><span class="n">name</span><span class="si">!r}</span><span class="s1"> val=</span><span class="si">{</span><span class="n">val</span><span class="si">!r}</span><span class="s1"> is not an int; values=</span><span class="si">{</span><span class="n">values</span><span class="si">}</span><span class="s1">&#39;</span>

            <span class="n">remainder</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">nvalues</span> <span class="o">%</span> <span class="mi">8</span><span class="p">)</span>
            <span class="n">dfields</span> <span class="o">=</span> <span class="p">(</span><span class="n">nvalues</span> <span class="o">//</span> <span class="mi">8</span> <span class="o">+</span> <span class="n">remainder</span><span class="p">)</span> <span class="o">*</span> <span class="mi">8</span>
            <span class="n">ifield</span> <span class="o">+=</span> <span class="n">dfields</span>
            <span class="n">ikey</span> <span class="o">+=</span> <span class="mi">1</span></div>

<div class="viewcode-block" id="DRESP2.add_card"><a class="viewcode-back" href="../../../../reference/bdf/cards/pyNastran.bdf.cards.optimization.html#pyNastran.bdf.cards.optimization.DRESP2.add_card">[docs]</a>    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">add_card</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">card</span><span class="p">,</span> <span class="n">comment</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Adds a DRESP2 card from ``BDF.add_card(...)``</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        card : BDFCard()</span>
<span class="sd">            a BDFCard object</span>
<span class="sd">        comment : str; default=&#39;&#39;</span>
<span class="sd">            a comment for the card</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">dresp_id</span> <span class="o">=</span> <span class="n">integer</span><span class="p">(</span><span class="n">card</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;dresp_id&#39;</span><span class="p">)</span>
        <span class="n">label</span> <span class="o">=</span> <span class="n">string</span><span class="p">(</span><span class="n">card</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;label&#39;</span><span class="p">)</span>
        <span class="n">dequation</span> <span class="o">=</span> <span class="n">integer_or_string</span><span class="p">(</span><span class="n">card</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="s1">&#39;dequation_id&#39;</span><span class="p">)</span>
        <span class="n">region</span> <span class="o">=</span> <span class="n">integer_or_blank</span><span class="p">(</span><span class="n">card</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="s1">&#39;region&#39;</span><span class="p">)</span>
        <span class="n">method</span> <span class="o">=</span> <span class="n">string_or_blank</span><span class="p">(</span><span class="n">card</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="s1">&#39;method&#39;</span><span class="p">,</span> <span class="s1">&#39;MIN&#39;</span><span class="p">)</span>

        <span class="c1"># MSC 2005   Defaults: C1=100., C2=.005)</span>
        <span class="c1"># MSC 2016.1 Defaults: C1=1., C2=.005, C3=10.)</span>
        <span class="n">c1</span> <span class="o">=</span> <span class="n">double_or_blank</span><span class="p">(</span><span class="n">card</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="s1">&#39;c1&#39;</span><span class="p">,</span> <span class="mf">1.</span><span class="p">)</span>
        <span class="n">c2</span> <span class="o">=</span> <span class="n">double_or_blank</span><span class="p">(</span><span class="n">card</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="s1">&#39;c2&#39;</span><span class="p">,</span> <span class="mf">0.005</span><span class="p">)</span>
        <span class="n">c3</span> <span class="o">=</span> <span class="n">double_or_blank</span><span class="p">(</span><span class="n">card</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="s1">&#39;c3&#39;</span><span class="p">,</span> <span class="mf">10.</span><span class="p">)</span>

        <span class="n">fields</span> <span class="o">=</span> <span class="p">[</span><span class="n">interpret_value</span><span class="p">(</span><span class="n">field</span><span class="p">)</span> <span class="k">for</span> <span class="n">field</span> <span class="ow">in</span> <span class="n">card</span><span class="p">[</span><span class="mi">9</span><span class="p">:]]</span>

        <span class="c1"># DRESP2, dresp_id,</span>
        <span class="c1">#         DRESP1, 10, 20</span>
        <span class="c1">#         DESVAR, 30</span>
        <span class="c1">#         DRESP1, 40</span>
        <span class="c1"># params = {</span>
        <span class="c1">#    (0, &#39;DRESP1&#39;) = [10, 20],</span>
        <span class="c1">#    (1, &#39;DESVAR&#39;) = [30],</span>
        <span class="c1">#    (2, &#39;DRESP1&#39;) = [40],</span>
        <span class="c1"># }</span>
        <span class="n">params</span> <span class="o">=</span> <span class="n">parse_table_fields</span><span class="p">(</span><span class="s1">&#39;DRESP2&#39;</span><span class="p">,</span> <span class="n">card</span><span class="p">,</span> <span class="n">fields</span><span class="p">)</span>

        <span class="c1">#print(&quot;--DRESP2 Params--&quot;)</span>
        <span class="c1">#for key, value_list in sorted(params.items()):</span>
            <span class="c1">#print(&quot;  key=%s value_list=%s&quot; %(key, value_list))</span>
        <span class="k">return</span> <span class="n">DRESP2</span><span class="p">(</span><span class="n">dresp_id</span><span class="p">,</span> <span class="n">label</span><span class="p">,</span> <span class="n">dequation</span><span class="p">,</span> <span class="n">region</span><span class="p">,</span> <span class="n">params</span><span class="p">,</span>
                      <span class="n">method</span><span class="p">,</span> <span class="n">c1</span><span class="p">,</span> <span class="n">c2</span><span class="p">,</span> <span class="n">c3</span><span class="p">,</span> <span class="n">comment</span><span class="o">=</span><span class="n">comment</span><span class="p">)</span></div>

<div class="viewcode-block" id="DRESP2.OptID"><a class="viewcode-back" href="../../../../reference/bdf/cards/pyNastran.bdf.cards.optimization.html#pyNastran.bdf.cards.optimization.DRESP2.OptID">[docs]</a>    <span class="k">def</span> <span class="nf">OptID</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">DRespID</span><span class="p">()</span></div>

<div class="viewcode-block" id="DRESP2.DRespID"><a class="viewcode-back" href="../../../../reference/bdf/cards/pyNastran.bdf.cards.optimization.html#pyNastran.bdf.cards.optimization.DRESP2.DRespID">[docs]</a>    <span class="k">def</span> <span class="nf">DRespID</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">dresp_id</span></div>

    <span class="k">def</span> <span class="nf">_verify</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">model</span><span class="p">,</span> <span class="n">xref</span><span class="p">):</span>
        <span class="k">pass</span>
        <span class="c1">#for (j, name), value_list in sorted(self.params.items()):</span>
            <span class="c1">#print(&#39;  DRESP2 verify - key=%s values=%s&#39; % (name,</span>
                <span class="c1">#self._get_values(name, value_list)))</span>

<div class="viewcode-block" id="DRESP2.calculate"><a class="viewcode-back" href="../../../../reference/bdf/cards/pyNastran.bdf.cards.optimization.html#pyNastran.bdf.cards.optimization.DRESP2.calculate">[docs]</a>    <span class="k">def</span> <span class="nf">calculate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">op2_model</span><span class="p">,</span> <span class="n">subcase_id</span><span class="p">):</span>
        <span class="n">argsi</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">vals</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">params_ref</span><span class="o">.</span><span class="n">items</span><span class="p">()):</span>
            <span class="n">unused_j</span><span class="p">,</span> <span class="n">name</span> <span class="o">=</span> <span class="n">key</span>
            <span class="k">if</span> <span class="n">name</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;DRESP1&#39;</span><span class="p">,</span> <span class="s1">&#39;DRESP2&#39;</span><span class="p">]:</span>
                <span class="c1">#print(&#39;vals =&#39;, vals)</span>
                <span class="k">for</span> <span class="n">val</span> <span class="ow">in</span> <span class="n">vals</span><span class="p">:</span>
                    <span class="n">arg</span> <span class="o">=</span> <span class="n">val</span><span class="o">.</span><span class="n">calculate</span><span class="p">(</span><span class="n">op2_model</span><span class="p">,</span> <span class="n">subcase_id</span><span class="p">)</span>
                    <span class="n">argsi</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">arg</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">name</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;DVMREL1&#39;</span><span class="p">,</span> <span class="s1">&#39;DVMREL2&#39;</span><span class="p">]:</span>
                <span class="k">for</span> <span class="n">val</span> <span class="ow">in</span> <span class="n">vals</span><span class="p">:</span>
                    <span class="n">arg</span> <span class="o">=</span> <span class="n">val</span><span class="o">.</span><span class="n">calculate</span><span class="p">(</span><span class="n">op2_model</span><span class="p">,</span> <span class="n">subcase_id</span><span class="p">)</span>
                    <span class="n">argsi</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">arg</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">name</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;DVPREL1&#39;</span><span class="p">,</span> <span class="s1">&#39;DVPREL2&#39;</span><span class="p">]:</span>
                <span class="k">for</span> <span class="n">val</span> <span class="ow">in</span> <span class="n">vals</span><span class="p">:</span>
                    <span class="n">arg</span> <span class="o">=</span> <span class="n">val</span><span class="o">.</span><span class="n">calculate</span><span class="p">(</span><span class="n">op2_model</span><span class="p">,</span> <span class="n">subcase_id</span><span class="p">)</span>
                    <span class="n">argsi</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">arg</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">name</span> <span class="o">==</span> <span class="s1">&#39;DTABLE&#39;</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">val</span> <span class="ow">in</span> <span class="n">vals</span><span class="p">:</span>
                    <span class="n">arg</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dtable_ref</span><span class="p">[</span><span class="n">val</span><span class="p">]</span>
                    <span class="n">argsi</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">arg</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="s1">&#39;  TODO: xref </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="nb">str</span><span class="p">(</span><span class="n">key</span><span class="p">))</span>
        <span class="c1">#op2_model.log.info(&#39;DRESP2 args = %s&#39; % argsi)</span>
        <span class="n">out</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">func</span><span class="p">(</span><span class="o">*</span><span class="n">argsi</span><span class="p">)</span>
        <span class="n">op2_model</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s1">&#39;  deqatn out = </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">out</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">out</span></div>

<div class="viewcode-block" id="DRESP2.cross_reference"><a class="viewcode-back" href="../../../../reference/bdf/cards/pyNastran.bdf.cards.optimization.html#pyNastran.bdf.cards.optimization.DRESP2.cross_reference">[docs]</a>    <span class="k">def</span> <span class="nf">cross_reference</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">model</span><span class="p">:</span> <span class="n">BDF</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Cross links the card so referenced cards can be extracted directly</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        model : BDF()</span>
<span class="sd">            the BDF object</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1">#if model.dtable is not None:</span>
            <span class="c1">#model.log.debug(model.dtable.rstrip())</span>
        <span class="n">msg</span> <span class="o">=</span> <span class="s1">&#39;, which is required by DRESP2 ID=</span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dresp_id</span><span class="p">)</span>
        <span class="n">default_values</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">params</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">vals</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="o">.</span><span class="n">items</span><span class="p">()):</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">unused_j</span><span class="p">,</span> <span class="n">name</span> <span class="o">=</span> <span class="n">key</span>
            <span class="k">except</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="p">))</span>
            <span class="c1">#print(j, name)</span>
            <span class="k">if</span> <span class="n">name</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;DRESP1&#39;</span><span class="p">,</span> <span class="s1">&#39;DRESP2&#39;</span><span class="p">]:</span>
                <span class="n">params</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
                <span class="k">for</span> <span class="n">unused_i</span><span class="p">,</span> <span class="n">val</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">vals</span><span class="p">):</span>
                    <span class="n">params</span><span class="p">[</span><span class="n">key</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">DResp</span><span class="p">(</span><span class="n">val</span><span class="p">,</span> <span class="n">msg</span><span class="p">))</span>
            <span class="k">elif</span> <span class="n">name</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;DVCREL1&#39;</span><span class="p">,</span> <span class="s1">&#39;DVCREL2&#39;</span><span class="p">]:</span>
                <span class="n">params</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
                <span class="k">for</span> <span class="n">val</span> <span class="ow">in</span> <span class="n">vals</span><span class="p">:</span>
                    <span class="n">params</span><span class="p">[</span><span class="n">key</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">DVcrel</span><span class="p">(</span><span class="n">val</span><span class="p">,</span> <span class="n">msg</span><span class="p">))</span>
            <span class="k">elif</span> <span class="n">name</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;DVMREL1&#39;</span><span class="p">,</span> <span class="s1">&#39;DVMREL2&#39;</span><span class="p">]:</span>
                <span class="n">params</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
                <span class="k">for</span> <span class="n">unused_i</span><span class="p">,</span> <span class="n">val</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">vals</span><span class="p">):</span>
                    <span class="n">params</span><span class="p">[</span><span class="n">key</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">DVmrel</span><span class="p">(</span><span class="n">val</span><span class="p">,</span> <span class="n">msg</span><span class="p">))</span>
            <span class="k">elif</span> <span class="n">name</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;DVPREL1&#39;</span><span class="p">,</span> <span class="s1">&#39;DVPREL2&#39;</span><span class="p">]:</span>
                <span class="n">params</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
                <span class="k">for</span> <span class="n">unused_i</span><span class="p">,</span> <span class="n">val</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">vals</span><span class="p">):</span>
                    <span class="n">params</span><span class="p">[</span><span class="n">key</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">DVprel</span><span class="p">(</span><span class="n">val</span><span class="p">,</span> <span class="n">msg</span><span class="p">))</span>
            <span class="k">elif</span> <span class="n">name</span> <span class="o">==</span> <span class="s1">&#39;DESVAR&#39;</span><span class="p">:</span>
                <span class="n">params</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
                <span class="k">for</span> <span class="n">unused_i</span><span class="p">,</span> <span class="n">val</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">vals</span><span class="p">):</span>
                    <span class="n">params</span><span class="p">[</span><span class="n">key</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">Desvar</span><span class="p">(</span><span class="n">val</span><span class="p">,</span> <span class="n">msg</span><span class="p">))</span>
            <span class="k">elif</span> <span class="n">name</span> <span class="o">==</span> <span class="s1">&#39;DTABLE&#39;</span><span class="p">:</span>
                <span class="c1">#model.log.info(&#39;bdf_filename = %s&#39; % model.bdf_filename)</span>
                <span class="c1">#model.log.info(&#39;\n&#39; + model.dtable.rstrip())</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">dtable_ref</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">dtable</span>
                <span class="c1">#print(&#39;dtable =&#39;, self.dtable)</span>
                <span class="k">for</span> <span class="n">unused_i</span><span class="p">,</span> <span class="n">val</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">vals</span><span class="p">):</span>
                    <span class="n">default_values</span><span class="p">[</span><span class="n">val</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dtable_ref</span><span class="p">[</span><span class="n">val</span><span class="p">]</span>
            <span class="k">elif</span> <span class="n">name</span> <span class="o">==</span> <span class="s1">&#39;DNODE&#39;</span><span class="p">:</span>
                <span class="n">params</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="p">[[],</span> <span class="p">[]]</span>
                <span class="n">node_vals</span><span class="p">,</span> <span class="n">component_vals</span> <span class="o">=</span> <span class="n">vals</span>
                <span class="k">for</span> <span class="n">nid</span> <span class="ow">in</span> <span class="n">node_vals</span><span class="p">:</span>
                    <span class="n">params</span><span class="p">[</span><span class="n">key</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">Node</span><span class="p">(</span><span class="n">nid</span><span class="p">,</span> <span class="n">msg</span><span class="p">))</span>
                <span class="n">params</span><span class="p">[</span><span class="n">key</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">component_vals</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="s1">&#39;  TODO: xref </span><span class="si">%s</span><span class="se">\n</span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">key</span><span class="p">),</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="p">)))</span>

        <span class="c1"># what does this do???</span>
        <span class="c1">#for key, value_list in sorted(self.params.items()):</span>
            <span class="c1">#j, name = key</span>
            <span class="c1">#values_list2 = self._get_values(name, value_list)</span>
            <span class="c1">#self.params[key] = values_list2</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">params_ref</span> <span class="o">=</span> <span class="n">params</span>

        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">DEquation</span><span class="p">(),</span> <span class="n">integer_types</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">dequation_ref</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">DEQATN</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dequation</span><span class="p">,</span> <span class="n">msg</span><span class="o">=</span><span class="n">msg</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">func</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dequation_ref</span><span class="o">.</span><span class="n">func</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dequation</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">func</span> <span class="o">=</span> <span class="n">fortran_to_python_short</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dequation</span><span class="p">,</span> <span class="n">default_values</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dequation</span><span class="p">)</span></div>

<div class="viewcode-block" id="DRESP2.safe_cross_reference"><a class="viewcode-back" href="../../../../reference/bdf/cards/pyNastran.bdf.cards.optimization.html#pyNastran.bdf.cards.optimization.DRESP2.safe_cross_reference">[docs]</a>    <span class="k">def</span> <span class="nf">safe_cross_reference</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">model</span><span class="p">,</span> <span class="n">xref_errors</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">cross_reference</span><span class="p">(</span><span class="n">model</span><span class="p">)</span></div>

<div class="viewcode-block" id="DRESP2.uncross_reference"><a class="viewcode-back" href="../../../../reference/bdf/cards/pyNastran.bdf.cards.optimization.html#pyNastran.bdf.cards.optimization.DRESP2.uncross_reference">[docs]</a>    <span class="k">def</span> <span class="nf">uncross_reference</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Removes cross-reference links&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;func&#39;</span><span class="p">):</span>
            <span class="k">del</span> <span class="bp">self</span><span class="o">.</span><span class="n">func</span>

        <span class="n">params</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value_list</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">params_ref</span><span class="o">.</span><span class="n">items</span><span class="p">()):</span>
            <span class="n">unused_j</span><span class="p">,</span> <span class="n">name</span> <span class="o">=</span> <span class="n">key</span>
            <span class="n">values_list2</span> <span class="o">=</span> <span class="n">_get_dresp23_table_values</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">value_list</span><span class="p">)</span>
            <span class="n">params</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">values_list2</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">params</span> <span class="o">=</span> <span class="n">params</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">params_ref</span> <span class="o">=</span> <span class="kc">None</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">dequation</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">DEquation</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dequation_ref</span> <span class="o">=</span> <span class="kc">None</span></div>

<div class="viewcode-block" id="DRESP2.DEquation"><a class="viewcode-back" href="../../../../reference/bdf/cards/pyNastran.bdf.cards.optimization.html#pyNastran.bdf.cards.optimization.DRESP2.DEquation">[docs]</a>    <span class="k">def</span> <span class="nf">DEquation</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">dequation_ref</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">dequation</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">dequation_ref</span><span class="o">.</span><span class="n">equation_id</span></div>

<div class="viewcode-block" id="DRESP2._pack_params"><a class="viewcode-back" href="../../../../reference/bdf/cards/pyNastran.bdf.cards.optimization.html#pyNastran.bdf.cards.optimization.DRESP2._pack_params">[docs]</a>    <span class="k">def</span> <span class="nf">_pack_params</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">params_ref</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_pack</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_pack</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">params_ref</span><span class="p">)</span></div>

<div class="viewcode-block" id="DRESP2._pack"><a class="viewcode-back" href="../../../../reference/bdf/cards/pyNastran.bdf.cards.optimization.html#pyNastran.bdf.cards.optimization.DRESP2._pack">[docs]</a>    <span class="k">def</span> <span class="nf">_pack</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">params</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;packs the params/params_ref into a form for output&quot;&quot;&quot;</span>
        <span class="c1"># # the amount of padding at the [beginning,end] of the 2nd line</span>
        <span class="n">pack_length</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;DESVAR&#39;</span> <span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
            <span class="s1">&#39;DTABLE&#39;</span> <span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
            <span class="s1">&#39;DFRFNC&#39;</span> <span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
            <span class="s1">&#39;DRESP1&#39;</span> <span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
            <span class="s1">&#39;DNODE&#39;</span> <span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>  <span class="c1"># unique entry</span>
            <span class="s1">&#39;DVPREL1&#39;</span> <span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
            <span class="s1">&#39;DVCREL1&#39;</span> <span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
            <span class="s1">&#39;DVMREL1&#39;</span> <span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
            <span class="s1">&#39;DVPREL2&#39;</span> <span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
            <span class="s1">&#39;DVCREL2&#39;</span> <span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
            <span class="s1">&#39;DVMREL2&#39;</span> <span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
            <span class="s1">&#39;DRESP2&#39;</span> <span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
        <span class="p">}</span>

        <span class="n">list_fields</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="p">(</span><span class="n">j</span><span class="p">,</span> <span class="n">name</span><span class="p">),</span> <span class="n">value_list</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">params</span><span class="o">.</span><span class="n">items</span><span class="p">()):</span>
            <span class="n">values_list2</span> <span class="o">=</span> <span class="n">_get_dresp23_table_values</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">value_list</span><span class="p">,</span> <span class="n">inline</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
            <span class="n">fields2</span> <span class="o">=</span> <span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">+</span> <span class="n">values_list2</span>
            <span class="c1">#try:</span>
            <span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">)</span> <span class="o">=</span> <span class="n">pack_length</span><span class="p">[</span><span class="n">name</span><span class="p">]</span>
            <span class="c1">#except KeyError:</span>
                <span class="c1">#msg = &#39;INVALID DRESP2 name=%r fields=%s ID=%s&#39; % (name, value_list, self.oid)</span>
                <span class="c1">#raise KeyError(msg)</span>
            <span class="n">list_fields</span> <span class="o">+=</span> <span class="n">build_table_lines</span><span class="p">(</span><span class="n">fields2</span><span class="p">,</span> <span class="n">nstart</span><span class="o">=</span><span class="n">i</span><span class="p">,</span> <span class="n">nend</span><span class="o">=</span><span class="n">j</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">list_fields</span></div>

<div class="viewcode-block" id="DRESP2.raw_fields"><a class="viewcode-back" href="../../../../reference/bdf/cards/pyNastran.bdf.cards.optimization.html#pyNastran.bdf.cards.optimization.DRESP2.raw_fields">[docs]</a>    <span class="k">def</span> <span class="nf">raw_fields</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">list_fields</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;DRESP2&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">dresp_id</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">label</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">DEquation</span><span class="p">(),</span>
                       <span class="bp">self</span><span class="o">.</span><span class="n">region</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">method</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">c1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">c2</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">c3</span><span class="p">]</span>
        <span class="n">list_fields</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_pack_params</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">list_fields</span></div>

<div class="viewcode-block" id="DRESP2.repr_fields"><a class="viewcode-back" href="../../../../reference/bdf/cards/pyNastran.bdf.cards.optimization.html#pyNastran.bdf.cards.optimization.DRESP2.repr_fields">[docs]</a>    <span class="k">def</span> <span class="nf">repr_fields</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">method</span> <span class="o">=</span> <span class="n">set_blank_if_default</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">method</span><span class="p">,</span> <span class="s1">&#39;MIN&#39;</span><span class="p">)</span>
        <span class="n">c1</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="n">c2</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="n">c3</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">method</span> <span class="o">==</span> <span class="s1">&#39;BETA&#39;</span><span class="p">:</span>
            <span class="k">if</span> <span class="s1">&#39;BETA&#39;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">func</span> <span class="ow">or</span> <span class="s1">&#39;MATCH&#39;</span> <span class="ow">in</span>  <span class="bp">self</span><span class="o">.</span><span class="n">func</span><span class="p">:</span>
                <span class="c1"># MSC 2005   Defaults: C1=100., C2=.005)</span>
                <span class="c1"># MSC 2016.1 Defaults: C1=1., C2=.005, C3=10.)</span>
                <span class="n">c1</span> <span class="o">=</span> <span class="n">set_blank_if_default</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">c1</span><span class="p">,</span> <span class="mf">100.</span><span class="p">)</span>
                <span class="n">c2</span> <span class="o">=</span> <span class="n">set_blank_if_default</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">c2</span><span class="p">,</span> <span class="mf">0.005</span><span class="p">)</span>
                <span class="n">c3</span> <span class="o">=</span> <span class="n">set_blank_if_default</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">c3</span><span class="p">,</span> <span class="mf">10.</span><span class="p">)</span>

        <span class="n">list_fields</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;DRESP2&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">dresp_id</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">label</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">DEquation</span><span class="p">(),</span>
                       <span class="bp">self</span><span class="o">.</span><span class="n">region</span><span class="p">,</span> <span class="n">method</span><span class="p">,</span> <span class="n">c1</span><span class="p">,</span> <span class="n">c2</span><span class="p">,</span> <span class="n">c3</span><span class="p">]</span>
        <span class="n">list_fields</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_pack_params</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">list_fields</span></div>

<div class="viewcode-block" id="DRESP2.write_card"><a class="viewcode-back" href="../../../../reference/bdf/cards/pyNastran.bdf.cards.optimization.html#pyNastran.bdf.cards.optimization.DRESP2.write_card">[docs]</a>    <span class="k">def</span> <span class="nf">write_card</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">size</span><span class="p">:</span> <span class="nb">int</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span> <span class="n">is_double</span><span class="p">:</span> <span class="nb">bool</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="n">card</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">repr_fields</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">size</span> <span class="o">==</span> <span class="mi">8</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">comment</span> <span class="o">+</span> <span class="n">print_card_8</span><span class="p">(</span><span class="n">card</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">is_double</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">comment</span> <span class="o">+</span> <span class="n">print_card_double</span><span class="p">(</span><span class="n">card</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">comment</span> <span class="o">+</span> <span class="n">print_card_16</span><span class="p">(</span><span class="n">card</span><span class="p">)</span></div></div>


<div class="viewcode-block" id="DRESP3"><a class="viewcode-back" href="../../../../reference/bdf/cards/pyNastran.bdf.cards.optimization.html#pyNastran.bdf.cards.optimization.DRESP3">[docs]</a><span class="k">class</span> <span class="nc">DRESP3</span><span class="p">(</span><span class="n">OptConstraint</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    +--------+---------+--------+--------+--------+--------+--------+--------+--------+</span>
<span class="sd">    |   1    |    2    |    3   |   4    |    5   |    6   |    7   |    8   |    9   |</span>
<span class="sd">    +========+=========+========+========+========+========+========+========+========+</span>
<span class="sd">    | DRESP3 |   ID    |  LABEL | GROUP  |  TYPE  | REGION |        |        |        |</span>
<span class="sd">    +--------+---------+--------+--------+--------+--------+--------+--------+--------+</span>
<span class="sd">    |        | DESVAR  | DVID1  | DVID2  |  DVID3 |  DVID4 |  DVID5 |  DVID6 |  DVID7 |</span>
<span class="sd">    +--------+---------+--------+--------+--------+--------+--------+--------+--------+</span>
<span class="sd">    |        |         | DVID8  |  etc.  |        |        |        |        |        |</span>
<span class="sd">    +--------+---------+--------+--------+--------+--------+--------+--------+--------+</span>
<span class="sd">    |        | DTABLE  | LABL1  |  LABL2 |  LABL3 |  LABL4 |  LABL5 |  LABL6 |  LABL7 |</span>
<span class="sd">    +--------+---------+--------+--------+--------+--------+--------+--------+--------+</span>
<span class="sd">    |        |         | LABL8  |  etc.  |        |        |        |        |        |</span>
<span class="sd">    +--------+---------+--------+--------+--------+--------+--------+--------+--------+</span>
<span class="sd">    |        | DRESP1  |  NR1   |  NR2   |   NR3  |   NR4  |   NR5  |   NR6  |  NR7   |</span>
<span class="sd">    +--------+---------+--------+--------+--------+--------+--------+--------+--------+</span>
<span class="sd">    |        |         |  NR8   | etc.   |        |        |        |        |        |</span>
<span class="sd">    +--------+---------+--------+--------+--------+--------+--------+--------+--------+</span>
<span class="sd">    |        | DNODE   |   G1   |   C1   |   G2   |   C2   |   G3   |   C3   |        |</span>
<span class="sd">    +--------+---------+--------+--------+--------+--------+--------+--------+--------+</span>
<span class="sd">    |        |         |   G4   |   C4   |  etc.  |        |        |        |        |</span>
<span class="sd">    +--------+---------+--------+--------+--------+--------+--------+--------+--------+</span>
<span class="sd">    |        | DVPREL1 | DPIP1  | DPIP2  | DPIP3  | DPIP4  | DPIP5  | DPIP6  | DPIP7  |</span>
<span class="sd">    +--------+---------+--------+--------+--------+--------+--------+--------+--------+</span>
<span class="sd">    |        |         | DPIP8  | DPIP9  |  etc.  |        |        |        |        |</span>
<span class="sd">    +--------+---------+--------+--------+--------+--------+--------+--------+--------+</span>
<span class="sd">    |        | DVCREL1 | DCIC1  | DCIC2  | DCIC3  | DCIC4  | DCIC5  | DCIC6  | DCIC7  |</span>
<span class="sd">    +--------+---------+--------+--------+--------+--------+--------+--------+--------+</span>
<span class="sd">    |        |         | DCIC8  | DCIC9  |  etc.  |        |        |        |        |</span>
<span class="sd">    +--------+---------+--------+--------+--------+--------+--------+--------+--------+</span>
<span class="sd">    |        | DVMREL1 | DMIM1  | DMIM2  | DMIM3  | DMIM4  | DMIM5  | DMIM6  | DMIM7  |</span>
<span class="sd">    +--------+---------+--------+--------+--------+--------+--------+--------+--------+</span>
<span class="sd">    |        |         | DMIM8  | DMIM9  |  etc.  |        |        |        |        |</span>
<span class="sd">    +--------+---------+--------+--------+--------+--------+--------+--------+--------+</span>
<span class="sd">    |        | DVPREL2 | DPI2P1 | DPI2P2 | DPI2P3 | DPI2P4 | DPI2P5 | DPI2P6 | DPI2P7 |</span>
<span class="sd">    +--------+---------+--------+--------+--------+--------+--------+--------+--------+</span>
<span class="sd">    |        |         | DPI2P8 | DPI2P9 |  etc.  |        |        |        |        |</span>
<span class="sd">    +--------+---------+--------+--------+--------+--------+--------+--------+--------+</span>
<span class="sd">    |        | DVCREL2 | DCI2C1 | DCI2C2 | DCI2C3 | DCI2C4 | DCI2C5 | DCI2C6 | DCI2C7 |</span>
<span class="sd">    +--------+---------+--------+--------+--------+--------+--------+--------+--------+</span>
<span class="sd">    |        |         | DCI2C8 | DCI2C9 |   etc. |        |        |        |        |</span>
<span class="sd">    +--------+---------+--------+--------+--------+--------+--------+--------+--------+</span>
<span class="sd">    |        | DVMREL2 | DMI2M1 | DMI2M2 | DMI2M3 | DMI2M4 | DMI2M5 | DMI2M6 | DMI2M7 |</span>
<span class="sd">    +--------+---------+--------+--------+--------+--------+--------+--------+--------+</span>
<span class="sd">    |        |         | DMI2M8 | DMI2M9 |   etc. |        |        |        |        |</span>
<span class="sd">    +--------+---------+--------+--------+--------+--------+--------+--------+--------+</span>
<span class="sd">    |        | DRESP2  | NRR1   | NRR2   |  NRR3  |  NRR4  |  NRR5  |  NRR6  |  NRR7  |</span>
<span class="sd">    +--------+---------+--------+--------+--------+--------+--------+--------+--------+</span>
<span class="sd">    |        |         | NRR8   | etc.   |        |        |        |        |        |</span>
<span class="sd">    +--------+---------+--------+--------+--------+--------+--------+--------+--------+</span>
<span class="sd">    |        | DVLREL1 | DLIL1  | DLIL2  |  DLIL3 |  DLIL4 |  DLIL5 |  DLIL6 |  DLIL7 |</span>
<span class="sd">    +--------+---------+--------+--------+--------+--------+--------+--------+--------+</span>
<span class="sd">    |        |         | DLIL8  | etc.   |        |        |        |        |        |</span>
<span class="sd">    +--------+---------+--------+--------+--------+--------+--------+--------+--------+</span>
<span class="sd">    |        | USRDATA | String                                                       |</span>
<span class="sd">    +--------+---------+--------------------------------------------------------------+</span>
<span class="sd">    |        |         | etc.                                                         |</span>
<span class="sd">    +--------+---------+--------------------------------------------------------------+</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="nb">type</span> <span class="o">=</span> <span class="s1">&#39;DRESP3&#39;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dresp_id</span><span class="p">,</span> <span class="n">label</span><span class="p">,</span> <span class="n">group</span><span class="p">,</span> <span class="n">Type</span><span class="p">,</span> <span class="n">region</span><span class="p">,</span> <span class="n">params</span><span class="p">,</span>
                 <span class="n">validate</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">comment</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Creates a DRESP3 card.</span>

<span class="sd">        A DRESP3 is used to define a &quot;complex&quot; output result that may be</span>
<span class="sd">        optimized on.  A complex result is a result that uses:</span>
<span class="sd">          - simple (DRESP1) results</span>
<span class="sd">          - complex (DRESP2) results</span>
<span class="sd">          - default values (DTABLE)</span>
<span class="sd">          - DVCRELx values</span>
<span class="sd">          - DVMRELx values</span>
<span class="sd">          - DVPRELx values</span>
<span class="sd">          - DESVAR values</span>
<span class="sd">          - DNODE values</span>
<span class="sd">          - DVLREL1 values</span>
<span class="sd">          - USRDATA</span>
<span class="sd">        Then, an secondary code (USRDATA) is used to formulate an output response.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        dresp_id : int</span>
<span class="sd">            response id</span>
<span class="sd">        label : str</span>
<span class="sd">            Name of the response</span>
<span class="sd">        group : str</span>
<span class="sd">            Selects a specific external response routine</span>
<span class="sd">        Type : str</span>
<span class="sd">            Refers to a specific user-created response calculation type</span>
<span class="sd">            in the external function evaluator</span>
<span class="sd">        region : str</span>
<span class="sd">            Region identifier for constraint screening</span>
<span class="sd">        params : dict[(index, card_type)] = values</span>
<span class="sd">            the storage table for the response function</span>
<span class="sd">            index : int</span>
<span class="sd">                a counter</span>
<span class="sd">            card_type : str</span>
<span class="sd">                the type of card to pull from</span>
<span class="sd">                DESVAR, DVPREL1, DRESP2, etc.</span>
<span class="sd">            values : List[int]</span>
<span class="sd">                the values for this response</span>
<span class="sd">        comment : str; default=&#39;&#39;</span>
<span class="sd">            a comment for the card</span>
<span class="sd">        validate : bool; default=False</span>
<span class="sd">            should the card be validated when it&#39;s created</span>

<span class="sd">        params = {</span>
<span class="sd">           (0, &#39;DRESP1&#39;) = [10, 20],</span>
<span class="sd">           (1, &#39;DESVAR&#39;) = [30],</span>
<span class="sd">           (2, &#39;DRESP1&#39;) = [40],</span>
<span class="sd">        }</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">OptConstraint</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">comment</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">comment</span> <span class="o">=</span> <span class="n">comment</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dresp_id</span> <span class="o">=</span> <span class="n">dresp_id</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">label</span> <span class="o">=</span> <span class="n">label</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">group</span> <span class="o">=</span> <span class="n">group</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Type</span> <span class="o">=</span> <span class="n">Type</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">region</span> <span class="o">=</span> <span class="n">region</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">params</span> <span class="o">=</span> <span class="n">params</span>
        <span class="k">if</span> <span class="n">validate</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_validate</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">params_ref</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dtable_ref</span> <span class="o">=</span> <span class="p">{}</span>

<div class="viewcode-block" id="DRESP3.export_to_hdf5"><a class="viewcode-back" href="../../../../reference/bdf/cards/pyNastran.bdf.cards.optimization.html#pyNastran.bdf.cards.optimization.DRESP3.export_to_hdf5">[docs]</a>    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">export_to_hdf5</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">h5_file</span><span class="p">,</span> <span class="n">model</span><span class="p">,</span> <span class="n">encoding</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;exports the dresps in a vectorized way&quot;&quot;&quot;</span>
        <span class="n">_export_dresps_to_hdf5</span><span class="p">(</span><span class="n">h5_file</span><span class="p">,</span> <span class="n">model</span><span class="p">,</span> <span class="n">encoding</span><span class="p">)</span></div>

<div class="viewcode-block" id="DRESP3._validate"><a class="viewcode-back" href="../../../../reference/bdf/cards/pyNastran.bdf.cards.optimization.html#pyNastran.bdf.cards.optimization.DRESP3._validate">[docs]</a>    <span class="k">def</span> <span class="nf">_validate</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="p">,</span> <span class="nb">dict</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">params</span>
        <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">group</span><span class="p">,</span> <span class="nb">str</span><span class="p">),</span> <span class="s1">&#39;group=</span><span class="si">%r</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">group</span>
        <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Type</span><span class="p">,</span> <span class="nb">str</span><span class="p">),</span> <span class="s1">&#39;Type=</span><span class="si">%r</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">Type</span>

        <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">values</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">),</span> <span class="s1">&#39;key=</span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="nb">str</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
            <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">key</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;key=</span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="nb">str</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
            <span class="n">iorder</span><span class="p">,</span> <span class="n">name</span> <span class="o">=</span> <span class="n">key</span>
            <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">iorder</span><span class="p">,</span> <span class="nb">int</span><span class="p">),</span> <span class="s1">&#39;iorder=</span><span class="si">%s</span><span class="s1"> key=</span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">iorder</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">key</span><span class="p">))</span>
            <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="nb">str</span><span class="p">),</span> <span class="s1">&#39;name=</span><span class="si">%r</span><span class="s1"> key=</span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">key</span><span class="p">))</span>
            <span class="k">if</span> <span class="n">name</span> <span class="o">==</span> <span class="s1">&#39;DNODE&#39;</span><span class="p">:</span>
                <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">values</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;name=</span><span class="si">%r</span><span class="s1"> must be a tuple of length 2 (nids, components); values=</span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">values</span><span class="p">)</span>
                <span class="n">nids</span><span class="p">,</span> <span class="n">components</span> <span class="o">=</span> <span class="n">values</span>
                <span class="k">for</span> <span class="n">nid</span> <span class="ow">in</span> <span class="n">nids</span><span class="p">:</span>
                    <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">nid</span><span class="p">,</span> <span class="nb">int</span><span class="p">),</span> <span class="s1">&#39;name=</span><span class="si">%r</span><span class="s1"> nid=</span><span class="si">%r</span><span class="s1"> is not an int; values=</span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">nid</span><span class="p">,</span> <span class="n">values</span><span class="p">)</span>
                <span class="k">for</span> <span class="n">comp</span> <span class="ow">in</span> <span class="n">components</span><span class="p">:</span>
                    <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">comp</span><span class="p">,</span> <span class="nb">int</span><span class="p">),</span> <span class="s1">&#39;name=</span><span class="si">%r</span><span class="s1"> comp=</span><span class="si">%r</span><span class="s1"> is not an int; values=</span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">comp</span><span class="p">,</span> <span class="n">values</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">val</span> <span class="ow">in</span> <span class="n">values</span><span class="p">:</span>
                    <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">val</span><span class="p">,</span> <span class="nb">int</span><span class="p">),</span> <span class="s1">&#39;name=</span><span class="si">%r</span><span class="s1"> val=</span><span class="si">%r</span><span class="s1"> is not an int; values=</span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">val</span><span class="p">,</span> <span class="n">values</span><span class="p">)</span></div>

<div class="viewcode-block" id="DRESP3.add_card"><a class="viewcode-back" href="../../../../reference/bdf/cards/pyNastran.bdf.cards.optimization.html#pyNastran.bdf.cards.optimization.DRESP3.add_card">[docs]</a>    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">add_card</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">card</span><span class="p">,</span> <span class="n">comment</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Adds a DRESP3 card from ``BDF.add_card(...)``</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        card : BDFCard()</span>
<span class="sd">            a BDFCard object</span>
<span class="sd">        comment : str; default=&#39;&#39;</span>
<span class="sd">            a comment for the card</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">dresp_id</span> <span class="o">=</span> <span class="n">integer</span><span class="p">(</span><span class="n">card</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;dresp_id&#39;</span><span class="p">)</span>
        <span class="n">label</span> <span class="o">=</span> <span class="n">string</span><span class="p">(</span><span class="n">card</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;label&#39;</span><span class="p">)</span>
        <span class="n">group</span> <span class="o">=</span> <span class="n">string</span><span class="p">(</span><span class="n">card</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="s1">&#39;group&#39;</span><span class="p">)</span>
        <span class="n">Type</span> <span class="o">=</span> <span class="n">string</span><span class="p">(</span><span class="n">card</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="s1">&#39;Type&#39;</span><span class="p">)</span>
        <span class="n">region</span> <span class="o">=</span> <span class="n">integer_or_blank</span><span class="p">(</span><span class="n">card</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="s1">&#39;region&#39;</span><span class="p">)</span>

        <span class="n">list_fields</span> <span class="o">=</span> <span class="p">[</span><span class="n">interpret_value</span><span class="p">(</span><span class="n">field</span><span class="p">)</span> <span class="k">for</span> <span class="n">field</span> <span class="ow">in</span> <span class="n">card</span><span class="p">[</span><span class="mi">9</span><span class="p">:]]</span>
        <span class="c1"># DRESP3, dresp_id,</span>
        <span class="c1">#         DRESP1, 10, 20</span>
        <span class="c1">#         DESVAR, 30</span>
        <span class="c1">#         DRESP1, 40</span>
        <span class="c1"># params = {</span>
        <span class="c1">#    (0, &#39;DRESP1&#39;) = [10, 20],</span>
        <span class="c1">#    (1, &#39;DESVAR&#39;) = [30],</span>
        <span class="c1">#    (2, &#39;DRESP1&#39;) = [40],</span>
        <span class="c1"># }</span>
        <span class="n">params</span> <span class="o">=</span> <span class="n">parse_table_fields</span><span class="p">(</span><span class="s1">&#39;DRESP3&#39;</span><span class="p">,</span> <span class="n">card</span><span class="p">,</span> <span class="n">list_fields</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">DRESP3</span><span class="p">(</span><span class="n">dresp_id</span><span class="p">,</span> <span class="n">label</span><span class="p">,</span> <span class="n">group</span><span class="p">,</span> <span class="n">Type</span><span class="p">,</span> <span class="n">region</span><span class="p">,</span> <span class="n">params</span><span class="p">,</span>
                      <span class="n">comment</span><span class="o">=</span><span class="n">comment</span><span class="p">)</span></div>

<div class="viewcode-block" id="DRESP3._pack_params"><a class="viewcode-back" href="../../../../reference/bdf/cards/pyNastran.bdf.cards.optimization.html#pyNastran.bdf.cards.optimization.DRESP3._pack_params">[docs]</a>    <span class="k">def</span> <span class="nf">_pack_params</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">params_ref</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_pack</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_pack</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">params_ref</span><span class="p">)</span></div>

<div class="viewcode-block" id="DRESP3._pack"><a class="viewcode-back" href="../../../../reference/bdf/cards/pyNastran.bdf.cards.optimization.html#pyNastran.bdf.cards.optimization.DRESP3._pack">[docs]</a>    <span class="k">def</span> <span class="nf">_pack</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">params</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;packs the params/params_ref into a form for output&quot;&quot;&quot;</span>
        <span class="c1"># # the amount of padding at the [beginning,end] of the 2nd line</span>
        <span class="n">pack_length</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;DESVAR&#39;</span> <span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
            <span class="s1">&#39;DTABLE&#39;</span> <span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
            <span class="s1">&#39;DFRFNC&#39;</span> <span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
            <span class="s1">&#39;DRESP1&#39;</span> <span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
            <span class="s1">&#39;DNODE&#39;</span> <span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>  <span class="c1"># unique entry</span>
            <span class="s1">&#39;DVPREL1&#39;</span> <span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
            <span class="s1">&#39;DVCREL1&#39;</span> <span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
            <span class="s1">&#39;DVMREL1&#39;</span> <span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
            <span class="s1">&#39;DVPREL2&#39;</span> <span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
            <span class="s1">&#39;DVCREL2&#39;</span> <span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
            <span class="s1">&#39;DVMREL2&#39;</span> <span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
            <span class="s1">&#39;DRESP2&#39;</span> <span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
            <span class="s1">&#39;USRDATA&#39;</span> <span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
        <span class="p">}</span>
        <span class="c1">#print(&#39;------------&#39;)</span>
        <span class="n">list_fields</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value_list</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">params</span><span class="o">.</span><span class="n">items</span><span class="p">()):</span>
            <span class="c1">#print(params[key])</span>
            <span class="n">unused_iorder</span><span class="p">,</span> <span class="n">name</span> <span class="o">=</span> <span class="n">key</span>
            <span class="n">values_list2</span> <span class="o">=</span> <span class="n">_get_dresp23_table_values</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">value_list</span><span class="p">,</span> <span class="n">inline</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
            <span class="n">fields2</span> <span class="o">=</span> <span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">+</span> <span class="n">values_list2</span>

            <span class="k">try</span><span class="p">:</span>
                <span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">)</span> <span class="o">=</span> <span class="n">pack_length</span><span class="p">[</span><span class="n">name</span><span class="p">]</span>
            <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
                <span class="n">msg</span> <span class="o">=</span> <span class="s1">&#39;INVALID DRESP3 key=</span><span class="si">%r</span><span class="s1"> fields=</span><span class="si">%s</span><span class="s1"> ID=</span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">value_list</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">dresp_id</span><span class="p">)</span>
                <span class="k">raise</span> <span class="ne">KeyError</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
            <span class="n">list_fields</span> <span class="o">+=</span> <span class="n">build_table_lines</span><span class="p">(</span><span class="n">fields2</span><span class="p">,</span> <span class="n">nstart</span><span class="o">=</span><span class="n">i</span><span class="p">,</span> <span class="n">nend</span><span class="o">=</span><span class="n">j</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">list_fields</span></div>

<div class="viewcode-block" id="DRESP3.safe_cross_reference"><a class="viewcode-back" href="../../../../reference/bdf/cards/pyNastran.bdf.cards.optimization.html#pyNastran.bdf.cards.optimization.DRESP3.safe_cross_reference">[docs]</a>    <span class="k">def</span> <span class="nf">safe_cross_reference</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">model</span><span class="p">,</span> <span class="n">xref_errors</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">cross_reference</span><span class="p">(</span><span class="n">model</span><span class="p">)</span></div>

<div class="viewcode-block" id="DRESP3.cross_reference"><a class="viewcode-back" href="../../../../reference/bdf/cards/pyNastran.bdf.cards.optimization.html#pyNastran.bdf.cards.optimization.DRESP3.cross_reference">[docs]</a>    <span class="k">def</span> <span class="nf">cross_reference</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">model</span><span class="p">:</span> <span class="n">BDF</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Cross links the card so referenced cards can be extracted directly</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        model : BDF()</span>
<span class="sd">            the BDF object</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">msg</span> <span class="o">=</span> <span class="s1">&#39;, which is required by DRESP3 ID=</span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dresp_id</span><span class="p">)</span>
        <span class="n">default_values</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">params</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">vals</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="o">.</span><span class="n">items</span><span class="p">()):</span>
            <span class="n">unused_iorder</span><span class="p">,</span> <span class="n">name</span> <span class="o">=</span> <span class="n">key</span>
            <span class="k">if</span> <span class="n">name</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;DRESP1&#39;</span><span class="p">,</span> <span class="s1">&#39;DRESP2&#39;</span><span class="p">]:</span>
                <span class="n">params</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
                <span class="k">for</span> <span class="n">val</span> <span class="ow">in</span> <span class="n">vals</span><span class="p">:</span>
                    <span class="n">params</span><span class="p">[</span><span class="n">key</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">DResp</span><span class="p">(</span><span class="n">val</span><span class="p">,</span> <span class="n">msg</span><span class="p">))</span>
            <span class="k">elif</span> <span class="n">name</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;DVCREL1&#39;</span><span class="p">,</span> <span class="s1">&#39;DVCREL2&#39;</span><span class="p">]:</span>
                <span class="n">params</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
                <span class="k">for</span> <span class="n">val</span> <span class="ow">in</span> <span class="n">vals</span><span class="p">:</span>
                    <span class="n">params</span><span class="p">[</span><span class="n">key</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">DVcrel</span><span class="p">(</span><span class="n">val</span><span class="p">,</span> <span class="n">msg</span><span class="p">))</span>
            <span class="k">elif</span> <span class="n">name</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;DVMREL1&#39;</span><span class="p">,</span> <span class="s1">&#39;DVMREL2&#39;</span><span class="p">]:</span>
                <span class="n">params</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
                <span class="k">for</span> <span class="n">val</span> <span class="ow">in</span> <span class="n">vals</span><span class="p">:</span>
                    <span class="n">params</span><span class="p">[</span><span class="n">key</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">DVmrel</span><span class="p">(</span><span class="n">val</span><span class="p">,</span> <span class="n">msg</span><span class="p">))</span>
            <span class="k">elif</span> <span class="n">name</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;DVPREL1&#39;</span><span class="p">,</span> <span class="s1">&#39;DVPREL2&#39;</span><span class="p">]:</span>
                <span class="n">params</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
                <span class="k">for</span> <span class="n">val</span> <span class="ow">in</span> <span class="n">vals</span><span class="p">:</span>
                    <span class="n">params</span><span class="p">[</span><span class="n">key</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">DVprel</span><span class="p">(</span><span class="n">val</span><span class="p">,</span> <span class="n">msg</span><span class="p">))</span>
            <span class="k">elif</span> <span class="n">name</span> <span class="o">==</span> <span class="s1">&#39;DESVAR&#39;</span><span class="p">:</span>
                <span class="n">params</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
                <span class="k">for</span> <span class="n">val</span> <span class="ow">in</span> <span class="n">vals</span><span class="p">:</span>
                    <span class="n">params</span><span class="p">[</span><span class="n">key</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">Desvar</span><span class="p">(</span><span class="n">val</span><span class="p">,</span> <span class="n">msg</span><span class="p">))</span>
            <span class="k">elif</span> <span class="n">name</span> <span class="o">==</span> <span class="s1">&#39;DTABLE&#39;</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">dtable_ref</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">dtable</span>
                <span class="k">for</span> <span class="n">val</span> <span class="ow">in</span> <span class="n">vals</span><span class="p">:</span>
                    <span class="n">default_values</span><span class="p">[</span><span class="n">val</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dtable_ref</span><span class="p">[</span><span class="n">val</span><span class="p">]</span>
            <span class="k">elif</span> <span class="n">name</span> <span class="o">==</span> <span class="s1">&#39;DNODE&#39;</span><span class="p">:</span>
                <span class="n">params</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="p">[[],</span> <span class="p">[]]</span>
                <span class="n">node_vals</span><span class="p">,</span> <span class="n">component_vals</span> <span class="o">=</span> <span class="n">vals</span>
                <span class="k">for</span> <span class="n">nid</span> <span class="ow">in</span> <span class="n">node_vals</span><span class="p">:</span>
                    <span class="n">params</span><span class="p">[</span><span class="n">key</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">Node</span><span class="p">(</span><span class="n">nid</span><span class="p">,</span> <span class="n">msg</span><span class="p">))</span>
                <span class="n">params</span><span class="p">[</span><span class="n">key</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">component_vals</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="s1">&#39;  TODO: xref key=</span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="nb">str</span><span class="p">(</span><span class="n">key</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">params_ref</span> <span class="o">=</span> <span class="n">params</span></div>

        <span class="c1">#if isinstance(self.DEquation(), integer_types):</span>
            <span class="c1">#self.dequation = model.DEQATN(self.dequation, msg=msg)</span>
            <span class="c1">#self.dequation_ref = self.dequation</span>
            <span class="c1">#self.func = self.dequation_ref.func</span>
        <span class="c1">#elif isinstance(self.dequation, str):</span>
            <span class="c1">#self.func = fortran_to_python_short(self.dequation, default_values)</span>
        <span class="c1">#else:</span>
            <span class="c1">#raise NotImplementedError(self.dequation)</span>

<div class="viewcode-block" id="DRESP3.uncross_reference"><a class="viewcode-back" href="../../../../reference/bdf/cards/pyNastran.bdf.cards.optimization.html#pyNastran.bdf.cards.optimization.DRESP3.uncross_reference">[docs]</a>    <span class="k">def</span> <span class="nf">uncross_reference</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Removes cross-reference links&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;func&#39;</span><span class="p">):</span>
            <span class="k">del</span> <span class="bp">self</span><span class="o">.</span><span class="n">func</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dtable_ref</span> <span class="o">=</span> <span class="p">{}</span>

        <span class="n">params</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value_list</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">params_ref</span><span class="o">.</span><span class="n">items</span><span class="p">()):</span>
            <span class="n">unused_iorder</span><span class="p">,</span> <span class="n">name</span> <span class="o">=</span> <span class="n">key</span>
            <span class="c1">#print(key)</span>
            <span class="c1">#j, name = key</span>
            <span class="n">values_list2</span> <span class="o">=</span> <span class="n">_get_dresp23_table_values</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">value_list</span><span class="p">)</span>
            <span class="n">params</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">values_list2</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">params</span> <span class="o">=</span> <span class="n">params</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">params_ref</span> <span class="o">=</span> <span class="kc">None</span></div>

        <span class="c1">#self.dequation = self.DEquation()</span>
        <span class="c1">#if isinstance(self.dequation, integer_types):</span>
            <span class="c1">#del self.dequation_ref</span>

    <span class="k">def</span> <span class="nf">_verify</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">model</span><span class="p">,</span> <span class="n">xref</span><span class="p">):</span>
        <span class="k">pass</span>

<div class="viewcode-block" id="DRESP3.raw_fields"><a class="viewcode-back" href="../../../../reference/bdf/cards/pyNastran.bdf.cards.optimization.html#pyNastran.bdf.cards.optimization.DRESP3.raw_fields">[docs]</a>    <span class="k">def</span> <span class="nf">raw_fields</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">list_fields</span> <span class="o">=</span> <span class="p">[</span>
            <span class="s1">&#39;DRESP3&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">dresp_id</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">label</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">group</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">Type</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">region</span><span class="p">,</span>
            <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">]</span>
        <span class="n">list_fields</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_pack_params</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">list_fields</span></div>

<div class="viewcode-block" id="DRESP3.repr_fields"><a class="viewcode-back" href="../../../../reference/bdf/cards/pyNastran.bdf.cards.optimization.html#pyNastran.bdf.cards.optimization.DRESP3.repr_fields">[docs]</a>    <span class="k">def</span> <span class="nf">repr_fields</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">list_fields</span> <span class="o">=</span> <span class="p">[</span>
            <span class="s1">&#39;DRESP3&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">dresp_id</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">label</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">group</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">Type</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">region</span><span class="p">,</span>
            <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">]</span>
        <span class="n">list_fields</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_pack_params</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">list_fields</span></div>

<div class="viewcode-block" id="DRESP3.write_card"><a class="viewcode-back" href="../../../../reference/bdf/cards/pyNastran.bdf.cards.optimization.html#pyNastran.bdf.cards.optimization.DRESP3.write_card">[docs]</a>    <span class="k">def</span> <span class="nf">write_card</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">size</span><span class="p">:</span> <span class="nb">int</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span> <span class="n">is_double</span><span class="p">:</span> <span class="nb">bool</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="n">card</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">repr_fields</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">size</span> <span class="o">==</span> <span class="mi">8</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">comment</span> <span class="o">+</span> <span class="n">print_card_8</span><span class="p">(</span><span class="n">card</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">is_double</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">comment</span> <span class="o">+</span> <span class="n">print_card_double</span><span class="p">(</span><span class="n">card</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">comment</span> <span class="o">+</span> <span class="n">print_card_16</span><span class="p">(</span><span class="n">card</span><span class="p">)</span></div></div>


<div class="viewcode-block" id="DCONADD"><a class="viewcode-back" href="../../../../reference/bdf/cards/pyNastran.bdf.cards.optimization.html#pyNastran.bdf.cards.optimization.DCONADD">[docs]</a><span class="k">class</span> <span class="nc">DCONADD</span><span class="p">(</span><span class="n">OptConstraint</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    +---------+------+------+-----+-----+-----+-----+-----+-----+</span>
<span class="sd">    |    1    |   2  |   3  |  4  |  5  |  6  |  7  |  8  |  9  |</span>
<span class="sd">    +=========+======+======+=====+=====+=====+=====+=====+=====+</span>
<span class="sd">    | DCONADD | DCID |  DC1 | DC2 | DC3 | DC4 | DC5 | DC6 | DC7 |</span>
<span class="sd">    +---------+------+------+-----+-----+-----+-----+-----+-----+</span>
<span class="sd">    |         | DC8  | etc. |     |     |     |     |     |     |</span>
<span class="sd">    +---------+------+------+-----+-----+-----+-----+-----+-----+</span>
<span class="sd">    | DCONADD |  10  |   4  |  12 |     |     |     |     |     |</span>
<span class="sd">    +---------+------+------+-----+-----+-----+-----+-----+-----+</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="nb">type</span> <span class="o">=</span> <span class="s1">&#39;DCONADD&#39;</span>

<div class="viewcode-block" id="DCONADD._init_from_empty"><a class="viewcode-back" href="../../../../reference/bdf/cards/pyNastran.bdf.cards.optimization.html#pyNastran.bdf.cards.optimization.DCONADD._init_from_empty">[docs]</a>    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">_init_from_empty</span><span class="p">(</span><span class="bp">cls</span><span class="p">):</span>
        <span class="n">oid</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="n">dconstrs</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">]</span>
        <span class="k">return</span> <span class="n">DCONADD</span><span class="p">(</span><span class="n">oid</span><span class="p">,</span> <span class="n">dconstrs</span><span class="p">,</span> <span class="n">comment</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">)</span></div>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">oid</span><span class="p">,</span> <span class="n">dconstrs</span><span class="p">,</span> <span class="n">comment</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">):</span>
        <span class="n">OptConstraint</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">comment</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">comment</span> <span class="o">=</span> <span class="n">comment</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">oid</span> <span class="o">=</span> <span class="n">oid</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dconstrs</span> <span class="o">=</span> <span class="n">dconstrs</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dconstrs_ref</span> <span class="o">=</span> <span class="kc">None</span>

<div class="viewcode-block" id="DCONADD.export_to_hdf5"><a class="viewcode-back" href="../../../../reference/bdf/cards/pyNastran.bdf.cards.optimization.html#pyNastran.bdf.cards.optimization.DCONADD.export_to_hdf5">[docs]</a>    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">export_to_hdf5</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">hdf5_file</span><span class="p">,</span> <span class="n">dconadds</span><span class="p">,</span> <span class="n">encoding</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">dconadd</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">dconadds</span><span class="p">):</span>
            <span class="n">dconadd_group</span> <span class="o">=</span> <span class="n">hdf5_file</span><span class="o">.</span><span class="n">create_group</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">))</span>
            <span class="n">dconadd_group</span><span class="o">.</span><span class="n">create_dataset</span><span class="p">(</span><span class="s1">&#39;oid&#39;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">dconadd</span><span class="o">.</span><span class="n">oid</span><span class="p">)</span>
            <span class="n">dconadd_group</span><span class="o">.</span><span class="n">create_dataset</span><span class="p">(</span><span class="s1">&#39;dconstrs&#39;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">dconadd</span><span class="o">.</span><span class="n">dconstrs</span><span class="p">)</span></div>

<div class="viewcode-block" id="DCONADD.add_card"><a class="viewcode-back" href="../../../../reference/bdf/cards/pyNastran.bdf.cards.optimization.html#pyNastran.bdf.cards.optimization.DCONADD.add_card">[docs]</a>    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">add_card</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">card</span><span class="p">,</span> <span class="n">comment</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Adds a DCONADD card from ``BDF.add_card(...)``</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        card : BDFCard()</span>
<span class="sd">            a BDFCard object</span>
<span class="sd">        comment : str; default=&#39;&#39;</span>
<span class="sd">            a comment for the card</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">oid</span> <span class="o">=</span> <span class="n">integer</span><span class="p">(</span><span class="n">card</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;dcid&#39;</span><span class="p">)</span>
        <span class="n">dconstrs</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">card</span><span class="p">)):</span>
            <span class="n">dconstr</span> <span class="o">=</span> <span class="n">integer</span><span class="p">(</span><span class="n">card</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="s1">&#39;dconstr_</span><span class="si">%i</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">i</span><span class="p">)</span>
            <span class="n">dconstrs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">dconstr</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">DCONADD</span><span class="p">(</span><span class="n">oid</span><span class="p">,</span> <span class="n">dconstrs</span><span class="p">,</span> <span class="n">comment</span><span class="o">=</span><span class="n">comment</span><span class="p">)</span></div>

<div class="viewcode-block" id="DCONADD.cross_reference"><a class="viewcode-back" href="../../../../reference/bdf/cards/pyNastran.bdf.cards.optimization.html#pyNastran.bdf.cards.optimization.DCONADD.cross_reference">[docs]</a>    <span class="k">def</span> <span class="nf">cross_reference</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">model</span><span class="p">:</span> <span class="n">BDF</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Cross links the card so referenced cards can be extracted directly</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        model : BDF()</span>
<span class="sd">            the BDF object</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1">#msg = f&#39;which is required by DCONADD={self.oid} and must reference a DCONSTR&#39;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">dconstrs_ref</span> <span class="o">=</span> <span class="p">[</span><span class="n">model</span><span class="o">.</span><span class="n">dconstrs</span><span class="p">[</span><span class="n">oid</span><span class="p">]</span> <span class="k">for</span> <span class="n">oid</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">dconstr_ids</span><span class="p">]</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="n">dconstrs_actual</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">dconstrs</span><span class="o">.</span><span class="n">keys</span><span class="p">()))</span>
            <span class="n">dconstrs_missing_set</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dconstr_ids</span><span class="p">)</span> <span class="o">-</span> <span class="n">dconstrs_actual</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">dconstrs_missing_set</span><span class="p">):</span>
                <span class="k">raise</span> <span class="ne">KeyError</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;The following DCONSTRs are missing which are required by:</span><span class="se">\n</span><span class="si">{</span><span class="bp">self</span><span class="si">}</span><span class="s1">&#39;</span>
                               <span class="sa">f</span><span class="s1">&#39;DCONSTRs=</span><span class="si">{</span><span class="n">dconstrs_missing_set</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
            <span class="k">raise</span></div>

<div class="viewcode-block" id="DCONADD.uncross_reference"><a class="viewcode-back" href="../../../../reference/bdf/cards/pyNastran.bdf.cards.optimization.html#pyNastran.bdf.cards.optimization.DCONADD.uncross_reference">[docs]</a>    <span class="k">def</span> <span class="nf">uncross_reference</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Removes cross-reference links&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dconstrs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dconstr_ids</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dconstrs_ref</span> <span class="o">=</span> <span class="kc">None</span></div>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">dconstr_ids</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">ids</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">dconstr</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">dconstrs</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">dconstr</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
                <span class="k">for</span> <span class="n">dconstri</span> <span class="ow">in</span> <span class="n">dconstr</span><span class="p">:</span>
                    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">dconstri</span><span class="p">,</span> <span class="n">integer_types</span><span class="p">):</span>
                        <span class="n">ids</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">dconstri</span><span class="p">)</span>
                    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">dconstri</span><span class="p">,</span> <span class="n">DCONSTR</span><span class="p">):</span>
                        <span class="n">ids</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">dconstri</span><span class="o">.</span><span class="n">oid</span><span class="p">)</span>
                        <span class="k">break</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;type=</span><span class="si">%s</span><span class="s2">; dconstri=</span><span class="si">%s</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">dconstri</span><span class="p">),</span> <span class="n">dconstri</span><span class="p">))</span>
                        <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="n">dconstri</span><span class="p">)</span>
            <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">dconstr</span><span class="p">,</span> <span class="n">integer_types</span><span class="p">):</span>
                <span class="n">ids</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">dconstr</span><span class="p">)</span>
            <span class="c1">#elif isinstance(dconstr, DCONSTR):</span>
                <span class="c1">#ids.append(dconstr.oid)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;type=</span><span class="si">%s</span><span class="s2">; dconstr=</span><span class="si">%s</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">dconstr</span><span class="p">),</span> <span class="n">dconstr</span><span class="p">))</span>
                <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="n">dconstr</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">ids</span>
        <span class="c1">#return [dconstr if isinstance(dconstr, integer_types) else dconstr.oid</span>
                <span class="c1">#for dconstr in self.dconstrs]</span>

<div class="viewcode-block" id="DCONADD.raw_fields"><a class="viewcode-back" href="../../../../reference/bdf/cards/pyNastran.bdf.cards.optimization.html#pyNastran.bdf.cards.optimization.DCONADD.raw_fields">[docs]</a>    <span class="k">def</span> <span class="nf">raw_fields</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">list_fields</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;DCONADD&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">oid</span><span class="p">]</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">dconstr_ids</span>
        <span class="k">return</span> <span class="n">list_fields</span></div>

<div class="viewcode-block" id="DCONADD.write_card"><a class="viewcode-back" href="../../../../reference/bdf/cards/pyNastran.bdf.cards.optimization.html#pyNastran.bdf.cards.optimization.DCONADD.write_card">[docs]</a>    <span class="k">def</span> <span class="nf">write_card</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">size</span><span class="p">:</span> <span class="nb">int</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span> <span class="n">is_double</span><span class="p">:</span> <span class="nb">bool</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="n">card</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">repr_fields</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">size</span> <span class="o">==</span> <span class="mi">8</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">comment</span> <span class="o">+</span> <span class="n">print_card_8</span><span class="p">(</span><span class="n">card</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">is_double</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">comment</span> <span class="o">+</span> <span class="n">print_card_double</span><span class="p">(</span><span class="n">card</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">comment</span> <span class="o">+</span> <span class="n">print_card_16</span><span class="p">(</span><span class="n">card</span><span class="p">)</span></div></div>


<div class="viewcode-block" id="DSCREEN"><a class="viewcode-back" href="../../../../reference/bdf/cards/pyNastran.bdf.cards.optimization.html#pyNastran.bdf.cards.optimization.DSCREEN">[docs]</a><span class="k">class</span> <span class="nc">DSCREEN</span><span class="p">(</span><span class="n">OptConstraint</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    +---------+-------+-------+------+</span>
<span class="sd">    |    1    |   2   |   3   |   4  |</span>
<span class="sd">    +=========+=======+=======+======+</span>
<span class="sd">    | DSCREEN | RTYPE |  TRS  | NSTR |</span>
<span class="sd">    +---------+-------+-------+------+</span>
<span class="sd">    | DSCREEN |  DISP | -0.3  | NSTR |</span>
<span class="sd">    +---------+-------+-------+------+</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="nb">type</span> <span class="o">=</span> <span class="s1">&#39;DSCREEN&#39;</span>

<div class="viewcode-block" id="DSCREEN._init_from_empty"><a class="viewcode-back" href="../../../../reference/bdf/cards/pyNastran.bdf.cards.optimization.html#pyNastran.bdf.cards.optimization.DSCREEN._init_from_empty">[docs]</a>    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">_init_from_empty</span><span class="p">(</span><span class="bp">cls</span><span class="p">):</span>
        <span class="n">rtype</span> <span class="o">=</span> <span class="s1">&#39;DISP&#39;</span>
        <span class="k">return</span> <span class="n">DSCREEN</span><span class="p">(</span><span class="n">rtype</span><span class="p">,</span> <span class="n">trs</span><span class="o">=-</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">nstr</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">comment</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">)</span></div>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">rtype</span><span class="p">,</span> <span class="n">trs</span><span class="o">=-</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">nstr</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">comment</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Creates a DSCREEN object</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        rtype : str</span>
<span class="sd">            Response type for which the screening criteria apply</span>
<span class="sd">        trs : float; default=-0.5</span>
<span class="sd">            Truncation threshold</span>
<span class="sd">        nstr : int; default=20</span>
<span class="sd">            Maximum number of constraints to be retained per region per</span>
<span class="sd">            load case</span>
<span class="sd">        comment : str; default=&#39;&#39;</span>
<span class="sd">            a comment for the card</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">OptConstraint</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">comment</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">comment</span> <span class="o">=</span> <span class="n">comment</span>

        <span class="c1">#: Response type for which the screening criteria apply. (Character)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">rtype</span> <span class="o">=</span> <span class="n">rtype</span>
        <span class="c1">#: Truncation threshold. (Real; Default = -0.5)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">trs</span> <span class="o">=</span> <span class="n">trs</span>
        <span class="c1">#: Maximum number of constraints to be retained per region per load</span>
        <span class="c1">#: case. (Integer &gt; 0; Default = 20)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">nstr</span> <span class="o">=</span> <span class="n">nstr</span>

<div class="viewcode-block" id="DSCREEN.add_card"><a class="viewcode-back" href="../../../../reference/bdf/cards/pyNastran.bdf.cards.optimization.html#pyNastran.bdf.cards.optimization.DSCREEN.add_card">[docs]</a>    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">add_card</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">card</span><span class="p">,</span> <span class="n">comment</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Adds a DSCREEN card from ``BDF.add_card(...)``</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        card : BDFCard()</span>
<span class="sd">            a BDFCard object</span>
<span class="sd">        comment : str; default=&#39;&#39;</span>
<span class="sd">            a comment for the card</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">rtype</span> <span class="o">=</span> <span class="n">string</span><span class="p">(</span><span class="n">card</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;rtype&#39;</span><span class="p">)</span>
        <span class="n">trs</span> <span class="o">=</span> <span class="n">double_or_blank</span><span class="p">(</span><span class="n">card</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;trs&#39;</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.5</span><span class="p">)</span>
        <span class="n">nstr</span> <span class="o">=</span> <span class="n">integer_or_blank</span><span class="p">(</span><span class="n">card</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="s1">&#39;nstr&#39;</span><span class="p">,</span> <span class="mi">20</span><span class="p">)</span>
        <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">card</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="mi">4</span><span class="p">,</span> <span class="s1">&#39;len(DSCREEN card) = </span><span class="si">%i</span><span class="se">\n</span><span class="s1">card=</span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">card</span><span class="p">),</span> <span class="n">card</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">DSCREEN</span><span class="p">(</span><span class="n">rtype</span><span class="p">,</span> <span class="n">trs</span><span class="o">=</span><span class="n">trs</span><span class="p">,</span> <span class="n">nstr</span><span class="o">=</span><span class="n">nstr</span><span class="p">,</span> <span class="n">comment</span><span class="o">=</span><span class="n">comment</span><span class="p">)</span></div>

<div class="viewcode-block" id="DSCREEN.raw_fields"><a class="viewcode-back" href="../../../../reference/bdf/cards/pyNastran.bdf.cards.optimization.html#pyNastran.bdf.cards.optimization.DSCREEN.raw_fields">[docs]</a>    <span class="k">def</span> <span class="nf">raw_fields</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">list_fields</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;DSCREEN&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">rtype</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">trs</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">nstr</span><span class="p">]</span>
        <span class="k">return</span> <span class="n">list_fields</span></div>

<div class="viewcode-block" id="DSCREEN.repr_fields"><a class="viewcode-back" href="../../../../reference/bdf/cards/pyNastran.bdf.cards.optimization.html#pyNastran.bdf.cards.optimization.DSCREEN.repr_fields">[docs]</a>    <span class="k">def</span> <span class="nf">repr_fields</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">trs</span> <span class="o">=</span> <span class="n">set_blank_if_default</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">trs</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.5</span><span class="p">)</span>
        <span class="n">nstr</span> <span class="o">=</span> <span class="n">set_blank_if_default</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nstr</span><span class="p">,</span> <span class="mi">20</span><span class="p">)</span>
        <span class="n">list_fields</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;DSCREEN&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">rtype</span><span class="p">,</span> <span class="n">trs</span><span class="p">,</span> <span class="n">nstr</span><span class="p">]</span>
        <span class="k">return</span> <span class="n">list_fields</span></div>

<div class="viewcode-block" id="DSCREEN.write_card"><a class="viewcode-back" href="../../../../reference/bdf/cards/pyNastran.bdf.cards.optimization.html#pyNastran.bdf.cards.optimization.DSCREEN.write_card">[docs]</a>    <span class="k">def</span> <span class="nf">write_card</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">size</span><span class="p">:</span> <span class="nb">int</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span> <span class="n">is_double</span><span class="p">:</span> <span class="nb">bool</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="n">card</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">repr_fields</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">size</span> <span class="o">==</span> <span class="mi">8</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">comment</span> <span class="o">+</span> <span class="n">print_card_8</span><span class="p">(</span><span class="n">card</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">is_double</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">comment</span> <span class="o">+</span> <span class="n">print_card_double</span><span class="p">(</span><span class="n">card</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">comment</span> <span class="o">+</span> <span class="n">print_card_16</span><span class="p">(</span><span class="n">card</span><span class="p">)</span></div></div>


<div class="viewcode-block" id="DVCREL1"><a class="viewcode-back" href="../../../../reference/bdf/cards/pyNastran.bdf.cards.optimization.html#pyNastran.bdf.cards.optimization.DVCREL1">[docs]</a><span class="k">class</span> <span class="nc">DVCREL1</span><span class="p">(</span><span class="n">DVXREL1</span><span class="p">):</span>  <span class="c1"># similar to DVMREL1</span>
    <span class="nb">type</span> <span class="o">=</span> <span class="s1">&#39;DVCREL1&#39;</span>
    <span class="n">_properties</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;desvar_ids&#39;</span><span class="p">]</span>

<div class="viewcode-block" id="DVCREL1._init_from_empty"><a class="viewcode-back" href="../../../../reference/bdf/cards/pyNastran.bdf.cards.optimization.html#pyNastran.bdf.cards.optimization.DVCREL1._init_from_empty">[docs]</a>    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">_init_from_empty</span><span class="p">(</span><span class="bp">cls</span><span class="p">):</span>
        <span class="n">oid</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="n">element_type</span> <span class="o">=</span> <span class="s1">&#39;CONM2&#39;</span>
        <span class="n">eid</span> <span class="o">=</span> <span class="mi">2</span>
        <span class="n">cp_name</span> <span class="o">=</span> <span class="s1">&#39;X1&#39;</span>
        <span class="n">dvids</span> <span class="o">=</span> <span class="mi">42</span>
        <span class="n">coeffs</span> <span class="o">=</span> <span class="mf">1.0</span>
        <span class="k">return</span> <span class="n">DVCREL1</span><span class="p">(</span><span class="n">oid</span><span class="p">,</span> <span class="n">element_type</span><span class="p">,</span> <span class="n">eid</span><span class="p">,</span> <span class="n">cp_name</span><span class="p">,</span> <span class="n">dvids</span><span class="p">,</span> <span class="n">coeffs</span><span class="p">,</span>
                       <span class="n">cp_min</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">cp_max</span><span class="o">=</span><span class="mf">1e20</span><span class="p">,</span> <span class="n">c0</span><span class="o">=</span><span class="mf">0.</span><span class="p">,</span> <span class="n">validate</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">comment</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">)</span></div>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">oid</span><span class="p">,</span> <span class="n">element_type</span><span class="p">,</span> <span class="n">eid</span><span class="p">,</span> <span class="n">cp_name</span><span class="p">,</span> <span class="n">dvids</span><span class="p">,</span> <span class="n">coeffs</span><span class="p">,</span>
                 <span class="n">cp_min</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">cp_max</span><span class="o">=</span><span class="mf">1e20</span><span class="p">,</span> <span class="n">c0</span><span class="o">=</span><span class="mf">0.</span><span class="p">,</span> <span class="n">validate</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">comment</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        +---------+--------+--------+--------+-----------+-------+--------+-----+---+</span>
<span class="sd">        |   1     |    2   |   3    |    4   |     5     |   6   |   7    |  8  | 9 |</span>
<span class="sd">        +=========+========+========+========+===========+=======+========+=====+===+</span>
<span class="sd">        | DVCREL1 |   ID   |  TYPE  |  EID   |   CPNAME  | CPMIN |  CPMAX |  C0 |   |</span>
<span class="sd">        +---------+--------+--------+--------+-----------+-------+--------+-----+---+</span>
<span class="sd">        |         | DVID1  | COEF1  | DVID2  |   COEF2   | DVID3 |  etc.  |     |   |</span>
<span class="sd">        +---------+--------+--------+--------+-----------+-------+--------+-----+---+</span>

<span class="sd">        +---------+--------+--------+--------+-------+-----+------+</span>
<span class="sd">        | DVCREL1 | 200000 | CQUAD4 | 1      | ZOFFS |     |  1.0 |</span>
<span class="sd">        +---------+--------+--------+--------+-------+-----+------+</span>
<span class="sd">        |         | 200000 |   1.0  |        |       |     |      |</span>
<span class="sd">        +---------+--------+--------+--------+-------+-----+------+</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">DVXREL1</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">oid</span><span class="p">,</span> <span class="n">dvids</span><span class="p">,</span> <span class="n">coeffs</span><span class="p">,</span> <span class="n">c0</span><span class="p">,</span> <span class="n">comment</span><span class="p">)</span>

        <span class="c1"># element type (e.g. CQUAD4)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">element_type</span> <span class="o">=</span> <span class="n">element_type</span>

        <span class="c1"># element id</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">eid</span> <span class="o">=</span> <span class="n">eid</span>

        <span class="c1"># the connectivity property (X1, X2, X3, ZOFFS, etc.)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">cp_name</span> <span class="o">=</span> <span class="n">cp_name</span>

        <span class="c1"># min value</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">cp_min</span> <span class="o">=</span> <span class="n">cp_min</span>

        <span class="c1"># max value</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">cp_max</span> <span class="o">=</span> <span class="n">cp_max</span>

        <span class="n">validate_dvcrel</span><span class="p">(</span><span class="n">validate</span><span class="p">,</span> <span class="n">element_type</span><span class="p">,</span> <span class="n">cp_name</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">eid_ref</span> <span class="o">=</span> <span class="kc">None</span>

        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">coeffs</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">msg</span> <span class="o">=</span> <span class="s1">&#39;len(coeffs)=</span><span class="si">%s</span><span class="s1"> len(dvids)=</span><span class="si">%s</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">coeffs</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dvids</span><span class="p">))</span>
            <span class="n">msg</span> <span class="o">+=</span> <span class="s2">&quot;We&#39;ve added a coeff=1.0 and desvar_id=1 in order to look at the crashing card</span><span class="se">\n</span><span class="s2">&quot;</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">coeffs</span> <span class="o">=</span> <span class="p">[</span><span class="mf">1.</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">dvids</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">]</span>
            <span class="n">msg</span> <span class="o">+=</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
            <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
        <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">coeffs</span><span class="p">)</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dvids</span><span class="p">),</span> <span class="s1">&#39;len(coeffs)=</span><span class="si">%s</span><span class="s1"> len(dvids)=</span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">coeffs</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dvids</span><span class="p">))</span>

<div class="viewcode-block" id="DVCREL1.add_card"><a class="viewcode-back" href="../../../../reference/bdf/cards/pyNastran.bdf.cards.optimization.html#pyNastran.bdf.cards.optimization.DVCREL1.add_card">[docs]</a>    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">add_card</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">card</span><span class="p">,</span> <span class="n">comment</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Adds a DVCREL1 card from ``BDF.add_card(...)``</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        card : BDFCard()</span>
<span class="sd">            a BDFCard object</span>
<span class="sd">        comment : str; default=&#39;&#39;</span>
<span class="sd">            a comment for the card</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">oid</span> <span class="o">=</span> <span class="n">integer</span><span class="p">(</span><span class="n">card</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;oid&#39;</span><span class="p">)</span>
        <span class="n">element_type</span> <span class="o">=</span> <span class="n">string</span><span class="p">(</span><span class="n">card</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;Type&#39;</span><span class="p">)</span>
        <span class="n">eid</span> <span class="o">=</span> <span class="n">integer</span><span class="p">(</span><span class="n">card</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="s1">&#39;eid&#39;</span><span class="p">)</span>
        <span class="n">cp_name</span> <span class="o">=</span> <span class="n">integer_or_string</span><span class="p">(</span><span class="n">card</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="s1">&#39;cp_name&#39;</span><span class="p">)</span>

        <span class="n">cp_min</span> <span class="o">=</span> <span class="n">double_or_blank</span><span class="p">(</span><span class="n">card</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="s1">&#39;cp_min&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="n">cp_max</span> <span class="o">=</span> <span class="n">double_or_blank</span><span class="p">(</span><span class="n">card</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="s1">&#39;cp_max&#39;</span><span class="p">,</span> <span class="mf">1e20</span><span class="p">)</span>
        <span class="n">c0</span> <span class="o">=</span> <span class="n">double_or_blank</span><span class="p">(</span><span class="n">card</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="s1">&#39;c0&#39;</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">)</span>

        <span class="n">dvids</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">coeffs</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">end_fields</span> <span class="o">=</span> <span class="p">[</span><span class="n">interpret_value</span><span class="p">(</span><span class="n">field</span><span class="p">)</span> <span class="k">for</span> <span class="n">field</span> <span class="ow">in</span> <span class="n">card</span><span class="p">[</span><span class="mi">9</span><span class="p">:]]</span>

        <span class="n">nfields</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">end_fields</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span>
        <span class="k">if</span> <span class="n">nfields</span> <span class="o">%</span> <span class="mi">2</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">end_fields</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="kc">None</span><span class="p">)</span>
            <span class="n">nfields</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">nfields</span><span class="p">,</span> <span class="mi">2</span><span class="p">):</span>
            <span class="n">dvids</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">end_fields</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
            <span class="n">coeffs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">end_fields</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">])</span>
        <span class="k">if</span> <span class="n">nfields</span> <span class="o">%</span> <span class="mi">2</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">card</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;dvids = </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">dvids</span><span class="p">))</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;coeffs = </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">coeffs</span><span class="p">))</span>
            <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s1">&#39;invalid DVCREL1...&#39;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">DVCREL1</span><span class="p">(</span><span class="n">oid</span><span class="p">,</span> <span class="n">element_type</span><span class="p">,</span> <span class="n">eid</span><span class="p">,</span> <span class="n">cp_name</span><span class="p">,</span> <span class="n">dvids</span><span class="p">,</span> <span class="n">coeffs</span><span class="p">,</span>
                       <span class="n">c0</span><span class="o">=</span><span class="n">c0</span><span class="p">,</span> <span class="n">cp_min</span><span class="o">=</span><span class="n">cp_min</span><span class="p">,</span> <span class="n">cp_max</span><span class="o">=</span><span class="n">cp_max</span><span class="p">,</span> <span class="n">comment</span><span class="o">=</span><span class="n">comment</span><span class="p">)</span></div>

    <span class="k">def</span> <span class="nf">_verify</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">xref</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Verifies all methods for this object work</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        xref : bool</span>
<span class="sd">            has this model been cross referenced</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">pass</span>

<div class="viewcode-block" id="DVCREL1.OptID"><a class="viewcode-back" href="../../../../reference/bdf/cards/pyNastran.bdf.cards.optimization.html#pyNastran.bdf.cards.optimization.DVCREL1.OptID">[docs]</a>    <span class="k">def</span> <span class="nf">OptID</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">oid</span></div>

<div class="viewcode-block" id="DVCREL1.object_attributes"><a class="viewcode-back" href="../../../../reference/bdf/cards/pyNastran.bdf.cards.optimization.html#pyNastran.bdf.cards.optimization.DVCREL1.object_attributes">[docs]</a>    <span class="k">def</span> <span class="nf">object_attributes</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;public&#39;</span><span class="p">,</span> <span class="n">keys_to_skip</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                          <span class="n">filter_properties</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;.. seealso:: `pyNastran.utils.object_attributes(...)`&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">keys_to_skip</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">keys_to_skip</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="n">my_keys_to_skip</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Type&#39;</span><span class="p">]</span>
        <span class="k">return</span> <span class="nb">super</span><span class="p">(</span><span class="n">DVCREL1</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">object_attributes</span><span class="p">(</span>
            <span class="n">mode</span><span class="o">=</span><span class="n">mode</span><span class="p">,</span> <span class="n">keys_to_skip</span><span class="o">=</span><span class="n">keys_to_skip</span><span class="o">+</span><span class="n">my_keys_to_skip</span><span class="p">,</span>
            <span class="n">filter_properties</span><span class="o">=</span><span class="n">filter_properties</span><span class="p">)</span></div>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">Type</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">element_type</span>

    <span class="nd">@Type</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">Type</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">element_type</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">element_type</span> <span class="o">=</span> <span class="n">element_type</span>

<div class="viewcode-block" id="DVCREL1.update_model"><a class="viewcode-back" href="../../../../reference/bdf/cards/pyNastran.bdf.cards.optimization.html#pyNastran.bdf.cards.optimization.DVCREL1.update_model">[docs]</a>    <span class="k">def</span> <span class="nf">update_model</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">model</span><span class="p">,</span> <span class="n">desvar_values</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;doesn&#39;t require cross-referencing&quot;&quot;&quot;</span>
        <span class="n">value</span> <span class="o">=</span> <span class="n">get_dvxrel1_coeffs</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">model</span><span class="p">,</span> <span class="n">desvar_values</span><span class="p">)</span>
        <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">eid</span><span class="p">,</span> <span class="nb">int</span><span class="p">),</span> <span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">eid</span><span class="p">)</span>
        <span class="n">element</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_element</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">msg</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_update_by_dvcrel</span><span class="p">(</span><span class="n">element</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span>
            <span class="k">raise</span></div>
            <span class="c1">#raise NotImplementedError(&#39;mat_type=%r is not supported in &#39;</span>
                                      <span class="c1">#&#39;update_model&#39; % self.mat_type)</span>

<div class="viewcode-block" id="DVCREL1._update_by_dvcrel"><a class="viewcode-back" href="../../../../reference/bdf/cards/pyNastran.bdf.cards.optimization.html#pyNastran.bdf.cards.optimization.DVCREL1._update_by_dvcrel">[docs]</a>    <span class="k">def</span> <span class="nf">_update_by_dvcrel</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">element</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">element</span><span class="p">,</span> <span class="s1">&#39;update_by_cp_name&#39;</span><span class="p">):</span>
            <span class="n">element</span><span class="o">.</span><span class="n">update_by_cp_name</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">cp_name</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">cp_name_map</span> <span class="o">=</span> <span class="n">element</span><span class="o">.</span><span class="n">cp_name_map</span>
            <span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="s1">&#39;element_type=</span><span class="si">%r</span><span class="s1"> cp_name=</span><span class="si">%r</span><span class="s1"> has not implemented &#39;</span>
                                          <span class="s1">&#39;cp_name_map/update_by_cp_name&#39;</span> <span class="o">%</span> <span class="p">(</span>
                                              <span class="bp">self</span><span class="o">.</span><span class="n">element_type</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">cp_name</span><span class="p">))</span>

            <span class="k">try</span><span class="p">:</span>
                <span class="n">key</span> <span class="o">=</span> <span class="n">cp_name_map</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">cp_name</span><span class="p">]</span>
            <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="s1">&#39;connectivity_type=</span><span class="si">%r</span><span class="s1"> has not implemented </span><span class="si">%r</span><span class="s1"> &#39;</span>
                                          <span class="s1">&#39;for in cp_name_map/update_by_cp_name&#39;</span> <span class="o">%</span> <span class="p">(</span>
                                              <span class="bp">self</span><span class="o">.</span><span class="n">element_type</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">cp_name</span><span class="p">))</span>
            <span class="nb">setattr</span><span class="p">(</span><span class="n">element</span><span class="p">,</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span></div>

<div class="viewcode-block" id="DVCREL1.cross_reference"><a class="viewcode-back" href="../../../../reference/bdf/cards/pyNastran.bdf.cards.optimization.html#pyNastran.bdf.cards.optimization.DVCREL1.cross_reference">[docs]</a>    <span class="k">def</span> <span class="nf">cross_reference</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">model</span><span class="p">:</span> <span class="n">BDF</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Cross links the card so referenced cards can be extracted directly</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        model : BDF()</span>
<span class="sd">            the BDF object</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">msg</span> <span class="o">=</span> <span class="s1">&#39;, which is required by DVCREL1 oid=</span><span class="si">%r</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">oid</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">eid_ref</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_element</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">msg</span><span class="o">=</span><span class="n">msg</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dvids_ref</span> <span class="o">=</span> <span class="p">[</span><span class="n">model</span><span class="o">.</span><span class="n">Desvar</span><span class="p">(</span><span class="n">dvid</span><span class="p">,</span> <span class="n">msg</span><span class="p">)</span> <span class="k">for</span> <span class="n">dvid</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">dvids</span><span class="p">]</span></div>

<div class="viewcode-block" id="DVCREL1._get_element"><a class="viewcode-back" href="../../../../reference/bdf/cards/pyNastran.bdf.cards.optimization.html#pyNastran.bdf.cards.optimization.DVCREL1._get_element">[docs]</a>    <span class="k">def</span> <span class="nf">_get_element</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">model</span><span class="p">,</span> <span class="n">msg</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">element_type</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;CQUAD4&#39;</span><span class="p">,</span> <span class="s1">&#39;CTRIA3&#39;</span><span class="p">,</span> <span class="s1">&#39;CBAR&#39;</span><span class="p">,</span> <span class="s1">&#39;CBEAM&#39;</span><span class="p">,</span>
                                 <span class="s1">&#39;CELAS1&#39;</span><span class="p">,</span> <span class="s1">&#39;CELAS2&#39;</span><span class="p">,</span> <span class="s1">&#39;CELAS4&#39;</span><span class="p">,</span>
                                 <span class="s1">&#39;CDAMP2&#39;</span><span class="p">,</span> <span class="s1">&#39;CGAP&#39;</span><span class="p">,</span> <span class="s1">&#39;CBUSH&#39;</span><span class="p">]:</span>
            <span class="n">elem</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">Element</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">eid</span><span class="p">,</span> <span class="n">msg</span><span class="o">=</span><span class="n">msg</span><span class="p">)</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">element_type</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;CONM1&#39;</span><span class="p">,</span> <span class="s1">&#39;CONM2&#39;</span><span class="p">,</span> <span class="s1">&#39;CMASS2&#39;</span><span class="p">,</span> <span class="s1">&#39;CMASS4&#39;</span><span class="p">]:</span>
            <span class="n">elem</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">Mass</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">eid</span><span class="p">,</span> <span class="n">msg</span><span class="o">=</span><span class="n">msg</span><span class="p">)</span>
        <span class="c1">#elif element_type in [&#39;CBUSH&#39;]:</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">element_type</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">elem</span></div>

<div class="viewcode-block" id="DVCREL1.uncross_reference"><a class="viewcode-back" href="../../../../reference/bdf/cards/pyNastran.bdf.cards.optimization.html#pyNastran.bdf.cards.optimization.DVCREL1.uncross_reference">[docs]</a>    <span class="k">def</span> <span class="nf">uncross_reference</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Removes cross-reference links&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">eid</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">Eid</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dvids</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">desvar_ids</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">eid_ref</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dvids_ref</span> <span class="o">=</span> <span class="kc">None</span></div>

<div class="viewcode-block" id="DVCREL1.calculate"><a class="viewcode-back" href="../../../../reference/bdf/cards/pyNastran.bdf.cards.optimization.html#pyNastran.bdf.cards.optimization.DVCREL1.calculate">[docs]</a>    <span class="k">def</span> <span class="nf">calculate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">op2_model</span><span class="p">,</span> <span class="n">subcase_id</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="p">))</span></div>

<div class="viewcode-block" id="DVCREL1.Eid"><a class="viewcode-back" href="../../../../reference/bdf/cards/pyNastran.bdf.cards.optimization.html#pyNastran.bdf.cards.optimization.DVCREL1.Eid">[docs]</a>    <span class="k">def</span> <span class="nf">Eid</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">eid_ref</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">eid_ref</span><span class="o">.</span><span class="n">eid</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">eid</span></div>

<div class="viewcode-block" id="DVCREL1.raw_fields"><a class="viewcode-back" href="../../../../reference/bdf/cards/pyNastran.bdf.cards.optimization.html#pyNastran.bdf.cards.optimization.DVCREL1.raw_fields">[docs]</a>    <span class="k">def</span> <span class="nf">raw_fields</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">list_fields</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;DVCREL1&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">oid</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">element_type</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">Eid</span><span class="p">(),</span>
                       <span class="bp">self</span><span class="o">.</span><span class="n">cp_name</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">cp_min</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">cp_max</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">c0</span><span class="p">,</span> <span class="kc">None</span><span class="p">]</span>
        <span class="k">for</span> <span class="p">(</span><span class="n">dvid</span><span class="p">,</span> <span class="n">coeff</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">desvar_ids</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">coeffs</span><span class="p">):</span>
            <span class="n">list_fields</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">dvid</span><span class="p">)</span>
            <span class="n">list_fields</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">coeff</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">list_fields</span></div>

<div class="viewcode-block" id="DVCREL1.repr_fields"><a class="viewcode-back" href="../../../../reference/bdf/cards/pyNastran.bdf.cards.optimization.html#pyNastran.bdf.cards.optimization.DVCREL1.repr_fields">[docs]</a>    <span class="k">def</span> <span class="nf">repr_fields</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">cp_max</span> <span class="o">=</span> <span class="n">set_blank_if_default</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">cp_max</span><span class="p">,</span> <span class="mf">1e20</span><span class="p">)</span>
        <span class="n">c0</span> <span class="o">=</span> <span class="n">set_blank_if_default</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">c0</span><span class="p">,</span> <span class="mf">0.</span><span class="p">)</span>
        <span class="n">list_fields</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;DVCREL1&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">oid</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">element_type</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">Eid</span><span class="p">(),</span>
                       <span class="bp">self</span><span class="o">.</span><span class="n">cp_name</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">cp_min</span><span class="p">,</span> <span class="n">cp_max</span><span class="p">,</span> <span class="n">c0</span><span class="p">,</span> <span class="kc">None</span><span class="p">]</span>
        <span class="k">for</span> <span class="p">(</span><span class="n">dvid</span><span class="p">,</span> <span class="n">coeff</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">desvar_ids</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">coeffs</span><span class="p">):</span>
            <span class="n">list_fields</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">dvid</span><span class="p">)</span>
            <span class="n">list_fields</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">coeff</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">list_fields</span></div>

<div class="viewcode-block" id="DVCREL1.write_card"><a class="viewcode-back" href="../../../../reference/bdf/cards/pyNastran.bdf.cards.optimization.html#pyNastran.bdf.cards.optimization.DVCREL1.write_card">[docs]</a>    <span class="k">def</span> <span class="nf">write_card</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">size</span><span class="p">:</span> <span class="nb">int</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span> <span class="n">is_double</span><span class="p">:</span> <span class="nb">bool</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="n">card</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">repr_fields</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">size</span> <span class="o">==</span> <span class="mi">8</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">comment</span> <span class="o">+</span> <span class="n">print_card_8</span><span class="p">(</span><span class="n">card</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">comment</span> <span class="o">+</span> <span class="n">print_card_16</span><span class="p">(</span><span class="n">card</span><span class="p">)</span></div></div>


<div class="viewcode-block" id="DVCREL2"><a class="viewcode-back" href="../../../../reference/bdf/cards/pyNastran.bdf.cards.optimization.html#pyNastran.bdf.cards.optimization.DVCREL2">[docs]</a><span class="k">class</span> <span class="nc">DVCREL2</span><span class="p">(</span><span class="n">DVXREL2</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    +----------+--------+--------+-------+------------+-------+-------+-------+-------+</span>
<span class="sd">    |    1     |    2   |   3    |   4   |      5     |   6   |   7   |   8   |   9   |</span>
<span class="sd">    +==========+========+========+=======+============+=======+=======+=======+=======+</span>
<span class="sd">    | DVCREL2  |   ID   |  TYPE  |  EID  | CPNAME/FID | CPMIN | CPMAX | EQID  |       |</span>
<span class="sd">    +----------+--------+--------+-------+------------+-------+-------+-------+-------+</span>
<span class="sd">    |          | DESVAR | DVID1  | DVID2 |   DVID3    | DVID4 | DVID5 | DVID6 | DVID7 |</span>
<span class="sd">    +----------+--------+--------+-------+------------+-------+-------+-------+-------+</span>
<span class="sd">    |          |        | DVID8  | etc.  |            |       |       |       |       |</span>
<span class="sd">    +----------+--------+--------+-------+------------+-------+-------+-------+-------+</span>
<span class="sd">    |          | DTABLE | LABL1  | LABL2 |   LABL3    | LABL4 | LABL5 | LABL6 | LABL7 |</span>
<span class="sd">    +----------+--------+--------+-------+------------+-------+-------+-------+-------+</span>
<span class="sd">    |          |        | LABL8  | etc.  |            |       |       |       |       |</span>
<span class="sd">    +----------+--------+--------+-------+------------+-------+-------+-------+-------+</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="nb">type</span> <span class="o">=</span> <span class="s1">&#39;DVCREL2&#39;</span>

    <span class="n">allowed_elements</span> <span class="o">=</span> <span class="p">[</span>
        <span class="s1">&#39;CQUAD4&#39;</span><span class="p">,</span> <span class="s1">&#39;CTRIA3&#39;</span><span class="p">,</span> <span class="s1">&#39;CBAR&#39;</span><span class="p">,</span> <span class="s1">&#39;CBEAM&#39;</span><span class="p">,</span> <span class="s1">&#39;CELAS1&#39;</span><span class="p">,</span> <span class="s1">&#39;CBUSH&#39;</span><span class="p">,</span>
        <span class="s1">&#39;CDAMP2&#39;</span><span class="p">,</span>
    <span class="p">]</span>
    <span class="n">_properties</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;desvar_ids&#39;</span><span class="p">]</span>
    <span class="c1">#allowed_masses = [&#39;CONM2&#39;, &#39;CMASS2&#39;, &#39;CMASS4&#39;]</span>
    <span class="c1">#allowed_properties_mass = [&#39;PMASS&#39;]</span>

<div class="viewcode-block" id="DVCREL2._init_from_empty"><a class="viewcode-back" href="../../../../reference/bdf/cards/pyNastran.bdf.cards.optimization.html#pyNastran.bdf.cards.optimization.DVCREL2._init_from_empty">[docs]</a>    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">_init_from_empty</span><span class="p">(</span><span class="bp">cls</span><span class="p">):</span>
        <span class="n">oid</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="n">element_type</span> <span class="o">=</span> <span class="s1">&#39;CONM2&#39;</span>
        <span class="n">eid</span> <span class="o">=</span> <span class="mi">2</span>
        <span class="n">cp_name</span> <span class="o">=</span> <span class="s1">&#39;X1&#39;</span>
        <span class="n">deqation</span> <span class="o">=</span> <span class="mi">42</span>
        <span class="n">dvids</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">labels</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">return</span> <span class="n">DVCREL2</span><span class="p">(</span><span class="n">oid</span><span class="p">,</span> <span class="n">element_type</span><span class="p">,</span> <span class="n">eid</span><span class="p">,</span> <span class="n">cp_name</span><span class="p">,</span> <span class="n">deqation</span><span class="p">,</span> <span class="n">dvids</span><span class="p">,</span> <span class="n">labels</span><span class="p">,</span>
                       <span class="n">cp_min</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">cp_max</span><span class="o">=</span><span class="mf">1e20</span><span class="p">,</span> <span class="n">validate</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">comment</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">)</span></div>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">oid</span><span class="p">,</span> <span class="n">element_type</span><span class="p">,</span> <span class="n">eid</span><span class="p">,</span> <span class="n">cp_name</span><span class="p">,</span> <span class="n">deqation</span><span class="p">,</span> <span class="n">dvids</span><span class="p">,</span> <span class="n">labels</span><span class="p">,</span>
                 <span class="n">cp_min</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">cp_max</span><span class="o">=</span><span class="mf">1e20</span><span class="p">,</span> <span class="n">validate</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">comment</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">):</span>
        <span class="n">DVXREL2</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">oid</span><span class="p">,</span> <span class="n">dvids</span><span class="p">,</span> <span class="n">labels</span><span class="p">,</span> <span class="n">deqation</span><span class="p">,</span> <span class="n">comment</span><span class="p">)</span>

        <span class="c1">#: Name of an element connectivity entry, such as CBAR, CQUAD4, etc.</span>
        <span class="c1">#: (Character)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">element_type</span> <span class="o">=</span> <span class="n">element_type</span>

        <span class="c1">#: Element Identification number. (Integer &gt; 0)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">eid</span> <span class="o">=</span> <span class="n">eid</span>

        <span class="c1">#: Name of connectivity property, such as X1, X2, X3, ZOFFS, etc.</span>
        <span class="c1">#: (Character)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">cp_name</span> <span class="o">=</span> <span class="n">cp_name</span>

        <span class="c1">#: Minimum value allowed for this property. If CPNAME references a connectivity</span>
        <span class="c1">#: property that can only be positive, then the default value of CPMIN is 1.0E-15.</span>
        <span class="c1">#: Otherwise, it is -1.0E35. (Real)</span>
        <span class="c1">#: .. todo:: bad default (see DVCREL2)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">cp_min</span> <span class="o">=</span> <span class="n">cp_min</span>

        <span class="c1">#: Maximum value allowed for this property. (Real; Default = 1.0E20)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">cp_max</span> <span class="o">=</span> <span class="n">cp_max</span>

        <span class="c1">#assert len(coeffs) &gt; 0, &#39;len(coeffs)=%s&#39; % len(coeffs)</span>
        <span class="c1">#assert len(coeffs) == len(dvids), &#39;len(coeffs)=%s len(dvids)=%s&#39; % (len(coeffs), len(dvids))</span>
        <span class="n">validate_dvcrel</span><span class="p">(</span><span class="n">validate</span><span class="p">,</span> <span class="n">element_type</span><span class="p">,</span> <span class="n">cp_name</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">eid_ref</span> <span class="o">=</span> <span class="kc">None</span>

<div class="viewcode-block" id="DVCREL2.add_card"><a class="viewcode-back" href="../../../../reference/bdf/cards/pyNastran.bdf.cards.optimization.html#pyNastran.bdf.cards.optimization.DVCREL2.add_card">[docs]</a>    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">add_card</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">card</span><span class="p">,</span> <span class="n">comment</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Adds a DVCREL2 card from ``BDF.add_card(...)``</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        card : BDFCard()</span>
<span class="sd">            a BDFCard object</span>
<span class="sd">        comment : str; default=&#39;&#39;</span>
<span class="sd">            a comment for the card</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">oid</span> <span class="o">=</span> <span class="n">integer</span><span class="p">(</span><span class="n">card</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;oid&#39;</span><span class="p">)</span>
        <span class="n">element_type</span> <span class="o">=</span> <span class="n">string</span><span class="p">(</span><span class="n">card</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;Type&#39;</span><span class="p">)</span>
        <span class="n">pid</span> <span class="o">=</span> <span class="n">integer</span><span class="p">(</span><span class="n">card</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="s1">&#39;pid&#39;</span><span class="p">)</span>
        <span class="n">cp_name</span> <span class="o">=</span> <span class="n">integer_or_string</span><span class="p">(</span><span class="n">card</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="s1">&#39;cpName_FID&#39;</span><span class="p">)</span>
        <span class="n">cp_min</span> <span class="o">=</span> <span class="n">double_or_blank</span><span class="p">(</span><span class="n">card</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="s1">&#39;cp_min&#39;</span><span class="p">)</span>
        <span class="n">cp_max</span> <span class="o">=</span> <span class="n">double_or_blank</span><span class="p">(</span><span class="n">card</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="s1">&#39;cp_max&#39;</span><span class="p">,</span> <span class="mf">1e20</span><span class="p">)</span>
        <span class="n">dequation</span> <span class="o">=</span> <span class="n">integer_or_blank</span><span class="p">(</span><span class="n">card</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="s1">&#39;dequation&#39;</span><span class="p">)</span> <span class="c1">#: .. todo:: or blank?</span>

        <span class="n">fields</span> <span class="o">=</span> <span class="p">[</span><span class="n">interpret_value</span><span class="p">(</span><span class="n">field</span><span class="p">)</span> <span class="k">for</span> <span class="n">field</span> <span class="ow">in</span> <span class="n">card</span><span class="p">[</span><span class="mi">9</span><span class="p">:]]</span>
        <span class="n">ioffset</span> <span class="o">=</span> <span class="mi">9</span>
        <span class="n">iend</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">fields</span><span class="p">)</span> <span class="o">+</span> <span class="n">ioffset</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="n">idesvar</span> <span class="o">=</span> <span class="n">fields</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="s1">&#39;DESVAR&#39;</span><span class="p">)</span> <span class="o">+</span> <span class="n">ioffset</span>
        <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
            <span class="n">idesvar</span> <span class="o">=</span> <span class="kc">None</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="n">idtable</span> <span class="o">=</span> <span class="n">fields</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="s1">&#39;DTABLE&#39;</span><span class="p">)</span> <span class="o">+</span> <span class="n">ioffset</span>
            <span class="c1">#iDesMax  = idtable # the index to start parsing DESVAR</span>
            <span class="n">ides_stop</span> <span class="o">=</span> <span class="n">idtable</span>  <span class="c1"># the index to stop  parsing DESVAR</span>
        <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
            <span class="n">idtable</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="n">ides_stop</span> <span class="o">=</span> <span class="n">iend</span>

        <span class="n">dvids</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">if</span> <span class="n">idesvar</span><span class="p">:</span>
            <span class="n">n</span> <span class="o">=</span> <span class="mi">1</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="n">ides_stop</span><span class="p">):</span>
                <span class="n">dvid_name</span> <span class="o">=</span> <span class="s1">&#39;DVID&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
                <span class="n">dvid</span> <span class="o">=</span> <span class="n">integer_or_blank</span><span class="p">(</span><span class="n">card</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">dvid_name</span><span class="p">)</span>
                <span class="c1">#print(&quot;%s = %s&quot; % (dvid_name, dvid))</span>
                <span class="k">if</span> <span class="n">dvid</span><span class="p">:</span>
                    <span class="k">assert</span> <span class="n">dvid</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
                    <span class="k">assert</span> <span class="n">dvid</span> <span class="o">!=</span> <span class="s1">&#39;DESVAR&#39;</span>
                    <span class="n">dvids</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">dvid</span><span class="p">)</span>
                    <span class="n">n</span> <span class="o">+=</span> <span class="mi">1</span>

        <span class="n">labels</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">if</span> <span class="n">idtable</span><span class="p">:</span>
            <span class="n">n</span> <span class="o">=</span> <span class="mi">1</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">idtable</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">iend</span><span class="p">):</span>
                <span class="n">label_name</span> <span class="o">=</span> <span class="s1">&#39;Label&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
                <span class="n">label</span> <span class="o">=</span> <span class="n">string</span><span class="p">(</span><span class="n">card</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">label_name</span><span class="p">)</span>
                <span class="c1">#print(&quot;%s = %s&quot; % (label_name, label))</span>
                <span class="k">if</span> <span class="n">label</span><span class="p">:</span>
                    <span class="k">assert</span> <span class="n">label</span> <span class="o">!=</span> <span class="s1">&#39;DTABLE&#39;</span>
                    <span class="n">labels</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">label</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">DVCREL2</span><span class="p">(</span><span class="n">oid</span><span class="p">,</span> <span class="n">element_type</span><span class="p">,</span> <span class="n">pid</span><span class="p">,</span> <span class="n">cp_name</span><span class="p">,</span> <span class="n">dequation</span><span class="p">,</span> <span class="n">dvids</span><span class="p">,</span> <span class="n">labels</span><span class="p">,</span>
                       <span class="n">cp_min</span><span class="p">,</span> <span class="n">cp_max</span><span class="p">,</span> <span class="n">comment</span><span class="o">=</span><span class="n">comment</span><span class="p">)</span></div>

<div class="viewcode-block" id="DVCREL2.object_attributes"><a class="viewcode-back" href="../../../../reference/bdf/cards/pyNastran.bdf.cards.optimization.html#pyNastran.bdf.cards.optimization.DVCREL2.object_attributes">[docs]</a>    <span class="k">def</span> <span class="nf">object_attributes</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;public&#39;</span><span class="p">,</span> <span class="n">keys_to_skip</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                          <span class="n">filter_properties</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;.. seealso:: `pyNastran.utils.object_attributes(...)`&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">keys_to_skip</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">keys_to_skip</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="n">my_keys_to_skip</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Type&#39;</span><span class="p">]</span>
        <span class="k">return</span> <span class="nb">super</span><span class="p">(</span><span class="n">DVCREL2</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">object_attributes</span><span class="p">(</span>
            <span class="n">mode</span><span class="o">=</span><span class="n">mode</span><span class="p">,</span> <span class="n">keys_to_skip</span><span class="o">=</span><span class="n">keys_to_skip</span><span class="o">+</span><span class="n">my_keys_to_skip</span><span class="p">,</span>
            <span class="n">filter_properties</span><span class="o">=</span><span class="n">filter_properties</span><span class="p">)</span></div>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">Type</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">element_type</span>

    <span class="nd">@Type</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">Type</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">element_type</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">element_type</span> <span class="o">=</span> <span class="n">element_type</span>

<div class="viewcode-block" id="DVCREL2.OptID"><a class="viewcode-back" href="../../../../reference/bdf/cards/pyNastran.bdf.cards.optimization.html#pyNastran.bdf.cards.optimization.DVCREL2.OptID">[docs]</a>    <span class="k">def</span> <span class="nf">OptID</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">oid</span></div>

<div class="viewcode-block" id="DVCREL2.Eid"><a class="viewcode-back" href="../../../../reference/bdf/cards/pyNastran.bdf.cards.optimization.html#pyNastran.bdf.cards.optimization.DVCREL2.Eid">[docs]</a>    <span class="k">def</span> <span class="nf">Eid</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">eid_ref</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">eid</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">element_type</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">allowed_elements</span><span class="p">:</span>
            <span class="n">eid</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">eid_ref</span><span class="o">.</span><span class="n">eid</span>
        <span class="c1">#elif self.element_type in self.allowed_masses:</span>
            <span class="c1">#pid = self.pid_ref.eid</span>
        <span class="c1">#elif self.element_type in self.allowed_properties_mass:</span>
            <span class="c1">#pid = self.pid_ref.pid</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="s1">&#39;element_type=</span><span class="si">%r</span><span class="s1"> is not supported&#39;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">element_type</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">eid</span></div>

<div class="viewcode-block" id="DVCREL2.DEquation"><a class="viewcode-back" href="../../../../reference/bdf/cards/pyNastran.bdf.cards.optimization.html#pyNastran.bdf.cards.optimization.DVCREL2.DEquation">[docs]</a>    <span class="k">def</span> <span class="nf">DEquation</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">dequation_ref</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">dequation</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">dequation_ref</span><span class="o">.</span><span class="n">equation_id</span></div>

<div class="viewcode-block" id="DVCREL2.calculate"><a class="viewcode-back" href="../../../../reference/bdf/cards/pyNastran.bdf.cards.optimization.html#pyNastran.bdf.cards.optimization.DVCREL2.calculate">[docs]</a>    <span class="k">def</span> <span class="nf">calculate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">op2_model</span><span class="p">,</span> <span class="n">subcase_id</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        this should really make a call the the DEQATN;</span>
<span class="sd">        see the PBEAM for an example of get/set_opt_value</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">get</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">eid_ref</span><span class="o">.</span><span class="n">get_optimization_value</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">cp_name</span><span class="p">)</span>
            <span class="n">out</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">eid_ref</span><span class="o">.</span><span class="n">set_optimization_value</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">cp_name</span><span class="p">,</span> <span class="n">get</span><span class="p">)</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;DVCREL2 calculate : </span><span class="si">%s</span><span class="s1">[</span><span class="si">%r</span><span class="s1">] = ???&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">element_type</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">cp_name</span><span class="p">))</span>
            <span class="k">raise</span>

        <span class="n">argsi</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">dvids_ref</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">desvar</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">dvids_ref</span><span class="p">:</span> <span class="c1"># DESVARS</span>
                <span class="n">arg</span> <span class="o">=</span> <span class="n">desvar</span><span class="o">.</span><span class="n">calculate</span><span class="p">(</span><span class="n">op2_model</span><span class="p">,</span> <span class="n">subcase_id</span><span class="p">)</span>
                <span class="n">argsi</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">arg</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">labels</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">label</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">labels</span><span class="p">:</span> <span class="c1"># DTABLE</span>
                <span class="n">arg</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dtable_ref</span><span class="p">[</span><span class="n">label</span><span class="p">]</span>
                <span class="n">argsi</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">arg</span><span class="p">)</span>
        <span class="c1">#op2_model.log.info(&#39;DVPREL2; args = %s&#39; % argsi)</span>

        <span class="c1">#op2_model.log.info(&#39;dvids  =&#39;, self.dvids)</span>
        <span class="c1">#op2_model.log.info(&#39;labels =&#39;, self.labels)</span>
        <span class="c1">#op2_model.log.info(&#39;%s[%r] = %s&#39; % (self.element_type, self.cp_name, out))</span>
        <span class="n">out</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">func</span><span class="p">(</span><span class="o">*</span><span class="n">argsi</span><span class="p">)</span>
        <span class="n">op2_model</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s1">&#39;  deqatn out = </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">out</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">out</span></div>

<div class="viewcode-block" id="DVCREL2.cross_reference"><a class="viewcode-back" href="../../../../reference/bdf/cards/pyNastran.bdf.cards.optimization.html#pyNastran.bdf.cards.optimization.DVCREL2.cross_reference">[docs]</a>    <span class="k">def</span> <span class="nf">cross_reference</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">model</span><span class="p">:</span> <span class="n">BDF</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Cross links the card so referenced cards can be extracted directly</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        model : BDF()</span>
<span class="sd">            the BDF object</span>

<span class="sd">        .. todo:: add support for DEQATN cards to finish DVPREL2 xref</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">msg</span> <span class="o">=</span> <span class="s1">&#39;, which is required by DVCREL2 oid=</span><span class="si">%r</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">oid</span>
        <span class="c1">#if self.element_type in self.allowed_elements:</span>
            <span class="c1">#self.pid = model.Element(self.pid, msg=msg)</span>
        <span class="c1">#elif self.element_type in self.allowed_masses:</span>
            <span class="c1">#self.pid = model.masses[self.pid]</span>
        <span class="c1">#elif self.element_type in self.allowed_properties_mass:</span>
            <span class="c1">#self.pid = model.properties_mass[self.pid]</span>
        <span class="c1">#else:</span>
            <span class="c1">#raise NotImplementedError(&#39;element_type=%r is not supported&#39; % self.element_type)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">eid_ref</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">Element</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">eid</span><span class="p">,</span> <span class="n">msg</span><span class="o">=</span><span class="n">msg</span><span class="p">)</span>
        <span class="c1">#self.dvids = [model.Desvar(dvid, msg) for dvid in self.dvids]</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">dvids_ref</span> <span class="o">=</span> <span class="p">[</span><span class="n">model</span><span class="o">.</span><span class="n">Desvar</span><span class="p">(</span><span class="n">dvid</span><span class="p">,</span> <span class="n">msg</span><span class="p">)</span> <span class="k">for</span> <span class="n">dvid</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">dvids</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dequation_ref</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">DEQATN</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dequation</span><span class="p">,</span> <span class="n">msg</span><span class="o">=</span><span class="n">msg</span><span class="p">)</span>
        <span class="k">assert</span> <span class="bp">self</span><span class="o">.</span><span class="n">eid_ref</span><span class="o">.</span><span class="n">type</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">allowed_elements</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">eid</span><span class="o">.</span><span class="n">type</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_check_args</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dtable_ref</span> <span class="o">=</span> <span class="p">{}</span></div>

<div class="viewcode-block" id="DVCREL2.uncross_reference"><a class="viewcode-back" href="../../../../reference/bdf/cards/pyNastran.bdf.cards.optimization.html#pyNastran.bdf.cards.optimization.DVCREL2.uncross_reference">[docs]</a>    <span class="k">def</span> <span class="nf">uncross_reference</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Removes cross-reference links&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">eid</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">Eid</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dvids</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">desvar_ids</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dequation</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">DEquation</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">eid_ref</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dequation_ref</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dtable_ref</span> <span class="o">=</span> <span class="p">{}</span></div>

<div class="viewcode-block" id="DVCREL2._get_element"><a class="viewcode-back" href="../../../../reference/bdf/cards/pyNastran.bdf.cards.optimization.html#pyNastran.bdf.cards.optimization.DVCREL2._get_element">[docs]</a>    <span class="k">def</span> <span class="nf">_get_element</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">model</span><span class="p">,</span> <span class="n">eid</span><span class="p">,</span> <span class="n">msg</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">):</span>
        <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">eid</span><span class="p">,</span> <span class="nb">int</span><span class="p">),</span> <span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">eid</span><span class="p">)</span>
        <span class="c1">#if self.element_type in [&#39;MAT1&#39;]:</span>
        <span class="n">eid_ref</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">Element</span><span class="p">(</span><span class="n">eid</span><span class="p">,</span> <span class="n">msg</span><span class="o">=</span><span class="n">msg</span><span class="p">)</span>
        <span class="c1">#else:</span>
            <span class="c1">#raise NotImplementedError(self.element_type)</span>
        <span class="k">return</span> <span class="n">eid_ref</span></div>

<div class="viewcode-block" id="DVCREL2.update_model"><a class="viewcode-back" href="../../../../reference/bdf/cards/pyNastran.bdf.cards.optimization.html#pyNastran.bdf.cards.optimization.DVCREL2.update_model">[docs]</a>    <span class="k">def</span> <span class="nf">update_model</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">model</span><span class="p">,</span> <span class="n">desvar_values</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;doesn&#39;t require cross-referencing&quot;&quot;&quot;</span>
        <span class="n">values</span> <span class="o">=</span> <span class="n">get_deqatn_value</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">model</span><span class="p">,</span> <span class="n">desvar_values</span><span class="p">)</span>
        <span class="n">elem</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_element</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">eid</span><span class="p">)</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_update_by_dvcrel</span><span class="p">(</span><span class="n">elem</span><span class="p">,</span> <span class="n">values</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span>
            <span class="k">raise</span></div>
            <span class="c1">#raise NotImplementedError(&#39;prop_type=%r is not supported in update_model&#39; % self.prop_type)</span>

<div class="viewcode-block" id="DVCREL2._update_by_dvcrel"><a class="viewcode-back" href="../../../../reference/bdf/cards/pyNastran.bdf.cards.optimization.html#pyNastran.bdf.cards.optimization.DVCREL2._update_by_dvcrel">[docs]</a>    <span class="k">def</span> <span class="nf">_update_by_dvcrel</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">elem</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">elem</span><span class="p">,</span> <span class="s1">&#39;update_by_cp_name&#39;</span><span class="p">):</span>
            <span class="n">elem</span><span class="o">.</span><span class="n">update_by_cp_name</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">cp_name</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">cp_name_map</span> <span class="o">=</span> <span class="n">elem</span><span class="o">.</span><span class="n">cp_name_map</span>
            <span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span>
                <span class="n">msg</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;element_type=</span><span class="si">%r</span><span class="s1"> name=</span><span class="si">%r</span><span class="s1"> has not implemented &#39;</span>
                       <span class="s1">&#39;cp_name_map/update_by_cp_name&#39;</span> <span class="o">%</span> <span class="p">(</span>
                           <span class="bp">self</span><span class="o">.</span><span class="n">element_type</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">cp_name</span><span class="p">))</span>
                <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>

            <span class="k">try</span><span class="p">:</span>
                <span class="n">key</span> <span class="o">=</span> <span class="n">cp_name_map</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">cp_name</span><span class="p">]</span>
            <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
                <span class="n">msg</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;element_type=</span><span class="si">%r</span><span class="s1"> has not implemented </span><span class="si">%r</span><span class="s1"> &#39;</span>
                       <span class="s1">&#39;for in cp_name_map/update_by_cp_name&#39;</span> <span class="o">%</span> <span class="p">(</span>
                           <span class="bp">self</span><span class="o">.</span><span class="n">element_type</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">cp_name</span><span class="p">))</span>
                <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
            <span class="nb">setattr</span><span class="p">(</span><span class="n">elem</span><span class="p">,</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span></div>

<div class="viewcode-block" id="DVCREL2.raw_fields"><a class="viewcode-back" href="../../../../reference/bdf/cards/pyNastran.bdf.cards.optimization.html#pyNastran.bdf.cards.optimization.DVCREL2.raw_fields">[docs]</a>    <span class="k">def</span> <span class="nf">raw_fields</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">list_fields</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;DVCREL2&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">oid</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">element_type</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">Eid</span><span class="p">(),</span>
                       <span class="bp">self</span><span class="o">.</span><span class="n">cp_name</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">cp_min</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">cp_max</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">DEquation</span><span class="p">(),</span> <span class="kc">None</span><span class="p">]</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">dvids</span><span class="p">:</span>
            <span class="n">fields2</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;DESVAR&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">dvids</span>
            <span class="n">list_fields</span> <span class="o">+=</span> <span class="n">build_table_lines</span><span class="p">(</span><span class="n">fields2</span><span class="p">,</span> <span class="n">nstart</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">nend</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">labels</span><span class="p">:</span>
            <span class="n">fields2</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;DTABLE&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">labels</span>
            <span class="n">list_fields</span> <span class="o">+=</span> <span class="n">build_table_lines</span><span class="p">(</span><span class="n">fields2</span><span class="p">,</span> <span class="n">nstart</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">nend</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">list_fields</span></div>

<div class="viewcode-block" id="DVCREL2.repr_fields"><a class="viewcode-back" href="../../../../reference/bdf/cards/pyNastran.bdf.cards.optimization.html#pyNastran.bdf.cards.optimization.DVCREL2.repr_fields">[docs]</a>    <span class="k">def</span> <span class="nf">repr_fields</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        .. todo:: finish repr_fields for DVCREL2</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">raw_fields</span><span class="p">()</span></div>

<div class="viewcode-block" id="DVCREL2.write_card"><a class="viewcode-back" href="../../../../reference/bdf/cards/pyNastran.bdf.cards.optimization.html#pyNastran.bdf.cards.optimization.DVCREL2.write_card">[docs]</a>    <span class="k">def</span> <span class="nf">write_card</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">size</span><span class="p">:</span> <span class="nb">int</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span> <span class="n">is_double</span><span class="p">:</span> <span class="nb">bool</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="n">card</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">repr_fields</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">size</span> <span class="o">==</span> <span class="mi">8</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">comment</span> <span class="o">+</span> <span class="n">print_card_8</span><span class="p">(</span><span class="n">card</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">comment</span> <span class="o">+</span> <span class="n">print_card_16</span><span class="p">(</span><span class="n">card</span><span class="p">)</span></div></div>


<div class="viewcode-block" id="DVMREL1"><a class="viewcode-back" href="../../../../reference/bdf/cards/pyNastran.bdf.cards.optimization.html#pyNastran.bdf.cards.optimization.DVMREL1">[docs]</a><span class="k">class</span> <span class="nc">DVMREL1</span><span class="p">(</span><span class="n">DVXREL1</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Design Variable to Material Relation</span>
<span class="sd">    Defines the relation between a material property and design variables.</span>

<span class="sd">    +---------+-------+-------+-------+--------+-------+-------+--------+</span>
<span class="sd">    |    1    |   2   |   3   |   4   |    5   |   6   |   7   |    8   |</span>
<span class="sd">    +=========+=======+=======+=======+========+=======+=======+========+</span>
<span class="sd">    | DVMREL1 |  ID   | TYPE  |  MID  | MPNAME | MPMIN | MPMAX |   C0   |</span>
<span class="sd">    +---------+-------+-------+-------+--------+-------+-------+--------+</span>
<span class="sd">    |         | DVID1 | COEF1 | DVID2 | COEF2  | DVID3 | COEF3 |  etc.  |</span>
<span class="sd">    +---------+-------+-------+-------+--------+-------+-------+--------+</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="nb">type</span> <span class="o">=</span> <span class="s1">&#39;DVMREL1&#39;</span>
    <span class="n">_properties</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;desvar_ids&#39;</span><span class="p">]</span>

<div class="viewcode-block" id="DVMREL1._init_from_empty"><a class="viewcode-back" href="../../../../reference/bdf/cards/pyNastran.bdf.cards.optimization.html#pyNastran.bdf.cards.optimization.DVMREL1._init_from_empty">[docs]</a>    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">_init_from_empty</span><span class="p">(</span><span class="bp">cls</span><span class="p">):</span>
        <span class="n">oid</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="n">mat_type</span> <span class="o">=</span> <span class="s1">&#39;MAT1&#39;</span>
        <span class="n">mid</span> <span class="o">=</span> <span class="mi">2</span>
        <span class="n">mp_name</span> <span class="o">=</span> <span class="s1">&#39;E&#39;</span>
        <span class="n">dvids</span> <span class="o">=</span> <span class="mi">42</span>
        <span class="n">coeffs</span> <span class="o">=</span> <span class="mf">1.0</span>
        <span class="k">return</span> <span class="n">DVMREL1</span><span class="p">(</span><span class="n">oid</span><span class="p">,</span> <span class="n">mat_type</span><span class="p">,</span> <span class="n">mid</span><span class="p">,</span> <span class="n">mp_name</span><span class="p">,</span> <span class="n">dvids</span><span class="p">,</span> <span class="n">coeffs</span><span class="p">,</span>
                       <span class="n">mp_min</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">mp_max</span><span class="o">=</span><span class="mf">1e20</span><span class="p">,</span> <span class="n">c0</span><span class="o">=</span><span class="mf">0.</span><span class="p">,</span> <span class="n">validate</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">comment</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">)</span></div>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">oid</span><span class="p">,</span> <span class="n">mat_type</span><span class="p">,</span> <span class="n">mid</span><span class="p">,</span> <span class="n">mp_name</span><span class="p">,</span> <span class="n">dvids</span><span class="p">,</span> <span class="n">coeffs</span><span class="p">,</span>
                 <span class="n">mp_min</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">mp_max</span><span class="o">=</span><span class="mf">1e20</span><span class="p">,</span> <span class="n">c0</span><span class="o">=</span><span class="mf">0.</span><span class="p">,</span> <span class="n">validate</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">comment</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Creates a DVMREL1 card</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        oid : int</span>
<span class="sd">            optimization id</span>
<span class="sd">        prop_type : str</span>
<span class="sd">            material card name (e.g., MAT1)</span>
<span class="sd">        mid : int</span>
<span class="sd">            material id</span>
<span class="sd">        mp_name : str</span>
<span class="sd">            optimization parameter as a pname (material name; E)</span>
<span class="sd">        dvids : List[int]</span>
<span class="sd">            DESVAR ids</span>
<span class="sd">        coeffs : List[float]</span>
<span class="sd">            scale factors for DESVAR ids</span>
<span class="sd">        mp_min : float; default=None</span>
<span class="sd">            minimum material property value</span>
<span class="sd">        mp_max : float; default=1e20</span>
<span class="sd">            maximum material property value</span>
<span class="sd">        c0 : float; default=0.</span>
<span class="sd">            offset factor for the variable</span>
<span class="sd">        validate : bool; default=False</span>
<span class="sd">            should the variable be validated</span>
<span class="sd">        comment : str; default=&#39;&#39;</span>
<span class="sd">            a comment for the card</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">DVXREL1</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">oid</span><span class="p">,</span> <span class="n">dvids</span><span class="p">,</span> <span class="n">coeffs</span><span class="p">,</span> <span class="n">c0</span><span class="p">,</span> <span class="n">comment</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">mat_type</span> <span class="o">=</span> <span class="n">mat_type</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mid</span> <span class="o">=</span> <span class="n">mid</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mp_name</span> <span class="o">=</span> <span class="n">mp_name</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mp_max</span> <span class="o">=</span> <span class="n">mp_max</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mp_min</span> <span class="o">=</span> <span class="n">mp_min</span>

        <span class="n">validate_dvmrel</span><span class="p">(</span><span class="n">validate</span><span class="p">,</span> <span class="n">mat_type</span><span class="p">,</span> <span class="n">mp_name</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mid_ref</span> <span class="o">=</span> <span class="kc">None</span>

        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">coeffs</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">msg</span> <span class="o">=</span> <span class="s1">&#39;len(coeffs)=</span><span class="si">%s</span><span class="s1"> len(dvids)=</span><span class="si">%s</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">coeffs</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dvids</span><span class="p">))</span>
            <span class="n">msg</span> <span class="o">+=</span> <span class="s2">&quot;We&#39;ve added a coeff=1.0 and desvar_id=1 in order to look at the crashing card</span><span class="se">\n</span><span class="s2">&quot;</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">coeffs</span> <span class="o">=</span> <span class="p">[</span><span class="mf">1.</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">dvids</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">]</span>
            <span class="n">msg</span> <span class="o">+=</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
            <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
        <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">coeffs</span><span class="p">)</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dvids</span><span class="p">),</span> <span class="s1">&#39;len(coeffs)=</span><span class="si">%s</span><span class="s1"> len(dvids)=</span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">coeffs</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dvids</span><span class="p">))</span>

<div class="viewcode-block" id="DVMREL1.add_card"><a class="viewcode-back" href="../../../../reference/bdf/cards/pyNastran.bdf.cards.optimization.html#pyNastran.bdf.cards.optimization.DVMREL1.add_card">[docs]</a>    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">add_card</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">card</span><span class="p">,</span> <span class="n">comment</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Adds a DVMREL1 card from ``BDF.add_card(...)``</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        card : BDFCard()</span>
<span class="sd">            a BDFCard object</span>
<span class="sd">        comment : str; default=&#39;&#39;</span>
<span class="sd">            a comment for the card</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">oid</span> <span class="o">=</span> <span class="n">integer</span><span class="p">(</span><span class="n">card</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;oid&#39;</span><span class="p">)</span>
        <span class="n">mat_type</span> <span class="o">=</span> <span class="n">string</span><span class="p">(</span><span class="n">card</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;mat_type&#39;</span><span class="p">)</span>
        <span class="n">mid</span> <span class="o">=</span> <span class="n">integer</span><span class="p">(</span><span class="n">card</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="s1">&#39;mid&#39;</span><span class="p">)</span>
        <span class="n">mp_name</span> <span class="o">=</span> <span class="n">string</span><span class="p">(</span><span class="n">card</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="s1">&#39;mpName&#39;</span><span class="p">)</span>
        <span class="c1">#if self.mp_name in [&#39;E&#39;, &#39;RHO&#39;, &#39;NU&#39;]:  positive values</span>
            <span class="c1">#self.mp_min = double_or_blank(card, 5, &#39;mpMin&#39;, 1e-15)</span>
        <span class="c1">#else: # negative</span>
            <span class="c1">#self.mp_min = double_or_blank(card, 5, &#39;mpMin&#39;, -1e-35)</span>
        <span class="n">mp_min</span> <span class="o">=</span> <span class="n">double_or_blank</span><span class="p">(</span><span class="n">card</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="s1">&#39;mp_min&#39;</span><span class="p">)</span>  <span class="c1">#: .. todo:: bad default</span>
        <span class="n">mp_max</span> <span class="o">=</span> <span class="n">double_or_blank</span><span class="p">(</span><span class="n">card</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="s1">&#39;mp_max&#39;</span><span class="p">,</span> <span class="mf">1e20</span><span class="p">)</span>
        <span class="n">c0</span> <span class="o">=</span> <span class="n">double_or_blank</span><span class="p">(</span><span class="n">card</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="s1">&#39;c0&#39;</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">)</span>

        <span class="n">dvids</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">coeffs</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">end_fields</span> <span class="o">=</span> <span class="p">[</span><span class="n">interpret_value</span><span class="p">(</span><span class="n">field</span><span class="p">)</span> <span class="k">for</span> <span class="n">field</span> <span class="ow">in</span> <span class="n">card</span><span class="p">[</span><span class="mi">9</span><span class="p">:]]</span>
        <span class="n">nfields</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">end_fields</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span>
        <span class="k">if</span> <span class="n">nfields</span> <span class="o">%</span> <span class="mi">2</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">end_fields</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="kc">None</span><span class="p">)</span>
            <span class="n">nfields</span> <span class="o">+=</span> <span class="mi">1</span>

        <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">nfields</span><span class="p">,</span> <span class="mi">2</span><span class="p">):</span>
            <span class="n">dvids</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">end_fields</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
            <span class="n">coeffs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">end_fields</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">])</span>
        <span class="k">if</span> <span class="n">nfields</span> <span class="o">%</span> <span class="mi">2</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">card</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;dvids = </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">dvids</span><span class="p">))</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;coeffs = </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">coeffs</span><span class="p">))</span>
            <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s1">&#39;invalid DVMREL1...&#39;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">DVMREL1</span><span class="p">(</span><span class="n">oid</span><span class="p">,</span> <span class="n">mat_type</span><span class="p">,</span> <span class="n">mid</span><span class="p">,</span> <span class="n">mp_name</span><span class="p">,</span> <span class="n">dvids</span><span class="p">,</span> <span class="n">coeffs</span><span class="p">,</span>
                       <span class="n">mp_min</span><span class="o">=</span><span class="n">mp_min</span><span class="p">,</span> <span class="n">mp_max</span><span class="o">=</span><span class="n">mp_max</span><span class="p">,</span> <span class="n">c0</span><span class="o">=</span><span class="n">c0</span><span class="p">,</span> <span class="n">comment</span><span class="o">=</span><span class="n">comment</span><span class="p">)</span></div>

<div class="viewcode-block" id="DVMREL1.object_attributes"><a class="viewcode-back" href="../../../../reference/bdf/cards/pyNastran.bdf.cards.optimization.html#pyNastran.bdf.cards.optimization.DVMREL1.object_attributes">[docs]</a>    <span class="k">def</span> <span class="nf">object_attributes</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;public&#39;</span><span class="p">,</span> <span class="n">keys_to_skip</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                          <span class="n">filter_properties</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;.. seealso:: `pyNastran.utils.object_attributes(...)`&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">keys_to_skip</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">keys_to_skip</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="n">my_keys_to_skip</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Type&#39;</span><span class="p">]</span>
        <span class="k">return</span> <span class="nb">super</span><span class="p">(</span><span class="n">DVMREL1</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">object_attributes</span><span class="p">(</span>
            <span class="n">mode</span><span class="o">=</span><span class="n">mode</span><span class="p">,</span> <span class="n">keys_to_skip</span><span class="o">=</span><span class="n">keys_to_skip</span><span class="o">+</span><span class="n">my_keys_to_skip</span><span class="p">,</span>
            <span class="n">filter_properties</span><span class="o">=</span><span class="n">filter_properties</span><span class="p">)</span></div>

<div class="viewcode-block" id="DVMREL1.update_model"><a class="viewcode-back" href="../../../../reference/bdf/cards/pyNastran.bdf.cards.optimization.html#pyNastran.bdf.cards.optimization.DVMREL1.update_model">[docs]</a>    <span class="k">def</span> <span class="nf">update_model</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">model</span><span class="p">,</span> <span class="n">desvar_values</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;doesn&#39;t require cross-referencing&quot;&quot;&quot;</span>
        <span class="n">value</span> <span class="o">=</span> <span class="n">get_dvxrel1_coeffs</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">model</span><span class="p">,</span> <span class="n">desvar_values</span><span class="p">)</span>
        <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mid</span><span class="p">,</span> <span class="nb">int</span><span class="p">),</span> <span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mid</span><span class="p">)</span>
        <span class="n">mat</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">materials</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">mid</span><span class="p">]</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_update_by_dvmrel</span><span class="p">(</span><span class="n">mat</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span>
            <span class="k">raise</span></div>
            <span class="c1">#raise NotImplementedError(&#39;mat_type=%r is not supported in update_model&#39; % self.mat_type)</span>

<div class="viewcode-block" id="DVMREL1._update_by_dvmrel"><a class="viewcode-back" href="../../../../reference/bdf/cards/pyNastran.bdf.cards.optimization.html#pyNastran.bdf.cards.optimization.DVMREL1._update_by_dvmrel">[docs]</a>    <span class="k">def</span> <span class="nf">_update_by_dvmrel</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">mat</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">mp_name_map</span> <span class="o">=</span> <span class="n">mat</span><span class="o">.</span><span class="n">mp_name_map</span>
        <span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="s1">&#39;mat_type=</span><span class="si">%r</span><span class="s1">, mp_name=</span><span class="si">%r</span><span class="s1"> has not implemented mp_name_map&#39;</span> <span class="o">%</span> <span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">mat_type</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">mp_name</span><span class="p">))</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="n">key</span> <span class="o">=</span> <span class="n">mp_name_map</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">mp_name</span><span class="p">]</span>
        <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="s1">&#39;mat_type=</span><span class="si">%r</span><span class="s1"> has not implemented </span><span class="si">%r</span><span class="s1"> for in mp_name_map&#39;</span> <span class="o">%</span> <span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">mat_type</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">mp_name</span><span class="p">))</span>
        <span class="nb">setattr</span><span class="p">(</span><span class="n">mat</span><span class="p">,</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span></div>

<div class="viewcode-block" id="DVMREL1.cross_reference"><a class="viewcode-back" href="../../../../reference/bdf/cards/pyNastran.bdf.cards.optimization.html#pyNastran.bdf.cards.optimization.DVMREL1.cross_reference">[docs]</a>    <span class="k">def</span> <span class="nf">cross_reference</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">model</span><span class="p">:</span> <span class="n">BDF</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Cross links the card so referenced cards can be extracted directly</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        model : BDF()</span>
<span class="sd">            the BDF object</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">msg</span> <span class="o">=</span> <span class="s1">&#39;, which is required by DVMREL1 oid=</span><span class="si">%r</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">oid</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mid_ref</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">Material</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mid</span><span class="p">,</span> <span class="n">msg</span><span class="o">=</span><span class="n">msg</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dvids_ref</span> <span class="o">=</span> <span class="p">[</span><span class="n">model</span><span class="o">.</span><span class="n">Desvar</span><span class="p">(</span><span class="n">dvid</span><span class="p">,</span> <span class="n">msg</span><span class="p">)</span> <span class="k">for</span> <span class="n">dvid</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">dvids</span><span class="p">]</span></div>

<div class="viewcode-block" id="DVMREL1.uncross_reference"><a class="viewcode-back" href="../../../../reference/bdf/cards/pyNastran.bdf.cards.optimization.html#pyNastran.bdf.cards.optimization.DVMREL1.uncross_reference">[docs]</a>    <span class="k">def</span> <span class="nf">uncross_reference</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Removes cross-reference links&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mid</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">Mid</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dvids</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">desvar_ids</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mid_ref</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dvids_ref</span> <span class="o">=</span> <span class="kc">None</span></div>

    <span class="k">def</span> <span class="nf">_verify</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">xref</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Verifies all methods for this object work</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        xref : bool</span>
<span class="sd">            has this model been cross referenced</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">pass</span>

<div class="viewcode-block" id="DVMREL1.OptID"><a class="viewcode-back" href="../../../../reference/bdf/cards/pyNastran.bdf.cards.optimization.html#pyNastran.bdf.cards.optimization.DVMREL1.OptID">[docs]</a>    <span class="k">def</span> <span class="nf">OptID</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">oid</span></div>

<div class="viewcode-block" id="DVMREL1.Mid"><a class="viewcode-back" href="../../../../reference/bdf/cards/pyNastran.bdf.cards.optimization.html#pyNastran.bdf.cards.optimization.DVMREL1.Mid">[docs]</a>    <span class="k">def</span> <span class="nf">Mid</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">mid_ref</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">mid_ref</span><span class="o">.</span><span class="n">mid</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">mid</span></div>

<div class="viewcode-block" id="DVMREL1.raw_fields"><a class="viewcode-back" href="../../../../reference/bdf/cards/pyNastran.bdf.cards.optimization.html#pyNastran.bdf.cards.optimization.DVMREL1.raw_fields">[docs]</a>    <span class="k">def</span> <span class="nf">raw_fields</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">list_fields</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;DVMREL1&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">oid</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">mat_type</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">Mid</span><span class="p">(),</span>
                       <span class="bp">self</span><span class="o">.</span><span class="n">mp_name</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">mp_min</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">mp_max</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">c0</span><span class="p">,</span> <span class="kc">None</span><span class="p">]</span>
        <span class="k">for</span> <span class="p">(</span><span class="n">dvid</span><span class="p">,</span> <span class="n">coeff</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dvids</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">coeffs</span><span class="p">):</span>
            <span class="n">list_fields</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">dvid</span><span class="p">)</span>
            <span class="n">list_fields</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">coeff</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">list_fields</span></div>

<div class="viewcode-block" id="DVMREL1.repr_fields"><a class="viewcode-back" href="../../../../reference/bdf/cards/pyNastran.bdf.cards.optimization.html#pyNastran.bdf.cards.optimization.DVMREL1.repr_fields">[docs]</a>    <span class="k">def</span> <span class="nf">repr_fields</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">mp_max</span> <span class="o">=</span> <span class="n">set_blank_if_default</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mp_max</span><span class="p">,</span> <span class="mf">1e20</span><span class="p">)</span>
        <span class="n">c0</span> <span class="o">=</span> <span class="n">set_blank_if_default</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">c0</span><span class="p">,</span> <span class="mf">0.</span><span class="p">)</span>
        <span class="n">list_fields</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;DVMREL1&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">oid</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">mat_type</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">Mid</span><span class="p">(),</span>
                       <span class="bp">self</span><span class="o">.</span><span class="n">mp_name</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">mp_min</span><span class="p">,</span> <span class="n">mp_max</span><span class="p">,</span> <span class="n">c0</span><span class="p">,</span> <span class="kc">None</span><span class="p">]</span>
        <span class="k">for</span> <span class="p">(</span><span class="n">dvid</span><span class="p">,</span> <span class="n">coeff</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dvids</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">coeffs</span><span class="p">):</span>
            <span class="n">list_fields</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">dvid</span><span class="p">)</span>
            <span class="n">list_fields</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">coeff</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">list_fields</span></div>

<div class="viewcode-block" id="DVMREL1.write_card"><a class="viewcode-back" href="../../../../reference/bdf/cards/pyNastran.bdf.cards.optimization.html#pyNastran.bdf.cards.optimization.DVMREL1.write_card">[docs]</a>    <span class="k">def</span> <span class="nf">write_card</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">size</span><span class="p">:</span> <span class="nb">int</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span> <span class="n">is_double</span><span class="p">:</span> <span class="nb">bool</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="n">card</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">repr_fields</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">size</span> <span class="o">==</span> <span class="mi">8</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">comment</span> <span class="o">+</span> <span class="n">print_card_8</span><span class="p">(</span><span class="n">card</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">is_double</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">comment</span> <span class="o">+</span> <span class="n">print_card_double</span><span class="p">(</span><span class="n">card</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">comment</span> <span class="o">+</span> <span class="n">print_card_16</span><span class="p">(</span><span class="n">card</span><span class="p">)</span></div></div>


<div class="viewcode-block" id="DVMREL2"><a class="viewcode-back" href="../../../../reference/bdf/cards/pyNastran.bdf.cards.optimization.html#pyNastran.bdf.cards.optimization.DVMREL2">[docs]</a><span class="k">class</span> <span class="nc">DVMREL2</span><span class="p">(</span><span class="n">DVXREL2</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    +---------+--------+--------+-------+---------+-------+-------+-------+-------+</span>
<span class="sd">    |    1    |    2   |   3    |   4   |     5   |   6   |   7   |   8   |   9   |</span>
<span class="sd">    +=========+========+========+=======+=========+=======+=======+=======+=======+</span>
<span class="sd">    | DVMREL2 |   ID   | TYPE   |  MID  | MPNAME  | MPMIN | MPMAX | EQID  |       |</span>
<span class="sd">    +---------+--------+--------+-------+---------+-------+-------+-------+-------+</span>
<span class="sd">    |         | DESVAR | DVID1  | DVID2 | DVID3   | DVID4 | DVID5 | DVID6 | DVID7 |</span>
<span class="sd">    +---------+--------+--------+-------+---------+-------+-------+-------+-------+</span>
<span class="sd">    |         | DVID8  |  etc.  |       |         |       |       |       |       |</span>
<span class="sd">    +---------+--------+--------+-------+---------+-------+-------+-------+-------+</span>
<span class="sd">    |         | DTABLE | LABL1  | LABL2 | LABL3   | LABL4 | LABL5 | LABL6 | LABL7 |</span>
<span class="sd">    +---------+--------+--------+-------+---------+-------+-------+-------+-------+</span>
<span class="sd">    |         | LABL8  |  etc.  |       |         |       |       |       |       |</span>
<span class="sd">    +---------+--------+--------+-------+---------+-------+-------+-------+-------+</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="nb">type</span> <span class="o">=</span> <span class="s1">&#39;DVMREL2&#39;</span>

    <span class="n">allowed_materials</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;MAT1&#39;</span><span class="p">,</span> <span class="s1">&#39;MAT2&#39;</span><span class="p">]</span>
    <span class="n">_properties</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;desvar_ids&#39;</span><span class="p">]</span>

<div class="viewcode-block" id="DVMREL2._init_from_empty"><a class="viewcode-back" href="../../../../reference/bdf/cards/pyNastran.bdf.cards.optimization.html#pyNastran.bdf.cards.optimization.DVMREL2._init_from_empty">[docs]</a>    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">_init_from_empty</span><span class="p">(</span><span class="bp">cls</span><span class="p">):</span>
        <span class="n">oid</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="n">mat_type</span> <span class="o">=</span> <span class="s1">&#39;MAT1&#39;</span>
        <span class="n">mid</span> <span class="o">=</span> <span class="mi">2</span>
        <span class="n">mp_name</span> <span class="o">=</span> <span class="s1">&#39;E&#39;</span>
        <span class="n">dvids</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">labels</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">deqation</span> <span class="o">=</span> <span class="mi">42</span>
        <span class="k">return</span> <span class="n">DVMREL2</span><span class="p">(</span><span class="n">oid</span><span class="p">,</span> <span class="n">mat_type</span><span class="p">,</span> <span class="n">mid</span><span class="p">,</span> <span class="n">mp_name</span><span class="p">,</span> <span class="n">deqation</span><span class="p">,</span> <span class="n">dvids</span><span class="p">,</span> <span class="n">labels</span><span class="p">,</span>
                       <span class="n">mp_min</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">mp_max</span><span class="o">=</span><span class="mf">1e20</span><span class="p">,</span> <span class="n">validate</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">comment</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">)</span></div>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">oid</span><span class="p">,</span> <span class="n">mat_type</span><span class="p">,</span> <span class="n">mid</span><span class="p">,</span> <span class="n">mp_name</span><span class="p">,</span> <span class="n">deqation</span><span class="p">,</span> <span class="n">dvids</span><span class="p">,</span> <span class="n">labels</span><span class="p">,</span>
                 <span class="n">mp_min</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">mp_max</span><span class="o">=</span><span class="mf">1e20</span><span class="p">,</span> <span class="n">validate</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">comment</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Creates a DVMREL2 card</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        oid : int</span>
<span class="sd">            optimization id</span>
<span class="sd">        mat_type : str</span>
<span class="sd">            material card name (e.g., MAT1)</span>
<span class="sd">        mid : int</span>
<span class="sd">            material id</span>
<span class="sd">        mp_name : str</span>
<span class="sd">            optimization parameter as a pname (material name; E)</span>
<span class="sd">        deqation : int</span>
<span class="sd">            DEQATN id</span>
<span class="sd">        dvids : List[int]; default=None</span>
<span class="sd">            DESVAR ids</span>
<span class="sd">        labels : List[str]; default=None</span>
<span class="sd">            DTABLE names</span>
<span class="sd">        mp_min : float; default=None</span>
<span class="sd">            minimum material property value</span>
<span class="sd">        mp_max : float; default=1e20</span>
<span class="sd">            maximum material property value</span>
<span class="sd">        validate : bool; default=False</span>
<span class="sd">            should the variable be validated</span>
<span class="sd">        comment : str; default=&#39;&#39;</span>
<span class="sd">            a comment for the card</span>

<span class="sd">        .. note:: either dvids or labels is required</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">DVXREL2</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">oid</span><span class="p">,</span> <span class="n">dvids</span><span class="p">,</span> <span class="n">labels</span><span class="p">,</span> <span class="n">deqation</span><span class="p">,</span> <span class="n">comment</span><span class="p">)</span>

        <span class="c1">#: Name of a material entry, such as MAT1, MAT2, etc</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mat_type</span> <span class="o">=</span> <span class="n">mat_type</span>

        <span class="c1">#: Property entry identification number</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mid</span> <span class="o">=</span> <span class="n">mid</span>

        <span class="c1">#: Property name, such as &#39;E&#39;, &#39;RHO&#39;</span>
        <span class="c1">#: (Character)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mp_name</span> <span class="o">=</span> <span class="n">mp_name</span>

        <span class="c1">#: Minimum value allowed for this property. If MPNAME references a material</span>
        <span class="c1">#: property that can only be positive, then the default value for MPMIN is 1.0E-15.</span>
        <span class="c1">#: Otherwise, it is -1.0E35. (Real)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mp_min</span> <span class="o">=</span> <span class="n">mp_min</span>

        <span class="c1">#: Maximum value allowed for this property. (Real; Default = 1.0E20)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mp_max</span> <span class="o">=</span> <span class="n">mp_max</span>

        <span class="n">validate_dvmrel</span><span class="p">(</span><span class="n">validate</span><span class="p">,</span> <span class="n">mat_type</span><span class="p">,</span> <span class="n">mp_name</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mid_ref</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dequation_ref</span> <span class="o">=</span> <span class="kc">None</span>

<div class="viewcode-block" id="DVMREL2.add_card"><a class="viewcode-back" href="../../../../reference/bdf/cards/pyNastran.bdf.cards.optimization.html#pyNastran.bdf.cards.optimization.DVMREL2.add_card">[docs]</a>    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">add_card</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">card</span><span class="p">,</span> <span class="n">comment</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Adds a DVMREL2 card from ``BDF.add_card(...)``</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        card : BDFCard()</span>
<span class="sd">            a BDFCard object</span>
<span class="sd">        comment : str; default=&#39;&#39;</span>
<span class="sd">            a comment for the card</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">oid</span> <span class="o">=</span> <span class="n">integer</span><span class="p">(</span><span class="n">card</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;oid&#39;</span><span class="p">)</span>
        <span class="n">mat_type</span> <span class="o">=</span> <span class="n">string</span><span class="p">(</span><span class="n">card</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;mat_type&#39;</span><span class="p">)</span>
        <span class="n">mid</span> <span class="o">=</span> <span class="n">integer</span><span class="p">(</span><span class="n">card</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="s1">&#39;mid&#39;</span><span class="p">)</span>
        <span class="n">mp_name</span> <span class="o">=</span> <span class="n">integer_or_string</span><span class="p">(</span><span class="n">card</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="s1">&#39;mp_name&#39;</span><span class="p">)</span>
        <span class="n">mp_min</span> <span class="o">=</span> <span class="n">double_or_blank</span><span class="p">(</span><span class="n">card</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="s1">&#39;mp_min&#39;</span><span class="p">)</span>
        <span class="n">mp_max</span> <span class="o">=</span> <span class="n">double_or_blank</span><span class="p">(</span><span class="n">card</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="s1">&#39;mp_max&#39;</span><span class="p">,</span> <span class="mf">1e20</span><span class="p">)</span>
        <span class="n">dequation</span> <span class="o">=</span> <span class="n">integer_or_blank</span><span class="p">(</span><span class="n">card</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="s1">&#39;dequation&#39;</span><span class="p">)</span> <span class="c1">#: .. todo:: or blank?</span>

        <span class="n">fields</span> <span class="o">=</span> <span class="p">[</span><span class="n">interpret_value</span><span class="p">(</span><span class="n">field</span><span class="p">)</span> <span class="k">for</span> <span class="n">field</span> <span class="ow">in</span> <span class="n">card</span><span class="p">[</span><span class="mi">9</span><span class="p">:]]</span>
        <span class="n">ioffset</span> <span class="o">=</span> <span class="mi">9</span>
        <span class="n">iend</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">fields</span><span class="p">)</span> <span class="o">+</span> <span class="n">ioffset</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="n">idesvar</span> <span class="o">=</span> <span class="n">fields</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="s1">&#39;DESVAR&#39;</span><span class="p">)</span> <span class="o">+</span> <span class="n">ioffset</span>
        <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
            <span class="n">idesvar</span> <span class="o">=</span> <span class="kc">None</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="n">idtable</span> <span class="o">=</span> <span class="n">fields</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="s1">&#39;DTABLE&#39;</span><span class="p">)</span> <span class="o">+</span> <span class="n">ioffset</span>
            <span class="c1">#iDesMax  = idtable # the index to start parsing DESVAR</span>
            <span class="n">ides_stop</span> <span class="o">=</span> <span class="n">idtable</span>  <span class="c1"># the index to stop  parsing DESVAR</span>
        <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
            <span class="n">idtable</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="n">ides_stop</span> <span class="o">=</span> <span class="n">iend</span>

        <span class="n">dvids</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">if</span> <span class="n">idesvar</span><span class="p">:</span>
            <span class="n">n</span> <span class="o">=</span> <span class="mi">1</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="n">ides_stop</span><span class="p">):</span>
                <span class="n">dvid_name</span> <span class="o">=</span> <span class="s1">&#39;DVID&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
                <span class="n">dvid</span> <span class="o">=</span> <span class="n">integer_or_blank</span><span class="p">(</span><span class="n">card</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">dvid_name</span><span class="p">)</span>
                <span class="c1">#print(&quot;%s = %s&quot; % (dvid_name, dvid))</span>
                <span class="k">if</span> <span class="n">dvid</span><span class="p">:</span>
                    <span class="k">assert</span> <span class="n">dvid</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
                    <span class="k">assert</span> <span class="n">dvid</span> <span class="o">!=</span> <span class="s1">&#39;DESVAR&#39;</span>
                    <span class="n">dvids</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">dvid</span><span class="p">)</span>
                    <span class="n">n</span> <span class="o">+=</span> <span class="mi">1</span>

        <span class="n">labels</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">if</span> <span class="n">idtable</span><span class="p">:</span>
            <span class="n">n</span> <span class="o">=</span> <span class="mi">1</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">idtable</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">iend</span><span class="p">):</span>
                <span class="n">label_name</span> <span class="o">=</span> <span class="s1">&#39;Label&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
                <span class="n">label</span> <span class="o">=</span> <span class="n">string</span><span class="p">(</span><span class="n">card</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">label_name</span><span class="p">)</span>
                <span class="c1">#print(&quot;%s = %s&quot; % (label_name, label))</span>
                <span class="k">if</span> <span class="n">label</span><span class="p">:</span>
                    <span class="k">assert</span> <span class="n">label</span> <span class="o">!=</span> <span class="s1">&#39;DTABLE&#39;</span>
                    <span class="n">labels</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">label</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">DVMREL2</span><span class="p">(</span><span class="n">oid</span><span class="p">,</span> <span class="n">mat_type</span><span class="p">,</span> <span class="n">mid</span><span class="p">,</span> <span class="n">mp_name</span><span class="p">,</span> <span class="n">dequation</span><span class="p">,</span> <span class="n">dvids</span><span class="p">,</span> <span class="n">labels</span><span class="p">,</span>
                       <span class="n">mp_min</span><span class="o">=</span><span class="n">mp_min</span><span class="p">,</span> <span class="n">mp_max</span><span class="o">=</span><span class="n">mp_max</span><span class="p">,</span> <span class="n">comment</span><span class="o">=</span><span class="n">comment</span><span class="p">)</span></div>

<div class="viewcode-block" id="DVMREL2._get_material"><a class="viewcode-back" href="../../../../reference/bdf/cards/pyNastran.bdf.cards.optimization.html#pyNastran.bdf.cards.optimization.DVMREL2._get_material">[docs]</a>    <span class="k">def</span> <span class="nf">_get_material</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">model</span><span class="p">,</span> <span class="n">mid</span><span class="p">,</span> <span class="n">msg</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">):</span>
        <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mid</span><span class="p">,</span> <span class="nb">int</span><span class="p">),</span> <span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mid</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">mat_type</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;MAT1&#39;</span><span class="p">]:</span>
            <span class="n">mid_ref</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">Material</span><span class="p">(</span><span class="n">mid</span><span class="p">,</span> <span class="n">msg</span><span class="o">=</span><span class="n">msg</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mat_type</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">mid_ref</span></div>

<div class="viewcode-block" id="DVMREL2.update_model"><a class="viewcode-back" href="../../../../reference/bdf/cards/pyNastran.bdf.cards.optimization.html#pyNastran.bdf.cards.optimization.DVMREL2.update_model">[docs]</a>    <span class="k">def</span> <span class="nf">update_model</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">model</span><span class="p">,</span> <span class="n">desvar_values</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;doesn&#39;t require cross-referencing&quot;&quot;&quot;</span>
        <span class="n">values</span> <span class="o">=</span> <span class="n">get_deqatn_value</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">model</span><span class="p">,</span> <span class="n">desvar_values</span><span class="p">)</span>
        <span class="n">mat</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_material</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">mid</span><span class="p">)</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_update_by_dvmrel</span><span class="p">(</span><span class="n">mat</span><span class="p">,</span> <span class="n">values</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span>
            <span class="k">raise</span></div>
            <span class="c1">#raise NotImplementedError(&#39;prop_type=%r is not supported in update_model&#39; % self.prop_type)</span>

<div class="viewcode-block" id="DVMREL2._update_by_dvmrel"><a class="viewcode-back" href="../../../../reference/bdf/cards/pyNastran.bdf.cards.optimization.html#pyNastran.bdf.cards.optimization.DVMREL2._update_by_dvmrel">[docs]</a>    <span class="k">def</span> <span class="nf">_update_by_dvmrel</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">mat</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">mat</span><span class="p">,</span> <span class="s1">&#39;update_by_mp_name&#39;</span><span class="p">):</span>
            <span class="n">mat</span><span class="o">.</span><span class="n">update_by_mname</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mp_name</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">mp_name_map</span> <span class="o">=</span> <span class="n">mat</span><span class="o">.</span><span class="n">mp_name_map</span>
            <span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span>
                <span class="n">msg</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;mat_type=</span><span class="si">%r</span><span class="s1"> name=</span><span class="si">%r</span><span class="s1"> has not implemented &#39;</span>
                       <span class="s1">&#39;mp_name_map/update_by_mp_name&#39;</span> <span class="o">%</span> <span class="p">(</span>
                           <span class="bp">self</span><span class="o">.</span><span class="n">mat_type</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">mp_name</span><span class="p">))</span>
                <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>

            <span class="k">try</span><span class="p">:</span>
                <span class="n">key</span> <span class="o">=</span> <span class="n">mp_name_map</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">mp_name</span><span class="p">]</span>
            <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
                <span class="n">msg</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;mat_type=</span><span class="si">%r</span><span class="s1"> has not implemented </span><span class="si">%r</span><span class="s1"> &#39;</span>
                       <span class="s1">&#39;for in mp_name_map/update_by_mp_name&#39;</span> <span class="o">%</span> <span class="p">(</span>
                           <span class="bp">self</span><span class="o">.</span><span class="n">mat_type</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">mp_name</span><span class="p">))</span>
                <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
            <span class="nb">setattr</span><span class="p">(</span><span class="n">mat</span><span class="p">,</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span></div>

<div class="viewcode-block" id="DVMREL2.OptID"><a class="viewcode-back" href="../../../../reference/bdf/cards/pyNastran.bdf.cards.optimization.html#pyNastran.bdf.cards.optimization.DVMREL2.OptID">[docs]</a>    <span class="k">def</span> <span class="nf">OptID</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">oid</span></div>

<div class="viewcode-block" id="DVMREL2.Mid"><a class="viewcode-back" href="../../../../reference/bdf/cards/pyNastran.bdf.cards.optimization.html#pyNastran.bdf.cards.optimization.DVMREL2.Mid">[docs]</a>    <span class="k">def</span> <span class="nf">Mid</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">mid_ref</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">mid</span>
        <span class="c1">#if self.mat_type in self.allowed_properties:</span>
            <span class="c1">#pid = self.pid_ref.pid</span>
        <span class="c1">#elif self.mat_type in self.allowed_elements:</span>
            <span class="c1">#pid = self.pid_ref.eid</span>
        <span class="c1">#elif self.mat_type in self.allowed_masses:</span>
            <span class="c1">#pid = self.pid_ref.eid</span>
        <span class="c1">#elif self.mat_type in self.allowed_properties_mass:</span>
            <span class="c1">#pid = self.pid_ref.pid</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">mat_type</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">allowed_materials</span><span class="p">:</span>
            <span class="n">mid</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">mid_ref</span><span class="o">.</span><span class="n">mid</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="s1">&#39;mat_type=</span><span class="si">%r</span><span class="s1"> is not supported&#39;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">mat_type</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">mid</span></div>

<div class="viewcode-block" id="DVMREL2.object_attributes"><a class="viewcode-back" href="../../../../reference/bdf/cards/pyNastran.bdf.cards.optimization.html#pyNastran.bdf.cards.optimization.DVMREL2.object_attributes">[docs]</a>    <span class="k">def</span> <span class="nf">object_attributes</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;public&#39;</span><span class="p">,</span> <span class="n">keys_to_skip</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                          <span class="n">filter_properties</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;.. seealso:: `pyNastran.utils.object_attributes(...)`&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">keys_to_skip</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">keys_to_skip</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="n">my_keys_to_skip</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Type&#39;</span><span class="p">]</span>
        <span class="k">return</span> <span class="nb">super</span><span class="p">(</span><span class="n">DVMREL2</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">object_attributes</span><span class="p">(</span>
            <span class="n">mode</span><span class="o">=</span><span class="n">mode</span><span class="p">,</span> <span class="n">keys_to_skip</span><span class="o">=</span><span class="n">keys_to_skip</span><span class="o">+</span><span class="n">my_keys_to_skip</span><span class="p">,</span>
            <span class="n">filter_properties</span><span class="o">=</span><span class="n">filter_properties</span><span class="p">,</span>
        <span class="p">)</span></div>

<div class="viewcode-block" id="DVMREL2.DEquation"><a class="viewcode-back" href="../../../../reference/bdf/cards/pyNastran.bdf.cards.optimization.html#pyNastran.bdf.cards.optimization.DVMREL2.DEquation">[docs]</a>    <span class="k">def</span> <span class="nf">DEquation</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">dequation_ref</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">dequation</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">dequation_ref</span><span class="o">.</span><span class="n">equation_id</span></div>

<div class="viewcode-block" id="DVMREL2.calculate"><a class="viewcode-back" href="../../../../reference/bdf/cards/pyNastran.bdf.cards.optimization.html#pyNastran.bdf.cards.optimization.DVMREL2.calculate">[docs]</a>    <span class="k">def</span> <span class="nf">calculate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">op2_model</span><span class="p">,</span> <span class="n">subcase_id</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        this should really make a call the the DEQATN;</span>
<span class="sd">        see the PBEAM for an example of get/set_opt_value</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">get</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">mid_ref</span><span class="o">.</span><span class="n">get_optimization_value</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mp_name</span><span class="p">)</span>
            <span class="n">out</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">mid_ref</span><span class="o">.</span><span class="n">set_optimization_value</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mp_name</span><span class="p">,</span> <span class="n">get</span><span class="p">)</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;DVMREL2 calculate : </span><span class="si">%s</span><span class="s1">[</span><span class="si">%r</span><span class="s1">] = ???&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mat_type</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">mp_name</span><span class="p">))</span>
            <span class="k">raise</span>

        <span class="n">argsi</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">dvids_ref</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">desvar</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">dvids_ref</span><span class="p">:</span> <span class="c1"># DESVARS</span>
                <span class="n">arg</span> <span class="o">=</span> <span class="n">desvar</span><span class="o">.</span><span class="n">calculate</span><span class="p">(</span><span class="n">op2_model</span><span class="p">,</span> <span class="n">subcase_id</span><span class="p">)</span>
                <span class="n">argsi</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">arg</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">labels</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">label</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">labels</span><span class="p">:</span> <span class="c1"># DTABLE</span>
                <span class="n">arg</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dtable_ref</span><span class="p">[</span><span class="n">label</span><span class="p">]</span>
                <span class="n">argsi</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">arg</span><span class="p">)</span>
        <span class="c1">#op2_model.log.info(&#39;DVMREL2; args = %s&#39; % argsi)</span>

        <span class="c1">#op2_model.log.info(&#39;dvids  =&#39;, self.dvids)</span>
        <span class="c1">#op2_model.log.info(&#39;labels =&#39;, self.labels)</span>
        <span class="c1">#op2_model.log.info(&#39;%s[%r] = %s&#39; % (self.mat_type, self.cp_name, out))</span>
        <span class="n">out</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">func</span><span class="p">(</span><span class="o">*</span><span class="n">argsi</span><span class="p">)</span>
        <span class="n">op2_model</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s1">&#39;  deqatn out = </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">out</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">out</span></div>
        <span class="c1">#raise NotImplementedError(&#39;\n&#39; + str(self))</span>

<div class="viewcode-block" id="DVMREL2.cross_reference"><a class="viewcode-back" href="../../../../reference/bdf/cards/pyNastran.bdf.cards.optimization.html#pyNastran.bdf.cards.optimization.DVMREL2.cross_reference">[docs]</a>    <span class="k">def</span> <span class="nf">cross_reference</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">model</span><span class="p">:</span> <span class="n">BDF</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Cross links the card so referenced cards can be extracted directly</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        model : BDF()</span>
<span class="sd">            the BDF object</span>

<span class="sd">        .. todo:: add support for DEQATN cards to finish DVMREL2 xref</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">msg</span> <span class="o">=</span> <span class="s1">&#39;, which is required by DVMREL2 oid=</span><span class="si">%r</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">oid</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">mat_type</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">allowed_materials</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">mid_ref</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">Material</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mid</span><span class="p">,</span> <span class="n">msg</span><span class="o">=</span><span class="n">msg</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="s1">&#39;mat_type=</span><span class="si">%r</span><span class="s1"> is not supported&#39;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">mat_type</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dvids_ref</span> <span class="o">=</span> <span class="p">[</span><span class="n">model</span><span class="o">.</span><span class="n">Desvar</span><span class="p">(</span><span class="n">dvid</span><span class="p">,</span> <span class="n">msg</span><span class="p">)</span> <span class="k">for</span> <span class="n">dvid</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">dvids</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dequation_ref</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">DEQATN</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dequation</span><span class="p">,</span> <span class="n">msg</span><span class="o">=</span><span class="n">msg</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_check_args</span><span class="p">()</span></div>

        <span class="c1">#assert self.pid_ref.type not in [&#39;PBEND&#39;, &#39;PBARL&#39;, &#39;PBEAML&#39;], self.pid</span>

<div class="viewcode-block" id="DVMREL2.uncross_reference"><a class="viewcode-back" href="../../../../reference/bdf/cards/pyNastran.bdf.cards.optimization.html#pyNastran.bdf.cards.optimization.DVMREL2.uncross_reference">[docs]</a>    <span class="k">def</span> <span class="nf">uncross_reference</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Removes cross-reference links&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mid</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">Mid</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dvids</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">desvar_ids</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dequation</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">DEquation</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mid_ref</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dequation_ref</span> <span class="o">=</span> <span class="kc">None</span></div>

    <span class="c1">#def OptValue(self):  #: .. todo:: not implemented</span>
        <span class="c1">#self.pid_ref.OptValue(self.mp_name)</span>

<div class="viewcode-block" id="DVMREL2.raw_fields"><a class="viewcode-back" href="../../../../reference/bdf/cards/pyNastran.bdf.cards.optimization.html#pyNastran.bdf.cards.optimization.DVMREL2.raw_fields">[docs]</a>    <span class="k">def</span> <span class="nf">raw_fields</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">list_fields</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;DVMREL2&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">oid</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">mat_type</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">Mid</span><span class="p">(),</span>
                       <span class="bp">self</span><span class="o">.</span><span class="n">mp_name</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">mp_min</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">mp_max</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">DEquation</span><span class="p">(),</span> <span class="kc">None</span><span class="p">]</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">dvids</span><span class="p">:</span>
            <span class="n">fields2</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;DESVAR&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">dvids</span>
            <span class="n">list_fields</span> <span class="o">+=</span> <span class="n">build_table_lines</span><span class="p">(</span><span class="n">fields2</span><span class="p">,</span> <span class="n">nstart</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">nend</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">labels</span><span class="p">:</span>
            <span class="n">fields2</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;DTABLE&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">labels</span>
            <span class="n">list_fields</span> <span class="o">+=</span> <span class="n">build_table_lines</span><span class="p">(</span><span class="n">fields2</span><span class="p">,</span> <span class="n">nstart</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">nend</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">list_fields</span></div>

<div class="viewcode-block" id="DVMREL2.repr_fields"><a class="viewcode-back" href="../../../../reference/bdf/cards/pyNastran.bdf.cards.optimization.html#pyNastran.bdf.cards.optimization.DVMREL2.repr_fields">[docs]</a>    <span class="k">def</span> <span class="nf">repr_fields</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        .. todo:: finish repr_fields for DVMREL2</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">raw_fields</span><span class="p">()</span></div>

<div class="viewcode-block" id="DVMREL2.write_card"><a class="viewcode-back" href="../../../../reference/bdf/cards/pyNastran.bdf.cards.optimization.html#pyNastran.bdf.cards.optimization.DVMREL2.write_card">[docs]</a>    <span class="k">def</span> <span class="nf">write_card</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">size</span><span class="p">:</span> <span class="nb">int</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span> <span class="n">is_double</span><span class="p">:</span> <span class="nb">bool</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="n">card</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">repr_fields</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">size</span> <span class="o">==</span> <span class="mi">8</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">comment</span> <span class="o">+</span> <span class="n">print_card_8</span><span class="p">(</span><span class="n">card</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">comment</span> <span class="o">+</span> <span class="n">print_card_16</span><span class="p">(</span><span class="n">card</span><span class="p">)</span></div></div>


<div class="viewcode-block" id="DVPREL1"><a class="viewcode-back" href="../../../../reference/bdf/cards/pyNastran.bdf.cards.optimization.html#pyNastran.bdf.cards.optimization.DVPREL1">[docs]</a><span class="k">class</span> <span class="nc">DVPREL1</span><span class="p">(</span><span class="n">DVXREL1</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    +---------+--------+--------+--------+-----------+-------+--------+-----+</span>
<span class="sd">    |   1     |    2   |   3    |    4   |     5     |   6   |   7    |  8  |</span>
<span class="sd">    +=========+========+========+========+===========+=======+========+=====+</span>
<span class="sd">    | DVPREL1 |   ID   |  TYPE  |  PID   | PNAME/FID | PMIN  |  PMAX  |  C0 |</span>
<span class="sd">    +---------+--------+--------+--------+-----------+-------+--------+-----+</span>
<span class="sd">    |         | DVID1  | COEF1  | DVID2  |   COEF2   | DVID3 |  etc.  |     |</span>
<span class="sd">    +---------+--------+--------+--------+-----------+-------+--------+-----+</span>
<span class="sd">    | DVPREL1 | 200000 | PCOMP  | 2000   |     T2    |       |        |     |</span>
<span class="sd">    +---------+--------+--------+--------+-----------+-------+--------+-----+</span>
<span class="sd">    |         | 200000 |   1.0  |        |           |       |        |     |</span>
<span class="sd">    +---------+--------+--------+--------+-----------+-------+--------+-----+</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="nb">type</span> <span class="o">=</span> <span class="s1">&#39;DVPREL1&#39;</span>

    <span class="n">allowed_properties</span> <span class="o">=</span> <span class="p">[</span>
        <span class="s1">&#39;PELAS&#39;</span><span class="p">,</span>
        <span class="s1">&#39;PROD&#39;</span><span class="p">,</span> <span class="s1">&#39;PTUBE&#39;</span><span class="p">,</span>
        <span class="s1">&#39;PBAR&#39;</span><span class="p">,</span> <span class="s1">&#39;PBARL&#39;</span><span class="p">,</span>
        <span class="s1">&#39;PBEAM&#39;</span><span class="p">,</span> <span class="s1">&#39;PBEAML&#39;</span><span class="p">,</span>
        <span class="s1">&#39;PSHEAR&#39;</span><span class="p">,</span>
        <span class="s1">&#39;PSHELL&#39;</span><span class="p">,</span> <span class="s1">&#39;PCOMP&#39;</span><span class="p">,</span> <span class="s1">&#39;PCOMPG&#39;</span><span class="p">,</span>
        <span class="s1">&#39;PBUSH&#39;</span><span class="p">,</span> <span class="s1">&#39;PBUSH1D&#39;</span><span class="p">,</span>
        <span class="s1">&#39;PGAP&#39;</span><span class="p">,</span> <span class="s1">&#39;PVISC&#39;</span><span class="p">,</span>
        <span class="s1">&#39;PDAMP&#39;</span><span class="p">,</span> <span class="s1">&#39;PWELD&#39;</span><span class="p">,</span>
        <span class="s1">&#39;PBMSECT&#39;</span><span class="p">,</span>
    <span class="p">]</span>
    <span class="n">allowed_elements</span> <span class="o">=</span> <span class="p">[</span>
        <span class="s1">&#39;CELAS2&#39;</span><span class="p">,</span> <span class="s1">&#39;CBAR&#39;</span><span class="p">,</span> <span class="s1">&#39;CBEAM&#39;</span><span class="p">,</span>
        <span class="s1">&#39;CQUAD4&#39;</span><span class="p">,</span>
        <span class="s1">&#39;CBUSH&#39;</span><span class="p">,</span> <span class="s1">&#39;CDAMP2&#39;</span><span class="p">,</span>
    <span class="p">]</span>
    <span class="n">allowed_masses</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;CONM2&#39;</span><span class="p">,</span> <span class="s1">&#39;CMASS2&#39;</span><span class="p">,</span> <span class="s1">&#39;CMASS4&#39;</span><span class="p">]</span>
    <span class="n">allowed_properties_mass</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;PMASS&#39;</span><span class="p">]</span>
    <span class="n">_properties</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;desvar_ids&#39;</span><span class="p">,</span> <span class="s1">&#39;allowed_properties&#39;</span><span class="p">,</span> <span class="s1">&#39;allowed_elements&#39;</span><span class="p">,</span>
                   <span class="s1">&#39;allowed_masses&#39;</span><span class="p">,</span> <span class="s1">&#39;allowed_properties_mass&#39;</span><span class="p">]</span>

<div class="viewcode-block" id="DVPREL1._init_from_empty"><a class="viewcode-back" href="../../../../reference/bdf/cards/pyNastran.bdf.cards.optimization.html#pyNastran.bdf.cards.optimization.DVPREL1._init_from_empty">[docs]</a>    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">_init_from_empty</span><span class="p">(</span><span class="bp">cls</span><span class="p">):</span>
        <span class="n">oid</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="n">prop_type</span> <span class="o">=</span> <span class="s1">&#39;PSHELL&#39;</span>
        <span class="n">pid</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="n">pname_fid</span> <span class="o">=</span> <span class="s1">&#39;T&#39;</span>
        <span class="n">dvids</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">coeffs</span> <span class="o">=</span> <span class="p">[</span><span class="mf">1.</span><span class="p">]</span>
        <span class="k">return</span> <span class="n">DVPREL1</span><span class="p">(</span><span class="n">oid</span><span class="p">,</span> <span class="n">prop_type</span><span class="p">,</span> <span class="n">pid</span><span class="p">,</span> <span class="n">pname_fid</span><span class="p">,</span> <span class="n">dvids</span><span class="p">,</span> <span class="n">coeffs</span><span class="p">,</span>
                       <span class="n">p_min</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">p_max</span><span class="o">=</span><span class="mf">1e20</span><span class="p">,</span> <span class="n">c0</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span>
                       <span class="n">validate</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></div>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">oid</span><span class="p">,</span> <span class="n">prop_type</span><span class="p">,</span> <span class="n">pid</span><span class="p">,</span> <span class="n">pname_fid</span><span class="p">,</span> <span class="n">dvids</span><span class="p">,</span> <span class="n">coeffs</span><span class="p">,</span>
                 <span class="n">p_min</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">p_max</span><span class="o">=</span><span class="mf">1e20</span><span class="p">,</span> <span class="n">c0</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">validate</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">comment</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Creates a DVPREL1 card</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        oid : int</span>
<span class="sd">            optimization id</span>
<span class="sd">        prop_type : str</span>
<span class="sd">            property card name (e.g., PSHELL)</span>
<span class="sd">        pid : int</span>
<span class="sd">            property id</span>
<span class="sd">        pname_fid : str/int</span>
<span class="sd">            optimization parameter as a pname (property name; T) or</span>
<span class="sd">            field number (fid)</span>
<span class="sd">        dvids : List[int]</span>
<span class="sd">            DESVAR ids</span>
<span class="sd">        coeffs : List[float]</span>
<span class="sd">            scale factors for DESVAR ids</span>
<span class="sd">        p_min : float; default=None</span>
<span class="sd">            minimum property value</span>
<span class="sd">        p_max : float; default=1e20</span>
<span class="sd">            maximum property value</span>
<span class="sd">        c0 : float; default=0.</span>
<span class="sd">            offset factor for the variable</span>
<span class="sd">        validate : bool; default=False</span>
<span class="sd">            should the variable be validated</span>
<span class="sd">        comment : str; default=&#39;&#39;</span>
<span class="sd">            a comment for the card</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">DVXREL1</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">oid</span><span class="p">,</span> <span class="n">dvids</span><span class="p">,</span> <span class="n">coeffs</span><span class="p">,</span> <span class="n">c0</span><span class="p">,</span> <span class="n">comment</span><span class="p">)</span>

        <span class="c1"># property type (e.g. PSHELL/PCOMP)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">prop_type</span> <span class="o">=</span> <span class="n">prop_type</span>

        <span class="c1"># property id</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pid</span> <span class="o">=</span> <span class="n">pid</span>

        <span class="c1"># the field type (e.g. &#39;T&#39; on a PSHELL or the field id)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pname_fid</span> <span class="o">=</span> <span class="n">pname_fid</span>

        <span class="c1"># min value for &#39;T&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">p_min</span> <span class="o">=</span> <span class="n">p_min</span>

        <span class="c1"># max value for &#39;T&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">p_max</span> <span class="o">=</span> <span class="n">p_max</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">pid_ref</span> <span class="o">=</span> <span class="kc">None</span>

        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">coeffs</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">msg</span> <span class="o">=</span> <span class="s1">&#39;len(coeffs)=</span><span class="si">%s</span><span class="s1"> len(dvids)=</span><span class="si">%s</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">coeffs</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dvids</span><span class="p">))</span>
            <span class="n">msg</span> <span class="o">+=</span> <span class="s2">&quot;We&#39;ve added a coeff=1.0 and desvar_id=1 in order to look at the crashing card</span><span class="se">\n</span><span class="s2">&quot;</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">coeffs</span> <span class="o">=</span> <span class="p">[</span><span class="mf">1.</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">dvids</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">]</span>
            <span class="n">msg</span> <span class="o">+=</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
            <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
        <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">coeffs</span><span class="p">)</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dvids</span><span class="p">),</span> <span class="s1">&#39;len(coeffs)=</span><span class="si">%s</span><span class="s1"> len(dvids)=</span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">coeffs</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dvids</span><span class="p">))</span>

        <span class="n">pname_fid</span> <span class="o">=</span> <span class="n">validate_dvprel</span><span class="p">(</span><span class="n">prop_type</span><span class="p">,</span> <span class="n">pname_fid</span><span class="p">,</span> <span class="n">validate</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pname_fid</span> <span class="o">=</span> <span class="n">pname_fid</span>

<div class="viewcode-block" id="DVPREL1.update_model"><a class="viewcode-back" href="../../../../reference/bdf/cards/pyNastran.bdf.cards.optimization.html#pyNastran.bdf.cards.optimization.DVPREL1.update_model">[docs]</a>    <span class="k">def</span> <span class="nf">update_model</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">model</span><span class="p">,</span> <span class="n">desvar_values</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;doesn&#39;t require cross-referencing&quot;&quot;&quot;</span>
        <span class="n">value</span> <span class="o">=</span> <span class="n">get_dvxrel1_coeffs</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">model</span><span class="p">,</span> <span class="n">desvar_values</span><span class="p">,</span> <span class="n">debug</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pid</span><span class="p">,</span> <span class="nb">int</span><span class="p">),</span> <span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pid</span><span class="p">)</span>
        <span class="n">prop</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_property</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">pid</span><span class="p">)</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_update_by_dvprel</span><span class="p">(</span><span class="n">prop</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>
        <span class="k">except</span> <span class="p">(</span><span class="ne">AttributeError</span><span class="p">,</span> <span class="ne">NotImplementedError</span><span class="p">):</span>
            <span class="nb">print</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">prop</span><span class="p">)</span>
            <span class="k">raise</span></div>
            <span class="c1">#raise NotImplementedError(&#39;prop_type=%r is not supported in &#39;</span>
                                      <span class="c1">#&#39;update_model&#39; % self.prop_type)</span>

<div class="viewcode-block" id="DVPREL1._update_by_dvprel"><a class="viewcode-back" href="../../../../reference/bdf/cards/pyNastran.bdf.cards.optimization.html#pyNastran.bdf.cards.optimization.DVPREL1._update_by_dvprel">[docs]</a>    <span class="k">def</span> <span class="nf">_update_by_dvprel</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">prop</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">prop_type</span> <span class="o">==</span> <span class="s1">&#39;PCOMP&#39;</span> <span class="ow">and</span> <span class="n">prop</span><span class="o">.</span><span class="n">type</span> <span class="o">==</span> <span class="s1">&#39;PCOMPG&#39;</span><span class="p">:</span>
            <span class="k">pass</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">prop_type</span> <span class="o">!=</span> <span class="n">prop</span><span class="o">.</span><span class="n">type</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s1">&#39;prop_type=</span><span class="si">%s</span><span class="s1"> is not the same as the property type (</span><span class="si">%s</span><span class="s1">)</span><span class="se">\n</span><span class="si">%s%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">prop_type</span><span class="p">,</span> <span class="n">prop</span><span class="o">.</span><span class="n">type</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="p">),</span> <span class="nb">str</span><span class="p">(</span><span class="n">prop</span><span class="p">)))</span>

        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">prop</span><span class="p">,</span> <span class="s1">&#39;update_by_pname_fid&#39;</span><span class="p">):</span>
            <span class="n">prop</span><span class="o">.</span><span class="n">update_by_pname_fid</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pname_fid</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">pname_fid_map</span> <span class="o">=</span> <span class="n">prop</span><span class="o">.</span><span class="n">pname_fid_map</span>
            <span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="s1">&#39;prop_type=</span><span class="si">%r</span><span class="s1"> name=</span><span class="si">%r</span><span class="s1"> has not implemented &#39;</span>
                                          <span class="s1">&#39;pname_fid_map/update_by_pname_fid&#39;</span> <span class="o">%</span> <span class="p">(</span>
                                              <span class="bp">self</span><span class="o">.</span><span class="n">prop_type</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">pname_fid</span><span class="p">))</span>

            <span class="k">try</span><span class="p">:</span>
                <span class="n">key</span> <span class="o">=</span> <span class="n">pname_fid_map</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">pname_fid</span><span class="p">]</span>
            <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
                <span class="n">valid</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">pname_fid_map</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">valid</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="n">msg</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;prop_type=</span><span class="si">%r</span><span class="s1"> has not implemented </span><span class="si">%r</span><span class="s1"> for in &#39;</span>
                           <span class="s1">&#39;pname_fid_map/update_by_pname_fid</span><span class="se">\n</span><span class="s1">&#39;</span>
                           <span class="s1">&#39;valid: []&#39;</span> <span class="o">%</span> <span class="p">(</span>
                               <span class="bp">self</span><span class="o">.</span><span class="n">prop_type</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">pname_fid</span><span class="p">))</span>
                    <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
                <span class="n">svalid</span> <span class="o">=</span> <span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">val</span><span class="p">)</span> <span class="k">for</span> <span class="n">val</span> <span class="ow">in</span> <span class="n">valid</span><span class="p">]</span>

                <span class="n">msg</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;prop_type=</span><span class="si">%r</span><span class="s1"> has not implemented </span><span class="si">%r</span><span class="s1"> for in &#39;</span>
                       <span class="s1">&#39;pname_fid_map/update_by_pname_fid</span><span class="se">\n</span><span class="s1">&#39;</span>
                       <span class="s1">&#39;valid: [</span><span class="si">%s</span><span class="s1">]&#39;</span> <span class="o">%</span> <span class="p">(</span>
                           <span class="bp">self</span><span class="o">.</span><span class="n">prop_type</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">pname_fid</span><span class="p">,</span> <span class="s1">&#39;, &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">svalid</span><span class="p">)))</span>
                <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
            <span class="nb">setattr</span><span class="p">(</span><span class="n">prop</span><span class="p">,</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span></div>

<div class="viewcode-block" id="DVPREL1.validate"><a class="viewcode-back" href="../../../../reference/bdf/cards/pyNastran.bdf.cards.optimization.html#pyNastran.bdf.cards.optimization.DVPREL1.validate">[docs]</a>    <span class="k">def</span> <span class="nf">validate</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">DVXREL1</span><span class="o">.</span><span class="n">validate</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pname_fid</span> <span class="o">=</span> <span class="n">validate_dvprel</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">prop_type</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">pname_fid</span><span class="p">,</span> <span class="n">validate</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">unused_key</span><span class="p">,</span> <span class="n">msg</span> <span class="o">=</span> <span class="n">get_dvprel_key</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">,</span> <span class="n">msg</span></div>

<div class="viewcode-block" id="DVPREL1.add_card"><a class="viewcode-back" href="../../../../reference/bdf/cards/pyNastran.bdf.cards.optimization.html#pyNastran.bdf.cards.optimization.DVPREL1.add_card">[docs]</a>    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">add_card</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">card</span><span class="p">,</span> <span class="n">comment</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Adds a DVPREL1 card from ``BDF.add_card(...)``</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        card : BDFCard()</span>
<span class="sd">            a BDFCard object</span>
<span class="sd">        comment : str; default=&#39;&#39;</span>
<span class="sd">            a comment for the card</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">oid</span> <span class="o">=</span> <span class="n">integer</span><span class="p">(</span><span class="n">card</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;oid&#39;</span><span class="p">)</span>
        <span class="n">prop_type</span> <span class="o">=</span> <span class="n">string</span><span class="p">(</span><span class="n">card</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;prop_type&#39;</span><span class="p">)</span>
        <span class="n">pid</span> <span class="o">=</span> <span class="n">integer</span><span class="p">(</span><span class="n">card</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="s1">&#39;pid&#39;</span><span class="p">)</span>
        <span class="n">pname_fid</span> <span class="o">=</span> <span class="n">integer_or_string</span><span class="p">(</span><span class="n">card</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="s1">&#39;pName_FID&#39;</span><span class="p">)</span>

        <span class="c1">#: Minimum value allowed for this property.</span>
        <span class="c1">#: .. todo:: bad default (see DVMREL1)</span>
        <span class="n">p_min</span> <span class="o">=</span> <span class="n">double_or_blank</span><span class="p">(</span><span class="n">card</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="s1">&#39;p_min&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="n">p_max</span> <span class="o">=</span> <span class="n">double_or_blank</span><span class="p">(</span><span class="n">card</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="s1">&#39;p_max&#39;</span><span class="p">,</span> <span class="mf">1e20</span><span class="p">)</span>
        <span class="n">c0</span> <span class="o">=</span> <span class="n">double_or_blank</span><span class="p">(</span><span class="n">card</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="s1">&#39;c0&#39;</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">)</span>

        <span class="n">dvids</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">coeffs</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">end_fields</span> <span class="o">=</span> <span class="p">[</span><span class="n">interpret_value</span><span class="p">(</span><span class="n">field</span><span class="p">)</span> <span class="k">for</span> <span class="n">field</span> <span class="ow">in</span> <span class="n">card</span><span class="p">[</span><span class="mi">9</span><span class="p">:]]</span>

        <span class="n">nfields</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">end_fields</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span>
        <span class="k">if</span> <span class="n">nfields</span> <span class="o">%</span> <span class="mi">2</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">end_fields</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="kc">None</span><span class="p">)</span>
            <span class="n">nfields</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">nfields</span><span class="p">,</span> <span class="mi">2</span><span class="p">):</span>
            <span class="n">dvids</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">end_fields</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
            <span class="n">coeffs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">end_fields</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">])</span>
        <span class="k">if</span> <span class="n">nfields</span> <span class="o">%</span> <span class="mi">2</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">card</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;dvids = </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">dvids</span><span class="p">))</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;coeffs = </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">coeffs</span><span class="p">))</span>
            <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s1">&#39;invalid DVPREL1...&#39;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">DVPREL1</span><span class="p">(</span><span class="n">oid</span><span class="p">,</span> <span class="n">prop_type</span><span class="p">,</span> <span class="n">pid</span><span class="p">,</span> <span class="n">pname_fid</span><span class="p">,</span> <span class="n">dvids</span><span class="p">,</span> <span class="n">coeffs</span><span class="p">,</span>
                       <span class="n">p_min</span><span class="o">=</span><span class="n">p_min</span><span class="p">,</span> <span class="n">p_max</span><span class="o">=</span><span class="n">p_max</span><span class="p">,</span> <span class="n">c0</span><span class="o">=</span><span class="n">c0</span><span class="p">,</span>
                       <span class="n">comment</span><span class="o">=</span><span class="n">comment</span><span class="p">)</span></div>

    <span class="k">def</span> <span class="nf">_verify</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">xref</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Verifies all methods for this object work</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        xref : bool</span>
<span class="sd">            has this model been cross referenced</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">pass</span>

<div class="viewcode-block" id="DVPREL1.OptID"><a class="viewcode-back" href="../../../../reference/bdf/cards/pyNastran.bdf.cards.optimization.html#pyNastran.bdf.cards.optimization.DVPREL1.OptID">[docs]</a>    <span class="k">def</span> <span class="nf">OptID</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">oid</span></div>

<div class="viewcode-block" id="DVPREL1.cross_reference"><a class="viewcode-back" href="../../../../reference/bdf/cards/pyNastran.bdf.cards.optimization.html#pyNastran.bdf.cards.optimization.DVPREL1.cross_reference">[docs]</a>    <span class="k">def</span> <span class="nf">cross_reference</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">model</span><span class="p">:</span> <span class="n">BDF</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Cross links the card so referenced cards can be extracted directly</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        model : BDF()</span>
<span class="sd">            the BDF object</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">msg</span> <span class="o">=</span> <span class="s1">&#39;, which is required by DVPREL1 oid=</span><span class="si">%r</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">oid</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pid_ref</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_property</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">pid</span><span class="p">,</span> <span class="n">msg</span><span class="o">=</span><span class="n">msg</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dvids_ref</span> <span class="o">=</span> <span class="p">[</span><span class="n">model</span><span class="o">.</span><span class="n">Desvar</span><span class="p">(</span><span class="n">dvid</span><span class="p">,</span> <span class="n">msg</span><span class="p">)</span> <span class="k">for</span> <span class="n">dvid</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">dvids</span><span class="p">]</span></div>

<div class="viewcode-block" id="DVPREL1._get_property"><a class="viewcode-back" href="../../../../reference/bdf/cards/pyNastran.bdf.cards.optimization.html#pyNastran.bdf.cards.optimization.DVPREL1._get_property">[docs]</a>    <span class="k">def</span> <span class="nf">_get_property</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">model</span><span class="p">,</span> <span class="n">pid</span><span class="p">,</span> <span class="n">msg</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">):</span>
        <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pid</span><span class="p">,</span> <span class="nb">int</span><span class="p">),</span> <span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pid</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">prop_type</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">allowed_properties</span><span class="p">:</span>
            <span class="n">pid_ref</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">Property</span><span class="p">(</span><span class="n">pid</span><span class="p">,</span> <span class="n">msg</span><span class="o">=</span><span class="n">msg</span><span class="p">)</span>
        <span class="c1">#elif self.prop_type in self.allowed_elements:</span>
            <span class="c1">#pid_ref = model.Element(pid, msg=msg)</span>
        <span class="c1">#elif self.prop_type in self.allowed_masses:</span>
            <span class="c1">#pid_ref = model.masses[pid]</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">prop_type</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">allowed_properties_mass</span><span class="p">:</span>
            <span class="n">pid_ref</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">properties_mass</span><span class="p">[</span><span class="n">pid</span><span class="p">]</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">prop_type</span> <span class="o">==</span> <span class="s1">&#39;PBUSHT&#39;</span><span class="p">:</span>
            <span class="n">pid_ref</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">pbusht</span><span class="p">[</span><span class="n">pid</span><span class="p">]</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">prop_type</span> <span class="o">==</span> <span class="s1">&#39;PELAST&#39;</span><span class="p">:</span>
            <span class="n">pid_ref</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">pelast</span><span class="p">[</span><span class="n">pid</span><span class="p">]</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">prop_type</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;PFAST&#39;</span><span class="p">,</span> <span class="s1">&#39;PBRSECT&#39;</span><span class="p">]:</span>
            <span class="n">pid_ref</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">properties</span><span class="p">[</span><span class="n">pid</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="s1">&#39;prop_type=</span><span class="si">%r</span><span class="s1"> is not supported&#39;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">prop_type</span><span class="p">)</span>
        <span class="k">assert</span> <span class="n">pid_ref</span><span class="o">.</span><span class="n">type</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;PBEND&#39;</span><span class="p">],</span> <span class="n">pid_ref</span>
        <span class="k">return</span> <span class="n">pid_ref</span></div>

<div class="viewcode-block" id="DVPREL1.uncross_reference"><a class="viewcode-back" href="../../../../reference/bdf/cards/pyNastran.bdf.cards.optimization.html#pyNastran.bdf.cards.optimization.DVPREL1.uncross_reference">[docs]</a>    <span class="k">def</span> <span class="nf">uncross_reference</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Removes cross-reference links&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pid</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">Pid</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pid_ref</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dvids</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">desvar_ids</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dvids_ref</span> <span class="o">=</span> <span class="kc">None</span></div>

<div class="viewcode-block" id="DVPREL1.calculate"><a class="viewcode-back" href="../../../../reference/bdf/cards/pyNastran.bdf.cards.optimization.html#pyNastran.bdf.cards.optimization.DVPREL1.calculate">[docs]</a>    <span class="k">def</span> <span class="nf">calculate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">op2_model</span><span class="p">,</span> <span class="n">subcase_id</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="p">))</span></div>

<div class="viewcode-block" id="DVPREL1.Pid"><a class="viewcode-back" href="../../../../reference/bdf/cards/pyNastran.bdf.cards.optimization.html#pyNastran.bdf.cards.optimization.DVPREL1.Pid">[docs]</a>    <span class="k">def</span> <span class="nf">Pid</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">pid_ref</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">pid</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">pid</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">prop_type</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">allowed_properties</span><span class="p">:</span>
            <span class="n">pid</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">pid_ref</span><span class="o">.</span><span class="n">pid</span>
        <span class="c1">#elif self.prop_type in self.allowed_elements:</span>
            <span class="c1">#pid = self.pid_ref.eid</span>
        <span class="c1">#elif self.prop_type in self.allowed_masses:</span>
            <span class="c1">#pid = self.pid_ref.eid</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">prop_type</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">allowed_properties_mass</span><span class="p">:</span>
            <span class="n">pid</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">pid_ref</span><span class="o">.</span><span class="n">pid</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">prop_type</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;PBUSHT&#39;</span><span class="p">,</span> <span class="s1">&#39;PELAST&#39;</span><span class="p">,</span> <span class="s1">&#39;PFAST&#39;</span><span class="p">,</span> <span class="s1">&#39;PBRSECT&#39;</span><span class="p">]:</span>
            <span class="n">pid</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">pid_ref</span><span class="o">.</span><span class="n">pid</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="s1">&#39;prop_type=</span><span class="si">%r</span><span class="s1"> is not supported&#39;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">prop_type</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">pid</span></div>

<div class="viewcode-block" id="DVPREL1.get_xinit_lower_upper_bound"><a class="viewcode-back" href="../../../../reference/bdf/cards/pyNastran.bdf.cards.optimization.html#pyNastran.bdf.cards.optimization.DVPREL1.get_xinit_lower_upper_bound">[docs]</a>    <span class="k">def</span> <span class="nf">get_xinit_lower_upper_bound</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">model</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;gets the active x value and the lower/upper bounds&quot;&quot;&quot;</span>
        <span class="n">lower_bound</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">p_min</span>
        <span class="n">upper_bound</span> <span class="o">=</span> <span class="kc">None</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">p_max</span> <span class="o">==</span> <span class="mf">1e20</span> <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">p_max</span>
        <span class="n">xinit</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">c0</span>

        <span class="n">desvars</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dvids</span>
        <span class="n">ndesvars</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">desvars</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">desvar</span><span class="p">,</span> <span class="n">coeff</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">desvars</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">coeffs</span><span class="p">):</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">desvar</span><span class="p">,</span> <span class="n">integer_types</span><span class="p">):</span>
                <span class="n">desvar_ref</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">desvars</span><span class="p">[</span><span class="n">desvar</span><span class="p">]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">desvar_ref</span> <span class="o">=</span> <span class="n">desvar</span><span class="o">.</span><span class="n">desvar_ref</span>
            <span class="n">xiniti</span> <span class="o">=</span> <span class="n">desvar_ref</span><span class="o">.</span><span class="n">xinit</span>

            <span class="c1"># update the lower/upper bound if we have 1 desvar</span>
            <span class="k">if</span> <span class="n">desvar_ref</span><span class="o">.</span><span class="n">xlb</span> <span class="o">!=</span> <span class="o">-</span><span class="mf">1e20</span><span class="p">:</span>
                <span class="n">xiniti</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">xiniti</span><span class="p">,</span> <span class="n">desvar_ref</span><span class="o">.</span><span class="n">xlb</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">ndesvars</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                    <span class="n">lower_bound</span> <span class="o">=</span> <span class="n">none_max</span><span class="p">(</span><span class="n">lower_bound</span><span class="p">,</span> <span class="n">desvar_ref</span><span class="o">.</span><span class="n">xlb</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">desvar_ref</span><span class="o">.</span><span class="n">xub</span> <span class="o">!=</span> <span class="mf">1e20</span><span class="p">:</span>
                <span class="n">xiniti</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">xiniti</span><span class="p">,</span> <span class="n">desvar_ref</span><span class="o">.</span><span class="n">xub</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">ndesvars</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                    <span class="n">upper_bound</span> <span class="o">=</span> <span class="n">none_min</span><span class="p">(</span><span class="n">upper_bound</span><span class="p">,</span> <span class="n">desvar_ref</span><span class="o">.</span><span class="n">xub</span><span class="p">)</span>

            <span class="c1"># code validation</span>
            <span class="k">if</span> <span class="n">desvar_ref</span><span class="o">.</span><span class="n">delx</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">desvar_ref</span><span class="o">.</span><span class="n">delx</span> <span class="o">!=</span> <span class="mf">1e20</span><span class="p">:</span>
                <span class="k">pass</span>

            <span class="c1"># TODO: haven&#39;t quite decided what to do</span>
            <span class="k">if</span> <span class="n">desvar_ref</span><span class="o">.</span><span class="n">ddval</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">msg</span> <span class="o">=</span> <span class="s1">&#39;DESVAR id=</span><span class="si">%s</span><span class="s1"> DDVAL is not None</span><span class="se">\n</span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">desvar</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">desvar_ref</span><span class="p">))</span>
            <span class="c1">#assert desvar_ref.ddval is None, desvar_ref</span>
            <span class="n">xinit</span> <span class="o">+=</span> <span class="n">coeff</span> <span class="o">*</span> <span class="n">xiniti</span>

        <span class="k">if</span> <span class="n">lower_bound</span><span class="p">:</span>
            <span class="n">xinit</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">xinit</span><span class="p">,</span> <span class="n">lower_bound</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">lower_bound</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>
        <span class="k">if</span> <span class="n">upper_bound</span><span class="p">:</span>
            <span class="n">xinit</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">xinit</span><span class="p">,</span> <span class="n">upper_bound</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">upper_bound</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>
        <span class="k">return</span> <span class="n">xinit</span><span class="p">,</span> <span class="n">lower_bound</span><span class="p">,</span> <span class="n">upper_bound</span></div>

<div class="viewcode-block" id="DVPREL1.raw_fields"><a class="viewcode-back" href="../../../../reference/bdf/cards/pyNastran.bdf.cards.optimization.html#pyNastran.bdf.cards.optimization.DVPREL1.raw_fields">[docs]</a>    <span class="k">def</span> <span class="nf">raw_fields</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">list_fields</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;DVPREL1&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">oid</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">prop_type</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">Pid</span><span class="p">(),</span>
                       <span class="bp">self</span><span class="o">.</span><span class="n">pname_fid</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">p_min</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">p_max</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">c0</span><span class="p">,</span> <span class="kc">None</span><span class="p">]</span>
        <span class="k">for</span> <span class="p">(</span><span class="n">dvid</span><span class="p">,</span> <span class="n">coeff</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">desvar_ids</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">coeffs</span><span class="p">):</span>
            <span class="n">list_fields</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">dvid</span><span class="p">)</span>
            <span class="n">list_fields</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">coeff</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">list_fields</span></div>

<div class="viewcode-block" id="DVPREL1.repr_fields"><a class="viewcode-back" href="../../../../reference/bdf/cards/pyNastran.bdf.cards.optimization.html#pyNastran.bdf.cards.optimization.DVPREL1.repr_fields">[docs]</a>    <span class="k">def</span> <span class="nf">repr_fields</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">p_max</span> <span class="o">=</span> <span class="n">set_blank_if_default</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">p_max</span><span class="p">,</span> <span class="mf">1e20</span><span class="p">)</span>
        <span class="n">c0</span> <span class="o">=</span> <span class="n">set_blank_if_default</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">c0</span><span class="p">,</span> <span class="mf">0.</span><span class="p">)</span>
        <span class="n">list_fields</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;DVPREL1&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">oid</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">prop_type</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">Pid</span><span class="p">(),</span>
                       <span class="bp">self</span><span class="o">.</span><span class="n">pname_fid</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">p_min</span><span class="p">,</span> <span class="n">p_max</span><span class="p">,</span> <span class="n">c0</span><span class="p">,</span> <span class="kc">None</span><span class="p">]</span>
        <span class="k">for</span> <span class="p">(</span><span class="n">dvid</span><span class="p">,</span> <span class="n">coeff</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">desvar_ids</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">coeffs</span><span class="p">):</span>
            <span class="n">list_fields</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">dvid</span><span class="p">)</span>
            <span class="n">list_fields</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">coeff</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">list_fields</span></div>

<div class="viewcode-block" id="DVPREL1.write_card"><a class="viewcode-back" href="../../../../reference/bdf/cards/pyNastran.bdf.cards.optimization.html#pyNastran.bdf.cards.optimization.DVPREL1.write_card">[docs]</a>    <span class="k">def</span> <span class="nf">write_card</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">size</span><span class="p">:</span> <span class="nb">int</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span> <span class="n">is_double</span><span class="p">:</span> <span class="nb">bool</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="n">card</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">repr_fields</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">size</span> <span class="o">==</span> <span class="mi">8</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">comment</span> <span class="o">+</span> <span class="n">print_card_8</span><span class="p">(</span><span class="n">card</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">comment</span> <span class="o">+</span> <span class="n">print_card_16</span><span class="p">(</span><span class="n">card</span><span class="p">)</span></div></div>


<div class="viewcode-block" id="DVPREL2"><a class="viewcode-back" href="../../../../reference/bdf/cards/pyNastran.bdf.cards.optimization.html#pyNastran.bdf.cards.optimization.DVPREL2">[docs]</a><span class="k">class</span> <span class="nc">DVPREL2</span><span class="p">(</span><span class="n">DVXREL2</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    +----------+--------+--------+-------+-----------+-------+-------+-------+-------+</span>
<span class="sd">    |    1     |    2   |   3    |   4   |     5     |   6   |   7   |   8   |   9   |</span>
<span class="sd">    +==========+========+========+=======+===========+=======+=======+=======+=======+</span>
<span class="sd">    | DVPREL2  | ID     | TYPE   | PID   | PNAME/FID | PMIN  | PMAX  | EQID  |       |</span>
<span class="sd">    +----------+--------+--------+-------+-----------+-------+-------+-------+-------+</span>
<span class="sd">    |          | DESVAR | DVID1  | DVID2 |   DVID3   | DVID4 | DVID5 | DVID6 | DVID7 |</span>
<span class="sd">    +----------+--------+--------+-------+-----------+-------+-------+-------+-------+</span>
<span class="sd">    |          |        | DVID8  | etc.  |           |       |       |       |       |</span>
<span class="sd">    +----------+--------+--------+-------+-----------+-------+-------+-------+-------+</span>
<span class="sd">    |          | DTABLE | LABL1  | LABL2 |   LABL3   | LABL4 | LABL5 | LABL6 | LABL7 |</span>
<span class="sd">    +----------+--------+--------+-------+-----------+-------+-------+-------+-------+</span>
<span class="sd">    |          |        | LABL8  | etc.  |           |       |       |       |       |</span>
<span class="sd">    +----------+--------+--------+-------+-----------+-------+-------+-------+-------+</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="nb">type</span> <span class="o">=</span> <span class="s1">&#39;DVPREL2&#39;</span>

    <span class="n">allowed_properties</span> <span class="o">=</span> <span class="p">[</span>
        <span class="s1">&#39;PELAS&#39;</span><span class="p">,</span>
        <span class="s1">&#39;PROD&#39;</span><span class="p">,</span> <span class="s1">&#39;PTUBE&#39;</span><span class="p">,</span>
        <span class="s1">&#39;PBAR&#39;</span><span class="p">,</span> <span class="s1">&#39;PBARL&#39;</span><span class="p">,</span>
        <span class="s1">&#39;PBEAM&#39;</span><span class="p">,</span> <span class="s1">&#39;PBEAML&#39;</span><span class="p">,</span>
        <span class="s1">&#39;PSHELL&#39;</span><span class="p">,</span> <span class="s1">&#39;PCOMP&#39;</span><span class="p">,</span> <span class="s1">&#39;PCOMPG&#39;</span><span class="p">,</span>
        <span class="s1">&#39;PBUSH&#39;</span><span class="p">,</span> <span class="s1">&#39;PBUSH1D&#39;</span><span class="p">,</span>
        <span class="s1">&#39;PGAP&#39;</span><span class="p">,</span> <span class="s1">&#39;PVISC&#39;</span><span class="p">,</span>
        <span class="s1">&#39;PDAMP&#39;</span><span class="p">,</span> <span class="s1">&#39;PWELD&#39;</span><span class="p">,</span>
    <span class="p">]</span>
    <span class="n">allowed_elements</span> <span class="o">=</span> <span class="p">[</span>
        <span class="s1">&#39;CELAS2&#39;</span><span class="p">,</span> <span class="s1">&#39;CBAR&#39;</span><span class="p">,</span> <span class="s1">&#39;CBEAM&#39;</span><span class="p">,</span>
        <span class="s1">&#39;CQUAD4&#39;</span><span class="p">,</span>
        <span class="s1">&#39;CBUSH&#39;</span><span class="p">,</span> <span class="s1">&#39;CDAMP2&#39;</span><span class="p">,</span>
    <span class="p">]</span>
    <span class="n">allowed_masses</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;CONM2&#39;</span><span class="p">,</span> <span class="s1">&#39;CMASS2&#39;</span><span class="p">,</span> <span class="s1">&#39;CMASS4&#39;</span><span class="p">]</span>
    <span class="n">allowed_properties_mass</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;PMASS&#39;</span><span class="p">]</span>
    <span class="n">_properties</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;desvar_ids&#39;</span><span class="p">]</span>

<div class="viewcode-block" id="DVPREL2._init_from_empty"><a class="viewcode-back" href="../../../../reference/bdf/cards/pyNastran.bdf.cards.optimization.html#pyNastran.bdf.cards.optimization.DVPREL2._init_from_empty">[docs]</a>    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">_init_from_empty</span><span class="p">(</span><span class="bp">cls</span><span class="p">):</span>
        <span class="n">oid</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="n">prop_type</span> <span class="o">=</span> <span class="s1">&#39;PSHELL&#39;</span>
        <span class="n">pid</span> <span class="o">=</span> <span class="mi">2</span>
        <span class="n">pname_fid</span> <span class="o">=</span> <span class="s1">&#39;T&#39;</span>
        <span class="n">deqation</span> <span class="o">=</span> <span class="mi">42</span>
        <span class="k">return</span> <span class="n">DVPREL2</span><span class="p">(</span><span class="n">oid</span><span class="p">,</span> <span class="n">prop_type</span><span class="p">,</span> <span class="n">pid</span><span class="p">,</span> <span class="n">pname_fid</span><span class="p">,</span> <span class="n">deqation</span><span class="p">,</span>
                       <span class="n">dvids</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">labels</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">p_min</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                       <span class="n">p_max</span><span class="o">=</span><span class="mf">1e20</span><span class="p">,</span> <span class="n">validate</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">comment</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">)</span></div>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">oid</span><span class="p">,</span> <span class="n">prop_type</span><span class="p">,</span> <span class="n">pid</span><span class="p">,</span> <span class="n">pname_fid</span><span class="p">,</span> <span class="n">deqation</span><span class="p">,</span>
                 <span class="n">dvids</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">labels</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">p_min</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">p_max</span><span class="o">=</span><span class="mf">1e20</span><span class="p">,</span>
                 <span class="n">validate</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">comment</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Creates a DVPREL2 card</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        oid : int</span>
<span class="sd">            optimization id</span>
<span class="sd">        prop_type : str</span>
<span class="sd">            property card name (e.g., PSHELL)</span>
<span class="sd">        pid : int</span>
<span class="sd">            property id</span>
<span class="sd">        pname_fid : str/int</span>
<span class="sd">            optimization parameter as a pname (property name; T) or field number (fid)</span>
<span class="sd">        deqation : int</span>
<span class="sd">            DEQATN id</span>
<span class="sd">        dvids : List[int]; default=None</span>
<span class="sd">            DESVAR ids</span>
<span class="sd">        labels : List[str]; default=None</span>
<span class="sd">            DTABLE names</span>
<span class="sd">        #params : dict[(index, card_type)] = values</span>
<span class="sd">            #the storage table for the response function</span>
<span class="sd">            #index : int</span>
<span class="sd">                #a counter</span>
<span class="sd">            #card_type : str</span>
<span class="sd">                #the type of card to pull from</span>
<span class="sd">                #DESVAR, DVPREL1, DRESP2, etc.</span>
<span class="sd">            #values : List[int]</span>
<span class="sd">                #the values for this response</span>

<span class="sd">        p_min : float; default=None</span>
<span class="sd">            minimum property value</span>
<span class="sd">        p_max : float; default=1e20</span>
<span class="sd">            maximum property value</span>
<span class="sd">        validate : bool; default=False</span>
<span class="sd">            should the variable be validated</span>
<span class="sd">        comment : str; default=&#39;&#39;</span>
<span class="sd">            a comment for the card</span>

<span class="sd">        .. note:: either dvids or labels is required</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">DVXREL2</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">oid</span><span class="p">,</span> <span class="n">dvids</span><span class="p">,</span> <span class="n">labels</span><span class="p">,</span> <span class="n">deqation</span><span class="p">,</span> <span class="n">comment</span><span class="p">)</span>

        <span class="c1">#: Name of a property entry, such as PBAR, PBEAM, etc</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">prop_type</span> <span class="o">=</span> <span class="n">prop_type</span>

        <span class="c1">#: Property entry identification number</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pid</span> <span class="o">=</span> <span class="n">pid</span>

        <span class="c1">#: Property name, such as &#39;T&#39;, &#39;A&#39;, or field position of the property</span>
        <span class="c1">#: entry, or word position in the element property table of the</span>
        <span class="c1">#: analysis model. Property names that begin with an integer such as</span>
        <span class="c1">#: 12I/T**3 may only be referred to by field position.</span>
        <span class="c1">#: (Character or Integer 0)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pname_fid</span> <span class="o">=</span> <span class="n">pname_fid</span>

        <span class="c1">#: Minimum value allowed for this property. If FID references a stress</span>
        <span class="c1">#: recovery location field, then the default value for PMIN is -1.0+35.</span>
        <span class="c1">#: PMIN must be explicitly set to a negative number for properties that</span>
        <span class="c1">#: may be less than zero (for example, field ZO on the PCOMP entry).</span>
        <span class="c1">#: (Real; Default = 1.E-15)</span>
        <span class="c1">#: .. todo:: bad default (see DVMREL1)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">p_min</span> <span class="o">=</span> <span class="n">p_min</span>
        <span class="c1">#: Maximum value allowed for this property. (Real; Default = 1.0E20)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">p_max</span> <span class="o">=</span> <span class="n">p_max</span>

        <span class="n">pname_fid</span> <span class="o">=</span> <span class="n">validate_dvprel</span><span class="p">(</span><span class="n">prop_type</span><span class="p">,</span> <span class="n">pname_fid</span><span class="p">,</span> <span class="n">validate</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pname_fid</span> <span class="o">=</span> <span class="n">pname_fid</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pid_ref</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">labels</span><span class="p">,</span> <span class="nb">list</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_stats</span><span class="p">()</span>

<div class="viewcode-block" id="DVPREL2.validate"><a class="viewcode-back" href="../../../../reference/bdf/cards/pyNastran.bdf.cards.optimization.html#pyNastran.bdf.cards.optimization.DVPREL2.validate">[docs]</a>    <span class="k">def</span> <span class="nf">validate</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">DVXREL2</span><span class="o">.</span><span class="n">validate</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pname_fid</span> <span class="o">=</span> <span class="n">validate_dvprel</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">prop_type</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">pname_fid</span><span class="p">,</span> <span class="n">validate</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></div>

<div class="viewcode-block" id="DVPREL2.add_card"><a class="viewcode-back" href="../../../../reference/bdf/cards/pyNastran.bdf.cards.optimization.html#pyNastran.bdf.cards.optimization.DVPREL2.add_card">[docs]</a>    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">add_card</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">card</span><span class="p">,</span> <span class="n">comment</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Adds a DVPREL2 card from ``BDF.add_card(...)``</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        card : BDFCard()</span>
<span class="sd">            a BDFCard object</span>
<span class="sd">        comment : str; default=&#39;&#39;</span>
<span class="sd">            a comment for the card</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">oid</span> <span class="o">=</span> <span class="n">integer</span><span class="p">(</span><span class="n">card</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;oid&#39;</span><span class="p">)</span>
        <span class="n">prop_type</span> <span class="o">=</span> <span class="n">string</span><span class="p">(</span><span class="n">card</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;prop_type&#39;</span><span class="p">)</span>
        <span class="n">pid</span> <span class="o">=</span> <span class="n">integer</span><span class="p">(</span><span class="n">card</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="s1">&#39;pid&#39;</span><span class="p">)</span>
        <span class="n">pname_fid</span> <span class="o">=</span> <span class="n">integer_or_string</span><span class="p">(</span><span class="n">card</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="s1">&#39;pName_FID&#39;</span><span class="p">)</span>
        <span class="n">p_min</span> <span class="o">=</span> <span class="n">double_or_blank</span><span class="p">(</span><span class="n">card</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="s1">&#39;p_in&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="n">p_max</span> <span class="o">=</span> <span class="n">double_or_blank</span><span class="p">(</span><span class="n">card</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="s1">&#39;p_max&#39;</span><span class="p">,</span> <span class="mf">1e20</span><span class="p">)</span>
        <span class="n">dequation</span> <span class="o">=</span> <span class="n">integer_or_blank</span><span class="p">(</span><span class="n">card</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="s1">&#39;dequation&#39;</span><span class="p">)</span> <span class="c1">#: .. todo:: or blank?</span>

        <span class="n">fields</span> <span class="o">=</span> <span class="p">[</span><span class="n">interpret_value</span><span class="p">(</span><span class="n">field</span><span class="p">)</span> <span class="k">for</span> <span class="n">field</span> <span class="ow">in</span> <span class="n">card</span><span class="p">[</span><span class="mi">9</span><span class="p">:]]</span>
        <span class="n">ioffset</span> <span class="o">=</span> <span class="mi">9</span>
        <span class="n">iend</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">fields</span><span class="p">)</span> <span class="o">+</span> <span class="n">ioffset</span>

        <span class="c1">#F:\work\pyNastran\examples\femap_examples\Support\nast\tpl\d200m20.dat</span>
        <span class="c1">#params = parse_table_fields(&#39;DRESP2&#39;, card, fields)</span>
        <span class="c1">#print(params)</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="n">idesvar</span> <span class="o">=</span> <span class="n">fields</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="s1">&#39;DESVAR&#39;</span><span class="p">)</span> <span class="o">+</span> <span class="n">ioffset</span>
        <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
            <span class="n">idesvar</span> <span class="o">=</span> <span class="kc">None</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="n">idtable</span> <span class="o">=</span> <span class="n">fields</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="s1">&#39;DTABLE&#39;</span><span class="p">)</span> <span class="o">+</span> <span class="n">ioffset</span>
            <span class="c1">#iDesMax  = idtable # the index to start parsing DESVAR</span>
            <span class="n">ides_stop</span> <span class="o">=</span> <span class="n">idtable</span>  <span class="c1"># the index to stop  parsing DESVAR</span>
        <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
            <span class="n">idtable</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="n">ides_stop</span> <span class="o">=</span> <span class="n">iend</span>

        <span class="n">dvids</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">if</span> <span class="n">idesvar</span><span class="p">:</span>
            <span class="n">n</span> <span class="o">=</span> <span class="mi">1</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="n">ides_stop</span><span class="p">):</span>
                <span class="n">dvid_name</span> <span class="o">=</span> <span class="s1">&#39;DVID&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
                <span class="n">dvid</span> <span class="o">=</span> <span class="n">integer_or_blank</span><span class="p">(</span><span class="n">card</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">dvid_name</span><span class="p">)</span>
                <span class="c1">#print(&quot;%s = %s&quot; % (dvid_name, dvid))</span>
                <span class="k">if</span> <span class="n">dvid</span><span class="p">:</span>
                    <span class="k">assert</span> <span class="n">dvid</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
                    <span class="k">assert</span> <span class="n">dvid</span> <span class="o">!=</span> <span class="s1">&#39;DESVAR&#39;</span>
                    <span class="n">dvids</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">dvid</span><span class="p">)</span>
                    <span class="n">n</span> <span class="o">+=</span> <span class="mi">1</span>

        <span class="n">labels</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">if</span> <span class="n">idtable</span><span class="p">:</span>
            <span class="n">n</span> <span class="o">=</span> <span class="mi">1</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">idtable</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">iend</span><span class="p">):</span>
                <span class="n">label_name</span> <span class="o">=</span> <span class="s1">&#39;Label&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
                <span class="n">label</span> <span class="o">=</span> <span class="n">string</span><span class="p">(</span><span class="n">card</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">label_name</span><span class="p">)</span>
                <span class="c1">#print(&quot;%s = %s&quot; % (label_name, label))</span>
                <span class="k">if</span> <span class="n">label</span><span class="p">:</span>
                    <span class="k">assert</span> <span class="n">label</span> <span class="o">!=</span> <span class="s1">&#39;DTABLE&#39;</span>
                    <span class="n">labels</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">label</span><span class="p">)</span>

        <span class="n">dvprel</span> <span class="o">=</span> <span class="n">DVPREL2</span><span class="p">(</span><span class="n">oid</span><span class="p">,</span> <span class="n">prop_type</span><span class="p">,</span> <span class="n">pid</span><span class="p">,</span> <span class="n">pname_fid</span><span class="p">,</span> <span class="n">dequation</span><span class="p">,</span> <span class="n">dvids</span><span class="p">,</span> <span class="n">labels</span><span class="p">,</span>
                         <span class="n">p_min</span><span class="o">=</span><span class="n">p_min</span><span class="p">,</span> <span class="n">p_max</span><span class="o">=</span><span class="n">p_max</span><span class="p">,</span> <span class="n">comment</span><span class="o">=</span><span class="n">comment</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">dvids</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">labels</span><span class="p">)</span> <span class="ow">and</span> <span class="n">idtable</span> <span class="o">&lt;</span> <span class="n">idesvar</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">SyntaxError</span><span class="p">(</span><span class="s1">&#39;DESVARs must be defined before DTABLE</span><span class="se">\n</span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="nb">str</span><span class="p">(</span><span class="n">dvprel</span><span class="p">))</span>
        <span class="k">return</span> <span class="n">dvprel</span></div>

<div class="viewcode-block" id="DVPREL2.OptID"><a class="viewcode-back" href="../../../../reference/bdf/cards/pyNastran.bdf.cards.optimization.html#pyNastran.bdf.cards.optimization.DVPREL2.OptID">[docs]</a>    <span class="k">def</span> <span class="nf">OptID</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">oid</span></div>

<div class="viewcode-block" id="DVPREL2.Pid"><a class="viewcode-back" href="../../../../reference/bdf/cards/pyNastran.bdf.cards.optimization.html#pyNastran.bdf.cards.optimization.DVPREL2.Pid">[docs]</a>    <span class="k">def</span> <span class="nf">Pid</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">pid_ref</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">pid</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">pid</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">prop_type</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">allowed_properties</span><span class="p">:</span>
            <span class="n">pid</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">pid_ref</span><span class="o">.</span><span class="n">pid</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">prop_type</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">allowed_elements</span><span class="p">:</span>
            <span class="n">pid</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">pid_ref</span><span class="o">.</span><span class="n">eid</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">prop_type</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">allowed_masses</span><span class="p">:</span>
            <span class="n">pid</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">pid_ref</span><span class="o">.</span><span class="n">eid</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">prop_type</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">allowed_properties_mass</span><span class="p">:</span>
            <span class="n">pid</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">pid_ref</span><span class="o">.</span><span class="n">pid</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="s1">&#39;prop_type=</span><span class="si">%r</span><span class="s1"> is not supported&#39;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">prop_type</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">pid</span></div>

<div class="viewcode-block" id="DVPREL2.DEquation"><a class="viewcode-back" href="../../../../reference/bdf/cards/pyNastran.bdf.cards.optimization.html#pyNastran.bdf.cards.optimization.DVPREL2.DEquation">[docs]</a>    <span class="k">def</span> <span class="nf">DEquation</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">dequation_ref</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">dequation</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">dequation_ref</span><span class="o">.</span><span class="n">equation_id</span></div>

<div class="viewcode-block" id="DVPREL2.calculate"><a class="viewcode-back" href="../../../../reference/bdf/cards/pyNastran.bdf.cards.optimization.html#pyNastran.bdf.cards.optimization.DVPREL2.calculate">[docs]</a>    <span class="k">def</span> <span class="nf">calculate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">op2_model</span><span class="p">,</span> <span class="n">subcase_id</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        this should really make a call the the DEQATN;</span>
<span class="sd">        see the PBEAM for an example of get/set_optimization_value</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">get</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">pid_ref</span><span class="o">.</span><span class="n">get_optimization_value</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pname_fid</span><span class="p">)</span>
            <span class="n">out</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">pid_ref</span><span class="o">.</span><span class="n">set_optimization_value</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pname_fid</span><span class="p">,</span> <span class="n">get</span><span class="p">)</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;DVPREL2 calculate : </span><span class="si">%s</span><span class="s1">[</span><span class="si">%r</span><span class="s1">] = ???&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">prop_type</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">pname_fid</span><span class="p">))</span>
            <span class="k">raise</span>

        <span class="n">argsi</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">dvids</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">desvar</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">dvids_ref</span><span class="p">:</span> <span class="c1"># DESVARS</span>
                <span class="n">arg</span> <span class="o">=</span> <span class="n">desvar</span><span class="o">.</span><span class="n">calculate</span><span class="p">(</span><span class="n">op2_model</span><span class="p">,</span> <span class="n">subcase_id</span><span class="p">)</span>
                <span class="n">argsi</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">arg</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">labels</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">label</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">labels</span><span class="p">:</span> <span class="c1"># DTABLE</span>
                <span class="n">arg</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dtable_ref</span><span class="p">[</span><span class="n">label</span><span class="p">]</span>
                <span class="n">argsi</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">arg</span><span class="p">)</span>
        <span class="c1">#op2_model.log.info(&#39;DVPREL2; args = %s&#39; % argsi)</span>

        <span class="c1">#op2_model.log.info(&#39;dvids  =&#39;, self.dvids)</span>
        <span class="c1">#op2_model.log.info(&#39;labels =&#39;, self.labels)</span>
        <span class="c1">#op2_model.log.info(&#39;%s[%r] = %s&#39; % (self.prop_type, self.pname_fid, out))</span>
        <span class="n">out</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">func</span><span class="p">(</span><span class="o">*</span><span class="n">argsi</span><span class="p">)</span>
        <span class="n">op2_model</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s1">&#39;  deqatn out = </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">out</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">out</span></div>

<div class="viewcode-block" id="DVPREL2.cross_reference"><a class="viewcode-back" href="../../../../reference/bdf/cards/pyNastran.bdf.cards.optimization.html#pyNastran.bdf.cards.optimization.DVPREL2.cross_reference">[docs]</a>    <span class="k">def</span> <span class="nf">cross_reference</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">model</span><span class="p">:</span> <span class="n">BDF</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Cross links the card so referenced cards can be extracted directly</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        model : BDF()</span>
<span class="sd">            the BDF object</span>

<span class="sd">        .. todo:: add support for DEQATN cards to finish DVPREL2 xref</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">msg</span> <span class="o">=</span> <span class="s1">&#39;, which is required by DVPREL2 oid=</span><span class="si">%r</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">oid</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pid_ref</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_property</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">pid</span><span class="p">,</span> <span class="n">msg</span><span class="o">=</span><span class="n">msg</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dvids_ref</span> <span class="o">=</span> <span class="p">[</span><span class="n">model</span><span class="o">.</span><span class="n">Desvar</span><span class="p">(</span><span class="n">dvid</span><span class="p">,</span> <span class="n">msg</span><span class="p">)</span> <span class="k">for</span> <span class="n">dvid</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">dvids</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dequation_ref</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">DEQATN</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dequation</span><span class="p">,</span> <span class="n">msg</span><span class="o">=</span><span class="n">msg</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_check_args</span><span class="p">()</span></div>

<div class="viewcode-block" id="DVPREL2._get_property"><a class="viewcode-back" href="../../../../reference/bdf/cards/pyNastran.bdf.cards.optimization.html#pyNastran.bdf.cards.optimization.DVPREL2._get_property">[docs]</a>    <span class="k">def</span> <span class="nf">_get_property</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">model</span><span class="p">,</span> <span class="n">pid</span><span class="p">,</span> <span class="n">msg</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">):</span>
        <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pid</span><span class="p">,</span> <span class="nb">int</span><span class="p">),</span> <span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pid</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">prop_type</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">allowed_properties</span><span class="p">:</span>
            <span class="n">pid_ref</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">Property</span><span class="p">(</span><span class="n">pid</span><span class="p">,</span> <span class="n">msg</span><span class="o">=</span><span class="n">msg</span><span class="p">)</span>
        <span class="c1">#elif self.prop_type in self.allowed_elements:</span>
            <span class="c1">#pid_ref = model.Element(pid, msg=msg)</span>
        <span class="c1">#elif self.prop_type in self.allowed_masses:</span>
            <span class="c1">#pid_ref = model.masses[pid]</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">prop_type</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">allowed_properties_mass</span><span class="p">:</span>
            <span class="n">pid_ref</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">properties_mass</span><span class="p">[</span><span class="n">pid</span><span class="p">]</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">prop_type</span> <span class="o">==</span> <span class="s1">&#39;PBUSHT&#39;</span><span class="p">:</span>
            <span class="n">pid_ref</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">pbusht</span><span class="p">[</span><span class="n">pid</span><span class="p">]</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">prop_type</span> <span class="o">==</span> <span class="s1">&#39;PELAST&#39;</span><span class="p">:</span>
            <span class="n">pid_ref</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">pelast</span><span class="p">[</span><span class="n">pid</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="s1">&#39;prop_type=</span><span class="si">%r</span><span class="s1"> is not supported&#39;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">prop_type</span><span class="p">)</span>
        <span class="k">assert</span> <span class="n">pid_ref</span><span class="o">.</span><span class="n">type</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;PBEND&#39;</span><span class="p">],</span> <span class="n">pid_ref</span>
        <span class="k">return</span> <span class="n">pid_ref</span></div>

<div class="viewcode-block" id="DVPREL2.uncross_reference"><a class="viewcode-back" href="../../../../reference/bdf/cards/pyNastran.bdf.cards.optimization.html#pyNastran.bdf.cards.optimization.DVPREL2.uncross_reference">[docs]</a>    <span class="k">def</span> <span class="nf">uncross_reference</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Removes cross-reference links&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pid</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">Pid</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dvids</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">desvar_ids</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dequation</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">DEquation</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pid_ref</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dequation_ref</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dvids_ref</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dtable_ref</span> <span class="o">=</span> <span class="p">{}</span></div>

<div class="viewcode-block" id="DVPREL2.update_model"><a class="viewcode-back" href="../../../../reference/bdf/cards/pyNastran.bdf.cards.optimization.html#pyNastran.bdf.cards.optimization.DVPREL2.update_model">[docs]</a>    <span class="k">def</span> <span class="nf">update_model</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">model</span><span class="p">,</span> <span class="n">desvar_values</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;doesn&#39;t require cross-referencing&quot;&quot;&quot;</span>
        <span class="n">values</span> <span class="o">=</span> <span class="n">get_deqatn_value</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">model</span><span class="p">,</span> <span class="n">desvar_values</span><span class="p">)</span>
        <span class="n">prop</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_property</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">pid</span><span class="p">)</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_update_by_dvprel</span><span class="p">(</span><span class="n">prop</span><span class="p">,</span> <span class="n">values</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span>
            <span class="k">raise</span></div>
            <span class="c1">#raise NotImplementedError(&#39;prop_type=%r is not supported in update_model&#39; % self.prop_type)</span>

<div class="viewcode-block" id="DVPREL2._update_by_dvprel"><a class="viewcode-back" href="../../../../reference/bdf/cards/pyNastran.bdf.cards.optimization.html#pyNastran.bdf.cards.optimization.DVPREL2._update_by_dvprel">[docs]</a>    <span class="k">def</span> <span class="nf">_update_by_dvprel</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">prop</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">prop</span><span class="p">,</span> <span class="s1">&#39;update_by_pname_fid&#39;</span><span class="p">):</span>
            <span class="n">prop</span><span class="o">.</span><span class="n">update_by_pname_fid</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pname_fid</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">pname_fid_map</span> <span class="o">=</span> <span class="n">prop</span><span class="o">.</span><span class="n">pname_fid_map</span>
            <span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span>
                <span class="n">msg</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;prop_type=</span><span class="si">%r</span><span class="s1"> name=</span><span class="si">%r</span><span class="s1"> has not implemented &#39;</span>
                       <span class="s1">&#39;pname_fid_map/update_by_pname_fid&#39;</span> <span class="o">%</span> <span class="p">(</span>
                           <span class="bp">self</span><span class="o">.</span><span class="n">prop_type</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">pname_fid</span><span class="p">))</span>
                <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>

            <span class="k">try</span><span class="p">:</span>
                <span class="n">key</span> <span class="o">=</span> <span class="n">pname_fid_map</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">pname_fid</span><span class="p">]</span>
            <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
                <span class="n">msg</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;prop_type=</span><span class="si">%r</span><span class="s1"> has not implemented </span><span class="si">%r</span><span class="s1"> &#39;</span>
                       <span class="s1">&#39;for in pname_fid_map/update_by_pname_fid&#39;</span> <span class="o">%</span> <span class="p">(</span>
                           <span class="bp">self</span><span class="o">.</span><span class="n">prop_type</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">pname_fid</span><span class="p">))</span>
                <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
            <span class="nb">setattr</span><span class="p">(</span><span class="n">prop</span><span class="p">,</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span></div>

    <span class="k">def</span> <span class="nf">_verify</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">xref</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Verifies all methods for this object work</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        xref : bool</span>
<span class="sd">            has this model been cross referenced</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">pass</span>

    <span class="c1">#def OptValue(self):  #: .. todo:: not implemented</span>
        <span class="c1">#self.pid_ref.OptValue(self.pname_fid)</span>

<div class="viewcode-block" id="DVPREL2.get_xinit_lower_upper_bound"><a class="viewcode-back" href="../../../../reference/bdf/cards/pyNastran.bdf.cards.optimization.html#pyNastran.bdf.cards.optimization.DVPREL2.get_xinit_lower_upper_bound">[docs]</a>    <span class="k">def</span> <span class="nf">get_xinit_lower_upper_bound</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">model</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;gets the active x value and the lower/upper bounds&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span></div>

<div class="viewcode-block" id="DVPREL2.raw_fields"><a class="viewcode-back" href="../../../../reference/bdf/cards/pyNastran.bdf.cards.optimization.html#pyNastran.bdf.cards.optimization.DVPREL2.raw_fields">[docs]</a>    <span class="k">def</span> <span class="nf">raw_fields</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">list_fields</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;DVPREL2&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">oid</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">prop_type</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">Pid</span><span class="p">(),</span>
                       <span class="bp">self</span><span class="o">.</span><span class="n">pname_fid</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">p_min</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">p_max</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">DEquation</span><span class="p">(),</span> <span class="kc">None</span><span class="p">]</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">dvids</span><span class="p">:</span>
            <span class="n">fields2</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;DESVAR&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">desvar_ids</span>
            <span class="n">list_fields</span> <span class="o">+=</span> <span class="n">build_table_lines</span><span class="p">(</span><span class="n">fields2</span><span class="p">,</span> <span class="n">nstart</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">nend</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">labels</span><span class="p">:</span>
            <span class="n">fields2</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;DTABLE&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">labels</span>
            <span class="n">list_fields</span> <span class="o">+=</span> <span class="n">build_table_lines</span><span class="p">(</span><span class="n">fields2</span><span class="p">,</span> <span class="n">nstart</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">nend</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">list_fields</span></div>

<div class="viewcode-block" id="DVPREL2.repr_fields"><a class="viewcode-back" href="../../../../reference/bdf/cards/pyNastran.bdf.cards.optimization.html#pyNastran.bdf.cards.optimization.DVPREL2.repr_fields">[docs]</a>    <span class="k">def</span> <span class="nf">repr_fields</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        .. todo:: finish repr_fields for DVPREL2</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">raw_fields</span><span class="p">()</span></div>

<div class="viewcode-block" id="DVPREL2.write_card"><a class="viewcode-back" href="../../../../reference/bdf/cards/pyNastran.bdf.cards.optimization.html#pyNastran.bdf.cards.optimization.DVPREL2.write_card">[docs]</a>    <span class="k">def</span> <span class="nf">write_card</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">size</span><span class="p">:</span> <span class="nb">int</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span> <span class="n">is_double</span><span class="p">:</span> <span class="nb">bool</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="n">card</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">repr_fields</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">size</span> <span class="o">==</span> <span class="mi">8</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">comment</span> <span class="o">+</span> <span class="n">print_card_8</span><span class="p">(</span><span class="n">card</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">comment</span> <span class="o">+</span> <span class="n">print_card_16</span><span class="p">(</span><span class="n">card</span><span class="p">)</span></div></div>

<div class="viewcode-block" id="DVGRID"><a class="viewcode-back" href="../../../../reference/bdf/cards/pyNastran.bdf.cards.optimization.html#pyNastran.bdf.cards.optimization.DVGRID">[docs]</a><span class="k">class</span> <span class="nc">DVGRID</span><span class="p">(</span><span class="n">BaseCard</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    +--------+------+-----+-----+-------+----+----+----+</span>
<span class="sd">    |    1   |   2  |  3  |  4  |   5   |  6 |  7 |  8 |</span>
<span class="sd">    +========+======+=====+=====+=======+====+====+====+</span>
<span class="sd">    | DVGRID | DVID | GID | CID | COEFF | N1 | N2 | N3 |</span>
<span class="sd">    +--------+------+-----+-----+-------+----+----+----+</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="nb">type</span> <span class="o">=</span> <span class="s1">&#39;DVGRID&#39;</span>
    <span class="n">_properties</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;desvar_id&#39;</span><span class="p">,</span> <span class="s1">&#39;node_id&#39;</span><span class="p">,</span> <span class="s1">&#39;coord_id&#39;</span><span class="p">]</span>

<div class="viewcode-block" id="DVGRID._init_from_empty"><a class="viewcode-back" href="../../../../reference/bdf/cards/pyNastran.bdf.cards.optimization.html#pyNastran.bdf.cards.optimization.DVGRID._init_from_empty">[docs]</a>    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">_init_from_empty</span><span class="p">(</span><span class="bp">cls</span><span class="p">):</span>
        <span class="n">dvid</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="n">nid</span> <span class="o">=</span> <span class="mi">2</span>
        <span class="n">dxyz</span> <span class="o">=</span> <span class="p">[</span><span class="mf">1.</span><span class="p">,</span> <span class="mf">2.</span><span class="p">,</span> <span class="mf">3.</span><span class="p">]</span>
        <span class="k">return</span> <span class="n">DVGRID</span><span class="p">(</span><span class="n">dvid</span><span class="p">,</span> <span class="n">nid</span><span class="p">,</span> <span class="n">dxyz</span><span class="p">,</span> <span class="n">cid</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">coeff</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">comment</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">)</span></div>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dvid</span><span class="p">,</span> <span class="n">nid</span><span class="p">,</span> <span class="n">dxyz</span><span class="p">,</span> <span class="n">cid</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">coeff</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">comment</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Creates a DVGRID card</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        dvid : int</span>
<span class="sd">            DESVAR id</span>
<span class="sd">        nid : int</span>
<span class="sd">            GRID/POINT id</span>
<span class="sd">        dxyz : (3, ) float ndarray</span>
<span class="sd">            the amount to move the grid point</span>
<span class="sd">        cid : int; default=0</span>
<span class="sd">            Coordinate system for dxyz</span>
<span class="sd">        coeff : float; default=1.0</span>
<span class="sd">            the dxyz scale factor</span>
<span class="sd">        comment : str; default=&#39;&#39;</span>
<span class="sd">            a comment for the card</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">BaseCard</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">comment</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">comment</span> <span class="o">=</span> <span class="n">comment</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">dxyz</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
            <span class="n">dxyz</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">dxyz</span><span class="p">)</span>
        <span class="k">elif</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">dxyz</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s1">&#39;DVGRID: dxyz = </span><span class="si">%r</span><span class="s1"> and must be a list&#39;</span> <span class="o">%</span> <span class="n">dxyz</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">dvid</span> <span class="o">=</span> <span class="n">dvid</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">nid</span> <span class="o">=</span> <span class="n">nid</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">cid</span> <span class="o">=</span> <span class="n">cid</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">coeff</span> <span class="o">=</span> <span class="n">coeff</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dxyz</span> <span class="o">=</span> <span class="n">dxyz</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">nid_ref</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">cid_ref</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dvid_ref</span> <span class="o">=</span> <span class="kc">None</span>

<div class="viewcode-block" id="DVGRID.validate"><a class="viewcode-back" href="../../../../reference/bdf/cards/pyNastran.bdf.cards.optimization.html#pyNastran.bdf.cards.optimization.DVGRID.validate">[docs]</a>    <span class="k">def</span> <span class="nf">validate</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dxyz</span><span class="p">)</span> <span class="o">==</span> <span class="mf">0.</span><span class="p">:</span>
            <span class="n">msg</span> <span class="o">=</span> <span class="s1">&#39;DVGRID Error; dvid=</span><span class="si">%s</span><span class="s1"> nid=</span><span class="si">%s</span><span class="s1"> norm(dxyz)=0.&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dvid</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">nid</span><span class="p">)</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span></div>

<div class="viewcode-block" id="DVGRID.add_card"><a class="viewcode-back" href="../../../../reference/bdf/cards/pyNastran.bdf.cards.optimization.html#pyNastran.bdf.cards.optimization.DVGRID.add_card">[docs]</a>    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">add_card</span><span class="p">(</span><span class="n">card</span><span class="p">,</span> <span class="n">comment</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Adds a DVGRID card from ``BDF.add_card(...)``</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        card : BDFCard()</span>
<span class="sd">            a BDFCard object</span>
<span class="sd">        comment : str; default=&#39;&#39;</span>
<span class="sd">            a comment for the card</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">dvid</span> <span class="o">=</span> <span class="n">integer</span><span class="p">(</span><span class="n">card</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;dvid&#39;</span><span class="p">)</span>
        <span class="n">nid</span> <span class="o">=</span> <span class="n">integer</span><span class="p">(</span><span class="n">card</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;nid&#39;</span><span class="p">)</span>
        <span class="n">cid</span> <span class="o">=</span> <span class="n">integer_or_blank</span><span class="p">(</span><span class="n">card</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="s1">&#39;cid&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
        <span class="n">coeff</span> <span class="o">=</span> <span class="n">double_or_blank</span><span class="p">(</span><span class="n">card</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="s1">&#39;coeff&#39;</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">)</span>
        <span class="n">dxyz</span> <span class="o">=</span> <span class="p">[</span>
            <span class="n">double_or_blank</span><span class="p">(</span><span class="n">card</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="s1">&#39;n1&#39;</span><span class="p">,</span> <span class="mf">0.</span><span class="p">),</span>
            <span class="n">double_or_blank</span><span class="p">(</span><span class="n">card</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="s1">&#39;n2&#39;</span><span class="p">,</span> <span class="mf">0.</span><span class="p">),</span>
            <span class="n">double_or_blank</span><span class="p">(</span><span class="n">card</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="s1">&#39;n3&#39;</span><span class="p">,</span> <span class="mf">0.</span><span class="p">),</span>
        <span class="p">]</span>
        <span class="k">return</span> <span class="n">DVGRID</span><span class="p">(</span><span class="n">dvid</span><span class="p">,</span> <span class="n">nid</span><span class="p">,</span> <span class="n">dxyz</span><span class="p">,</span> <span class="n">cid</span><span class="o">=</span><span class="n">cid</span><span class="p">,</span> <span class="n">coeff</span><span class="o">=</span><span class="n">coeff</span><span class="p">,</span> <span class="n">comment</span><span class="o">=</span><span class="n">comment</span><span class="p">)</span></div>

<div class="viewcode-block" id="DVGRID.cross_reference"><a class="viewcode-back" href="../../../../reference/bdf/cards/pyNastran.bdf.cards.optimization.html#pyNastran.bdf.cards.optimization.DVGRID.cross_reference">[docs]</a>    <span class="k">def</span> <span class="nf">cross_reference</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">model</span><span class="p">:</span> <span class="n">BDF</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Cross links the card so referenced cards can be extracted directly</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        model : BDF()</span>
<span class="sd">            the BDF object</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dvid_ref</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">desvars</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">dvid</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">nid_ref</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">Node</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nid</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">cid_ref</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">Coord</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">cid</span><span class="p">)</span></div>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">node_id</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">nid_ref</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">nid</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">nid_ref</span><span class="o">.</span><span class="n">nid</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">coord_id</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">cid_ref</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">cid</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">cid_ref</span><span class="o">.</span><span class="n">cid</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">desvar_id</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">dvid_ref</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">dvid</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">dvid_ref</span><span class="o">.</span><span class="n">dvid</span>

<div class="viewcode-block" id="DVGRID.uncross_reference"><a class="viewcode-back" href="../../../../reference/bdf/cards/pyNastran.bdf.cards.optimization.html#pyNastran.bdf.cards.optimization.DVGRID.uncross_reference">[docs]</a>    <span class="k">def</span> <span class="nf">uncross_reference</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Removes cross-reference links&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">nid</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">node_id</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">cid</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">coord_id</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dvid</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">desvar_id</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">nid_ref</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">cid_ref</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dvid_ref</span> <span class="o">=</span> <span class="kc">None</span></div>

<div class="viewcode-block" id="DVGRID.raw_fields"><a class="viewcode-back" href="../../../../reference/bdf/cards/pyNastran.bdf.cards.optimization.html#pyNastran.bdf.cards.optimization.DVGRID.raw_fields">[docs]</a>    <span class="k">def</span> <span class="nf">raw_fields</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">list_fields</span> <span class="o">=</span> <span class="p">[</span>
            <span class="s1">&#39;DVGRID&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">desvar_id</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">node_id</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">coord_id</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">coeff</span><span class="p">]</span> <span class="o">+</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dxyz</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">list_fields</span></div>

<div class="viewcode-block" id="DVGRID.write_card"><a class="viewcode-back" href="../../../../reference/bdf/cards/pyNastran.bdf.cards.optimization.html#pyNastran.bdf.cards.optimization.DVGRID.write_card">[docs]</a>    <span class="k">def</span> <span class="nf">write_card</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">size</span><span class="p">:</span> <span class="nb">int</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span> <span class="n">is_double</span><span class="p">:</span> <span class="nb">bool</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="n">card</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">repr_fields</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">size</span> <span class="o">==</span> <span class="mi">8</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">comment</span> <span class="o">+</span> <span class="n">print_card_8</span><span class="p">(</span><span class="n">card</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">is_double</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">comment</span> <span class="o">+</span> <span class="n">print_card_double</span><span class="p">(</span><span class="n">card</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">comment</span> <span class="o">+</span> <span class="n">print_card_16</span><span class="p">(</span><span class="n">card</span><span class="p">)</span></div>

    <span class="k">def</span> <span class="nf">_verify</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">xref</span><span class="p">):</span>
        <span class="k">pass</span></div>

<div class="viewcode-block" id="parse_table_fields"><a class="viewcode-back" href="../../../../reference/bdf/cards/pyNastran.bdf.cards.optimization.html#pyNastran.bdf.cards.optimization.parse_table_fields">[docs]</a><span class="k">def</span> <span class="nf">parse_table_fields</span><span class="p">(</span><span class="n">card_type</span><span class="p">,</span> <span class="n">card</span><span class="p">,</span> <span class="n">fields</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    params = {</span>
<span class="sd">       (0, &#39;DRESP1&#39;) = [10, 20],</span>
<span class="sd">       (1, &#39;DESVAR&#39;) = [30],</span>
<span class="sd">       (2, &#39;DRESP1&#39;) = [40],</span>
<span class="sd">    }</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">params</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">fields</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">params</span>

    <span class="n">j</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">value_list</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">key</span> <span class="o">=</span> <span class="kc">None</span>  <span class="c1"># dummy key</span>
    <span class="n">integer_names</span> <span class="o">=</span> <span class="p">[</span>
        <span class="s1">&#39;DESVAR&#39;</span><span class="p">,</span> <span class="s1">&#39;DRESP1&#39;</span><span class="p">,</span> <span class="s1">&#39;DRESP2&#39;</span><span class="p">,</span> <span class="s1">&#39;DVCREL1&#39;</span><span class="p">,</span> <span class="s1">&#39;DVCREL2&#39;</span><span class="p">,</span>
        <span class="s1">&#39;DVMREL1&#39;</span><span class="p">,</span> <span class="s1">&#39;DVMREL2&#39;</span><span class="p">,</span> <span class="s1">&#39;DVPREL1&#39;</span><span class="p">,</span> <span class="s1">&#39;DVPREL2&#39;</span><span class="p">,</span> <span class="s1">&#39;DNODE&#39;</span><span class="p">]</span>
    <span class="k">for</span> <span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">field</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">fields</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">i</span> <span class="o">%</span> <span class="mi">8</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">field</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">i</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">value_list</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;key=</span><span class="si">%s</span><span class="s1"> values=</span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">value_list</span><span class="p">)</span>
                <span class="n">params</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">value_list</span>
                <span class="n">j</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="n">key</span> <span class="o">=</span> <span class="p">(</span><span class="n">j</span><span class="p">,</span> <span class="n">field</span><span class="p">)</span>
            <span class="n">value_list</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="n">name</span> <span class="o">=</span> <span class="n">field</span>
        <span class="k">elif</span> <span class="n">field</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">name</span> <span class="ow">in</span> <span class="n">integer_names</span><span class="p">:</span>
                <span class="c1">#print(&#39;field=%s value=%r type=%r should be an integer...\ncard=%s&#39; % (</span>
                    <span class="c1">#i+9, field, name, card))</span>
                <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">field</span><span class="p">,</span> <span class="n">integer_types</span><span class="p">),</span> <span class="s1">&#39;field=</span><span class="si">%i</span><span class="s1"> value=</span><span class="si">%r</span><span class="s1"> type=</span><span class="si">%s</span><span class="s1"> should be an integer...</span><span class="se">\n</span><span class="s1">card=</span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">9</span><span class="p">,</span> <span class="n">field</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">card</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">name</span> <span class="o">==</span> <span class="s1">&#39;DTABLE&#39;</span><span class="p">:</span>
                <span class="c1">#print(&#39;field=%s value=%r type=%r should be an string...\ncard=%s&#39; % (</span>
                    <span class="c1">#i+9, field, name, card))</span>
                <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">field</span><span class="p">,</span> <span class="nb">str</span><span class="p">),</span> <span class="s1">&#39;field=</span><span class="si">%i</span><span class="s1"> value=</span><span class="si">%r</span><span class="s1"> type=</span><span class="si">%s</span><span class="s1"> should be an string...</span><span class="se">\n</span><span class="s1">card=</span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">9</span><span class="p">,</span> <span class="n">field</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">card</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">name</span> <span class="o">==</span> <span class="s1">&#39;DFRFNC&#39;</span><span class="p">:</span>
                <span class="k">pass</span>
            <span class="k">elif</span> <span class="n">name</span> <span class="o">==</span> <span class="s1">&#39;USRDATA&#39;</span> <span class="ow">and</span> <span class="n">card_type</span> <span class="o">==</span> <span class="s1">&#39;DRESP3&#39;</span><span class="p">:</span>
                <span class="k">pass</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="s1">&#39;name=</span><span class="si">%r</span><span class="se">\n</span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">card</span><span class="p">))</span>
            <span class="n">value_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">field</span><span class="p">)</span>
    <span class="n">params</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">value_list</span>

    <span class="k">assert</span> <span class="kc">None</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">params</span><span class="p">,</span> <span class="n">params</span>
    <span class="n">params2</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="k">for</span> <span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">name</span><span class="p">),</span> <span class="n">values</span> <span class="ow">in</span> <span class="n">params</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="k">if</span> <span class="n">name</span> <span class="o">!=</span> <span class="s1">&#39;DNODE&#39;</span><span class="p">:</span>
            <span class="n">params2</span><span class="p">[(</span><span class="n">i</span><span class="p">,</span> <span class="n">name</span><span class="p">)]</span> <span class="o">=</span> <span class="n">values</span>
            <span class="k">continue</span>

        <span class="n">nids</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">components</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">values</span><span class="p">)</span> <span class="o">%</span> <span class="mi">2</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">msg</span> <span class="o">=</span> <span class="s1">&#39;DNODE nvalues=</span><span class="si">%s</span><span class="s1"> must be even; values=</span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">values</span><span class="p">),</span> <span class="n">values</span><span class="p">)</span>
            <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">j</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">cycle</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]),</span> <span class="n">values</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">j</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">nids</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">components</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
        <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">nids</span><span class="p">)</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="n">components</span><span class="p">)</span>
        <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">nids</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span>
        <span class="n">params2</span><span class="p">[(</span><span class="n">i</span><span class="p">,</span> <span class="n">name</span><span class="p">)]</span> <span class="o">=</span> <span class="p">(</span><span class="n">nids</span><span class="p">,</span> <span class="n">components</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">params2</span></div>


<div class="viewcode-block" id="_get_dresp23_table_values"><a class="viewcode-back" href="../../../../reference/bdf/cards/pyNastran.bdf.cards.optimization.html#pyNastran.bdf.cards.optimization._get_dresp23_table_values">[docs]</a><span class="k">def</span> <span class="nf">_get_dresp23_table_values</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">values_list</span><span class="p">,</span> <span class="n">inline</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    name : str</span>
<span class="sd">        the name of the response (e.g., DRESP1, DVPREL1)</span>
<span class="sd">    values_list : varies</span>
<span class="sd">        typical : List[int]</span>
<span class="sd">        DNODE : List[List[int], List[int]]</span>
<span class="sd">    inline : bool; default=False</span>
<span class="sd">        used for DNODE</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">out</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">if</span> <span class="n">name</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;DRESP1&#39;</span><span class="p">,</span> <span class="s1">&#39;DRESP2&#39;</span><span class="p">]:</span>
        <span class="k">for</span> <span class="n">val</span> <span class="ow">in</span> <span class="n">values_list</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">val</span><span class="p">,</span> <span class="n">integer_types</span><span class="p">):</span>
                <span class="n">out</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">val</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">out</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">val</span><span class="o">.</span><span class="n">OptID</span><span class="p">())</span>

    <span class="k">elif</span> <span class="n">name</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;DVCREL1&#39;</span><span class="p">,</span> <span class="s1">&#39;DVCREL2&#39;</span><span class="p">]:</span>
        <span class="k">for</span> <span class="n">val</span> <span class="ow">in</span> <span class="n">values_list</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">val</span><span class="p">,</span> <span class="n">integer_types</span><span class="p">):</span>
                <span class="n">out</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">val</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">out</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">val</span><span class="o">.</span><span class="n">OptID</span><span class="p">())</span>

    <span class="k">elif</span> <span class="n">name</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;DVMREL1&#39;</span><span class="p">,</span> <span class="s1">&#39;DVMREL2&#39;</span><span class="p">]:</span>
        <span class="k">for</span> <span class="n">val</span> <span class="ow">in</span> <span class="n">values_list</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">val</span><span class="p">,</span> <span class="n">integer_types</span><span class="p">):</span>
                <span class="n">out</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">val</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">out</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">val</span><span class="o">.</span><span class="n">OptID</span><span class="p">())</span>

    <span class="k">elif</span> <span class="n">name</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;DVPREL1&#39;</span><span class="p">,</span> <span class="s1">&#39;DVPREL2&#39;</span><span class="p">]:</span>
        <span class="k">for</span> <span class="n">val</span> <span class="ow">in</span> <span class="n">values_list</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">val</span><span class="p">,</span> <span class="n">integer_types</span><span class="p">):</span>
                <span class="n">out</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">val</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">out</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">val</span><span class="o">.</span><span class="n">OptID</span><span class="p">())</span>
    <span class="k">elif</span> <span class="n">name</span> <span class="o">==</span> <span class="s1">&#39;DESVAR&#39;</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">val</span> <span class="ow">in</span> <span class="n">values_list</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">val</span><span class="p">,</span> <span class="n">integer_types</span><span class="p">):</span>
                <span class="n">out</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">val</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">out</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">val</span><span class="o">.</span><span class="n">desvar_id</span><span class="p">)</span>

    <span class="k">elif</span> <span class="n">name</span> <span class="o">==</span> <span class="s1">&#39;DNODE&#39;</span><span class="p">:</span>
        <span class="n">nids_list</span><span class="p">,</span> <span class="n">components_list</span> <span class="o">=</span> <span class="n">values_list</span>
        <span class="k">if</span> <span class="n">inline</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">nid</span><span class="p">,</span> <span class="n">component</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">nids_list</span><span class="p">,</span> <span class="n">components_list</span><span class="p">):</span>
                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">nid</span><span class="p">,</span> <span class="n">integer_types</span><span class="p">):</span>
                    <span class="n">out</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">nid</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">out</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">nid</span><span class="o">.</span><span class="n">nid</span><span class="p">)</span>
                <span class="n">out</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">component</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">out1</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="n">out2</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="n">out</span> <span class="o">=</span> <span class="p">[</span><span class="n">out1</span><span class="p">,</span> <span class="n">out2</span><span class="p">]</span>
            <span class="k">for</span> <span class="n">nid</span><span class="p">,</span> <span class="n">component</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">nids_list</span><span class="p">,</span> <span class="n">components_list</span><span class="p">):</span>
                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">nid</span><span class="p">,</span> <span class="n">integer_types</span><span class="p">):</span>
                    <span class="n">out1</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">nid</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">out1</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">nid</span><span class="o">.</span><span class="n">nid</span><span class="p">)</span>
                <span class="n">out2</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">component</span><span class="p">)</span>

    <span class="k">elif</span> <span class="n">name</span> <span class="o">==</span> <span class="s1">&#39;DTABLE&#39;</span><span class="p">:</span>
        <span class="n">out</span> <span class="o">=</span> <span class="n">values_list</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="s1">&#39;  TODO: _get_values </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="nb">str</span><span class="p">(</span><span class="n">name</span><span class="p">))</span>
        <span class="c1">#out = values_list</span>
    <span class="k">return</span> <span class="n">out</span></div>


<div class="viewcode-block" id="get_dvxrel1_coeffs"><a class="viewcode-back" href="../../../../reference/bdf/cards/pyNastran.bdf.cards.optimization.html#pyNastran.bdf.cards.optimization.get_dvxrel1_coeffs">[docs]</a><span class="k">def</span> <span class="nf">get_dvxrel1_coeffs</span><span class="p">(</span><span class="n">dvxrel</span><span class="p">,</span> <span class="n">model</span><span class="p">,</span> <span class="n">desvar_values</span><span class="p">,</span> <span class="n">debug</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Used by DVPREL1/2, DVMREL1/2, DVCREL1/2, and DVGRID to determine</span>
<span class="sd">    the value for the new property/material/etc. value</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">value</span> <span class="o">=</span> <span class="n">dvxrel</span><span class="o">.</span><span class="n">c0</span>
    <span class="k">if</span> <span class="n">debug</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;value_init=</span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">value</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">coeff</span><span class="p">,</span> <span class="n">desvar_id</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">dvxrel</span><span class="o">.</span><span class="n">coeffs</span><span class="p">,</span> <span class="n">dvxrel</span><span class="o">.</span><span class="n">desvar_ids</span><span class="p">):</span>
        <span class="c1">#desvar = model.desvars[desvar_id]</span>
        <span class="c1">#valuei = desvar.value</span>
        <span class="n">valuei</span> <span class="o">=</span> <span class="n">_get_desvar</span><span class="p">(</span><span class="n">desvar_values</span><span class="p">,</span> <span class="n">desvar_id</span><span class="p">,</span> <span class="n">dvxrel</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">debug</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;  desvar_id=</span><span class="si">%s</span><span class="s1"> coeff=</span><span class="si">%s</span><span class="s1"> valuei=</span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">desvar_id</span><span class="p">,</span> <span class="n">coeff</span><span class="p">,</span> <span class="n">valuei</span><span class="p">))</span>
        <span class="n">value</span> <span class="o">+=</span> <span class="n">coeff</span> <span class="o">*</span> <span class="n">valuei</span>

    <span class="k">if</span> <span class="n">debug</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;value_final=</span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">value</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">value</span></div>

<div class="viewcode-block" id="_get_desvar"><a class="viewcode-back" href="../../../../reference/bdf/cards/pyNastran.bdf.cards.optimization.html#pyNastran.bdf.cards.optimization._get_desvar">[docs]</a><span class="k">def</span> <span class="nf">_get_desvar</span><span class="p">(</span><span class="n">desvar_values</span><span class="p">,</span> <span class="n">desvar_id</span><span class="p">,</span> <span class="n">dvxrel</span><span class="p">):</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">value</span> <span class="o">=</span> <span class="n">desvar_values</span><span class="p">[</span><span class="n">desvar_id</span><span class="p">]</span>
    <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
        <span class="n">msg</span> <span class="o">=</span> <span class="s1">&#39;Cannot find desvar_id=</span><span class="si">%r</span><span class="s1"> in:</span><span class="se">\n</span><span class="si">%s</span><span class="se">\n</span><span class="s1">desvar_ids=</span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span>
            <span class="n">desvar_id</span><span class="p">,</span> <span class="n">dvxrel</span><span class="p">,</span> <span class="nb">list</span><span class="p">(</span><span class="n">desvar_values</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
        <span class="p">)</span>
        <span class="k">raise</span> <span class="ne">KeyError</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
    <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="nb">float</span><span class="p">),</span> <span class="n">value</span>
    <span class="c1">#print(&#39;value = %s&#39; % value)</span>
    <span class="k">return</span> <span class="n">value</span></div>

<div class="viewcode-block" id="_get_dtable_value"><a class="viewcode-back" href="../../../../reference/bdf/cards/pyNastran.bdf.cards.optimization.html#pyNastran.bdf.cards.optimization._get_dtable_value">[docs]</a><span class="k">def</span> <span class="nf">_get_dtable_value</span><span class="p">(</span><span class="n">dtable</span><span class="p">,</span> <span class="n">labels</span><span class="p">,</span> <span class="n">dvxrel</span><span class="p">):</span>
    <span class="n">values</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">labels</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">values</span>
    <span class="k">if</span> <span class="n">dtable</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">KeyError</span><span class="p">(</span><span class="s1">&#39;DTABLE is None and must contain </span><span class="si">%s</span><span class="se">\n</span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span>
            <span class="nb">str</span><span class="p">(</span><span class="n">labels</span><span class="p">),</span> <span class="nb">str</span><span class="p">(</span><span class="n">dvxrel</span><span class="p">)))</span>
    <span class="k">for</span> <span class="n">label</span> <span class="ow">in</span> <span class="n">labels</span><span class="p">:</span>
        <span class="n">value</span> <span class="o">=</span> <span class="n">dtable</span><span class="p">[</span><span class="n">label</span><span class="p">]</span>
        <span class="n">values</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">values</span></div>

<div class="viewcode-block" id="get_deqatn_args"><a class="viewcode-back" href="../../../../reference/bdf/cards/pyNastran.bdf.cards.optimization.html#pyNastran.bdf.cards.optimization.get_deqatn_args">[docs]</a><span class="k">def</span> <span class="nf">get_deqatn_args</span><span class="p">(</span><span class="n">dvxrel2</span><span class="p">,</span> <span class="n">model</span><span class="p">,</span> <span class="n">desvar_values</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;gets the arguments for the DEQATN for the DVxREL2&quot;&quot;&quot;</span>
    <span class="n">values</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">desvar_id</span> <span class="ow">in</span> <span class="n">dvxrel2</span><span class="o">.</span><span class="n">dvids</span><span class="p">:</span>
        <span class="n">valuei</span> <span class="o">=</span> <span class="n">_get_desvar</span><span class="p">(</span><span class="n">desvar_values</span><span class="p">,</span> <span class="n">desvar_id</span><span class="p">,</span> <span class="n">dvxrel2</span><span class="p">)</span>
        <span class="n">values</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">valuei</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">dvxrel2</span><span class="o">.</span><span class="n">labels</span><span class="p">:</span>
        <span class="n">values</span> <span class="o">+=</span> <span class="n">_get_dtable_value</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">dtable</span><span class="p">,</span> <span class="n">dvxrel2</span><span class="o">.</span><span class="n">labels</span><span class="p">,</span> <span class="n">dvxrel2</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">values</span></div>

<div class="viewcode-block" id="get_deqatn_value"><a class="viewcode-back" href="../../../../reference/bdf/cards/pyNastran.bdf.cards.optimization.html#pyNastran.bdf.cards.optimization.get_deqatn_value">[docs]</a><span class="k">def</span> <span class="nf">get_deqatn_value</span><span class="p">(</span><span class="n">dvxrel2</span><span class="p">,</span> <span class="n">model</span><span class="p">,</span> <span class="n">desvar_values</span><span class="p">):</span>
    <span class="n">values</span> <span class="o">=</span> <span class="n">get_deqatn_args</span><span class="p">(</span><span class="n">dvxrel2</span><span class="p">,</span> <span class="n">model</span><span class="p">,</span> <span class="n">desvar_values</span><span class="p">)</span>
    <span class="n">deqatn</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">DEQATN</span><span class="p">(</span><span class="n">dvxrel2</span><span class="o">.</span><span class="n">dequation</span><span class="p">)</span>
    <span class="c1">#print(deqatn.func_str)</span>
    <span class="c1">#exec(deqatn.func_str)</span>
    <span class="n">func</span> <span class="o">=</span> <span class="n">deqatn</span><span class="o">.</span><span class="n">func</span>
    <span class="k">if</span> <span class="n">func</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">msg</span> <span class="o">=</span> <span class="s1">&#39;func is None...DEQATN=</span><span class="si">%s</span><span class="se">\n</span><span class="si">%s</span><span class="se">\n</span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">dvxrel2</span><span class="o">.</span><span class="n">dequation</span><span class="p">,</span> <span class="n">dvxrel2</span><span class="p">,</span> <span class="n">deqatn</span><span class="p">)</span>
        <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
    <span class="c1">#print(func)</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">value</span> <span class="o">=</span> <span class="n">func</span><span class="p">(</span><span class="o">*</span><span class="n">values</span><span class="p">)</span>
    <span class="k">except</span> <span class="ne">NameError</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">deqatn</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">deqatn</span><span class="o">.</span><span class="n">func_str</span><span class="p">)</span>
        <span class="k">raise</span>
    <span class="k">return</span> <span class="n">value</span></div>

<div class="viewcode-block" id="get_dvprel_key"><a class="viewcode-back" href="../../../../reference/bdf/cards/pyNastran.bdf.cards.optimization.html#pyNastran.bdf.cards.optimization.get_dvprel_key">[docs]</a><span class="k">def</span> <span class="nf">get_dvprel_key</span><span class="p">(</span><span class="n">dvprel</span><span class="p">,</span> <span class="n">prop</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;helper method for the gui&quot;&quot;&quot;</span>
    <span class="n">msg</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
    <span class="n">prop_type</span> <span class="o">=</span> <span class="n">dvprel</span><span class="o">.</span><span class="n">prop_type</span>
    <span class="n">var_to_change</span> <span class="o">=</span> <span class="n">dvprel</span><span class="o">.</span><span class="n">pname_fid</span>

    <span class="k">if</span> <span class="n">prop_type</span> <span class="o">==</span> <span class="s1">&#39;PROD&#39;</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">var_to_change</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;J&#39;</span><span class="p">]:</span>
            <span class="k">pass</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">var_to_change</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>  <span class="c1"># pragma: no cover</span>
            <span class="n">msg</span> <span class="o">=</span> <span class="s1">&#39;prop_type=</span><span class="si">%r</span><span class="s1"> pname/fid=</span><span class="si">%s</span><span class="s1"> is not supported&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">prop_type</span><span class="p">,</span> <span class="n">var_to_change</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>  <span class="c1"># pragma: no cover</span>
            <span class="n">msg</span> <span class="o">=</span> <span class="s1">&#39;prop_type=</span><span class="si">%r</span><span class="s1"> pname/fid=</span><span class="si">%r</span><span class="s1"> is not supported&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">prop_type</span><span class="p">,</span> <span class="n">var_to_change</span><span class="p">)</span>

    <span class="k">elif</span> <span class="n">prop_type</span> <span class="o">==</span> <span class="s1">&#39;PTUBE&#39;</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">var_to_change</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;OD&#39;</span><span class="p">,</span> <span class="s1">&#39;T&#39;</span><span class="p">]:</span>
            <span class="k">pass</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">var_to_change</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>  <span class="c1"># pragma: no cover</span>
            <span class="n">msg</span> <span class="o">=</span> <span class="s1">&#39;prop_type=</span><span class="si">%r</span><span class="s1"> pname/fid=</span><span class="si">%s</span><span class="s1"> is not supported&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">prop_type</span><span class="p">,</span> <span class="n">var_to_change</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>  <span class="c1"># pragma: no cover</span>
            <span class="n">msg</span> <span class="o">=</span> <span class="s1">&#39;prop_type=</span><span class="si">%r</span><span class="s1"> pname/fid=</span><span class="si">%r</span><span class="s1"> is not supported&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">prop_type</span><span class="p">,</span> <span class="n">var_to_change</span><span class="p">)</span>

    <span class="k">elif</span> <span class="n">prop_type</span> <span class="o">==</span> <span class="s1">&#39;PSHELL&#39;</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">var_to_change</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;T&#39;</span><span class="p">]:</span>
            <span class="k">pass</span>
        <span class="k">elif</span> <span class="n">var_to_change</span> <span class="o">==</span> <span class="mi">6</span><span class="p">:</span>
            <span class="n">var_to_change</span> <span class="o">=</span> <span class="s1">&#39;12I/t^3&#39;</span>
        <span class="k">elif</span> <span class="n">var_to_change</span> <span class="o">==</span> <span class="mi">8</span><span class="p">:</span>
            <span class="n">var_to_change</span> <span class="o">=</span> <span class="s1">&#39;Ts/T&#39;</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">var_to_change</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>  <span class="c1"># pragma: no cover</span>
            <span class="n">msg</span> <span class="o">=</span> <span class="s1">&#39;prop_type=</span><span class="si">%r</span><span class="s1"> pname/fid=</span><span class="si">%s</span><span class="s1"> is not supported&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">prop_type</span><span class="p">,</span> <span class="n">var_to_change</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>  <span class="c1"># pragma: no cover</span>
            <span class="n">msg</span> <span class="o">=</span> <span class="s1">&#39;prop_type=</span><span class="si">%r</span><span class="s1"> pname/fid=</span><span class="si">%r</span><span class="s1"> is not supported&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">prop_type</span><span class="p">,</span> <span class="n">var_to_change</span><span class="p">)</span>

    <span class="k">elif</span> <span class="n">prop_type</span> <span class="o">==</span> <span class="s1">&#39;PCOMP&#39;</span><span class="p">:</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">var_to_change</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">var_to_change</span> <span class="ow">in</span> <span class="n">valid_pcomp_codes</span><span class="p">:</span>
                <span class="k">pass</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">msg</span> <span class="o">=</span> <span class="s1">&#39;prop_type=</span><span class="si">%r</span><span class="s1"> pname/fid=</span><span class="si">%s</span><span class="s1"> int is not supported&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">prop_type</span><span class="p">,</span> <span class="n">var_to_change</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">var_to_change</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;THETA&#39;</span><span class="p">)</span> <span class="ow">or</span> <span class="n">var_to_change</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;T&#39;</span><span class="p">):</span>
            <span class="k">pass</span>
        <span class="k">elif</span> <span class="n">var_to_change</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;Z0&#39;</span><span class="p">,</span> <span class="s1">&#39;SB&#39;</span><span class="p">,</span> <span class="s1">&#39;TREF&#39;</span><span class="p">,</span> <span class="s1">&#39;GE&#39;</span><span class="p">]:</span>
            <span class="k">pass</span>
        <span class="k">else</span><span class="p">:</span>  <span class="c1"># pragma: no cover</span>
            <span class="n">msg</span> <span class="o">=</span> <span class="s1">&#39;prop_type=</span><span class="si">%r</span><span class="s1"> pname/fid=</span><span class="si">%r</span><span class="s1"> is not supported&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">prop_type</span><span class="p">,</span> <span class="n">var_to_change</span><span class="p">)</span>

    <span class="k">elif</span> <span class="n">prop_type</span> <span class="o">==</span> <span class="s1">&#39;PCOMPG&#39;</span><span class="p">:</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">var_to_change</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>
            <span class="n">msg</span> <span class="o">=</span> <span class="s1">&#39;prop_type=</span><span class="si">%r</span><span class="s1"> pname/fid=</span><span class="si">%s</span><span class="s1"> is not supported&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">prop_type</span><span class="p">,</span> <span class="n">var_to_change</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">var_to_change</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;THETA&#39;</span><span class="p">)</span> <span class="ow">or</span> <span class="n">var_to_change</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;T&#39;</span><span class="p">):</span>
            <span class="k">pass</span>
        <span class="k">elif</span> <span class="n">var_to_change</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;Z0&#39;</span><span class="p">,</span> <span class="s1">&#39;SB&#39;</span><span class="p">]:</span>
            <span class="k">pass</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">var_to_change</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>  <span class="c1"># pragma: no cover</span>
            <span class="n">msg</span> <span class="o">=</span> <span class="s1">&#39;prop_type=</span><span class="si">%r</span><span class="s1"> pname/fid=</span><span class="si">%s</span><span class="s1"> is not supported&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">prop_type</span><span class="p">,</span> <span class="n">var_to_change</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>  <span class="c1"># pragma: no cover</span>
            <span class="n">msg</span> <span class="o">=</span> <span class="s1">&#39;prop_type=</span><span class="si">%r</span><span class="s1"> pname/fid=</span><span class="si">%r</span><span class="s1"> is not supported&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">prop_type</span><span class="p">,</span> <span class="n">var_to_change</span><span class="p">)</span>

    <span class="k">elif</span> <span class="n">prop_type</span> <span class="o">==</span> <span class="s1">&#39;PBAR&#39;</span><span class="p">:</span>
        <span class="n">pbar_var_map</span> <span class="o">=</span> <span class="p">{</span>
            <span class="c1"># 1-based</span>
            <span class="mi">4</span> <span class="p">:</span> <span class="s1">&#39;A&#39;</span><span class="p">,</span>
            <span class="mi">5</span> <span class="p">:</span> <span class="s1">&#39;I1&#39;</span><span class="p">,</span>
            <span class="mi">6</span> <span class="p">:</span> <span class="s1">&#39;I2&#39;</span><span class="p">,</span>
            <span class="mi">7</span> <span class="p">:</span> <span class="s1">&#39;J&#39;</span><span class="p">,</span>
            <span class="mi">10</span> <span class="p">:</span> <span class="s1">&#39;C1&#39;</span><span class="p">,</span>
            <span class="mi">11</span> <span class="p">:</span> <span class="s1">&#39;C2&#39;</span><span class="p">,</span>
            <span class="mi">12</span> <span class="p">:</span> <span class="s1">&#39;D1&#39;</span><span class="p">,</span>
            <span class="mi">13</span> <span class="p">:</span> <span class="s1">&#39;D2&#39;</span><span class="p">,</span>
            <span class="mi">14</span> <span class="p">:</span> <span class="s1">&#39;E1&#39;</span><span class="p">,</span>
            <span class="mi">15</span> <span class="p">:</span> <span class="s1">&#39;E2&#39;</span><span class="p">,</span>
            <span class="mi">16</span> <span class="p">:</span> <span class="s1">&#39;F1&#39;</span><span class="p">,</span>
            <span class="mi">17</span> <span class="p">:</span> <span class="s1">&#39;F2&#39;</span><span class="p">,</span>
            <span class="mi">18</span> <span class="p">:</span> <span class="s1">&#39;K1&#39;</span><span class="p">,</span>
            <span class="mi">19</span> <span class="p">:</span> <span class="s1">&#39;K1&#39;</span><span class="p">,</span>
            <span class="mi">20</span> <span class="p">:</span> <span class="s1">&#39;I12&#39;</span><span class="p">,</span>
        <span class="p">}</span>
        <span class="k">if</span> <span class="n">var_to_change</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;I1&#39;</span><span class="p">,</span> <span class="s1">&#39;I2&#39;</span><span class="p">,</span> <span class="s1">&#39;J&#39;</span><span class="p">,</span> <span class="s1">&#39;C1&#39;</span><span class="p">,</span> <span class="s1">&#39;C2&#39;</span><span class="p">,</span> <span class="s1">&#39;D1&#39;</span><span class="p">,</span> <span class="s1">&#39;D2&#39;</span><span class="p">,</span>
                             <span class="s1">&#39;E1&#39;</span><span class="p">,</span> <span class="s1">&#39;E2&#39;</span><span class="p">,</span> <span class="s1">&#39;F1&#39;</span><span class="p">,</span> <span class="s1">&#39;F2&#39;</span><span class="p">,</span> <span class="s1">&#39;K1&#39;</span><span class="p">,</span> <span class="s1">&#39;K2&#39;</span><span class="p">,</span> <span class="s1">&#39;I12&#39;</span><span class="p">]:</span>
            <span class="k">pass</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">var_to_change</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>  <span class="c1"># pragma: no cover</span>
            <span class="k">if</span> <span class="n">var_to_change</span> <span class="ow">in</span> <span class="n">pbar_var_map</span><span class="p">:</span>
                <span class="n">var_to_change</span> <span class="o">=</span> <span class="n">pbar_var_map</span><span class="p">[</span><span class="n">var_to_change</span><span class="p">]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">msg</span> <span class="o">=</span> <span class="s1">&#39;prop_type=</span><span class="si">%r</span><span class="s1"> pname/fid=</span><span class="si">%s</span><span class="s1"> is not supported&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">prop_type</span><span class="p">,</span> <span class="n">var_to_change</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>  <span class="c1"># pragma: no cover</span>
            <span class="n">msg</span> <span class="o">=</span> <span class="s1">&#39;prop_type=</span><span class="si">%r</span><span class="s1"> pname/fid=</span><span class="si">%r</span><span class="s1"> is not supported&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">prop_type</span><span class="p">,</span> <span class="n">var_to_change</span><span class="p">)</span>

    <span class="k">elif</span> <span class="n">prop_type</span> <span class="o">==</span> <span class="s1">&#39;PBEAM&#39;</span><span class="p">:</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">var_to_change</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">var_to_change</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;I1&#39;</span><span class="p">,</span> <span class="s1">&#39;I2&#39;</span><span class="p">,</span> <span class="s1">&#39;I1(B)&#39;</span><span class="p">,</span> <span class="s1">&#39;J&#39;</span><span class="p">,</span> <span class="s1">&#39;I2(B)&#39;</span><span class="p">,</span>
                                 <span class="s1">&#39;A(A)&#39;</span><span class="p">,]:</span>
                <span class="k">pass</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">word</span><span class="p">,</span> <span class="n">num</span> <span class="o">=</span> <span class="n">break_word_by_trailing_parentheses_integer_ab</span><span class="p">(</span>
                    <span class="n">var_to_change</span><span class="p">)</span>
                <span class="n">var_to_change</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">%s</span><span class="s1">(</span><span class="si">%s</span><span class="s1">)&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">word</span><span class="p">,</span> <span class="n">num</span><span class="p">)</span>  <span class="c1"># A(A), A(1), A(10)</span>

        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">var_to_change</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>  <span class="c1"># pragma: no cover</span>
            <span class="k">if</span> <span class="n">var_to_change</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
                <span class="c1"># shift to divisible by 16</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="o">-</span><span class="mi">167</span> <span class="o">&lt;=</span> <span class="n">var_to_change</span> <span class="o">&lt;=</span> <span class="o">-</span><span class="mi">6</span><span class="p">):</span>
                    <span class="n">msg</span> <span class="o">=</span> <span class="s1">&#39;A-property_type=</span><span class="si">%r</span><span class="s1"> has not implemented </span><span class="si">%r</span><span class="s1"> in pname_map&#39;</span> <span class="o">%</span> <span class="p">(</span>
                        <span class="n">prop_type</span><span class="p">,</span> <span class="n">var_to_change</span><span class="p">)</span>
                    <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
                <span class="n">ioffset</span> <span class="o">=</span> <span class="o">-</span><span class="n">var_to_change</span> <span class="o">-</span> <span class="mi">6</span>
                <span class="n">istation</span> <span class="o">=</span> <span class="n">ioffset</span> <span class="o">//</span> <span class="mi">16</span>
                <span class="n">iterm</span> <span class="o">=</span> <span class="n">ioffset</span> <span class="o">%</span> <span class="mi">16</span>

                <span class="c1"># 0    1   2   3   4   5   6   7    8  9</span>
                <span class="c1">#(soi, xxb, a, i1, i2, i12, j, nsm, c1, c2,</span>
                <span class="c1">#</span>
                 <span class="c1">#10  11  12  13  14  15</span>
                 <span class="c1">#d1, d2, e1, e2, f1, f2) = pack</span>
                <span class="k">assert</span> <span class="n">istation</span> <span class="o">==</span> <span class="mi">0</span><span class="p">,</span> <span class="n">istation</span>
                <span class="n">pbeam_var_map</span> <span class="o">=</span> <span class="p">{</span>
                    <span class="mi">2</span> <span class="p">:</span> <span class="s1">&#39;A&#39;</span><span class="p">,</span>
                    <span class="mi">3</span> <span class="p">:</span> <span class="s1">&#39;I1&#39;</span><span class="p">,</span>
                    <span class="mi">4</span> <span class="p">:</span> <span class="s1">&#39;I2&#39;</span><span class="p">,</span>
                    <span class="mi">5</span> <span class="p">:</span> <span class="s1">&#39;I12&#39;</span><span class="p">,</span>
                    <span class="mi">6</span> <span class="p">:</span> <span class="s1">&#39;J&#39;</span><span class="p">,</span>
                    <span class="c1">#7 : &#39;NSM&#39;,</span>
                    <span class="mi">8</span> <span class="p">:</span> <span class="s1">&#39;C1&#39;</span><span class="p">,</span>
                    <span class="mi">9</span> <span class="p">:</span> <span class="s1">&#39;C2&#39;</span><span class="p">,</span>
                    <span class="mi">10</span> <span class="p">:</span> <span class="s1">&#39;D1&#39;</span><span class="p">,</span>
                    <span class="mi">11</span> <span class="p">:</span> <span class="s1">&#39;D2&#39;</span><span class="p">,</span>
                    <span class="mi">12</span> <span class="p">:</span> <span class="s1">&#39;E1&#39;</span><span class="p">,</span>
                    <span class="mi">13</span> <span class="p">:</span> <span class="s1">&#39;E2&#39;</span><span class="p">,</span>
                    <span class="mi">14</span> <span class="p">:</span> <span class="s1">&#39;F1&#39;</span><span class="p">,</span>
                    <span class="mi">15</span> <span class="p">:</span> <span class="s1">&#39;F2&#39;</span><span class="p">,</span>
                <span class="p">}</span>
                <span class="k">if</span> <span class="n">iterm</span> <span class="ow">in</span> <span class="n">pbeam_var_map</span><span class="p">:</span>
                    <span class="n">var_to_change</span> <span class="o">=</span> <span class="n">pbeam_var_map</span><span class="p">[</span><span class="n">iterm</span><span class="p">]</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">istation</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">msg</span> <span class="o">=</span> <span class="s1">&#39;istation=</span><span class="si">%s</span><span class="s1"> iterm=</span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">istation</span><span class="p">,</span> <span class="n">iterm</span><span class="p">)</span>
                    <span class="n">msg</span> <span class="o">+=</span> <span class="s1">&#39;prop_type=</span><span class="si">%r</span><span class="s1"> pname/fid=</span><span class="si">%s</span><span class="s1"> is not supported&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">prop_type</span><span class="p">,</span> <span class="n">var_to_change</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">msg</span> <span class="o">=</span> <span class="s1">&#39;prop_type=</span><span class="si">%r</span><span class="s1"> pname/fid=</span><span class="si">%s</span><span class="s1"> is not supported&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">prop_type</span><span class="p">,</span> <span class="n">var_to_change</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>  <span class="c1"># pragma: no cover</span>
            <span class="n">msg</span> <span class="o">=</span> <span class="s1">&#39;prop_type=</span><span class="si">%r</span><span class="s1"> pname/fid=</span><span class="si">%r</span><span class="s1"> is not supported&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">prop_type</span><span class="p">,</span> <span class="n">var_to_change</span><span class="p">)</span>

    <span class="k">elif</span> <span class="n">prop_type</span> <span class="o">==</span> <span class="s1">&#39;PBARL&#39;</span><span class="p">:</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">var_to_change</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>
            <span class="n">msg</span> <span class="o">=</span> <span class="s1">&#39;prop_type=</span><span class="si">%r</span><span class="s1"> pname/fid=</span><span class="si">%s</span><span class="s1"> is not supported&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">prop_type</span><span class="p">,</span> <span class="n">var_to_change</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">var_to_change</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;DIM&#39;</span><span class="p">):</span>
            <span class="k">pass</span>
        <span class="k">else</span><span class="p">:</span>  <span class="c1"># pragma: no cover</span>
            <span class="n">msg</span> <span class="o">=</span> <span class="s1">&#39;prop_type=</span><span class="si">%r</span><span class="s1"> pname/fid=</span><span class="si">%s</span><span class="s1"> is not supported&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">prop_type</span><span class="p">,</span> <span class="n">var_to_change</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">prop</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">var_to_change</span> <span class="o">=</span> <span class="s1">&#39;??? </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">var_to_change</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">var_to_change</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">%s</span><span class="s1"> </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">prop</span><span class="o">.</span><span class="n">Type</span><span class="p">,</span> <span class="n">var_to_change</span><span class="p">)</span>

    <span class="k">elif</span> <span class="n">prop_type</span> <span class="o">==</span> <span class="s1">&#39;PBEAML&#39;</span><span class="p">:</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">var_to_change</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>
            <span class="n">msg</span> <span class="o">=</span> <span class="s1">&#39;prop_type=</span><span class="si">%r</span><span class="s1"> pname/fid=</span><span class="si">%s</span><span class="s1"> is not supported&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">prop_type</span><span class="p">,</span> <span class="n">var_to_change</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">var_to_change</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;NSM&#39;</span><span class="p">]:</span>
            <span class="k">pass</span>
        <span class="k">elif</span> <span class="n">var_to_change</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;DIM&#39;</span><span class="p">):</span>
            <span class="k">pass</span>
        <span class="k">else</span><span class="p">:</span>  <span class="c1"># pragma: no cover</span>
            <span class="n">msg</span> <span class="o">=</span> <span class="s1">&#39;prop_type=</span><span class="si">%r</span><span class="s1"> pname/fid=</span><span class="si">%s</span><span class="s1"> is not supported&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">prop_type</span><span class="p">,</span> <span class="n">var_to_change</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">prop</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">var_to_change</span> <span class="o">=</span> <span class="s1">&#39;??? </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">var_to_change</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">var_to_change</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">%s</span><span class="s1"> </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">prop</span><span class="o">.</span><span class="n">Type</span><span class="p">,</span> <span class="n">var_to_change</span><span class="p">)</span>

    <span class="k">elif</span> <span class="n">prop_type</span> <span class="o">==</span> <span class="s1">&#39;PSHEAR&#39;</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">var_to_change</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;T&#39;</span><span class="p">]:</span>
            <span class="k">pass</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">var_to_change</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>  <span class="c1"># pragma: no cover</span>
            <span class="n">msg</span> <span class="o">=</span> <span class="s1">&#39;prop_type=</span><span class="si">%r</span><span class="s1"> pname/fid=</span><span class="si">%s</span><span class="s1"> is not supported&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">prop_type</span><span class="p">,</span> <span class="n">var_to_change</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>  <span class="c1"># pragma: no cover</span>
            <span class="n">msg</span> <span class="o">=</span> <span class="s1">&#39;prop_type=</span><span class="si">%r</span><span class="s1"> pname/fid=</span><span class="si">%r</span><span class="s1"> is not supported&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">prop_type</span><span class="p">,</span> <span class="n">var_to_change</span><span class="p">)</span>

    <span class="k">elif</span> <span class="n">prop_type</span> <span class="o">==</span> <span class="s1">&#39;PELAS&#39;</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">var_to_change</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;K1&#39;</span><span class="p">,</span> <span class="s1">&#39;GE1&#39;</span><span class="p">]:</span>
            <span class="k">pass</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">var_to_change</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>  <span class="c1"># pragma: no cover</span>
            <span class="n">msg</span> <span class="o">=</span> <span class="s1">&#39;prop_type=</span><span class="si">%r</span><span class="s1"> pname/fid=</span><span class="si">%s</span><span class="s1"> is not supported&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">prop_type</span><span class="p">,</span> <span class="n">var_to_change</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>  <span class="c1"># pragma: no cover</span>
            <span class="n">msg</span> <span class="o">=</span> <span class="s1">&#39;prop_type=</span><span class="si">%r</span><span class="s1"> pname/fid=</span><span class="si">%r</span><span class="s1"> is not supported&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">prop_type</span><span class="p">,</span> <span class="n">var_to_change</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">prop_type</span> <span class="o">==</span> <span class="s1">&#39;PELAST&#39;</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">var_to_change</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;TKID&#39;</span><span class="p">]:</span>
            <span class="k">pass</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">var_to_change</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>  <span class="c1"># pragma: no cover</span>
            <span class="n">msg</span> <span class="o">=</span> <span class="s1">&#39;prop_type=</span><span class="si">%r</span><span class="s1"> pname/fid=</span><span class="si">%s</span><span class="s1"> is not supported&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">prop_type</span><span class="p">,</span> <span class="n">var_to_change</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>  <span class="c1"># pragma: no cover</span>
            <span class="n">msg</span> <span class="o">=</span> <span class="s1">&#39;prop_type=</span><span class="si">%r</span><span class="s1"> pname/fid=</span><span class="si">%r</span><span class="s1"> is not supported&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">prop_type</span><span class="p">,</span> <span class="n">var_to_change</span><span class="p">)</span>

    <span class="k">elif</span> <span class="n">prop_type</span> <span class="o">==</span> <span class="s1">&#39;PDAMP&#39;</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">var_to_change</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;B1&#39;</span><span class="p">]:</span>
            <span class="k">pass</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">var_to_change</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>  <span class="c1"># pragma: no cover</span>
            <span class="n">msg</span> <span class="o">=</span> <span class="s1">&#39;prop_type=</span><span class="si">%r</span><span class="s1"> pname/fid=</span><span class="si">%s</span><span class="s1"> is not supported&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">prop_type</span><span class="p">,</span> <span class="n">var_to_change</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>  <span class="c1"># pragma: no cover</span>
            <span class="n">msg</span> <span class="o">=</span> <span class="s1">&#39;prop_type=</span><span class="si">%r</span><span class="s1"> pname/fid=</span><span class="si">%r</span><span class="s1"> is not supported&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">prop_type</span><span class="p">,</span> <span class="n">var_to_change</span><span class="p">)</span>

    <span class="k">elif</span> <span class="n">prop_type</span> <span class="o">==</span> <span class="s1">&#39;PWELD&#39;</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">var_to_change</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;D&#39;</span><span class="p">]:</span>
            <span class="k">pass</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">var_to_change</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>  <span class="c1"># pragma: no cover</span>
            <span class="n">msg</span> <span class="o">=</span> <span class="s1">&#39;prop_type=</span><span class="si">%r</span><span class="s1"> pname/fid=</span><span class="si">%s</span><span class="s1"> is not supported&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">prop_type</span><span class="p">,</span> <span class="n">var_to_change</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>  <span class="c1"># pragma: no cover</span>
            <span class="n">msg</span> <span class="o">=</span> <span class="s1">&#39;prop_type=</span><span class="si">%r</span><span class="s1"> pname/fid=</span><span class="si">%r</span><span class="s1"> is not supported&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">prop_type</span><span class="p">,</span> <span class="n">var_to_change</span><span class="p">)</span>

    <span class="k">elif</span> <span class="n">prop_type</span> <span class="o">==</span> <span class="s1">&#39;PBUSH&#39;</span><span class="p">:</span>
        <span class="n">pbush_var_map</span> <span class="o">=</span> <span class="p">{</span>
            <span class="o">-</span><span class="mi">2</span> <span class="p">:</span> <span class="s1">&#39;K1&#39;</span><span class="p">,</span> <span class="o">-</span><span class="mi">3</span> <span class="p">:</span> <span class="s1">&#39;K2&#39;</span><span class="p">,</span> <span class="o">-</span><span class="mi">4</span> <span class="p">:</span> <span class="s1">&#39;K3&#39;</span><span class="p">,</span> <span class="o">-</span><span class="mi">5</span> <span class="p">:</span> <span class="s1">&#39;K4&#39;</span><span class="p">,</span> <span class="o">-</span><span class="mi">6</span> <span class="p">:</span> <span class="s1">&#39;K5&#39;</span><span class="p">,</span> <span class="o">-</span><span class="mi">7</span> <span class="p">:</span> <span class="s1">&#39;K6&#39;</span><span class="p">,</span>
            <span class="o">-</span><span class="mi">8</span> <span class="p">:</span> <span class="s1">&#39;B1&#39;</span><span class="p">,</span> <span class="o">-</span><span class="mi">9</span> <span class="p">:</span> <span class="s1">&#39;B2&#39;</span><span class="p">,</span> <span class="o">-</span><span class="mi">10</span> <span class="p">:</span> <span class="s1">&#39;B3&#39;</span><span class="p">,</span> <span class="o">-</span><span class="mi">11</span> <span class="p">:</span> <span class="s1">&#39;B4&#39;</span><span class="p">,</span> <span class="o">-</span><span class="mi">12</span> <span class="p">:</span> <span class="s1">&#39;B5&#39;</span><span class="p">,</span> <span class="o">-</span><span class="mi">13</span> <span class="p">:</span> <span class="s1">&#39;B6&#39;</span><span class="p">,</span>
            <span class="o">-</span><span class="mi">14</span> <span class="p">:</span> <span class="s1">&#39;GE1&#39;</span><span class="p">,</span> <span class="o">-</span><span class="mi">15</span> <span class="p">:</span> <span class="s1">&#39;GE2&#39;</span><span class="p">,</span> <span class="o">-</span><span class="mi">16</span> <span class="p">:</span> <span class="s1">&#39;GE3&#39;</span><span class="p">,</span> <span class="o">-</span><span class="mi">17</span> <span class="p">:</span> <span class="s1">&#39;GE4&#39;</span><span class="p">,</span> <span class="o">-</span><span class="mi">18</span> <span class="p">:</span> <span class="s1">&#39;GE5&#39;</span><span class="p">,</span> <span class="o">-</span><span class="mi">19</span> <span class="p">:</span> <span class="s1">&#39;GE6&#39;</span><span class="p">,</span>
            <span class="o">-</span><span class="mi">20</span> <span class="p">:</span> <span class="s1">&#39;SA&#39;</span><span class="p">,</span> <span class="o">-</span><span class="mi">21</span> <span class="p">:</span> <span class="s1">&#39;ST&#39;</span><span class="p">,</span> <span class="o">-</span><span class="mi">22</span> <span class="p">:</span> <span class="s1">&#39;EA&#39;</span><span class="p">,</span> <span class="o">-</span><span class="mi">23</span> <span class="p">:</span> <span class="s1">&#39;ET&#39;</span><span class="p">,</span>
        <span class="p">}</span>
        <span class="c1">#data_in = (pid, k1, k2, k3, k4, k5, k6, b1, b2, b3, b4, b5, b6,</span>
                   <span class="c1">#g1, g2, g3, g4, g5, g6, sa, st, ea, et)</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">var_to_change</span><span class="p">,</span> <span class="nb">int</span><span class="p">)</span> <span class="ow">and</span> <span class="n">var_to_change</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span> <span class="c1"># and (var_to_change &lt;= -23 &lt;= var_to_change &lt; 1):</span>
            <span class="n">var_to_change</span> <span class="o">=</span> <span class="n">pbush_var_map</span><span class="p">[</span><span class="n">var_to_change</span><span class="p">]</span>
        <span class="k">elif</span> <span class="n">var_to_change</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;K1&#39;</span><span class="p">,</span> <span class="s1">&#39;K2&#39;</span><span class="p">,</span> <span class="s1">&#39;K3&#39;</span><span class="p">,</span> <span class="s1">&#39;K4&#39;</span><span class="p">,</span> <span class="s1">&#39;K5&#39;</span><span class="p">,</span> <span class="s1">&#39;K6&#39;</span><span class="p">,</span>
                               <span class="s1">&#39;B1&#39;</span><span class="p">,</span> <span class="s1">&#39;B2&#39;</span><span class="p">,</span> <span class="s1">&#39;B3&#39;</span><span class="p">,</span> <span class="s1">&#39;B4&#39;</span><span class="p">,</span> <span class="s1">&#39;B5&#39;</span><span class="p">,</span> <span class="s1">&#39;B6&#39;</span><span class="p">,</span>
                               <span class="s1">&#39;M1&#39;</span><span class="p">,</span> <span class="s1">&#39;M2&#39;</span><span class="p">,</span> <span class="s1">&#39;M3&#39;</span><span class="p">,</span> <span class="s1">&#39;M4&#39;</span><span class="p">,</span> <span class="s1">&#39;M5&#39;</span><span class="p">,</span> <span class="s1">&#39;M6&#39;</span><span class="p">,</span>
                               <span class="s1">&#39;GE1&#39;</span><span class="p">,</span> <span class="s1">&#39;GE3&#39;</span><span class="p">,</span> <span class="s1">&#39;GE4&#39;</span><span class="p">,</span> <span class="s1">&#39;GE5&#39;</span><span class="p">,</span> <span class="s1">&#39;GE6&#39;</span><span class="p">,]:</span>
            <span class="k">pass</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">var_to_change</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>  <span class="c1"># pragma: no cover</span>
            <span class="n">msg</span> <span class="o">=</span> <span class="s1">&#39;prop_type=</span><span class="si">%r</span><span class="s1"> pname/fid=</span><span class="si">%s</span><span class="s1"> is not supported&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">prop_type</span><span class="p">,</span> <span class="n">var_to_change</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>  <span class="c1"># pragma: no cover</span>
            <span class="n">msg</span> <span class="o">=</span> <span class="s1">&#39;prop_type=</span><span class="si">%r</span><span class="s1"> pname/fid=</span><span class="si">%r</span><span class="s1"> is not supported&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">prop_type</span><span class="p">,</span> <span class="n">var_to_change</span><span class="p">)</span>

    <span class="k">elif</span> <span class="n">prop_type</span> <span class="o">==</span> <span class="s1">&#39;PBUSH1D&#39;</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">var_to_change</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;K&#39;</span><span class="p">,</span> <span class="s1">&#39;C&#39;</span><span class="p">,</span> <span class="s1">&#39;M&#39;</span><span class="p">]:</span>
            <span class="k">pass</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">var_to_change</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>  <span class="c1"># pragma: no cover</span>
            <span class="n">msg</span> <span class="o">=</span> <span class="s1">&#39;prop_type=</span><span class="si">%r</span><span class="s1"> pname/fid=</span><span class="si">%s</span><span class="s1"> is not supported&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">prop_type</span><span class="p">,</span> <span class="n">var_to_change</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>  <span class="c1"># pragma: no cover</span>
            <span class="n">msg</span> <span class="o">=</span> <span class="s1">&#39;prop_type=</span><span class="si">%r</span><span class="s1"> pname/fid=</span><span class="si">%r</span><span class="s1"> is not supported&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">prop_type</span><span class="p">,</span> <span class="n">var_to_change</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">prop_type</span> <span class="o">==</span> <span class="s1">&#39;PBUSHT&#39;</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">var_to_change</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;TGEID1&#39;</span><span class="p">,</span> <span class="s1">&#39;TGEID2&#39;</span><span class="p">]:</span>
            <span class="k">pass</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">var_to_change</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>  <span class="c1"># pragma: no cover</span>
            <span class="n">msg</span> <span class="o">=</span> <span class="s1">&#39;prop_type=</span><span class="si">%r</span><span class="s1"> pname/fid=</span><span class="si">%s</span><span class="s1"> is not supported&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">prop_type</span><span class="p">,</span> <span class="n">var_to_change</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>  <span class="c1"># pragma: no cover</span>
            <span class="n">msg</span> <span class="o">=</span> <span class="s1">&#39;prop_type=</span><span class="si">%r</span><span class="s1"> pname/fid=</span><span class="si">%r</span><span class="s1"> is not supported&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">prop_type</span><span class="p">,</span> <span class="n">var_to_change</span><span class="p">)</span>

    <span class="k">elif</span> <span class="n">prop_type</span> <span class="o">==</span> <span class="s1">&#39;PGAP&#39;</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">var_to_change</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;KA&#39;</span><span class="p">,]:</span>
            <span class="k">pass</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">var_to_change</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>  <span class="c1"># pragma: no cover</span>
            <span class="n">msg</span> <span class="o">=</span> <span class="s1">&#39;prop_type=</span><span class="si">%r</span><span class="s1"> pname/fid=</span><span class="si">%s</span><span class="s1"> is not supported&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">prop_type</span><span class="p">,</span> <span class="n">var_to_change</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>  <span class="c1"># pragma: no cover</span>
            <span class="n">msg</span> <span class="o">=</span> <span class="s1">&#39;prop_type=</span><span class="si">%r</span><span class="s1"> pname/fid=</span><span class="si">%r</span><span class="s1"> is not supported&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">prop_type</span><span class="p">,</span> <span class="n">var_to_change</span><span class="p">)</span>

    <span class="k">elif</span> <span class="n">prop_type</span> <span class="o">==</span> <span class="s1">&#39;PVISC&#39;</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">var_to_change</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;CE1&#39;</span><span class="p">]:</span>
            <span class="k">pass</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">var_to_change</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>  <span class="c1"># pragma: no cover</span>
            <span class="n">msg</span> <span class="o">=</span> <span class="s1">&#39;prop_type=</span><span class="si">%r</span><span class="s1"> pname/fid=</span><span class="si">%s</span><span class="s1"> is not supported&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">prop_type</span><span class="p">,</span> <span class="n">var_to_change</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>  <span class="c1"># pragma: no cover</span>
            <span class="n">msg</span> <span class="o">=</span> <span class="s1">&#39;prop_type=</span><span class="si">%r</span><span class="s1"> pname/fid=</span><span class="si">%r</span><span class="s1"> is not supported&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">prop_type</span><span class="p">,</span> <span class="n">var_to_change</span><span class="p">)</span>

    <span class="k">elif</span> <span class="n">prop_type</span> <span class="o">==</span> <span class="s1">&#39;PFAST&#39;</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">var_to_change</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;KT1&#39;</span><span class="p">,</span> <span class="s1">&#39;KT2&#39;</span><span class="p">,</span> <span class="s1">&#39;KT3&#39;</span><span class="p">,</span> <span class="s1">&#39;KR1&#39;</span><span class="p">,</span> <span class="s1">&#39;KR2&#39;</span><span class="p">,</span> <span class="s1">&#39;KR3&#39;</span><span class="p">,</span> <span class="s1">&#39;MASS&#39;</span><span class="p">]:</span>
            <span class="k">pass</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">var_to_change</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>  <span class="c1"># pragma: no cover</span>
            <span class="n">msg</span> <span class="o">=</span> <span class="s1">&#39;prop_type=</span><span class="si">%r</span><span class="s1"> pname/fid=</span><span class="si">%s</span><span class="s1"> is not supported&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">prop_type</span><span class="p">,</span> <span class="n">var_to_change</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>  <span class="c1"># pragma: no cover</span>
            <span class="n">msg</span> <span class="o">=</span> <span class="s1">&#39;prop_type=</span><span class="si">%r</span><span class="s1"> pname/fid=</span><span class="si">%r</span><span class="s1"> is not supported&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">prop_type</span><span class="p">,</span> <span class="n">var_to_change</span><span class="p">)</span>

    <span class="k">elif</span> <span class="n">prop_type</span> <span class="o">==</span> <span class="s1">&#39;PMASS&#39;</span><span class="p">:</span> <span class="c1"># 3</span>
        <span class="k">if</span> <span class="n">var_to_change</span> <span class="o">==</span> <span class="mi">3</span><span class="p">:</span>
            <span class="n">var_to_change</span> <span class="o">=</span> <span class="s1">&#39;M1&#39;</span>

        <span class="k">if</span> <span class="n">var_to_change</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;M1&#39;</span><span class="p">]:</span>
            <span class="k">pass</span>
        <span class="c1">#elif isinstance(var_to_change, int):  # pragma: no cover</span>
            <span class="c1">#msg = &#39;prop_type=%r pname/fid=%s is not supported&#39; % (prop_type, var_to_change)</span>
        <span class="k">else</span><span class="p">:</span>  <span class="c1"># pragma: no cover</span>
            <span class="n">msg</span> <span class="o">=</span> <span class="s1">&#39;prop_type=</span><span class="si">%r</span><span class="s1"> pname/fid=</span><span class="si">%r</span><span class="s1"> is not supported&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">prop_type</span><span class="p">,</span> <span class="n">var_to_change</span><span class="p">)</span>

    <span class="k">elif</span> <span class="n">prop_type</span> <span class="o">==</span> <span class="s1">&#39;PBRSECT&#39;</span><span class="p">:</span> <span class="c1"># 3</span>
        <span class="k">if</span> <span class="n">var_to_change</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;T&#39;</span><span class="p">,</span> <span class="s1">&#39;W&#39;</span><span class="p">,</span> <span class="s1">&#39;H&#39;</span><span class="p">]:</span>
            <span class="k">pass</span>
        <span class="k">else</span><span class="p">:</span>  <span class="c1"># pragma: no cover</span>
            <span class="n">msg</span> <span class="o">=</span> <span class="s1">&#39;prop_type=</span><span class="si">%r</span><span class="s1"> pname/fid=</span><span class="si">%r</span><span class="s1"> is not supported&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">prop_type</span><span class="p">,</span> <span class="n">var_to_change</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">prop_type</span> <span class="o">==</span> <span class="s1">&#39;PBMSECT&#39;</span><span class="p">:</span> <span class="c1"># 3</span>
        <span class="k">if</span> <span class="n">var_to_change</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;T&#39;</span><span class="p">,</span> <span class="s1">&#39;W&#39;</span><span class="p">,</span> <span class="s1">&#39;H&#39;</span><span class="p">]:</span>
            <span class="k">pass</span>
        <span class="k">elif</span> <span class="n">var_to_change</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;T(&#39;</span><span class="p">)</span> <span class="ow">and</span> <span class="n">var_to_change</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s1">&#39;)&#39;</span><span class="p">):</span> <span class="c1">#  T(2)</span>
            <span class="k">pass</span>
        <span class="k">else</span><span class="p">:</span>  <span class="c1"># pragma: no cover</span>
            <span class="n">msg</span> <span class="o">=</span> <span class="s1">&#39;prop_type=</span><span class="si">%r</span><span class="s1"> pname/fid=</span><span class="si">%r</span><span class="s1"> is not supported&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">prop_type</span><span class="p">,</span> <span class="n">var_to_change</span><span class="p">)</span>

    <span class="k">else</span><span class="p">:</span>  <span class="c1"># pragma: no cover</span>
        <span class="n">msg</span> <span class="o">=</span> <span class="s1">&#39;prop_type=</span><span class="si">%r</span><span class="s1"> pname/fid=</span><span class="si">%s</span><span class="s1"> is not supported&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">prop_type</span><span class="p">,</span> <span class="n">var_to_change</span><span class="p">)</span>
    <span class="n">key</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">%s</span><span class="s1"> </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">prop_type</span><span class="p">,</span> <span class="n">var_to_change</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">key</span><span class="p">,</span> <span class="n">msg</span></div>

<div class="viewcode-block" id="_export_dresps_to_hdf5"><a class="viewcode-back" href="../../../../reference/bdf/cards/pyNastran.bdf.cards.optimization.html#pyNastran.bdf.cards.optimization._export_dresps_to_hdf5">[docs]</a><span class="k">def</span> <span class="nf">_export_dresps_to_hdf5</span><span class="p">(</span><span class="n">h5_file</span><span class="p">,</span> <span class="n">model</span><span class="p">,</span> <span class="n">encoding</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;exports dresps&quot;&quot;&quot;</span>
    <span class="n">dresp1s</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">dresp2s</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">dresp3s</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">dresp</span> <span class="ow">in</span> <span class="n">model</span><span class="o">.</span><span class="n">dresps</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="c1"># key : int</span>
        <span class="k">if</span> <span class="n">dresp</span><span class="o">.</span><span class="n">type</span> <span class="o">==</span> <span class="s1">&#39;DRESP1&#39;</span><span class="p">:</span>
            <span class="n">dresp1s</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">dresp</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">dresp</span><span class="o">.</span><span class="n">type</span> <span class="o">==</span> <span class="s1">&#39;DRESP2&#39;</span><span class="p">:</span>
            <span class="n">dresp2s</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">dresp</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">dresp</span><span class="o">.</span><span class="n">type</span> <span class="o">==</span> <span class="s1">&#39;DRESP3&#39;</span><span class="p">:</span>
            <span class="n">dresp3s</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">dresp</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">dresp</span><span class="o">.</span><span class="n">get_stats</span><span class="p">())</span>
            <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="n">dresp</span><span class="o">.</span><span class="n">type</span><span class="p">)</span>

    <span class="n">ndresp1s</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">dresp1s</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">ndresp1s</span><span class="p">:</span>
        <span class="n">dresp_group</span> <span class="o">=</span> <span class="n">h5_file</span><span class="o">.</span><span class="n">create_group</span><span class="p">(</span><span class="s1">&#39;DRESP1&#39;</span><span class="p">)</span>

        <span class="n">dresp_id</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">atta</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">attb</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">label</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">region</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">response_type</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">property_type</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">dresp</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">dresp1s</span><span class="p">):</span>
            <span class="c1">#print(dresp.get_stats())</span>
            <span class="n">dresp_id</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">dresp</span><span class="o">.</span><span class="n">dresp_id</span><span class="p">)</span>

            <span class="c1"># super hackish, we&#39;ll just write everything as a string</span>
            <span class="k">if</span> <span class="n">dresp</span><span class="o">.</span><span class="n">atta</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">attai</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
            <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">dresp</span><span class="o">.</span><span class="n">atta</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>
                <span class="n">attai</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">dresp</span><span class="o">.</span><span class="n">atta</span><span class="p">)</span>
            <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">dresp</span><span class="o">.</span><span class="n">atta</span><span class="p">,</span> <span class="nb">float</span><span class="p">):</span>
                <span class="n">attai</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">%.12e</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">dresp</span><span class="o">.</span><span class="n">atta</span>
            <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">dresp</span><span class="o">.</span><span class="n">atta</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
                <span class="n">attai</span> <span class="o">=</span> <span class="n">dresp</span><span class="o">.</span><span class="n">atta</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">dresp</span><span class="o">.</span><span class="n">atta</span><span class="p">))</span>
            <span class="n">atta</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">attai</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="n">encoding</span><span class="p">))</span>  <span class="c1"># int, float, str, blank</span>

            <span class="c1"># super hackish, we&#39;ll just write everything as a string</span>
            <span class="k">if</span> <span class="n">dresp</span><span class="o">.</span><span class="n">attb</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">attbi</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
            <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">dresp</span><span class="o">.</span><span class="n">attb</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>
                <span class="n">attbi</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">dresp</span><span class="o">.</span><span class="n">attb</span><span class="p">)</span>
            <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">dresp</span><span class="o">.</span><span class="n">attb</span><span class="p">,</span> <span class="nb">float</span><span class="p">):</span>
                <span class="n">attbi</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">%.12e</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">dresp</span><span class="o">.</span><span class="n">attb</span>
            <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">dresp</span><span class="o">.</span><span class="n">attb</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
                <span class="n">attbi</span> <span class="o">=</span> <span class="n">dresp</span><span class="o">.</span><span class="n">attb</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">dresp</span><span class="o">.</span><span class="n">attb</span><span class="p">))</span>
            <span class="n">attb</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">attbi</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="n">encoding</span><span class="p">))</span>  <span class="c1"># int, float, str, blank</span>


            <span class="n">label</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">dresp</span><span class="o">.</span><span class="n">label</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="n">encoding</span><span class="p">))</span>
            <span class="n">response_type</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">dresp</span><span class="o">.</span><span class="n">response_type</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="n">encoding</span><span class="p">))</span>

            <span class="k">if</span> <span class="n">dresp</span><span class="o">.</span><span class="n">region</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">region</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">region</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">dresp</span><span class="o">.</span><span class="n">region</span><span class="p">)</span>
                <span class="c1">#region.append(dresp.region.encode(encoding))</span>

            <span class="c1">#print(&#39;property_type&#39;, dresp.property_type)</span>
            <span class="k">if</span> <span class="n">dresp</span><span class="o">.</span><span class="n">property_type</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">property_typei</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
            <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">dresp</span><span class="o">.</span><span class="n">atta</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>
                <span class="n">property_typei</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">dresp</span><span class="o">.</span><span class="n">property_type</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">property_typei</span> <span class="o">=</span> <span class="n">dresp</span><span class="o">.</span><span class="n">property_type</span>
            <span class="n">property_type</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">property_typei</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="n">encoding</span><span class="p">))</span>

            <span class="c1">#atta   : 1</span>
            <span class="c1">#attb   : None</span>
            <span class="c1">#atti   : [2]</span>
            <span class="c1">#dresp_id : 10</span>
            <span class="c1">#label  : &#39;DISPL&#39;</span>
            <span class="c1">#property_type : None</span>
            <span class="c1">#region : None</span>
            <span class="c1">#response_type : &#39;DISP&#39;</span>
            <span class="n">dresp_groupi</span> <span class="o">=</span> <span class="n">dresp_group</span><span class="o">.</span><span class="n">create_group</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">))</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">dresp</span><span class="o">.</span><span class="n">atti</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">dresp</span><span class="o">.</span><span class="n">atti</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="nb">str</span><span class="p">):</span> <span class="c1"># ALL</span>
                    <span class="c1">#model.log.debug(&#39;str atti = %s&#39; % dresp.atti)</span>
                    <span class="n">values_bytes</span> <span class="o">=</span> <span class="p">[</span>
                        <span class="n">attii</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="n">encoding</span><span class="p">)</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">attii</span><span class="p">,</span> <span class="nb">str</span><span class="p">)</span> <span class="k">else</span> <span class="n">attii</span>
                        <span class="k">for</span> <span class="n">attii</span> <span class="ow">in</span> <span class="n">dresp</span><span class="o">.</span><span class="n">atti</span><span class="p">]</span>
                    <span class="n">dresp_groupi</span><span class="o">.</span><span class="n">create_dataset</span><span class="p">(</span><span class="s1">&#39;atti&#39;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">values_bytes</span><span class="p">)</span>  <span class="c1"># int</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="c1">#model.log.debug(&#39;atti = %s&#39; % dresp.atti)</span>
                    <span class="n">dresp_groupi</span><span class="o">.</span><span class="n">create_dataset</span><span class="p">(</span><span class="s1">&#39;atti&#39;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">dresp</span><span class="o">.</span><span class="n">atti</span><span class="p">)</span>  <span class="c1"># int</span>

        <span class="n">dresp_group</span><span class="o">.</span><span class="n">create_dataset</span><span class="p">(</span><span class="s1">&#39;dresp_id&#39;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">dresp_id</span><span class="p">)</span>
        <span class="n">dresp_group</span><span class="o">.</span><span class="n">create_dataset</span><span class="p">(</span><span class="s1">&#39;atta&#39;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">atta</span><span class="p">)</span>
        <span class="n">dresp_group</span><span class="o">.</span><span class="n">create_dataset</span><span class="p">(</span><span class="s1">&#39;attb&#39;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">attb</span><span class="p">)</span>
        <span class="n">dresp_group</span><span class="o">.</span><span class="n">create_dataset</span><span class="p">(</span><span class="s1">&#39;label&#39;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">label</span><span class="p">)</span>
        <span class="n">dresp_group</span><span class="o">.</span><span class="n">create_dataset</span><span class="p">(</span><span class="s1">&#39;region&#39;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">region</span><span class="p">)</span>
        <span class="n">dresp_group</span><span class="o">.</span><span class="n">create_dataset</span><span class="p">(</span><span class="s1">&#39;response_type&#39;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">response_type</span><span class="p">)</span>
        <span class="n">dresp_group</span><span class="o">.</span><span class="n">create_dataset</span><span class="p">(</span><span class="s1">&#39;property_type&#39;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">property_type</span><span class="p">)</span>

    <span class="n">ndresp2s</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">dresp2s</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">ndresp2s</span><span class="p">:</span>
        <span class="c1">#c1     : 1.0</span>
        <span class="c1">#c2     : 0.005</span>
        <span class="c1">#c3     : 10.0</span>
        <span class="c1">#comment : u&#39;&#39;</span>
        <span class="c1">#dequation : 1</span>
        <span class="c1">#dequation_str : None</span>
        <span class="c1">#dresp_id : 1</span>
        <span class="c1">#label  : &#39;VOLUME&#39;</span>
        <span class="c1">#method : u&#39;MIN&#39;</span>
        <span class="c1">#params : {(0, u&#39;DESVAR&#39;): [1, 2, 3]}</span>
        <span class="c1">#region : None</span>
        <span class="n">c123</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">full</span><span class="p">((</span><span class="n">ndresp2s</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">)</span>
        <span class="n">dresp_id</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">full</span><span class="p">(</span><span class="n">ndresp2s</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="s1">&#39;int32&#39;</span><span class="p">)</span>
        <span class="n">dequation</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">full</span><span class="p">(</span><span class="n">ndresp2s</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="s1">&#39;int32&#39;</span><span class="p">)</span>
        <span class="n">func</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">dequation_str</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">label</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">method</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">region</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="n">dresp_group</span> <span class="o">=</span> <span class="n">h5_file</span><span class="o">.</span><span class="n">create_group</span><span class="p">(</span><span class="s1">&#39;DRESP2&#39;</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">dresp</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">dresp2s</span><span class="p">):</span>
            <span class="c1">#model.log.debug(&#39;\n&#39; + dresp.get_stats())</span>

            <span class="c1"># DRESP2 params: {(0, u&#39;DRESP1&#39;): [1], (0, u&#39;DTABLE&#39;): [u&#39;L1&#39;], (0, u&#39;DESVAR&#39;): [1]}</span>
            <span class="c1"># DRESP2 params: {(0, &#39;DRESP1&#39;): [10501, 10502, 10503]}</span>

            <span class="n">param_keys</span> <span class="o">=</span> <span class="p">[</span><span class="kc">None</span><span class="p">]</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">dresp</span><span class="o">.</span><span class="n">params</span><span class="p">)</span>
            <span class="c1">#print(dresp_group)</span>

            <span class="c1">#model.log.debug(&#39;  DRESP2 params %s %s&#39; % (i, dresp.params))</span>
            <span class="c1">#print(&#39;i = %i&#39; % i)</span>
            <span class="n">dresp_groupi</span> <span class="o">=</span> <span class="n">dresp_group</span><span class="o">.</span><span class="n">create_group</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">))</span>
            <span class="k">for</span> <span class="p">(</span><span class="n">j</span><span class="p">,</span> <span class="n">param_key</span><span class="p">),</span> <span class="n">values</span> <span class="ow">in</span> <span class="n">dresp</span><span class="o">.</span><span class="n">params</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="n">param_keys</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">param_key</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="n">encoding</span><span class="p">)</span>
                <span class="k">except</span> <span class="ne">IndexError</span><span class="p">:</span>
                    <span class="nb">print</span><span class="p">(</span><span class="n">dresp</span><span class="o">.</span><span class="n">get_stats</span><span class="p">())</span>
                    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;  DRESP2&#39;</span><span class="p">,</span> <span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">),</span> <span class="n">param_key</span><span class="p">,</span> <span class="n">values</span><span class="p">)</span>
                    <span class="k">raise</span>
                <span class="n">dresp_groupj</span> <span class="o">=</span> <span class="n">dresp_groupi</span><span class="o">.</span><span class="n">create_group</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">j</span><span class="p">))</span>
                <span class="n">values2</span> <span class="o">=</span> <span class="p">[</span><span class="n">val</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="n">encoding</span><span class="p">)</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">val</span><span class="p">,</span> <span class="nb">str</span><span class="p">)</span> <span class="k">else</span> <span class="n">val</span>
                           <span class="k">for</span> <span class="n">val</span> <span class="ow">in</span> <span class="n">values</span><span class="p">]</span>
                <span class="n">dresp_groupj</span><span class="o">.</span><span class="n">create_dataset</span><span class="p">(</span><span class="s1">&#39;values&#39;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">values2</span><span class="p">)</span>
            <span class="n">dresp_groupi</span><span class="o">.</span><span class="n">create_dataset</span><span class="p">(</span><span class="s1">&#39;param_keys&#39;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">param_keys</span><span class="p">)</span>
            <span class="c1">#print(&#39;param_keys =&#39;, param_keys)</span>
            <span class="c1">#print(&#39;keys&#39;, list(dresp_group.keys()))</span>

            <span class="n">dresp_id</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">dresp</span><span class="o">.</span><span class="n">dresp_id</span>
            <span class="n">c123</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="p">:]</span> <span class="o">=</span> <span class="p">[</span><span class="n">dresp</span><span class="o">.</span><span class="n">c1</span><span class="p">,</span> <span class="n">dresp</span><span class="o">.</span><span class="n">c2</span><span class="p">,</span> <span class="n">dresp</span><span class="o">.</span><span class="n">c3</span><span class="p">]</span>
            <span class="n">method</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">dresp</span><span class="o">.</span><span class="n">method</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="n">encoding</span><span class="p">))</span>
            <span class="n">label</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">dresp</span><span class="o">.</span><span class="n">label</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="n">encoding</span><span class="p">))</span>

            <span class="k">if</span> <span class="n">dresp</span><span class="o">.</span><span class="n">region</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">region</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">region</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">dresp</span><span class="o">.</span><span class="n">region</span><span class="p">)</span>
                <span class="c1">#region.append(dresp.region.encode(encoding))</span>

            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">dresp</span><span class="o">.</span><span class="n">dequation</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>
                <span class="n">dequation</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">dresp</span><span class="o">.</span><span class="n">dequation</span>
                <span class="n">func</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">b</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">func</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">dresp</span><span class="o">.</span><span class="n">dequation</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="n">encoding</span><span class="p">))</span>

            <span class="k">assert</span> <span class="n">dresp</span><span class="o">.</span><span class="n">dequation_str</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">,</span> <span class="n">dresp</span><span class="o">.</span><span class="n">get_stats</span><span class="p">()</span>
            <span class="k">if</span> <span class="n">dresp</span><span class="o">.</span><span class="n">dequation_str</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">dequation_str</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">b</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">dequation_str</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">dresp</span><span class="o">.</span><span class="n">dequation_str</span><span class="p">)</span>

            <span class="c1">#dresp_id[i] = dresp.dresp_id</span>
            <span class="c1">#dresp_id[i] = dresp.dresp_id</span>

        <span class="n">dresp_group</span><span class="o">.</span><span class="n">create_dataset</span><span class="p">(</span><span class="s1">&#39;dresp_id&#39;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">dresp_id</span><span class="p">)</span>
        <span class="n">dresp_group</span><span class="o">.</span><span class="n">create_dataset</span><span class="p">(</span><span class="s1">&#39;c123&#39;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">c123</span><span class="p">)</span>
        <span class="n">dresp_group</span><span class="o">.</span><span class="n">create_dataset</span><span class="p">(</span><span class="s1">&#39;dequation&#39;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">dequation</span><span class="p">)</span>
        <span class="n">dresp_group</span><span class="o">.</span><span class="n">create_dataset</span><span class="p">(</span><span class="s1">&#39;func&#39;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">func</span><span class="p">)</span>
        <span class="n">dresp_group</span><span class="o">.</span><span class="n">create_dataset</span><span class="p">(</span><span class="s1">&#39;dequation_str&#39;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">dequation_str</span><span class="p">)</span>
        <span class="n">dresp_group</span><span class="o">.</span><span class="n">create_dataset</span><span class="p">(</span><span class="s1">&#39;label&#39;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">label</span><span class="p">)</span>
        <span class="n">dresp_group</span><span class="o">.</span><span class="n">create_dataset</span><span class="p">(</span><span class="s1">&#39;method&#39;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">method</span><span class="p">)</span>
        <span class="n">dresp_group</span><span class="o">.</span><span class="n">create_dataset</span><span class="p">(</span><span class="s1">&#39;region&#39;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">region</span><span class="p">)</span>

    <span class="n">ndresp3s</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">dresp3s</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">ndresp3s</span><span class="p">:</span>
        <span class="n">model</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s1">&#39;skipping DRESP3&#39;</span><span class="p">)</span></div>

<div class="viewcode-block" id="none_max"><a class="viewcode-back" href="../../../../reference/bdf/cards/pyNastran.bdf.cards.optimization.html#pyNastran.bdf.cards.optimization.none_max">[docs]</a><span class="k">def</span> <span class="nf">none_max</span><span class="p">(</span><span class="n">lower_bound</span><span class="p">,</span> <span class="n">xlb</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;helper method for DVPREL1&quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">lower_bound</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">xlb</span>
    <span class="k">return</span> <span class="nb">max</span><span class="p">(</span><span class="n">lower_bound</span><span class="p">,</span> <span class="n">xlb</span><span class="p">)</span></div>

<div class="viewcode-block" id="none_min"><a class="viewcode-back" href="../../../../reference/bdf/cards/pyNastran.bdf.cards.optimization.html#pyNastran.bdf.cards.optimization.none_min">[docs]</a><span class="k">def</span> <span class="nf">none_min</span><span class="p">(</span><span class="n">upper_bound</span><span class="p">,</span> <span class="n">xub</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;helper method for DVPREL1&quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">upper_bound</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">xub</span>
    <span class="k">return</span> <span class="nb">min</span><span class="p">(</span><span class="n">upper_bound</span><span class="p">,</span> <span class="n">xub</span><span class="p">)</span></div>
</pre></div>

           </div>
           
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>
        &#169; Copyright 2021, Steven Doyle.

    </p>
  </div>
    
    
    
    Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>
        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>