

<!DOCTYPE html>
<html class="writer-html4" lang="en" >
<head>
  <meta charset="utf-8" />
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
  <title>pyNastran.bdf.cards.dmig &mdash; pyNastran 1.4-dev 1.4-dev documentation</title>
  

  
  <link rel="stylesheet" href="../../../../_static/css/my_theme.css" type="text/css" />
  <link rel="stylesheet" href="../../../../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../../../../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../../../../_static/css/my_theme.css" type="text/css" />
  <link rel="stylesheet" href="../../../../_static/graphviz.css" type="text/css" />

  
  

  
  

  

  
  <!--[if lt IE 9]>
    <script src="../../../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../../../" src="../../../../_static/documentation_options.js"></script>
        <script data-url_root="../../../../" id="documentation_options" src="../../../../_static/documentation_options.js"></script>
        <script src="../../../../_static/jquery.js"></script>
        <script src="../../../../_static/underscore.js"></script>
        <script src="../../../../_static/doctools.js"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    
    <script type="text/javascript" src="../../../../_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="../../../../genindex.html" />
    <link rel="search" title="Search" href="../../../../search.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../../../../index.html" class="icon icon-home"> pyNastran 1.4-dev
          

          
            
            <img src="../../../../_static/logo.png" class="logo" alt="Logo"/>
          
          </a>

          
            
            
              <div class="version">
                1.4-dev
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul>
<li class="toctree-l1"><a class="reference internal" href="../../../../installation/index.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../quick_start/index.html">Quick Start</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../how_to/index.html">How To: pyNastran</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../reference/pyNastran.html">pyNastran Package</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../manual/index.html">pyNastran Manual</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../../index.html">pyNastran 1.4-dev</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          

















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../../../index.html" class="icon icon-home"></a> &raquo;</li>
        
          <li><a href="../../../index.html">Module code</a> &raquo;</li>
        
      <li>pyNastran.bdf.cards.dmig</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <h1>Source code for pyNastran.bdf.cards.dmig</h1><div class="highlight"><pre>
<span></span><span class="c1"># pylint: disable=R0902,R0904,R0914</span>
<span class="kn">from</span> <span class="nn">math</span> <span class="kn">import</span> <span class="n">sin</span><span class="p">,</span> <span class="n">cos</span><span class="p">,</span> <span class="n">radians</span><span class="p">,</span> <span class="n">atan2</span><span class="p">,</span> <span class="n">sqrt</span><span class="p">,</span> <span class="n">degrees</span>
<span class="kn">from</span> <span class="nn">itertools</span> <span class="kn">import</span> <span class="n">count</span>
<span class="kn">from</span> <span class="nn">typing</span> <span class="kn">import</span> <span class="n">Tuple</span> <span class="c1"># , TYPE_CHECKING</span>

<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">numpy</span> <span class="kn">import</span> <span class="n">array</span><span class="p">,</span> <span class="n">zeros</span>
<span class="kn">from</span> <span class="nn">scipy.sparse</span> <span class="kn">import</span> <span class="n">coo_matrix</span>  <span class="c1"># type: ignore</span>

<span class="kn">from</span> <span class="nn">pyNastran.utils.numpy_utils</span> <span class="kn">import</span> <span class="n">integer_types</span>
<span class="kn">from</span> <span class="nn">pyNastran.bdf.cards.base_card</span> <span class="kn">import</span> <span class="n">BaseCard</span>
<span class="kn">from</span> <span class="nn">pyNastran.bdf.field_writer_8</span> <span class="kn">import</span> <span class="n">print_card_8</span>
<span class="kn">from</span> <span class="nn">pyNastran.bdf.field_writer_16</span> <span class="kn">import</span> <span class="n">print_card_16</span>
<span class="kn">from</span> <span class="nn">pyNastran.bdf.field_writer_double</span> <span class="kn">import</span> <span class="n">print_card_double</span>

<span class="kn">from</span> <span class="nn">pyNastran.bdf.bdf_interface.assign_type</span> <span class="kn">import</span> <span class="p">(</span>
    <span class="n">integer</span><span class="p">,</span> <span class="n">integer_or_blank</span><span class="p">,</span> <span class="n">double</span><span class="p">,</span> <span class="n">string</span><span class="p">,</span> <span class="n">string_or_blank</span><span class="p">,</span>
    <span class="n">parse_components</span><span class="p">,</span> <span class="n">interpret_value</span><span class="p">,</span> <span class="n">integer_double_string_or_blank</span><span class="p">)</span>


<div class="viewcode-block" id="DTI"><a class="viewcode-back" href="../../../../reference/bdf/cards/pyNastran.bdf.cards.dmig.html#pyNastran.bdf.cards.dmig.DTI">[docs]</a><span class="k">class</span> <span class="nc">DTI</span><span class="p">(</span><span class="n">BaseCard</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    +-----+-------+-----+------+-------+--------+------+-------------+</span>
<span class="sd">    |  1  |   2   |  3  |   4  |   5   |    6   |   7  |       8     |</span>
<span class="sd">    +=====+=======+=====+======+=======+========+======+=============+</span>
<span class="sd">    | DTI | UNITS | &quot;1&quot; | MASS | FORCE | LENGTH | TIME |   STRESS    |</span>
<span class="sd">    +-----+-------+-----+------+-------+--------+------+-------------+</span>

<span class="sd">    MSC</span>

<span class="sd">    +-----+-------+-----+------+-------+--------+------+-------------+</span>
<span class="sd">    |  1  |   2   |  3  |   4  |   5   |    6   |   7  |       8     |</span>
<span class="sd">    +=====+=======+=====+======+=======+========+======+=============+</span>
<span class="sd">    | DTI | UNITS | &quot;1&quot; | MASS | FORCE | LENGTH | TIME | TEMPERATURE |</span>
<span class="sd">    +-----+-------+-----+------+-------+--------+------+-------------+</span>

<span class="sd">    NX</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="nb">type</span> <span class="o">=</span> <span class="s1">&#39;DTI&#39;</span>
    <span class="c1">#_properties = [&#39;shape&#39;, &#39;ifo&#39;, &#39;is_real&#39;, &#39;is_complex&#39;, &#39;is_polar&#39;, &#39;matrix_type&#39;, &#39;tin_dtype&#39;, &#39;tout_dtype&#39;]</span>

<div class="viewcode-block" id="DTI._init_from_empty"><a class="viewcode-back" href="../../../../reference/bdf/cards/pyNastran.bdf.cards.dmig.html#pyNastran.bdf.cards.dmig.DTI._init_from_empty">[docs]</a>    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">_init_from_empty</span><span class="p">(</span><span class="bp">cls</span><span class="p">):</span>
        <span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;name&#39;</span>
        <span class="n">fields</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">return</span> <span class="n">DTI</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">fields</span><span class="p">,</span> <span class="n">comment</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">)</span></div>

<div class="viewcode-block" id="DTI._finalize_hdf5"><a class="viewcode-back" href="../../../../reference/bdf/cards/pyNastran.bdf.cards.dmig.html#pyNastran.bdf.cards.dmig.DTI._finalize_hdf5">[docs]</a>    <span class="k">def</span> <span class="nf">_finalize_hdf5</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">encoding</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;hdf5 helper function&quot;&quot;&quot;</span>
        <span class="n">keys</span><span class="p">,</span> <span class="n">values</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fields</span>

        <span class="c1"># nan != nan</span>
        <span class="n">values</span> <span class="o">=</span> <span class="p">[</span><span class="n">value</span> <span class="k">if</span> <span class="n">value</span> <span class="o">==</span> <span class="n">value</span> <span class="k">else</span> <span class="kc">None</span> <span class="k">for</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">values</span><span class="p">]</span>
        <span class="n">values_str</span> <span class="o">=</span> <span class="p">[</span><span class="n">value</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="n">encoding</span><span class="p">)</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="nb">bytes</span><span class="p">)</span> <span class="k">else</span> <span class="n">value</span>
                      <span class="k">for</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">values</span><span class="p">]</span>
        <span class="c1">#values = [valuei.decode(encoding) if isinstance(valuei, bytes) else (</span>
        <span class="c1">#    None if np.isnan(valuei) else valuei)</span>
        <span class="c1">#          for valuei in values]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fields</span> <span class="o">=</span> <span class="p">{</span><span class="n">key</span> <span class="p">:</span> <span class="n">value</span> <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">keys</span><span class="p">,</span> <span class="n">values_str</span><span class="p">)}</span></div>

<div class="viewcode-block" id="DTI.export_to_hdf5"><a class="viewcode-back" href="../../../../reference/bdf/cards/pyNastran.bdf.cards.dmig.html#pyNastran.bdf.cards.dmig.DTI.export_to_hdf5">[docs]</a>    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">export_to_hdf5</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">h5_file</span><span class="p">,</span> <span class="n">model</span><span class="p">,</span> <span class="n">encoding</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;exports the elements in a vectorized way&quot;&quot;&quot;</span>
        <span class="kn">from</span> <span class="nn">pyNastran.bdf.bdf_interface.hdf5_exporter</span> <span class="kn">import</span> <span class="n">_export_list</span>
        <span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">dti</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">dti</span><span class="o">.</span><span class="n">items</span><span class="p">()):</span>
            <span class="k">if</span> <span class="n">name</span> <span class="o">==</span> <span class="s1">&#39;UNITS&#39;</span><span class="p">:</span>
                <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span>
                <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">dti</span><span class="o">.</span><span class="n">fields</span><span class="o">.</span><span class="n">items</span><span class="p">()):</span>
                    <span class="c1">#print(key, value)</span>
                    <span class="n">h5_group</span> <span class="o">=</span> <span class="n">h5_file</span><span class="o">.</span><span class="n">create_group</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">key</span><span class="p">))</span>
                    <span class="k">if</span> <span class="n">value</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                        <span class="n">h5_group</span><span class="o">.</span><span class="n">create_dataset</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">),</span> <span class="n">data</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">)</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">h5_group</span><span class="o">.</span><span class="n">create_dataset</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">),</span> <span class="n">data</span><span class="o">=</span><span class="n">value</span><span class="p">)</span>
                    <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span>
                <span class="c1">#fields = {</span>
                    <span class="c1">#&#39;mass&#39; : mass,</span>
                    <span class="c1">#&#39;force&#39; : force,</span>
                    <span class="c1">#&#39;length&#39; : length,</span>
                    <span class="c1">#&#39;time&#39; : time,</span>
                    <span class="c1">#&#39;temp_stress&#39; : temp_stress</span>
                <span class="c1">#}</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">irecord</span><span class="p">,</span> <span class="n">fields</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">dti</span><span class="o">.</span><span class="n">fields</span><span class="o">.</span><span class="n">items</span><span class="p">()):</span>
                    <span class="c1">#h5_group = h5_file.create_group(str(irecord))</span>
                    <span class="n">attr</span> <span class="o">=</span> <span class="s1">&#39;irecord=</span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">irecord</span>
                    <span class="n">namei</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">irecord</span><span class="p">)</span>
                    <span class="n">values</span> <span class="o">=</span> <span class="n">fields</span>
                    <span class="n">_export_list</span><span class="p">(</span><span class="n">h5_file</span><span class="p">,</span> <span class="n">attr</span><span class="p">,</span> <span class="n">namei</span><span class="p">,</span> <span class="n">values</span><span class="p">,</span> <span class="n">encoding</span><span class="p">)</span></div>
                    <span class="c1">#print(h5_group)</span>
                    <span class="c1">#print(irecord, fields)</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">fields</span><span class="p">,</span> <span class="n">comment</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Creates a DTI card</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        name : str</span>
<span class="sd">            UNITS</span>
<span class="sd">        fields : List[varies]</span>
<span class="sd">            the fields</span>
<span class="sd">        comment : str; default=&#39;&#39;</span>
<span class="sd">            a comment for the card</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">comment</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">comment</span> <span class="o">=</span> <span class="n">comment</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">name</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fields</span> <span class="o">=</span> <span class="n">fields</span>
        <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">fields</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">,</span> <span class="n">fields</span>

<div class="viewcode-block" id="DTI.add_card"><a class="viewcode-back" href="../../../../reference/bdf/cards/pyNastran.bdf.cards.dmig.html#pyNastran.bdf.cards.dmig.DTI.add_card">[docs]</a>    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">add_card</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">card</span><span class="p">,</span> <span class="n">comment</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Adds a DTI card from ``BDF.add_card(...)``</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        card : BDFCard()</span>
<span class="sd">            a BDFCard object</span>
<span class="sd">        comment : str; default=&#39;&#39;</span>
<span class="sd">            a comment for the card</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">name</span> <span class="o">=</span> <span class="n">string</span><span class="p">(</span><span class="n">card</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;name&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">name</span> <span class="o">==</span> <span class="s1">&#39;UNITS&#39;</span><span class="p">:</span>
            <span class="n">integer</span><span class="p">(</span><span class="n">card</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;1&#39;</span><span class="p">)</span>
            <span class="n">mass</span> <span class="o">=</span> <span class="n">string_or_blank</span><span class="p">(</span><span class="n">card</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="s1">&#39;mass&#39;</span><span class="p">)</span>
            <span class="n">force</span> <span class="o">=</span> <span class="n">string_or_blank</span><span class="p">(</span><span class="n">card</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="s1">&#39;force&#39;</span><span class="p">)</span>
            <span class="n">length</span> <span class="o">=</span> <span class="n">string_or_blank</span><span class="p">(</span><span class="n">card</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="s1">&#39;length&#39;</span><span class="p">)</span>
            <span class="n">time</span> <span class="o">=</span> <span class="n">string_or_blank</span><span class="p">(</span><span class="n">card</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="s1">&#39;time&#39;</span><span class="p">)</span>
            <span class="n">temp_stress</span> <span class="o">=</span> <span class="n">string_or_blank</span><span class="p">(</span><span class="n">card</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="s1">&#39;stress/temperature&#39;</span><span class="p">)</span>
            <span class="n">fields</span> <span class="o">=</span> <span class="p">{</span>
                <span class="s1">&#39;mass&#39;</span> <span class="p">:</span> <span class="n">mass</span><span class="p">,</span>
                <span class="s1">&#39;force&#39;</span> <span class="p">:</span> <span class="n">force</span><span class="p">,</span>
                <span class="s1">&#39;length&#39;</span> <span class="p">:</span> <span class="n">length</span><span class="p">,</span>
                <span class="s1">&#39;time&#39;</span> <span class="p">:</span> <span class="n">time</span><span class="p">,</span>
                <span class="s1">&#39;temp_stress&#39;</span> <span class="p">:</span> <span class="n">temp_stress</span>
            <span class="p">}</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">fields</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="c1">#field2 = card[2]</span>

            <span class="n">list_fields</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="n">irecord</span> <span class="o">=</span> <span class="n">integer</span><span class="p">(</span><span class="n">card</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;record&#39;</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">irecord</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">card</span><span class="p">)):</span>
                    <span class="n">val</span> <span class="o">=</span> <span class="n">integer_double_string_or_blank</span><span class="p">(</span>
                        <span class="n">card</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="s1">&#39;T</span><span class="si">%i</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">),</span> <span class="n">default</span><span class="o">=</span><span class="mi">32767</span><span class="p">)</span>
                    <span class="n">list_fields</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">val</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">card</span><span class="p">)):</span>
                    <span class="n">val</span> <span class="o">=</span> <span class="n">integer_double_string_or_blank</span><span class="p">(</span>
                        <span class="n">card</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="s1">&#39;T</span><span class="si">%i</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">),</span> <span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
                    <span class="n">list_fields</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">val</span><span class="p">)</span>
            <span class="n">fields</span> <span class="o">=</span> <span class="p">{</span><span class="n">irecord</span><span class="p">:</span> <span class="n">list_fields</span><span class="p">,}</span>
        <span class="k">return</span> <span class="n">DTI</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">fields</span><span class="p">,</span> <span class="n">comment</span><span class="o">=</span><span class="n">comment</span><span class="p">)</span></div>

<div class="viewcode-block" id="DTI.raw_fields"><a class="viewcode-back" href="../../../../reference/bdf/cards/pyNastran.bdf.cards.dmig.html#pyNastran.bdf.cards.dmig.DTI.raw_fields">[docs]</a>    <span class="k">def</span> <span class="nf">raw_fields</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="s1">&#39;UNITS&#39;</span><span class="p">:</span>
            <span class="n">mass</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fields</span><span class="p">[</span><span class="s1">&#39;mass&#39;</span><span class="p">]</span>
            <span class="n">force</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fields</span><span class="p">[</span><span class="s1">&#39;force&#39;</span><span class="p">]</span>
            <span class="n">length</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fields</span><span class="p">[</span><span class="s1">&#39;length&#39;</span><span class="p">]</span>
            <span class="n">time</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fields</span><span class="p">[</span><span class="s1">&#39;time&#39;</span><span class="p">]</span>
            <span class="n">temp_stress</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fields</span><span class="p">[</span><span class="s1">&#39;temp_stress&#39;</span><span class="p">]</span>
            <span class="n">list_fields</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;DTI&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="s1">&#39;1&#39;</span><span class="p">,</span> <span class="n">mass</span><span class="p">,</span> <span class="n">force</span><span class="p">,</span> <span class="n">length</span><span class="p">,</span> <span class="n">time</span><span class="p">,</span> <span class="n">temp_stress</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">list_fields</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">for</span> <span class="n">irecord</span><span class="p">,</span> <span class="n">fields</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fields</span><span class="o">.</span><span class="n">items</span><span class="p">()):</span>
                <span class="n">nfields</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">fields</span><span class="p">)</span>
                <span class="n">list_fields</span> <span class="o">+=</span> <span class="p">[</span><span class="s1">&#39;DTI&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">]</span> <span class="o">+</span> <span class="n">fields</span>
                <span class="n">nleftover</span> <span class="o">=</span> <span class="n">nfields</span> <span class="o">%</span> <span class="mi">8</span>
                <span class="k">if</span> <span class="n">nleftover</span><span class="p">:</span>
                    <span class="n">list_fields</span> <span class="o">+=</span> <span class="p">[</span><span class="kc">None</span><span class="p">]</span> <span class="o">*</span> <span class="n">nleftover</span>
        <span class="k">return</span> <span class="n">list_fields</span></div>

<div class="viewcode-block" id="DTI.write_card"><a class="viewcode-back" href="../../../../reference/bdf/cards/pyNastran.bdf.cards.dmig.html#pyNastran.bdf.cards.dmig.DTI.write_card">[docs]</a>    <span class="k">def</span> <span class="nf">write_card</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">size</span><span class="p">:</span> <span class="nb">int</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span> <span class="n">is_double</span><span class="p">:</span> <span class="nb">bool</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="s1">&#39;UNITS&#39;</span><span class="p">:</span>
            <span class="n">card</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">repr_fields</span><span class="p">()</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">comment</span> <span class="o">+</span> <span class="n">print_card_8</span><span class="p">(</span><span class="n">card</span><span class="p">)</span>

        <span class="n">msg</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">comment</span>
        <span class="k">for</span> <span class="n">irecord</span><span class="p">,</span> <span class="n">fields</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fields</span><span class="o">.</span><span class="n">items</span><span class="p">()):</span>
            <span class="n">list_fields</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;DTI&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">irecord</span><span class="p">,</span> <span class="p">]</span> <span class="o">+</span> <span class="n">fields</span>
            <span class="n">msg</span> <span class="o">+=</span> <span class="n">print_card_8</span><span class="p">(</span><span class="n">list_fields</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">msg</span></div></div>


<div class="viewcode-block" id="NastranMatrix"><a class="viewcode-back" href="../../../../reference/bdf/cards/pyNastran.bdf.cards.dmig.html#pyNastran.bdf.cards.dmig.NastranMatrix">[docs]</a><span class="k">class</span> <span class="nc">NastranMatrix</span><span class="p">(</span><span class="n">BaseCard</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Base class for the DMIG, DMIJ, DMIJI, DMIK matrices</span>
<span class="sd">    &quot;&quot;&quot;</span>
<div class="viewcode-block" id="NastranMatrix._finalize_hdf5"><a class="viewcode-back" href="../../../../reference/bdf/cards/pyNastran.bdf.cards.dmig.html#pyNastran.bdf.cards.dmig.NastranMatrix._finalize_hdf5">[docs]</a>    <span class="k">def</span> <span class="nf">_finalize_hdf5</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">encoding</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;hdf5 helper function&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">finalize</span><span class="p">()</span></div>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">matrix_form</span><span class="p">,</span> <span class="n">tin</span><span class="p">,</span> <span class="n">tout</span><span class="p">,</span> <span class="n">polar</span><span class="p">,</span> <span class="n">ncols</span><span class="p">,</span>
                 <span class="n">GCj</span><span class="p">,</span> <span class="n">GCi</span><span class="p">,</span> <span class="n">Real</span><span class="p">,</span> <span class="n">Complex</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">comment</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">finalize</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Creates a NastranMatrix</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        name : str</span>
<span class="sd">            the name of the matrix</span>
<span class="sd">        matrix_form : int</span>
<span class="sd">            matrix shape</span>
<span class="sd">            4=Lower Triangular</span>
<span class="sd">            5=Upper Triangular</span>
<span class="sd">            6=Symmetric</span>
<span class="sd">            8=Identity (m=nRows, n=m)</span>
<span class="sd">        tin : int</span>
<span class="sd">            matrix input precision</span>
<span class="sd">            1=Real, Single Precision</span>
<span class="sd">            2=Real, Double Precision</span>
<span class="sd">            3=Complex, Single Precision</span>
<span class="sd">            4=Complex, Double Precision</span>
<span class="sd">        tout : int</span>
<span class="sd">            matrix output precision</span>
<span class="sd">            0=same as tin</span>
<span class="sd">            1=Real, Single Precision</span>
<span class="sd">            2=Real, Double Precision</span>
<span class="sd">            3=Complex, Single Precision</span>
<span class="sd">            4=Complex, Double Precision</span>
<span class="sd">        polar : int; default=0</span>
<span class="sd">            Input format of Ai, Bi</span>
<span class="sd">            Integer=blank or 0 indicates real, imaginary format</span>
<span class="sd">            Integer &gt; 0 indicates amplitude, phase format</span>
<span class="sd">        ncols : int</span>
<span class="sd">            ???</span>
<span class="sd">        GCj  : List[(node, dof)]</span>
<span class="sd">            the jnode, jDOFs</span>
<span class="sd">        GCi  : List[(node, dof)]</span>
<span class="sd">            the inode, iDOFs</span>
<span class="sd">        Real : List[float]</span>
<span class="sd">            The real values</span>
<span class="sd">        Complex : List[float]; default=None</span>
<span class="sd">            The complex values (if the matrix is complex)</span>
<span class="sd">        comment : str; default=&#39;&#39;</span>
<span class="sd">            a comment for the card</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">comment</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">comment</span> <span class="o">=</span> <span class="n">comment</span>
        <span class="k">if</span> <span class="n">Complex</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">Complex</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">if</span> <span class="n">tout</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">tout</span> <span class="o">=</span> <span class="mi">0</span>

        <span class="n">polar</span> <span class="o">=</span> <span class="n">_set_polar</span><span class="p">(</span><span class="n">polar</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">matrix_form</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">9</span><span class="p">]:</span>
            <span class="n">msg</span> <span class="o">=</span> <span class="p">(</span>
                <span class="s1">&#39;matrix_form=</span><span class="si">%r</span><span class="s1"> must be [1, 2, 4, 5, 6, 8, 9]</span><span class="se">\n</span><span class="s1">&#39;</span>
                <span class="s1">&#39;  1: Square</span><span class="se">\n</span><span class="s1">&#39;</span>
                <span class="s1">&#39;  2: Rectangular</span><span class="se">\n</span><span class="s1">&#39;</span>
                <span class="c1">#&#39;  4: Lower Triangular\n&#39;</span>
                <span class="c1">#&#39;  5: Upper Triangular\n&#39;</span>
                <span class="s1">&#39;  6: Symmetric</span><span class="se">\n</span><span class="s1">&#39;</span>
                <span class="c1">#&#39;  8: Identity (m=nRows, n=m)\n&#39;</span>
                <span class="s1">&#39;  9: Rectangular</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">matrix_form</span><span class="p">)</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">name</span>

        <span class="c1">#: 4-Lower Triangular; 5=Upper Triangular; 6=Symmetric; 8=Identity (m=nRows, n=m)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">matrix_form</span> <span class="o">=</span> <span class="n">matrix_form</span>

        <span class="c1">#: 1-Real, Single Precision; 2=Real,Double Precision;</span>
        <span class="c1">#  3=Complex, Single; 4=Complex, Double</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tin</span> <span class="o">=</span> <span class="n">tin</span>

        <span class="c1">#: 0-Set by cell precision</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tout</span> <span class="o">=</span> <span class="n">tout</span>

        <span class="c1">#: Input format of Ai, Bi. (Integer=blank or 0 indicates real, imaginary format;</span>
        <span class="c1">#: Integer &gt; 0 indicates amplitude, phase format.)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">polar</span> <span class="o">=</span> <span class="n">polar</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">ncols</span> <span class="o">=</span> <span class="n">ncols</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">GCj</span> <span class="o">=</span> <span class="n">GCj</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">GCi</span> <span class="o">=</span> <span class="n">GCi</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">Real</span> <span class="o">=</span> <span class="n">Real</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">Complex</span><span class="p">)</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_complex</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">Complex</span> <span class="o">=</span> <span class="n">Complex</span>
            <span class="k">assert</span> <span class="bp">self</span><span class="o">.</span><span class="n">tin</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span> <span class="s1">&#39;tin=</span><span class="si">%r</span><span class="s1"> and must 3 or 4 to be complex&#39;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">tin</span>
            <span class="k">assert</span> <span class="bp">self</span><span class="o">.</span><span class="n">tout</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span> <span class="s1">&#39;tin=</span><span class="si">%r</span><span class="s1"> and must 0, 3 or 4 to be complex&#39;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">tout</span>
        <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">matrix_form</span><span class="p">,</span> <span class="n">integer_types</span><span class="p">),</span> <span class="s1">&#39;matrix_form=</span><span class="si">%r</span><span class="s1"> type=</span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">matrix_form</span><span class="p">,</span> <span class="nb">type</span><span class="p">(</span><span class="n">matrix_form</span><span class="p">))</span>
        <span class="k">assert</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">matrix_form</span><span class="p">,</span> <span class="nb">bool</span><span class="p">),</span> <span class="s1">&#39;matrix_form=</span><span class="si">%r</span><span class="s1"> type=</span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">matrix_form</span><span class="p">,</span> <span class="nb">type</span><span class="p">(</span><span class="n">matrix_form</span><span class="p">))</span>
        <span class="k">if</span> <span class="n">finalize</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">finalize</span><span class="p">()</span>

<div class="viewcode-block" id="NastranMatrix.add_card"><a class="viewcode-back" href="../../../../reference/bdf/cards/pyNastran.bdf.cards.dmig.html#pyNastran.bdf.cards.dmig.NastranMatrix.add_card">[docs]</a>    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">add_card</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">card</span><span class="p">,</span> <span class="n">comment</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Adds a NastranMatrix (DMIG, DMIJ, DMIK, DMIJI) card from ``BDF.add_card(...)``</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        card : BDFCard()</span>
<span class="sd">            a BDFCard object</span>
<span class="sd">        comment : str; default=&#39;&#39;</span>
<span class="sd">            a comment for the card</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">name</span> <span class="o">=</span> <span class="n">string</span><span class="p">(</span><span class="n">card</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;name&#39;</span><span class="p">)</span>
        <span class="c1">#zero</span>

        <span class="n">matrix_form</span> <span class="o">=</span> <span class="n">integer</span><span class="p">(</span><span class="n">card</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="s1">&#39;ifo&#39;</span><span class="p">)</span>
        <span class="n">tin</span> <span class="o">=</span> <span class="n">integer</span><span class="p">(</span><span class="n">card</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="s1">&#39;tin&#39;</span><span class="p">)</span>
        <span class="n">tout</span> <span class="o">=</span> <span class="n">integer_or_blank</span><span class="p">(</span><span class="n">card</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="s1">&#39;tout&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
        <span class="n">polar</span> <span class="o">=</span> <span class="n">integer_or_blank</span><span class="p">(</span><span class="n">card</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="s1">&#39;polar&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">matrix_form</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span> <span class="c1"># square</span>
            <span class="n">ncols</span> <span class="o">=</span> <span class="n">integer_or_blank</span><span class="p">(</span><span class="n">card</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="s1">&#39;matrix_form=</span><span class="si">%s</span><span class="s1">; ncol&#39;</span> <span class="o">%</span> <span class="n">matrix_form</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">matrix_form</span> <span class="o">==</span> <span class="mi">6</span><span class="p">:</span> <span class="c1"># symmetric</span>
            <span class="n">ncols</span> <span class="o">=</span> <span class="n">integer_or_blank</span><span class="p">(</span><span class="n">card</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="s1">&#39;matrix_form=</span><span class="si">%s</span><span class="s1">; ncol&#39;</span> <span class="o">%</span> <span class="n">matrix_form</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">matrix_form</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">9</span><span class="p">]:</span> <span class="c1"># rectangular</span>
            <span class="n">ncols</span> <span class="o">=</span> <span class="n">integer</span><span class="p">(</span><span class="n">card</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="s1">&#39;matrix_form=</span><span class="si">%s</span><span class="s1">; ncol&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">matrix_form</span><span class="p">))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># technically right, but nulling this will fix bad decks</span>
            <span class="c1">#self.ncols = blank(card, 8, &#39;matrix_form=%s; ncol&#39; % self.matrix_form)</span>

            <span class="n">msg</span> <span class="o">=</span> <span class="p">(</span>
                <span class="s1">&#39;</span><span class="si">%s</span><span class="s1"> name=</span><span class="si">%r</span><span class="s1"> matrix_form=</span><span class="si">%r</span><span class="s1"> is not supported.  Valid forms:</span><span class="se">\n</span><span class="s1">&#39;</span>
                <span class="s1">&#39;  4=Lower Triangular</span><span class="se">\n</span><span class="s1">&#39;</span>
                <span class="s1">&#39;  5=Upper Triangular</span><span class="se">\n</span><span class="s1">&#39;</span>
                <span class="s1">&#39;  6=Symmetric</span><span class="se">\n</span><span class="s1">&#39;</span>
                <span class="s1">&#39;  8=Identity (m=nRows, n=m)</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="bp">cls</span><span class="o">.</span><span class="n">type</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">matrix_form</span><span class="p">)</span>
            <span class="p">)</span>
            <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>

        <span class="n">GCj</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">GCi</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">Real</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">Complex</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">return</span> <span class="bp">cls</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">matrix_form</span><span class="p">,</span> <span class="n">tin</span><span class="p">,</span> <span class="n">tout</span><span class="p">,</span> <span class="n">polar</span><span class="p">,</span> <span class="n">ncols</span><span class="p">,</span>
                   <span class="n">GCj</span><span class="p">,</span> <span class="n">GCi</span><span class="p">,</span> <span class="n">Real</span><span class="p">,</span> <span class="n">Complex</span><span class="p">,</span> <span class="n">comment</span><span class="o">=</span><span class="n">comment</span><span class="p">,</span> <span class="n">finalize</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></div>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">matrix_type</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;gets the matrix type&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">matrix_form</span><span class="p">,</span> <span class="n">integer_types</span><span class="p">):</span>
            <span class="n">msg</span> <span class="o">=</span> <span class="s1">&#39;ifo must be an integer; matrix_form=</span><span class="si">%r</span><span class="s1"> type=</span><span class="si">%s</span><span class="s1"> name=</span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">matrix_form</span><span class="p">,</span> <span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">matrix_form</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">matrix_form</span><span class="p">,</span> <span class="nb">bool</span><span class="p">):</span>
            <span class="n">msg</span> <span class="o">=</span> <span class="s1">&#39;matrix_form must not be a boolean; matrix_form=</span><span class="si">%r</span><span class="s1"> type=</span><span class="si">%s</span><span class="s1"> name=</span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">matrix_form</span><span class="p">,</span> <span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">matrix_form</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">matrix_form</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">matrix_type</span> <span class="o">=</span> <span class="s1">&#39;square&#39;</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">matrix_form</span> <span class="o">==</span> <span class="mi">6</span><span class="p">:</span>
            <span class="n">matrix_type</span> <span class="o">=</span> <span class="s1">&#39;symmetric&#39;</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">matrix_form</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">9</span><span class="p">]:</span>
            <span class="n">matrix_type</span> <span class="o">=</span> <span class="s1">&#39;rectangular&#39;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># technically right, but nulling this will fix bad decks</span>
            <span class="c1">#self.ncols = blank(card, 8, &#39;matrix_form=%s; ncol&#39; % self.matrix_form)</span>
            <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%s</span><span class="s1"> matrix_form=</span><span class="si">%r</span><span class="s1"> is not supported&#39;</span> <span class="o">%</span> <span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">type</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">matrix_form</span><span class="p">))</span>
        <span class="k">return</span> <span class="n">matrix_type</span>

<div class="viewcode-block" id="NastranMatrix.finalize"><a class="viewcode-back" href="../../../../reference/bdf/cards/pyNastran.bdf.cards.dmig.html#pyNastran.bdf.cards.dmig.NastranMatrix.finalize">[docs]</a>    <span class="k">def</span> <span class="nf">finalize</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;converts the lists into numpy arrays&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">GCi</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">GCi</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">GCj</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">GCj</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Real</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Real</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_complex</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">Complex</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Complex</span><span class="p">)</span></div>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">shape</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;gets the matrix shape&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">matrix_form</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">6</span><span class="p">]:</span> <span class="c1"># square, symmetric</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">ncols</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">shape</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ncols</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">ncols</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">nrows</span><span class="p">,</span> <span class="n">ncols</span> <span class="o">=</span> <span class="n">get_row_col_map</span><span class="p">(</span>
                    <span class="bp">self</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">GCi</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">GCj</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">matrix_form</span><span class="p">)[:</span><span class="mi">2</span><span class="p">]</span>
                <span class="n">shape</span> <span class="o">=</span> <span class="p">(</span><span class="n">nrows</span><span class="p">,</span> <span class="n">ncols</span><span class="p">)</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">matrix_form</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">9</span><span class="p">]:</span>
            <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="s1">&#39;need to pull the nrows after reading in everything&#39;</span><span class="p">)</span>
            <span class="c1">#shape = (self.ncols, self.ncols)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="s1">&#39;matrix_form=</span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">matrix_form</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">shape</span>

    <span class="k">def</span> <span class="nf">_add_column</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">card</span><span class="p">,</span> <span class="n">comment</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;adds an additional column entry to the matrix&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">comment</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;_comment&#39;</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">comment</span> <span class="o">+=</span> <span class="n">comment</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">comment</span> <span class="o">=</span> <span class="n">comment</span>

        <span class="n">name</span> <span class="o">=</span> <span class="n">string</span><span class="p">(</span><span class="n">card</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;name&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">name</span> <span class="o">==</span> <span class="s1">&#39;UACCEL&#39;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_add_column_uaccel</span><span class="p">()</span>
            <span class="k">return</span>

        <span class="n">Gj</span> <span class="o">=</span> <span class="n">integer</span><span class="p">(</span><span class="n">card</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;Gj&#39;</span><span class="p">)</span>
        <span class="c1"># Cj = integer(card, 3, &#39;Cj&#39;)</span>
        <span class="n">Cj</span> <span class="o">=</span> <span class="n">integer_or_blank</span><span class="p">(</span><span class="n">card</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="s1">&#39;Cj&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
        <span class="c1">#Cj = parse_components(card, 3, &#39;Cj&#39;)</span>
        <span class="k">assert</span> <span class="mi">0</span> <span class="o">&lt;=</span> <span class="n">Cj</span> <span class="o">&lt;=</span> <span class="mi">6</span><span class="p">,</span> <span class="s1">&#39;C</span><span class="si">%i</span><span class="s1"> must be between [0, 6]; Cj=</span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">Cj</span><span class="p">)</span>

        <span class="n">nfields</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">card</span><span class="p">)</span>
        <span class="c1">#print(&quot;nfields = %i&quot; % nfields)</span>
        <span class="c1">#print(&quot;card[5:] =&quot;, card[5:])</span>
        <span class="c1">#print(&quot;(nfields - 5) %% 4 = %i&quot; % ((nfields - 5) % 4))</span>

        <span class="n">nloops</span> <span class="o">=</span> <span class="p">(</span><span class="n">nfields</span> <span class="o">-</span> <span class="mi">5</span><span class="p">)</span> <span class="o">//</span> <span class="mi">4</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">nfields</span> <span class="o">-</span> <span class="mi">5</span><span class="p">)</span> <span class="o">%</span> <span class="mi">4</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">]:</span>  <span class="c1"># real/complex</span>
            <span class="n">nloops</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="c1">#assert nfields &lt;= 8,&#39;nfields=%s&#39; % nfields</span>
        <span class="c1">#print(&quot;nloops = %i&quot; % nloops)</span>
        <span class="k">assert</span> <span class="n">nloops</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;nloops=</span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">nloops</span>

        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nloops</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">GCj</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">Gj</span><span class="p">,</span> <span class="n">Cj</span><span class="p">))</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_complex</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_polar</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nloops</span><span class="p">):</span>
                    <span class="n">n</span> <span class="o">=</span> <span class="mi">5</span> <span class="o">+</span> <span class="mi">4</span> <span class="o">*</span> <span class="n">i</span>
                    <span class="n">Gi</span> <span class="o">=</span> <span class="n">integer</span><span class="p">(</span><span class="n">card</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="s1">&#39;Gi&#39;</span><span class="p">)</span>
                    <span class="c1"># Ci = integer(card, n + 1, &#39;Ci&#39;)</span>
                    <span class="n">Ci</span> <span class="o">=</span> <span class="n">integer_or_blank</span><span class="p">(</span><span class="n">card</span><span class="p">,</span> <span class="n">n</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;Ci&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
                    <span class="c1">#Ci = parse_components(card, n + 1, &#39;Ci&#39;)</span>
                    <span class="k">assert</span> <span class="mi">0</span> <span class="o">&lt;=</span> <span class="n">Ci</span> <span class="o">&lt;=</span> <span class="mi">6</span><span class="p">,</span> <span class="s1">&#39;C</span><span class="si">%i</span><span class="s1"> must be between [0, 6]; Ci=</span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">Ci</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">GCi</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">Gi</span><span class="p">,</span> <span class="n">Ci</span><span class="p">))</span>
                    <span class="n">magi</span> <span class="o">=</span> <span class="n">double</span><span class="p">(</span><span class="n">card</span><span class="p">,</span> <span class="n">n</span> <span class="o">+</span> <span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;ai&#39;</span><span class="p">)</span>
                    <span class="n">phasei</span> <span class="o">=</span> <span class="n">double</span><span class="p">(</span><span class="n">card</span><span class="p">,</span> <span class="n">n</span> <span class="o">+</span> <span class="mi">3</span><span class="p">,</span> <span class="s1">&#39;bi&#39;</span><span class="p">)</span>
                    <span class="n">reali</span> <span class="o">=</span> <span class="n">magi</span> <span class="o">*</span> <span class="n">cos</span><span class="p">(</span><span class="n">radians</span><span class="p">(</span><span class="n">phasei</span><span class="p">))</span>
                    <span class="n">complexi</span> <span class="o">=</span> <span class="n">magi</span> <span class="o">*</span> <span class="n">sin</span><span class="p">(</span><span class="n">radians</span><span class="p">(</span><span class="n">phasei</span><span class="p">))</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">Real</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">reali</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">Complex</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">complexi</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nloops</span><span class="p">):</span>
                    <span class="n">n</span> <span class="o">=</span> <span class="mi">5</span> <span class="o">+</span> <span class="mi">4</span> <span class="o">*</span> <span class="n">i</span>
                    <span class="n">Gi</span> <span class="o">=</span> <span class="n">integer</span><span class="p">(</span><span class="n">card</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="s1">&#39;Gi&#39;</span><span class="p">)</span>
                    <span class="c1"># Ci = integer(card, n + 1, &#39;Ci&#39;)</span>
                    <span class="n">Ci</span> <span class="o">=</span> <span class="n">integer_or_blank</span><span class="p">(</span><span class="n">card</span><span class="p">,</span> <span class="n">n</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;Ci&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
                    <span class="c1">#Ci = parse_components(card, n + 1, &#39;Ci&#39;)</span>
                    <span class="k">assert</span> <span class="mi">0</span> <span class="o">&lt;=</span> <span class="n">Ci</span> <span class="o">&lt;=</span> <span class="mi">6</span><span class="p">,</span> <span class="s1">&#39;C</span><span class="si">%i</span><span class="s1"> must be between [0, 6]; Ci=</span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">Ci</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">GCi</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">Gi</span><span class="p">,</span> <span class="n">Ci</span><span class="p">))</span>
                    <span class="n">reali</span> <span class="o">=</span> <span class="n">double</span><span class="p">(</span><span class="n">card</span><span class="p">,</span> <span class="n">n</span> <span class="o">+</span> <span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;real&#39;</span><span class="p">)</span>
                    <span class="n">complexi</span> <span class="o">=</span> <span class="n">double</span><span class="p">(</span><span class="n">card</span><span class="p">,</span> <span class="n">n</span> <span class="o">+</span> <span class="mi">3</span><span class="p">,</span> <span class="s1">&#39;complex&#39;</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">Real</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">reali</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">Complex</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">complexi</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># real</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nloops</span><span class="p">):</span>
                <span class="n">n</span> <span class="o">=</span> <span class="mi">5</span> <span class="o">+</span> <span class="mi">4</span> <span class="o">*</span> <span class="n">i</span>
                <span class="n">Gi</span> <span class="o">=</span> <span class="n">integer</span><span class="p">(</span><span class="n">card</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="s1">&#39;Gi&#39;</span><span class="p">)</span>
                <span class="c1"># Ci = integer(card, n + 1, &#39;Ci&#39;)</span>
                <span class="n">Ci</span> <span class="o">=</span> <span class="n">integer_or_blank</span><span class="p">(</span><span class="n">card</span><span class="p">,</span> <span class="n">n</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;Ci&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
                <span class="c1">#Ci = parse_components(card, n + 1, &#39;Ci&#39;)</span>
                <span class="k">assert</span> <span class="mi">0</span> <span class="o">&lt;=</span> <span class="n">Ci</span> <span class="o">&lt;=</span> <span class="mi">6</span><span class="p">,</span> <span class="s1">&#39;C</span><span class="si">%i</span><span class="s1"> must be between [0, 6]; Ci=</span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">Ci</span><span class="p">)</span>
                <span class="n">reali</span> <span class="o">=</span> <span class="n">double</span><span class="p">(</span><span class="n">card</span><span class="p">,</span> <span class="n">n</span> <span class="o">+</span> <span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;real&#39;</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">GCi</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">Gi</span><span class="p">,</span> <span class="n">Ci</span><span class="p">))</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">Real</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">reali</span><span class="p">)</span>
                <span class="c1">#print(&quot;GC=%s,%s real=%s&quot; % (Gi, Ci, reali))</span>

        <span class="n">msg</span> <span class="o">=</span> <span class="s1">&#39;(len(GCj)=</span><span class="si">%s</span><span class="s1"> len(GCi)=</span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">GCj</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">GCi</span><span class="p">))</span>
        <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">GCj</span><span class="p">)</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">GCi</span><span class="p">),</span> <span class="n">msg</span>
        <span class="c1">#if self.is_complex:</span>
            <span class="c1">#self.Complex(double(card, v, &#39;complex&#39;)</span>

<div class="viewcode-block" id="NastranMatrix.get_matrix"><a class="viewcode-back" href="../../../../reference/bdf/cards/pyNastran.bdf.cards.dmig.html#pyNastran.bdf.cards.dmig.NastranMatrix.get_matrix">[docs]</a>    <span class="k">def</span> <span class="nf">get_matrix</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">is_sparse</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">apply_symmetry</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Builds the Matrix</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        is_sparse : bool; default=False</span>
<span class="sd">            should the matrix be returned as a sparse matrix.</span>
<span class="sd">            Slower for dense matrices.</span>
<span class="sd">        apply_symmetry : bool; default=True</span>
<span class="sd">            If the matrix is symmetric (ifo=6), returns a symmetric matrix.</span>
<span class="sd">            Supported as there are symmetric matrix routines.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        M : numpy.ndarray or scipy.coomatrix</span>
<span class="sd">            the matrix</span>
<span class="sd">        rows : dict[int] = [int, int]</span>
<span class="sd">            dictionary of keys=rowID, values=(Grid,Component) for the matrix</span>
<span class="sd">        cols: dict[int] = [int, int]</span>
<span class="sd">            dictionary of keys=columnID, values=(Grid,Component) for the matrix</span>

<span class="sd">        .. warning:: is_sparse=True WILL fail</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">get_matrix</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">is_sparse</span><span class="o">=</span><span class="n">is_sparse</span><span class="p">,</span> <span class="n">apply_symmetry</span><span class="o">=</span><span class="n">apply_symmetry</span><span class="p">)</span></div>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">is_real</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;real vs. complex attribute&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_complex</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">is_complex</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;real vs. complex attribute&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">tin</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]:</span> <span class="c1"># real</span>
            <span class="k">return</span> <span class="kc">False</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">tin</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">]:</span> <span class="c1"># complex</span>
            <span class="k">return</span> <span class="kc">True</span>
        <span class="n">msg</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;Matrix </span><span class="si">%r</span><span class="s1"> must have a value of TIN = [1, 2, 3, 4].</span><span class="se">\n</span><span class="s1">&#39;</span>
               <span class="s1">&#39;TIN defines the type (real, complex) &#39;</span>
               <span class="s1">&#39;of the matrix.  TIN=</span><span class="si">%r</span><span class="s1">.</span><span class="se">\n</span><span class="s1">&#39;</span>
               <span class="s1">&#39;  TIN=1,2 -&gt; real</span><span class="se">\n</span><span class="s1">&#39;</span>
               <span class="s1">&#39;  TIN=3,4 -&gt; complex&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">tin</span><span class="p">))</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">is_polar</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Used by:</span>
<span class="sd">          - DMIG</span>
<span class="sd">          - DMIJ</span>
<span class="sd">          - DMIJI</span>
<span class="sd">          - DMIK</span>

<span class="sd">        Not used by:</span>
<span class="sd">          - DMI</span>
<span class="sd">          - DMIAX</span>
<span class="sd">          - DMIG, UACCEL</span>
<span class="sd">          - DMIGOUT</span>
<span class="sd">          - DMIGROT</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">polar</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span> <span class="c1"># real, imag</span>
            <span class="k">return</span> <span class="kc">False</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">polar</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span> <span class="c1"># mag, phase</span>
            <span class="k">return</span> <span class="kc">True</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">polar</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">False</span>
        <span class="n">msg</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;Matrix </span><span class="si">%r</span><span class="s1"> must have a value of POLAR = [0, 1].</span><span class="se">\n</span><span class="s1">&#39;</span>
               <span class="s1">&#39;POLAR defines the type (real/imag or mag/phase) complex) &#39;</span>
               <span class="s1">&#39;of the matrix.  POLAR=</span><span class="si">%r</span><span class="s1">.&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">polar</span><span class="p">))</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">tin_dtype</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;gets the input dtype&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">_get_dtype</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">is_complex</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">tin</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">tout_dtype</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;gets the output dtype&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">_get_dtype</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">is_complex</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">tout</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">write_card</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span> <span class="n">is_double</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

<div class="viewcode-block" id="NastranMatrix.fill_in_default_components"><a class="viewcode-back" href="../../../../reference/bdf/cards/pyNastran.bdf.cards.dmig.html#pyNastran.bdf.cards.dmig.NastranMatrix.fill_in_default_components">[docs]</a>    <span class="k">def</span> <span class="nf">fill_in_default_components</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">model</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="p">(</span><span class="n">Gi</span><span class="p">,</span> <span class="n">Ci</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">GCi</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">Ci</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">node</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">nodes</span><span class="p">[</span><span class="n">Gi</span><span class="p">]</span>
                <span class="k">if</span> <span class="n">node</span><span class="o">.</span><span class="n">type</span> <span class="o">==</span> <span class="s1">&#39;GRID&#39;</span><span class="p">:</span>
                    <span class="n">msg</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;Ci on DMIG card must be 1, 2, 3, 4, 5, or 6; &#39;</span>
                           <span class="s1">&#39;Node=</span><span class="si">%i</span><span class="s1"> (GRID); Ci=</span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">Gi</span><span class="p">,</span> <span class="n">Ci</span><span class="p">))</span>
                    <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
                <span class="k">elif</span> <span class="n">node</span><span class="o">.</span><span class="n">type</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;SPOINT&#39;</span><span class="p">,</span> <span class="s1">&#39;EPOINT&#39;</span><span class="p">]:</span>
                    <span class="n">Ci</span> <span class="o">=</span> <span class="mi">0</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="n">node</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">GCi</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">Gi</span><span class="p">,</span> <span class="n">Ci</span><span class="p">]</span>

        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="p">(</span><span class="n">Gj</span><span class="p">,</span> <span class="n">Cj</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">GCj</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">Cj</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">node</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">nodes</span><span class="p">[</span><span class="n">Gj</span><span class="p">]</span>
                <span class="k">if</span> <span class="n">node</span><span class="o">.</span><span class="n">type</span> <span class="o">==</span> <span class="s1">&#39;GRID&#39;</span><span class="p">:</span>
                    <span class="n">msg</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;Cj on DMIG card must be 1, 2, 3, 4, 5, or 6; &#39;</span>
                           <span class="s1">&#39;Node=</span><span class="si">%i</span><span class="s1"> (GRID); Cj=</span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">Gj</span><span class="p">,</span> <span class="n">Cj</span><span class="p">))</span>
                    <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
                <span class="k">elif</span> <span class="n">node</span><span class="o">.</span><span class="n">type</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;SPOINT&#39;</span><span class="p">,</span> <span class="s1">&#39;EPOINT&#39;</span><span class="p">]:</span>
                    <span class="n">Cj</span> <span class="o">=</span> <span class="mi">0</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="n">node</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">GCj</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">Gj</span><span class="p">,</span> <span class="n">Cj</span><span class="p">]</span>
        <span class="k">return</span></div>

<div class="viewcode-block" id="NastranMatrix.write_card"><a class="viewcode-back" href="../../../../reference/bdf/cards/pyNastran.bdf.cards.dmig.html#pyNastran.bdf.cards.dmig.NastranMatrix.write_card">[docs]</a>    <span class="k">def</span> <span class="nf">write_card</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">size</span><span class="p">:</span> <span class="nb">int</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span> <span class="n">is_double</span><span class="p">:</span> <span class="nb">bool</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">tin</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">]:</span>
            <span class="n">is_double</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">tin</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">]:</span>
            <span class="n">is_double</span> <span class="o">=</span> <span class="kc">True</span>
            <span class="n">size</span> <span class="o">=</span> <span class="mi">16</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s1">&#39;tin=</span><span class="si">%r</span><span class="s1"> must be 1, 2, 3, or 4&#39;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">tin</span><span class="p">)</span>

        <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">GCi</span><span class="p">,</span> <span class="p">(</span><span class="nb">list</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">)),</span> <span class="s1">&#39;type(GCi)=</span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">GCi</span><span class="p">)</span>
        <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">GCj</span><span class="p">,</span> <span class="p">(</span><span class="nb">list</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">)),</span> <span class="s1">&#39;type(GCj)=</span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">GCj</span><span class="p">)</span>
        <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Real</span><span class="p">,</span> <span class="p">(</span><span class="nb">list</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">)),</span> <span class="s1">&#39;type(Real)=</span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Real</span><span class="p">)</span>
        <span class="c1">#assert isinstance(self.GCi[0], (list, np.ndarray)), &#39;type(GCi[0])=%s&#39; % type(self.GCi[0])</span>
        <span class="c1">#assert isinstance(self.GCj[0], (list, np.ndarray)), &#39;type(GCj[0])=%s&#39; % type(self.GCj[0])</span>

        <span class="n">msg</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">$&#39;</span> <span class="o">+</span> <span class="s1">&#39;-&#39;</span> <span class="o">*</span> <span class="mi">80</span>
        <span class="n">msg</span> <span class="o">+=</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">$ </span><span class="si">%s</span><span class="s1"> Matrix </span><span class="si">%s</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">type</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
        <span class="n">list_fields</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">type</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">matrix_form</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">tin</span><span class="p">,</span>
                       <span class="bp">self</span><span class="o">.</span><span class="n">tout</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">polar</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">ncols</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">size</span> <span class="o">==</span> <span class="mi">8</span><span class="p">:</span>
            <span class="n">msg</span> <span class="o">+=</span> <span class="n">print_card_8</span><span class="p">(</span><span class="n">list_fields</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">msg</span> <span class="o">+=</span> <span class="n">print_card_16</span><span class="p">(</span><span class="n">list_fields</span><span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_complex</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_polar</span><span class="p">:</span>
                <span class="k">for</span> <span class="p">(</span><span class="n">GCi</span><span class="p">,</span> <span class="n">GCj</span><span class="p">,</span> <span class="n">reali</span><span class="p">,</span> <span class="n">complexi</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">GCi</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">GCj</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">Real</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">Complex</span><span class="p">):</span>
                    <span class="n">magi</span> <span class="o">=</span> <span class="n">sqrt</span><span class="p">(</span><span class="n">reali</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">complexi</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
                    <span class="k">if</span> <span class="n">reali</span> <span class="o">==</span> <span class="mf">0.0</span><span class="p">:</span>
                        <span class="n">phasei</span> <span class="o">=</span> <span class="mf">0.0</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">phasei</span> <span class="o">=</span> <span class="n">degrees</span><span class="p">(</span><span class="n">atan2</span><span class="p">(</span><span class="n">complexi</span><span class="p">,</span> <span class="n">reali</span><span class="p">))</span>
                    <span class="n">list_fields</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">type</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">GCj</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">GCj</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span>
                                   <span class="kc">None</span><span class="p">,</span> <span class="n">GCi</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">GCi</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">magi</span><span class="p">,</span> <span class="n">phasei</span><span class="p">]</span>
                    <span class="k">if</span> <span class="n">size</span> <span class="o">==</span> <span class="mi">8</span><span class="p">:</span>
                        <span class="n">msg</span> <span class="o">+=</span> <span class="n">print_card_8</span><span class="p">(</span><span class="n">list_fields</span><span class="p">)</span>
                    <span class="k">elif</span> <span class="n">is_double</span><span class="p">:</span>
                        <span class="n">msg</span> <span class="o">+=</span> <span class="n">print_card_double</span><span class="p">(</span><span class="n">list_fields</span><span class="p">)</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">msg</span> <span class="o">+=</span> <span class="n">print_card_16</span><span class="p">(</span><span class="n">list_fields</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">for</span> <span class="p">(</span><span class="n">GCi</span><span class="p">,</span> <span class="n">GCj</span><span class="p">,</span> <span class="n">reali</span><span class="p">,</span> <span class="n">complexi</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">GCi</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">GCj</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">Real</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">Complex</span><span class="p">):</span>
                    <span class="n">list_fields</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">type</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">GCj</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">GCj</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span>
                                   <span class="kc">None</span><span class="p">,</span> <span class="n">GCi</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">GCi</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">reali</span><span class="p">,</span> <span class="n">complexi</span><span class="p">]</span>
                    <span class="k">if</span> <span class="n">size</span> <span class="o">==</span> <span class="mi">8</span><span class="p">:</span>
                        <span class="n">msg</span> <span class="o">+=</span> <span class="n">print_card_8</span><span class="p">(</span><span class="n">list_fields</span><span class="p">)</span>
                    <span class="k">elif</span> <span class="n">is_double</span><span class="p">:</span>
                        <span class="n">msg</span> <span class="o">+=</span> <span class="n">print_card_double</span><span class="p">(</span><span class="n">list_fields</span><span class="p">)</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">msg</span> <span class="o">+=</span> <span class="n">print_card_16</span><span class="p">(</span><span class="n">list_fields</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">for</span> <span class="p">(</span><span class="n">GCi</span><span class="p">,</span> <span class="n">GCj</span><span class="p">,</span> <span class="n">reali</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">GCi</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">GCj</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">Real</span><span class="p">):</span>
                <span class="n">list_fields</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">type</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">GCj</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">GCj</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span>
                               <span class="kc">None</span><span class="p">,</span> <span class="n">GCi</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">GCi</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">reali</span><span class="p">,</span> <span class="kc">None</span><span class="p">]</span>
                <span class="k">if</span> <span class="n">size</span> <span class="o">==</span> <span class="mi">8</span><span class="p">:</span>
                    <span class="n">msg</span> <span class="o">+=</span> <span class="n">print_card_8</span><span class="p">(</span><span class="n">list_fields</span><span class="p">)</span>
                <span class="k">elif</span> <span class="n">is_double</span><span class="p">:</span>
                    <span class="n">msg</span> <span class="o">+=</span> <span class="n">print_card_double</span><span class="p">(</span><span class="n">list_fields</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">msg</span> <span class="o">+=</span> <span class="n">print_card_16</span><span class="p">(</span><span class="n">list_fields</span><span class="p">)</span>

        <span class="c1">#msg += &#39;\n\nGCi[0]=%s\n&#39; % self.GCi[0]</span>
        <span class="c1">#msg += &#39;GCj[0]=%s\n&#39; % self.GCj[0]</span>
        <span class="c1">#msg += &#39;Real[0]=%s\n&#39; % self.Real[0]</span>
        <span class="c1">#assert isinstance(self.GCi[0], (list, np.ndarray)), msg</span>
        <span class="c1">#assert isinstance(self.GCj[0], (list, np.ndarray)), msg</span>
        <span class="c1">#assert isinstance(self.Real[0], (list, np.ndarray)), msg</span>

        <span class="k">return</span> <span class="n">msg</span></div></div>


<div class="viewcode-block" id="DMIG_UACCEL"><a class="viewcode-back" href="../../../../reference/bdf/cards/pyNastran.bdf.cards.dmig.html#pyNastran.bdf.cards.dmig.DMIG_UACCEL">[docs]</a><span class="k">class</span> <span class="nc">DMIG_UACCEL</span><span class="p">(</span><span class="n">BaseCard</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Direct Matrix Input of Enforced Static Acceleration</span>
<span class="sd">    Defines rigid body accelerations in the basic coordinate system.</span>

<span class="sd">    +------+--------+-----+-----+-----+-----+-----+-------+-------+</span>
<span class="sd">    |   1  |   2    |  3  |  4  |  5  |  6  |  7  |   8   |       |</span>
<span class="sd">    +======+========+=====+=====+=====+=====+=====+=======+=======+</span>
<span class="sd">    | DMIG | UACCEL | &quot;0&quot; | &quot;9&quot; | TIN |     |     |       | NCOL  |</span>
<span class="sd">    +------+--------+-----+-----+-----+-----+-----+-------+-------+</span>
<span class="sd">    | DMIG | UACCEL |  L  |     |     |  G1 | C1  |  X1   |       |</span>
<span class="sd">    +------+--------+-----+-----+-----+-----+-----+-------+-------+</span>
<span class="sd">    |      |   G2   |  C2 | X2  |     |  G3 | C3  |  X3   |       |</span>
<span class="sd">    +------+--------+-----+-----+-----+-----+-----+-------+-------+</span>

<span class="sd">    +------+--------+-----+-----+-----+-----+-----+-------+-------+</span>
<span class="sd">    | DMIG | UACCEL |  0  |  9  |  1  |     |     |       |   4   |</span>
<span class="sd">    +------+--------+-----+-----+-----+-----+-----+-------+-------+</span>
<span class="sd">    | DMIG | UACCEL |  2  |     |     |  2  |  3  | 386.4 |       |</span>
<span class="sd">    +------+--------+-----+-----+-----+-----+-----+-------+-------+</span>
<span class="sd">    | DMIG | UACCEL |  3  |     |     |  2  |  4  |  3.0  |       |</span>
<span class="sd">    +------+--------+-----+-----+-----+-----+-----+-------+-------+</span>
<span class="sd">    | DMIG | UACCEL |  4  |     |     |  2  |  6  |  1.0  |       |</span>
<span class="sd">    +------+--------+-----+-----+-----+-----+-----+-------+-------+</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="nb">type</span> <span class="o">=</span> <span class="s1">&#39;DMIG&#39;</span>
    <span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;UACCEL&#39;</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">tin</span><span class="p">,</span> <span class="n">ncol</span><span class="p">,</span> <span class="n">load_sequences</span><span class="p">,</span> <span class="n">comment</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">comment</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">comment</span> <span class="o">=</span> <span class="n">comment</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tin</span> <span class="o">=</span> <span class="n">tin</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ncol</span> <span class="o">=</span> <span class="n">ncol</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">load_sequences</span> <span class="o">=</span> <span class="n">load_sequences</span>
        <span class="c1">#print(str(self))</span>

<div class="viewcode-block" id="DMIG_UACCEL.export_to_hdf5"><a class="viewcode-back" href="../../../../reference/bdf/cards/pyNastran.bdf.cards.dmig.html#pyNastran.bdf.cards.dmig.DMIG_UACCEL.export_to_hdf5">[docs]</a>    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">export_to_hdf5</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">h5_file</span><span class="p">,</span> <span class="n">model</span><span class="p">,</span> <span class="n">encoding</span><span class="p">):</span>
        <span class="n">_export_dmig_to_hdf5</span><span class="p">(</span><span class="n">h5_file</span><span class="p">,</span> <span class="n">model</span><span class="p">,</span> <span class="n">model</span><span class="o">.</span><span class="n">dmig</span><span class="p">,</span> <span class="n">encoding</span><span class="p">)</span></div>

<div class="viewcode-block" id="DMIG_UACCEL.add_card"><a class="viewcode-back" href="../../../../reference/bdf/cards/pyNastran.bdf.cards.dmig.html#pyNastran.bdf.cards.dmig.DMIG_UACCEL.add_card">[docs]</a>    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">add_card</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">card</span><span class="p">,</span> <span class="n">comment</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Adds a DMIG,UACCEL card from ``BDF.add_card(...)``</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        card : BDFCard()</span>
<span class="sd">            a BDFCard object</span>
<span class="sd">        comment : str; default=&#39;&#39;</span>
<span class="sd">            a comment for the card</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">tin</span> <span class="o">=</span> <span class="n">integer</span><span class="p">(</span><span class="n">card</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="s1">&#39;tin&#39;</span><span class="p">)</span>
        <span class="n">ncol</span> <span class="o">=</span> <span class="n">integer_or_blank</span><span class="p">(</span><span class="n">card</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="s1">&#39;ncol&#39;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">DMIG_UACCEL</span><span class="p">(</span><span class="n">tin</span><span class="p">,</span> <span class="n">ncol</span><span class="p">,</span> <span class="n">load_sequences</span><span class="o">=</span><span class="p">{},</span> <span class="n">comment</span><span class="o">=</span><span class="n">comment</span><span class="p">)</span></div>

    <span class="k">def</span> <span class="nf">_add_column</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">card</span><span class="p">,</span> <span class="n">comment</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">comment</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;_comment&#39;</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">comment</span> <span class="o">+=</span> <span class="n">comment</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">comment</span> <span class="o">=</span> <span class="n">comment</span>
        <span class="n">load_seq</span> <span class="o">=</span> <span class="n">integer</span><span class="p">(</span><span class="n">card</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;load_seq&#39;</span><span class="p">)</span>

        <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">ifield</span> <span class="o">=</span> <span class="mi">5</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">load_sequences</span><span class="p">[</span><span class="n">load_seq</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">card</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="mi">8</span><span class="p">,</span> <span class="s1">&#39;len=</span><span class="si">%s</span><span class="s1"> card=</span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">card</span><span class="p">),</span> <span class="n">card</span><span class="p">)</span>
        <span class="k">while</span> <span class="n">ifield</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">card</span><span class="p">):</span>
            <span class="n">g1</span> <span class="o">=</span> <span class="n">integer</span><span class="p">(</span><span class="n">card</span><span class="p">,</span> <span class="n">ifield</span><span class="p">,</span> <span class="s1">&#39;nid</span><span class="si">%d</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">i</span><span class="p">)</span>
            <span class="n">c1</span> <span class="o">=</span> <span class="n">parse_components</span><span class="p">(</span><span class="n">card</span><span class="p">,</span> <span class="n">ifield</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;c</span><span class="si">%d</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">i</span><span class="p">)</span>
            <span class="n">x1</span> <span class="o">=</span> <span class="n">double</span><span class="p">(</span><span class="n">card</span><span class="p">,</span> <span class="n">ifield</span><span class="o">+</span><span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;x</span><span class="si">%d</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">i</span><span class="p">)</span>
            <span class="c1">#assert len(card) &lt;= 8, &#39;len=%s card=%s&#39; % (len(card), card)</span>
            <span class="n">gcx</span> <span class="o">=</span> <span class="p">[</span><span class="n">g1</span><span class="p">,</span> <span class="n">c1</span><span class="p">,</span> <span class="n">x1</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">load_sequences</span><span class="p">[</span><span class="n">load_seq</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">gcx</span><span class="p">)</span>
            <span class="n">ifield</span> <span class="o">+=</span> <span class="mi">4</span>
            <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span>


<div class="viewcode-block" id="DMIG_UACCEL.finalize"><a class="viewcode-back" href="../../../../reference/bdf/cards/pyNastran.bdf.cards.dmig.html#pyNastran.bdf.cards.dmig.DMIG_UACCEL.finalize">[docs]</a>    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">finalize</span><span class="p">():</span>
        <span class="sd">&quot;&quot;&quot;a passer method&quot;&quot;&quot;</span>
        <span class="k">pass</span></div>

<div class="viewcode-block" id="DMIG_UACCEL.raw_fields"><a class="viewcode-back" href="../../../../reference/bdf/cards/pyNastran.bdf.cards.dmig.html#pyNastran.bdf.cards.dmig.DMIG_UACCEL.raw_fields">[docs]</a>    <span class="k">def</span> <span class="nf">raw_fields</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">list_fields</span> <span class="o">=</span> <span class="p">[</span>
            <span class="s1">&#39;DMIG&#39;</span><span class="p">,</span> <span class="s1">&#39;UACCEL&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">tin</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">ncol</span>
        <span class="p">]</span>
        <span class="k">for</span> <span class="n">lseq</span><span class="p">,</span> <span class="n">ncx</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">load_sequences</span><span class="o">.</span><span class="n">items</span><span class="p">()):</span>
            <span class="n">list_fields</span> <span class="o">+=</span> <span class="p">[</span><span class="n">lseq</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">]</span>
            <span class="k">for</span> <span class="n">ncxi</span> <span class="ow">in</span> <span class="n">ncx</span><span class="p">:</span>
                <span class="n">list_fields</span> <span class="o">+=</span> <span class="n">ncxi</span>
           <span class="c1">#for (nid, comp, xi) in ncx:</span>
        <span class="c1">#print(&#39;list_fields= %s&#39; % list_fields)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">write_card</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">list_fields</span></div>

<div class="viewcode-block" id="DMIG_UACCEL.write_card"><a class="viewcode-back" href="../../../../reference/bdf/cards/pyNastran.bdf.cards.dmig.html#pyNastran.bdf.cards.dmig.DMIG_UACCEL.write_card">[docs]</a>    <span class="k">def</span> <span class="nf">write_card</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">size</span><span class="p">:</span> <span class="nb">int</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span> <span class="n">is_double</span><span class="p">:</span> <span class="nb">bool</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">tin</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">]:</span>
            <span class="n">is_double</span> <span class="o">=</span> <span class="kc">False</span>
            <span class="n">msg</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">write_card_8</span><span class="p">()</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">tin</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">]:</span>
            <span class="n">is_double</span> <span class="o">=</span> <span class="kc">True</span>
            <span class="n">size</span> <span class="o">=</span> <span class="mi">16</span>
            <span class="n">msg</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">write_card_16</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s1">&#39;tin=</span><span class="si">%r</span><span class="s1"> must be 1, 2, 3, or 4&#39;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">tin</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">msg</span></div>

<div class="viewcode-block" id="DMIG_UACCEL.write_card_8"><a class="viewcode-back" href="../../../../reference/bdf/cards/pyNastran.bdf.cards.dmig.html#pyNastran.bdf.cards.dmig.DMIG_UACCEL.write_card_8">[docs]</a>    <span class="k">def</span> <span class="nf">write_card_8</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;writes the card in small field format&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_write_card</span><span class="p">(</span><span class="n">print_card_8</span><span class="p">)</span></div>

<div class="viewcode-block" id="DMIG_UACCEL.write_card_16"><a class="viewcode-back" href="../../../../reference/bdf/cards/pyNastran.bdf.cards.dmig.html#pyNastran.bdf.cards.dmig.DMIG_UACCEL.write_card_16">[docs]</a>    <span class="k">def</span> <span class="nf">write_card_16</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;writes the card in small large format&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_write_card</span><span class="p">(</span><span class="n">print_card_16</span><span class="p">)</span></div>

<div class="viewcode-block" id="DMIG_UACCEL._write_card"><a class="viewcode-back" href="../../../../reference/bdf/cards/pyNastran.bdf.cards.dmig.html#pyNastran.bdf.cards.dmig.DMIG_UACCEL._write_card">[docs]</a>    <span class="k">def</span> <span class="nf">_write_card</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">func</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;writes the card&quot;&quot;&quot;</span>
        <span class="n">msg</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">$&#39;</span> <span class="o">+</span> <span class="s1">&#39;-&#39;</span> <span class="o">*</span> <span class="mi">80</span>
        <span class="n">msg</span> <span class="o">+=</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">$ DMIG Matrix UACCEL</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">list_fields</span> <span class="o">=</span> <span class="p">[</span>
            <span class="s1">&#39;DMIG&#39;</span><span class="p">,</span> <span class="s1">&#39;UACCEL&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">tin</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">ncol</span><span class="p">,</span>
        <span class="p">]</span>
        <span class="n">msg</span> <span class="o">+=</span> <span class="n">func</span><span class="p">(</span><span class="n">list_fields</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">lseq</span><span class="p">,</span> <span class="n">ncx</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">load_sequences</span><span class="o">.</span><span class="n">items</span><span class="p">()):</span>
            <span class="n">list_fields</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;DMIG&#39;</span><span class="p">,</span> <span class="s1">&#39;UACCEL&#39;</span><span class="p">]</span>
            <span class="n">list_fields</span> <span class="o">+=</span> <span class="p">[</span><span class="n">lseq</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">]</span>
            <span class="k">for</span> <span class="n">ncxi</span> <span class="ow">in</span> <span class="n">ncx</span><span class="p">:</span>
                <span class="n">list_fields</span> <span class="o">+=</span> <span class="n">ncxi</span> <span class="o">+</span> <span class="p">[</span><span class="kc">None</span><span class="p">]</span>
            <span class="n">list_fields</span><span class="o">.</span><span class="n">pop</span><span class="p">()</span>
            <span class="n">msg</span> <span class="o">+=</span> <span class="n">func</span><span class="p">(</span><span class="n">list_fields</span><span class="p">)</span>
        <span class="c1">#print(msg)</span>
        <span class="c1">#if self.is_complex:</span>
            <span class="c1">#msg += self._get_complex_fields(func)</span>
        <span class="c1">#else:</span>
            <span class="c1">#msg += self._get_real_fields(func)</span>
        <span class="k">return</span> <span class="n">msg</span></div>

    <span class="k">def</span> <span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">write_card</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span></div>

<div class="viewcode-block" id="DMIG"><a class="viewcode-back" href="../../../../reference/bdf/cards/pyNastran.bdf.cards.dmig.html#pyNastran.bdf.cards.dmig.DMIG">[docs]</a><span class="k">class</span> <span class="nc">DMIG</span><span class="p">(</span><span class="n">NastranMatrix</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Defines direct input matrices related to grid, extra, and/or scalar points.</span>
<span class="sd">    The matrix is defined by a single header entry and one or more column</span>
<span class="sd">    entries. A column entry is required for each column with nonzero elements.</span>

<span class="sd">    +------+------+----+-----+-----+------+-------+----+------+</span>
<span class="sd">    |   1  |  2   | 3  |  4  |  5  |   6  |   7   | 8  |  9   |</span>
<span class="sd">    +======+======+====+=====+=====+======+=======+====+======+</span>
<span class="sd">    | DMIG | NAME | 0  | IFO | TIN | TOUT | POLAR |    | NCOL |</span>
<span class="sd">    +------+------+----+-----+-----+------+-------+----+------+</span>
<span class="sd">    | DMIG | NAME | GJ | CJ  |     |  G1  |  C1   | A1 |  B1  |</span>
<span class="sd">    +------+------+----+-----+-----+------+-------+----+------+</span>
<span class="sd">    |      |  G2  | C2 | A2  |  B2 |      |       |    |      |</span>
<span class="sd">    +------+------+----+-----+-----+------+-------+----+------+</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="nb">type</span> <span class="o">=</span> <span class="s1">&#39;DMIG&#39;</span>
    <span class="n">_properties</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;is_real&#39;</span><span class="p">,</span> <span class="s1">&#39;is_complex&#39;</span><span class="p">,</span> <span class="s1">&#39;is_polar&#39;</span><span class="p">,</span> <span class="s1">&#39;matrix_type&#39;</span><span class="p">,</span> <span class="s1">&#39;shape&#39;</span><span class="p">,</span>
                   <span class="s1">&#39;tin_dtype&#39;</span><span class="p">,</span> <span class="s1">&#39;tout_dtype&#39;</span><span class="p">]</span>

    <span class="c1">#@classmethod</span>
    <span class="c1">#def _init_from_empty(cls):</span>
        <span class="c1">#name = &#39;name&#39;</span>
        <span class="c1">#ifo = 1</span>
        <span class="c1">#tin = 1</span>
        <span class="c1">#tout = 1</span>
        <span class="c1">#polar = 0</span>
        <span class="c1">#ncols = 1</span>
        <span class="c1">#GCj = []</span>
        <span class="c1">#GCi = []</span>
        <span class="c1">#Real = []</span>
        <span class="c1">#return DMIG(name, ifo, tin, tout, polar, ncols, GCj, GCi, Real,</span>
                    <span class="c1">#Complex=None, comment=&#39;&#39;, finalize=True)</span>

<div class="viewcode-block" id="DMIG.export_to_hdf5"><a class="viewcode-back" href="../../../../reference/bdf/cards/pyNastran.bdf.cards.dmig.html#pyNastran.bdf.cards.dmig.DMIG.export_to_hdf5">[docs]</a>    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">export_to_hdf5</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">h5_file</span><span class="p">,</span> <span class="n">model</span><span class="p">,</span> <span class="n">encoding</span><span class="p">):</span>
        <span class="n">_export_dmig_to_hdf5</span><span class="p">(</span><span class="n">h5_file</span><span class="p">,</span> <span class="n">model</span><span class="p">,</span> <span class="n">model</span><span class="o">.</span><span class="n">dmig</span><span class="p">,</span> <span class="n">encoding</span><span class="p">)</span></div>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">ifo</span><span class="p">,</span> <span class="n">tin</span><span class="p">,</span> <span class="n">tout</span><span class="p">,</span> <span class="n">polar</span><span class="p">,</span> <span class="n">ncols</span><span class="p">,</span>
                 <span class="n">GCj</span><span class="p">,</span> <span class="n">GCi</span><span class="p">,</span> <span class="n">Real</span><span class="p">,</span> <span class="n">Complex</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">comment</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">finalize</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Creates a DMIG card</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        name : str</span>
<span class="sd">            the name of the matrix</span>
<span class="sd">        ifo : int</span>
<span class="sd">            matrix shape</span>
<span class="sd">            4=Lower Triangular</span>
<span class="sd">            5=Upper Triangular</span>
<span class="sd">            6=Symmetric</span>
<span class="sd">            8=Identity (m=nRows, n=m)</span>
<span class="sd">        tin : int</span>
<span class="sd">            matrix input precision</span>
<span class="sd">            1=Real, Single Precision</span>
<span class="sd">            2=Real, Double Precision</span>
<span class="sd">            3=Complex, Single Precision</span>
<span class="sd">            4=Complex, Double Precision</span>
<span class="sd">        tout : int</span>
<span class="sd">            matrix output precision</span>
<span class="sd">            0=same as tin</span>
<span class="sd">            1=Real, Single Precision</span>
<span class="sd">            2=Real, Double Precision</span>
<span class="sd">            3=Complex, Single Precision</span>
<span class="sd">            4=Complex, Double Precision</span>
<span class="sd">        polar : int; default=0</span>
<span class="sd">            Input format of Ai, Bi</span>
<span class="sd">            Integer=blank or 0 indicates real, imaginary format</span>
<span class="sd">            Integer &gt; 0 indicates amplitude, phase format</span>
<span class="sd">        ncols : int</span>
<span class="sd">            ???</span>
<span class="sd">        GCj  : List[(node, dof)]</span>
<span class="sd">            the [jnode, jDOFs]</span>
<span class="sd">        GCi  : List[(node, dof)]</span>
<span class="sd">            the inode, iDOFs</span>
<span class="sd">        Real : List[float]</span>
<span class="sd">            The real values</span>
<span class="sd">        Complex : List[float]; default=None</span>
<span class="sd">            The complex values (if the matrix is complex)</span>
<span class="sd">        comment : str; default=&#39;&#39;</span>
<span class="sd">            a comment for the card</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">NastranMatrix</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">ifo</span><span class="p">,</span> <span class="n">tin</span><span class="p">,</span> <span class="n">tout</span><span class="p">,</span> <span class="n">polar</span><span class="p">,</span> <span class="n">ncols</span><span class="p">,</span>
                               <span class="n">GCj</span><span class="p">,</span> <span class="n">GCi</span><span class="p">,</span> <span class="n">Real</span><span class="p">,</span> <span class="n">Complex</span><span class="p">,</span> <span class="n">comment</span><span class="o">=</span><span class="n">comment</span><span class="p">,</span>
                               <span class="n">finalize</span><span class="o">=</span><span class="n">finalize</span><span class="p">)</span></div>


<div class="viewcode-block" id="DMIAX"><a class="viewcode-back" href="../../../../reference/bdf/cards/pyNastran.bdf.cards.dmig.html#pyNastran.bdf.cards.dmig.DMIAX">[docs]</a><span class="k">class</span> <span class="nc">DMIAX</span><span class="p">(</span><span class="n">BaseCard</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Direct Matrix Input for Axisymmetric Analysis</span>

<span class="sd">    Defines axisymmetric (fluid or structure) related direct input matrix</span>
<span class="sd">    terms.  The matrix is defined by a single header entry and one or</span>
<span class="sd">    more column entries. Only one header entry is required. A column</span>
<span class="sd">    entry is required for each column with nonzero elements.</span>

<span class="sd">    +-------+------+----+--------+------+--------+-------+----+------+</span>
<span class="sd">    |   1   |  2   | 3  |    4   |   5  |   6    |   7   | 8  |  9   |</span>
<span class="sd">    +=======+======+====+========+======+========+=======+====+======+</span>
<span class="sd">    | DMIAX | NAME | 0  |   IFO  | TIN  |  TOUT  |       |    |      |</span>
<span class="sd">    +-------+------+----+--------+------+--------+-------+----+------+</span>

<span class="sd">    +-------+------+----+--------+------+--------+-------+----+------+</span>
<span class="sd">    |   1   |  2   | 3  |    4   |   5  |   6    |   7   | 8  |  9   |</span>
<span class="sd">    +=======+======+====+========+======+========+=======+====+======+</span>
<span class="sd">    | DMIAX | NAME | GJ |   CJ   |  NJ  |        |       |    |      |</span>
<span class="sd">    +-------+------+----+--------+------+--------+-------+----+------+</span>
<span class="sd">    |       |  G1  | C1 |   N1   |  A1  |   B1   |       |    |      |</span>
<span class="sd">    +-------+------+----+--------+------+--------+-------+----+------+</span>
<span class="sd">    |       |  G2  | C2 |  etc.  |      |        |       |    |      |</span>
<span class="sd">    +-------+------+----+--------+------+--------+-------+----+------+</span>

<span class="sd">    +-------+------+----+--------+------+--------+-------+----+------+</span>
<span class="sd">    |   1   |  2   | 3  |    4   |   5  |   6    |   7   | 8  |  9   |</span>
<span class="sd">    +=======+======+====+========+======+========+=======+====+======+</span>
<span class="sd">    | DMIAX | B2PP | 0  |   1    |  3   |        |       |    |      |</span>
<span class="sd">    +-------+------+----+--------+------+--------+-------+----+------+</span>
<span class="sd">    | DMIAX | B2PP | 32 |        |      |        |       |    |      |</span>
<span class="sd">    +-------+------+----+--------+------+--------+-------+----+------+</span>
<span class="sd">    |       | 1027 | 3  | 4.25+6 |      | 2.27+3 |       |    |      |</span>
<span class="sd">    +-------+------+----+--------+------+--------+-------+----+------+</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="nb">type</span> <span class="o">=</span> <span class="s1">&#39;DMIAX&#39;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">matrix_form</span><span class="p">,</span> <span class="n">tin</span><span class="p">,</span> <span class="n">tout</span><span class="p">,</span> <span class="n">ncols</span><span class="p">,</span>
                 <span class="n">GCNj</span><span class="p">,</span> <span class="n">GCNi</span><span class="p">,</span> <span class="n">Real</span><span class="p">,</span> <span class="n">Complex</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">comment</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Creates a DMIAX card</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        name : str</span>
<span class="sd">            the name of the matrix</span>
<span class="sd">        matrix_form : int</span>
<span class="sd">            matrix shape</span>
<span class="sd">            1=Square</span>
<span class="sd">            2=General Rectangular</span>
<span class="sd">            6=Symmetric</span>
<span class="sd">        tin : int</span>
<span class="sd">            matrix input precision</span>
<span class="sd">            1=Real, Single Precision</span>
<span class="sd">            3=Complex, Single Precision</span>
<span class="sd">        tout : int</span>
<span class="sd">            matrix output precision</span>
<span class="sd">            1=Real, Single Precision</span>
<span class="sd">            2=Real, Double Precision</span>
<span class="sd">            3=Complex, Single Precision</span>
<span class="sd">            4=Complex, Double Precision</span>
<span class="sd">        GCNj  : List[(node, dof, harmonic_number)]???</span>
<span class="sd">            the jnode, jDOFs</span>
<span class="sd">        GCNi  : List[(node, dof, harmonic_number)]???</span>
<span class="sd">            the inode, iDOFs</span>
<span class="sd">        Real : List[float]???</span>
<span class="sd">            The real values</span>
<span class="sd">        Complex : List[float]???; default=None</span>
<span class="sd">            The complex values (if the matrix is complex)</span>
<span class="sd">        comment : str; default=&#39;&#39;</span>
<span class="sd">            a comment for the card</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">ncols</span> <span class="o">=</span> <span class="kc">None</span>

        <span class="k">if</span> <span class="n">comment</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">comment</span> <span class="o">=</span> <span class="n">comment</span>

        <span class="k">if</span> <span class="n">Complex</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">Complex</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="k">if</span> <span class="n">tout</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">tout</span> <span class="o">=</span> <span class="mi">0</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">name</span>

        <span class="c1">#: ifo/4-Lower Triangular; 5=Upper Triangular; 6=Symmetric; 8=Identity (m=nRows, n=m)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">matrix_form</span> <span class="o">=</span> <span class="n">matrix_form</span>

        <span class="c1">#: 1-Real, Single Precision; 2=Real,Double Precision;</span>
        <span class="c1">#  3=Complex, Single; 4=Complex, Double</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tin</span> <span class="o">=</span> <span class="n">tin</span>

        <span class="c1">#: 0-Set by cell precision</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tout</span> <span class="o">=</span> <span class="n">tout</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">ncols</span> <span class="o">=</span> <span class="n">ncols</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">GCNj</span> <span class="o">=</span> <span class="n">GCNj</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">GCNi</span> <span class="o">=</span> <span class="n">GCNi</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">Real</span> <span class="o">=</span> <span class="n">Real</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">Complex</span><span class="p">)</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_complex</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">Complex</span> <span class="o">=</span> <span class="n">Complex</span>
            <span class="k">if</span> <span class="n">matrix_form</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">1</span><span class="p">]:</span>  <span class="c1">#4, 5, 6, 8</span>
                <span class="n">msg</span> <span class="o">=</span> <span class="p">(</span>
                    <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">type</span><span class="si">}</span><span class="s1"> name=</span><span class="si">{</span><span class="n">name</span><span class="si">!r}</span><span class="s1"> matrix_form=</span><span class="si">{</span><span class="n">matrix_form</span><span class="si">!r}</span><span class="s1"> &#39;</span>
                    <span class="s1">&#39;must be [1, 2, 6]</span><span class="se">\n</span><span class="s1">&#39;</span>
                    <span class="s1">&#39;  1: Square</span><span class="se">\n</span><span class="s1">&#39;</span>
                    <span class="s1">&#39;  2: General Rectangular</span><span class="se">\n</span><span class="s1">&#39;</span>
                    <span class="s1">&#39;  4: Lower Triangular</span><span class="se">\n</span><span class="s1">&#39;</span>
                    <span class="s1">&#39;  5: Upper Triangular</span><span class="se">\n</span><span class="s1">&#39;</span>
                    <span class="s1">&#39;  6: Symmetric</span><span class="se">\n</span><span class="s1">&#39;</span>
                    <span class="s1">&#39;  8: Identity (m=nRows, n=m)</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>

        <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">matrix_form</span><span class="p">,</span> <span class="n">integer_types</span><span class="p">),</span> <span class="s1">&#39;matrix_form=</span><span class="si">%r</span><span class="s1"> type=</span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">matrix_form</span><span class="p">,</span> <span class="nb">type</span><span class="p">(</span><span class="n">matrix_form</span><span class="p">))</span>
        <span class="k">assert</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">matrix_form</span><span class="p">,</span> <span class="nb">bool</span><span class="p">),</span> <span class="s1">&#39;matrix_form=</span><span class="si">%r</span><span class="s1"> type=</span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">matrix_form</span><span class="p">,</span> <span class="nb">type</span><span class="p">(</span><span class="n">matrix_form</span><span class="p">))</span>

<div class="viewcode-block" id="DMIAX.finalize"><a class="viewcode-back" href="../../../../reference/bdf/cards/pyNastran.bdf.cards.dmig.html#pyNastran.bdf.cards.dmig.DMIAX.finalize">[docs]</a>    <span class="k">def</span> <span class="nf">finalize</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;converts the lists into numpy arrays&quot;&quot;&quot;</span>
        <span class="k">return</span>
        <span class="c1">#self.GCi = np.asarray(self.GCi)</span>
        <span class="c1">#self.GCj = np.asarray(self.GCj)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Real</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Real</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_complex</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">Complex</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Complex</span><span class="p">)</span></div>

<div class="viewcode-block" id="DMIAX.export_to_hdf5"><a class="viewcode-back" href="../../../../reference/bdf/cards/pyNastran.bdf.cards.dmig.html#pyNastran.bdf.cards.dmig.DMIAX.export_to_hdf5">[docs]</a>    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">export_to_hdf5</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">h5_file</span><span class="p">,</span> <span class="n">model</span><span class="p">,</span> <span class="n">encoding</span><span class="p">):</span>
        <span class="n">_export_dmiax_to_hdf5</span><span class="p">(</span><span class="n">h5_file</span><span class="p">,</span> <span class="n">model</span><span class="p">,</span> <span class="n">model</span><span class="o">.</span><span class="n">dmiax</span><span class="p">,</span> <span class="n">encoding</span><span class="p">)</span></div>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">is_real</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;is the matrix real?&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">tin</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]:</span>
            <span class="k">return</span> <span class="kc">True</span>
        <span class="k">return</span> <span class="kc">False</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">is_complex</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;is the matrix complex&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_real</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">is_polar</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;is the matrix polar (vs real/imag)?&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="kc">False</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">tin_dtype</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;gets the input dtype&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">_get_dtype</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">is_complex</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">tin</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">tout_dtype</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;gets the output dtype&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">_get_dtype</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">is_complex</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">tout</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">matrix_type</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;gets the matrix type&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">matrix_form</span><span class="p">,</span> <span class="n">integer_types</span><span class="p">):</span>
            <span class="n">msg</span> <span class="o">=</span> <span class="s1">&#39;ifo must be an integer; matrix_form=</span><span class="si">%r</span><span class="s1"> type=</span><span class="si">%s</span><span class="s1"> name=</span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">matrix_form</span><span class="p">,</span> <span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">matrix_form</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">matrix_form</span><span class="p">,</span> <span class="nb">bool</span><span class="p">):</span>
            <span class="n">msg</span> <span class="o">=</span> <span class="s1">&#39;matrix_form must not be a boolean; matrix_form=</span><span class="si">%r</span><span class="s1"> type=</span><span class="si">%s</span><span class="s1"> name=</span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">matrix_form</span><span class="p">,</span> <span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">matrix_form</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">matrix_form</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">matrix_type</span> <span class="o">=</span> <span class="s1">&#39;square&#39;</span>
        <span class="c1">#elif self.matrix_form == 6:</span>
            <span class="c1">#matrix_type = &#39;symmetric&#39;</span>
        <span class="c1">#elif self.matrix_form in [2, 9]:</span>
            <span class="c1">#matrix_type = &#39;rectangular&#39;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># technically right, but nulling this will fix bad decks</span>
            <span class="c1">#self.ncols = blank(card, 8, &#39;matrix_form=%s; ncol&#39; % self.matrix_form)</span>
            <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">type</span><span class="si">}</span><span class="s1"> matrix_form=</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">matrix_form</span><span class="si">}</span><span class="s1"> &#39;</span>
                                      <span class="s1">&#39;is not supported&#39;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">matrix_type</span>

<div class="viewcode-block" id="DMIAX.add_card"><a class="viewcode-back" href="../../../../reference/bdf/cards/pyNastran.bdf.cards.dmig.html#pyNastran.bdf.cards.dmig.DMIAX.add_card">[docs]</a>    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">add_card</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">card</span><span class="p">,</span> <span class="n">comment</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Adds a NastranMatrix (DMIAX) card from ``BDF.add_card(...)``</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        card : BDFCard()</span>
<span class="sd">            a BDFCard object</span>
<span class="sd">        comment : str; default=&#39;&#39;</span>
<span class="sd">            a comment for the card</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">name</span> <span class="o">=</span> <span class="n">string</span><span class="p">(</span><span class="n">card</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;name&#39;</span><span class="p">)</span>
        <span class="c1">#zero</span>

        <span class="n">matrix_form</span> <span class="o">=</span> <span class="n">integer</span><span class="p">(</span><span class="n">card</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="s1">&#39;ifo&#39;</span><span class="p">)</span>
        <span class="n">tin</span> <span class="o">=</span> <span class="n">integer</span><span class="p">(</span><span class="n">card</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="s1">&#39;tin&#39;</span><span class="p">)</span>
        <span class="n">tout</span> <span class="o">=</span> <span class="n">integer_or_blank</span><span class="p">(</span><span class="n">card</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="s1">&#39;tout&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">matrix_form</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span> <span class="c1"># square</span>
            <span class="n">ncols</span> <span class="o">=</span> <span class="n">integer_or_blank</span><span class="p">(</span><span class="n">card</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="s1">&#39;matrix_form=</span><span class="si">%s</span><span class="s1">; ncol&#39;</span> <span class="o">%</span> <span class="n">matrix_form</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">matrix_form</span> <span class="o">==</span> <span class="mi">6</span><span class="p">:</span> <span class="c1"># symmetric</span>
            <span class="n">ncols</span> <span class="o">=</span> <span class="n">integer_or_blank</span><span class="p">(</span><span class="n">card</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="s1">&#39;matrix_form=</span><span class="si">%s</span><span class="s1">; ncol&#39;</span> <span class="o">%</span> <span class="n">matrix_form</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">matrix_form</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">9</span><span class="p">]:</span> <span class="c1"># rectangular</span>
            <span class="n">ncols</span> <span class="o">=</span> <span class="n">integer</span><span class="p">(</span><span class="n">card</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="s1">&#39;matrix_form=</span><span class="si">%s</span><span class="s1">; ncol&#39;</span> <span class="o">%</span> <span class="n">matrix_form</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># technically right, but nulling this will fix bad decks</span>
            <span class="c1">#self.ncols = blank(card, 8, &#39;matrix_form=%s; ncol&#39; % self.matrix_form)</span>
            <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="s1">&#39;matrix_form=</span><span class="si">%s</span><span class="s1"> is not supported&#39;</span> <span class="o">%</span> <span class="n">matrix_form</span><span class="p">)</span>

        <span class="n">GCj</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">GCi</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">Real</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">Complex</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">return</span> <span class="n">DMIAX</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">matrix_form</span><span class="p">,</span> <span class="n">tin</span><span class="p">,</span> <span class="n">tout</span><span class="p">,</span> <span class="n">ncols</span><span class="p">,</span>
                     <span class="n">GCj</span><span class="p">,</span> <span class="n">GCi</span><span class="p">,</span> <span class="n">Real</span><span class="p">,</span> <span class="n">Complex</span><span class="p">,</span> <span class="n">comment</span><span class="o">=</span><span class="n">comment</span><span class="p">)</span></div>

    <span class="k">def</span> <span class="nf">_add_column</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">card</span><span class="p">,</span> <span class="n">comment</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">comment</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;_comment&#39;</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">comment</span> <span class="o">+=</span> <span class="n">comment</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">comment</span> <span class="o">=</span> <span class="n">comment</span>

        <span class="n">unused_name</span> <span class="o">=</span> <span class="n">string</span><span class="p">(</span><span class="n">card</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;name&#39;</span><span class="p">)</span>

        <span class="n">Gj</span> <span class="o">=</span> <span class="n">integer</span><span class="p">(</span><span class="n">card</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;Gj&#39;</span><span class="p">)</span>
        <span class="c1"># Cj = integer(card, 3, &#39;Cj&#39;)</span>
        <span class="n">Cj</span> <span class="o">=</span> <span class="n">integer_or_blank</span><span class="p">(</span><span class="n">card</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="s1">&#39;Cj&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
        <span class="c1">#Cj = parse_components(card, 3, &#39;Cj&#39;)</span>
        <span class="n">Nj</span> <span class="o">=</span> <span class="n">integer_or_blank</span><span class="p">(</span><span class="n">card</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="s1">&#39;Nj&#39;</span><span class="p">)</span>

        <span class="k">assert</span> <span class="mi">0</span> <span class="o">&lt;=</span> <span class="n">Cj</span> <span class="o">&lt;=</span> <span class="mi">6</span><span class="p">,</span> <span class="s1">&#39;C</span><span class="si">%i</span><span class="s1"> must be between [0, 6]; Cj=</span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">Cj</span><span class="p">)</span>

        <span class="n">nfields</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">card</span><span class="p">)</span>
        <span class="c1">#print(&quot;nfields = %i&quot; % nfields)</span>
        <span class="c1">#print(&quot;card[5:] =&quot;, card[5:])</span>
        <span class="c1">#print(&quot;(nfields - 5) %% 4 = %i&quot; % ((nfields - 5) % 4))</span>

        <span class="n">nloops</span> <span class="o">=</span> <span class="p">(</span><span class="n">nfields</span> <span class="o">-</span> <span class="mi">8</span><span class="p">)</span> <span class="o">//</span> <span class="mi">8</span>
        <span class="k">if</span> <span class="n">nfields</span> <span class="o">-</span> <span class="mi">8</span> <span class="o">%</span> <span class="mi">8</span><span class="p">:</span>
            <span class="n">nloops</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="c1">#assert nfields &lt;= 8,&#39;nfields=%s&#39; % nfields</span>
        <span class="c1">#print(&quot;nloops = %i&quot; % nloops)</span>
        <span class="k">assert</span> <span class="n">nloops</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;nloops=</span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">nloops</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">GCNj</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">Gj</span><span class="p">,</span> <span class="n">Cj</span><span class="p">,</span> <span class="n">Nj</span><span class="p">))</span>
        <span class="n">GCNi</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">GCNi</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">GCNi</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_complex</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nloops</span><span class="p">):</span>
                <span class="c1">#print(dir(card))</span>
                <span class="n">n</span> <span class="o">=</span> <span class="mi">9</span> <span class="o">+</span> <span class="mi">8</span> <span class="o">*</span> <span class="n">i</span>
                <span class="n">Gi</span> <span class="o">=</span> <span class="n">integer</span><span class="p">(</span><span class="n">card</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="sa">f</span><span class="s1">&#39;Gi</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
                <span class="c1"># Ci = integer(card, n + 1, &#39;Ci&#39;)</span>
                <span class="n">Ci</span> <span class="o">=</span> <span class="n">integer_or_blank</span><span class="p">(</span><span class="n">card</span><span class="p">,</span> <span class="n">n</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="sa">f</span><span class="s1">&#39;Ci</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
                <span class="c1">#Ci = parse_components(card, n + 1, &#39;Ci&#39;)</span>
                <span class="n">Ni</span> <span class="o">=</span> <span class="n">integer_or_blank</span><span class="p">(</span><span class="n">card</span><span class="p">,</span> <span class="n">n</span> <span class="o">+</span> <span class="mi">2</span><span class="p">,</span> <span class="sa">f</span><span class="s1">&#39;Ni</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>

                <span class="k">assert</span> <span class="mi">0</span> <span class="o">&lt;=</span> <span class="n">Ci</span> <span class="o">&lt;=</span> <span class="mi">6</span><span class="p">,</span> <span class="s1">&#39;C</span><span class="si">%i</span><span class="s1"> must be between [0, 6]; Ci=</span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">Ci</span><span class="p">)</span>
                <span class="n">GCNi</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">Gi</span><span class="p">,</span> <span class="n">Ci</span><span class="p">,</span> <span class="n">Ni</span><span class="p">))</span>
                <span class="n">reali</span> <span class="o">=</span> <span class="n">double</span><span class="p">(</span><span class="n">card</span><span class="p">,</span> <span class="n">n</span> <span class="o">+</span> <span class="mi">3</span><span class="p">,</span> <span class="s1">&#39;real&#39;</span><span class="p">)</span>
                <span class="n">complexi</span> <span class="o">=</span> <span class="n">double</span><span class="p">(</span><span class="n">card</span><span class="p">,</span> <span class="n">n</span> <span class="o">+</span> <span class="mi">4</span><span class="p">,</span> <span class="s1">&#39;complex&#39;</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">Real</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">reali</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">Complex</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">complexi</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># real</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nloops</span><span class="p">):</span>
                <span class="n">n</span> <span class="o">=</span> <span class="mi">9</span> <span class="o">+</span> <span class="mi">9</span> <span class="o">*</span> <span class="n">i</span>
                <span class="n">Gi</span> <span class="o">=</span> <span class="n">integer</span><span class="p">(</span><span class="n">card</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="s1">&#39;Gi&#39;</span><span class="p">)</span>
                <span class="c1"># Ci = integer(card, n + 1, &#39;Ci&#39;)</span>
                <span class="n">Ci</span> <span class="o">=</span> <span class="n">integer_or_blank</span><span class="p">(</span><span class="n">card</span><span class="p">,</span> <span class="n">n</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;Ci&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
                <span class="c1">#Ci = parse_components(card, n + 1, &#39;Ci&#39;)</span>
                <span class="n">Ni</span> <span class="o">=</span> <span class="n">integer</span><span class="p">(</span><span class="n">card</span><span class="p">,</span> <span class="n">n</span> <span class="o">+</span> <span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;Ni&#39;</span><span class="p">)</span>

                <span class="k">assert</span> <span class="mi">0</span> <span class="o">&lt;=</span> <span class="n">Ci</span> <span class="o">&lt;=</span> <span class="mi">6</span><span class="p">,</span> <span class="s1">&#39;C</span><span class="si">%i</span><span class="s1"> must be between [0, 6]; Ci=</span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">Ci</span><span class="p">)</span>
                <span class="n">reali</span> <span class="o">=</span> <span class="n">double</span><span class="p">(</span><span class="n">card</span><span class="p">,</span> <span class="n">n</span> <span class="o">+</span> <span class="mi">3</span><span class="p">,</span> <span class="s1">&#39;real&#39;</span><span class="p">)</span>
                <span class="n">GCNi</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">Gi</span><span class="p">,</span> <span class="n">Ci</span><span class="p">,</span> <span class="n">Ni</span><span class="p">))</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">Real</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">reali</span><span class="p">)</span>
                <span class="c1">#print(&quot;GC=%s,%s real=%s&quot; % (Gi, Ci, reali))</span>

        <span class="n">msg</span> <span class="o">=</span> <span class="s1">&#39;(len(GCNj)=</span><span class="si">%s</span><span class="s1"> len(GCNi)=</span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">GCNj</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">GCNi</span><span class="p">))</span>
        <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">GCNj</span><span class="p">)</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">GCNi</span><span class="p">),</span> <span class="n">msg</span>
        <span class="c1">#if self.is_complex:</span>
            <span class="c1">#self.Complex(double(card, v, &#39;complex&#39;)</span>

<div class="viewcode-block" id="DMIAX.raw_fields"><a class="viewcode-back" href="../../../../reference/bdf/cards/pyNastran.bdf.cards.dmig.html#pyNastran.bdf.cards.dmig.DMIAX.raw_fields">[docs]</a>    <span class="k">def</span> <span class="nf">raw_fields</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">list_fields</span> <span class="o">=</span> <span class="p">[</span>
            <span class="s1">&#39;DMIAX&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">matrix_form</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">tin</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">ncols</span><span class="p">,</span>
        <span class="p">]</span>
        <span class="n">k</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_real</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">GCNj</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">GCNj</span><span class="p">):</span>
                <span class="n">gj</span><span class="p">,</span> <span class="n">cj</span><span class="p">,</span> <span class="n">nj</span> <span class="o">=</span> <span class="n">GCNj</span>
                <span class="n">list_fields</span> <span class="o">+=</span> <span class="p">[</span><span class="s1">&#39;DMIAX&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">gj</span><span class="p">,</span> <span class="n">cj</span><span class="p">,</span> <span class="n">nj</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">]</span>
                <span class="k">for</span> <span class="n">unused_j</span><span class="p">,</span> <span class="n">GCNi</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">GCNi</span><span class="p">[</span><span class="n">i</span><span class="p">]):</span>
                    <span class="n">gi</span><span class="p">,</span> <span class="n">ci</span><span class="p">,</span> <span class="n">ni</span> <span class="o">=</span> <span class="n">GCNi</span>
                    <span class="n">reali</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">Real</span><span class="p">[</span><span class="n">k</span><span class="p">]</span>
                    <span class="n">list_fields</span> <span class="o">+=</span> <span class="p">[</span><span class="n">gi</span><span class="p">,</span> <span class="n">ci</span><span class="p">,</span> <span class="n">ni</span><span class="p">,</span> <span class="n">reali</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">]</span>
                    <span class="n">k</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">GCNj</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">GCNj</span><span class="p">):</span>
                <span class="n">gj</span><span class="p">,</span> <span class="n">cj</span><span class="p">,</span> <span class="n">nj</span> <span class="o">=</span> <span class="n">GCNj</span>
                <span class="n">list_fields</span> <span class="o">+=</span> <span class="p">[</span><span class="s1">&#39;DMIAX&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">gj</span><span class="p">,</span> <span class="n">cj</span><span class="p">,</span> <span class="n">nj</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">]</span>
                <span class="k">for</span> <span class="n">unused_j</span><span class="p">,</span> <span class="n">GCNi</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">GCNi</span><span class="p">[</span><span class="n">i</span><span class="p">]):</span>
                    <span class="n">gi</span><span class="p">,</span> <span class="n">ci</span><span class="p">,</span> <span class="n">ni</span> <span class="o">=</span> <span class="n">GCNi</span>
                    <span class="n">reali</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">Real</span><span class="p">[</span><span class="n">k</span><span class="p">]</span>
                    <span class="n">imagi</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">Complex</span><span class="p">[</span><span class="n">k</span><span class="p">]</span>
                    <span class="n">list_fields</span> <span class="o">+=</span> <span class="p">[</span><span class="n">gi</span><span class="p">,</span> <span class="n">ci</span><span class="p">,</span> <span class="n">ni</span><span class="p">,</span> <span class="n">reali</span><span class="p">,</span> <span class="n">imagi</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">]</span>
                    <span class="n">k</span> <span class="o">+=</span> <span class="mi">1</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">write_card</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">list_fields</span></div>

<div class="viewcode-block" id="DMIAX.write_card"><a class="viewcode-back" href="../../../../reference/bdf/cards/pyNastran.bdf.cards.dmig.html#pyNastran.bdf.cards.dmig.DMIAX.write_card">[docs]</a>    <span class="k">def</span> <span class="nf">write_card</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">size</span><span class="p">:</span> <span class="nb">int</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span> <span class="n">is_double</span><span class="p">:</span> <span class="nb">bool</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">tin</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">]:</span>
            <span class="n">is_double</span> <span class="o">=</span> <span class="kc">False</span>
            <span class="n">msg</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">write_card_8</span><span class="p">()</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">tin</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">]:</span>
            <span class="n">is_double</span> <span class="o">=</span> <span class="kc">True</span>
            <span class="n">size</span> <span class="o">=</span> <span class="mi">16</span>
            <span class="n">msg</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">write_card_16</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s1">&#39;tin=</span><span class="si">%r</span><span class="s1"> must be 1, 2, 3, or 4&#39;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">tin</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">msg</span></div>

<div class="viewcode-block" id="DMIAX.write_card_8"><a class="viewcode-back" href="../../../../reference/bdf/cards/pyNastran.bdf.cards.dmig.html#pyNastran.bdf.cards.dmig.DMIAX.write_card_8">[docs]</a>    <span class="k">def</span> <span class="nf">write_card_8</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;writes the card in small field format&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_write_card</span><span class="p">(</span><span class="n">print_card_8</span><span class="p">)</span></div>

<div class="viewcode-block" id="DMIAX.write_card_16"><a class="viewcode-back" href="../../../../reference/bdf/cards/pyNastran.bdf.cards.dmig.html#pyNastran.bdf.cards.dmig.DMIAX.write_card_16">[docs]</a>    <span class="k">def</span> <span class="nf">write_card_16</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;writes the card in small large format&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_write_card</span><span class="p">(</span><span class="n">print_card_16</span><span class="p">)</span></div>

<div class="viewcode-block" id="DMIAX._write_card"><a class="viewcode-back" href="../../../../reference/bdf/cards/pyNastran.bdf.cards.dmig.html#pyNastran.bdf.cards.dmig.DMIAX._write_card">[docs]</a>    <span class="k">def</span> <span class="nf">_write_card</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">func</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;writes the card&quot;&quot;&quot;</span>
        <span class="n">msg</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">$&#39;</span> <span class="o">+</span> <span class="s1">&#39;-&#39;</span> <span class="o">*</span> <span class="mi">80</span>
        <span class="n">msg</span> <span class="o">+=</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">$ DMIAX Matrix </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="n">list_fields</span> <span class="o">=</span> <span class="p">[</span>
            <span class="s1">&#39;DMIAX&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">matrix_form</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">tin</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">ncols</span><span class="p">,</span>
        <span class="p">]</span>
        <span class="n">msg</span> <span class="o">+=</span> <span class="n">func</span><span class="p">(</span><span class="n">list_fields</span><span class="p">)</span>
        <span class="n">k</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">GCNj</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_stats</span><span class="p">()</span>
        <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">GCNi</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_stats</span><span class="p">()</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_real</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">GCNj</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">GCNj</span><span class="p">):</span>
                <span class="n">gj</span><span class="p">,</span> <span class="n">cj</span><span class="p">,</span> <span class="n">nj</span> <span class="o">=</span> <span class="n">GCNj</span>
                <span class="n">list_fields</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;DMIAX&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">gj</span><span class="p">,</span> <span class="n">cj</span><span class="p">,</span> <span class="n">nj</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">]</span>
                <span class="k">for</span> <span class="n">unused_j</span><span class="p">,</span> <span class="n">GCNi</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">GCNi</span><span class="p">[</span><span class="n">i</span><span class="p">]):</span>
                    <span class="n">gi</span><span class="p">,</span> <span class="n">ci</span><span class="p">,</span> <span class="n">ni</span> <span class="o">=</span> <span class="n">GCNi</span>
                    <span class="n">reali</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">Real</span><span class="p">[</span><span class="n">k</span><span class="p">]</span>
                    <span class="n">list_fields</span> <span class="o">+=</span> <span class="p">[</span><span class="n">gi</span><span class="p">,</span> <span class="n">ci</span><span class="p">,</span> <span class="n">ni</span><span class="p">,</span> <span class="n">reali</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">]</span>
                    <span class="n">k</span> <span class="o">+=</span> <span class="mi">1</span>
                <span class="n">msg</span> <span class="o">+=</span> <span class="n">func</span><span class="p">(</span><span class="n">list_fields</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">GCNj</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">GCNj</span><span class="p">):</span>
                <span class="n">gj</span><span class="p">,</span> <span class="n">cj</span><span class="p">,</span> <span class="n">nj</span> <span class="o">=</span> <span class="n">GCNj</span>
                <span class="n">list_fields</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;DMIAX&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">gj</span><span class="p">,</span> <span class="n">cj</span><span class="p">,</span> <span class="n">nj</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">]</span>
                <span class="k">for</span> <span class="n">unused_j</span><span class="p">,</span> <span class="n">GCNi</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">GCNi</span><span class="p">[</span><span class="n">i</span><span class="p">]):</span>
                    <span class="n">gi</span><span class="p">,</span> <span class="n">ci</span><span class="p">,</span> <span class="n">ni</span> <span class="o">=</span> <span class="n">GCNi</span>
                    <span class="n">reali</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">Real</span><span class="p">[</span><span class="n">k</span><span class="p">]</span>
                    <span class="n">imagi</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">Complex</span><span class="p">[</span><span class="n">k</span><span class="p">]</span>
                    <span class="n">list_fields</span> <span class="o">+=</span> <span class="p">[</span><span class="n">gi</span><span class="p">,</span> <span class="n">ci</span><span class="p">,</span> <span class="n">ni</span><span class="p">,</span> <span class="n">reali</span><span class="p">,</span> <span class="n">imagi</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">]</span>
                    <span class="n">k</span> <span class="o">+=</span> <span class="mi">1</span>
                <span class="n">msg</span> <span class="o">+=</span> <span class="n">func</span><span class="p">(</span><span class="n">list_fields</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">msg</span></div>

    <span class="k">def</span> <span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">write_card</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span></div>

<div class="viewcode-block" id="DMIJ"><a class="viewcode-back" href="../../../../reference/bdf/cards/pyNastran.bdf.cards.dmig.html#pyNastran.bdf.cards.dmig.DMIJ">[docs]</a><span class="k">class</span> <span class="nc">DMIJ</span><span class="p">(</span><span class="n">NastranMatrix</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Direct Matrix Input at js-Set of the Aerodynamic Mesh</span>
<span class="sd">    Defines direct input matrices related to collation degrees-of-freedom</span>
<span class="sd">    (js-set) of aerodynamic mesh points for CAERO1, CAERO3, CAERO4 and CAERO5</span>
<span class="sd">    and for the slender body elements of CAERO2. These include W2GJ, FA2J and</span>
<span class="sd">    input pressures and downwashes associated with AEPRESS and AEDW entries.</span>
<span class="sd">    The matrix is described by a single header entry and one or more column</span>
<span class="sd">    entries. A column entry is required for each column with nonzero elements.</span>
<span class="sd">    For entering data for the interference elements of a CAERO2, use DMIJI</span>
<span class="sd">    or DMI.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="nb">type</span> <span class="o">=</span> <span class="s1">&#39;DMIJ&#39;</span>
    <span class="n">_properties</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;shape&#39;</span><span class="p">,</span> <span class="s1">&#39;ifo&#39;</span><span class="p">,</span> <span class="s1">&#39;is_real&#39;</span><span class="p">,</span> <span class="s1">&#39;is_complex&#39;</span><span class="p">,</span> <span class="s1">&#39;is_polar&#39;</span><span class="p">,</span> <span class="s1">&#39;matrix_type&#39;</span><span class="p">,</span>
                   <span class="s1">&#39;tin_dtype&#39;</span><span class="p">,</span> <span class="s1">&#39;tout_dtype&#39;</span><span class="p">]</span>

<div class="viewcode-block" id="DMIJ._init_from_empty"><a class="viewcode-back" href="../../../../reference/bdf/cards/pyNastran.bdf.cards.dmig.html#pyNastran.bdf.cards.dmig.DMIJ._init_from_empty">[docs]</a>    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">_init_from_empty</span><span class="p">(</span><span class="bp">cls</span><span class="p">):</span>
        <span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;name&#39;</span>
        <span class="n">ifo</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="n">tin</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="n">tout</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="n">polar</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">ncols</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="n">GCj</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">GCi</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">Real</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">return</span> <span class="n">DMIJ</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">ifo</span><span class="p">,</span> <span class="n">tin</span><span class="p">,</span> <span class="n">tout</span><span class="p">,</span> <span class="n">polar</span><span class="p">,</span> <span class="n">ncols</span><span class="p">,</span> <span class="n">GCj</span><span class="p">,</span> <span class="n">GCi</span><span class="p">,</span> <span class="n">Real</span><span class="p">,</span>
                    <span class="n">Complex</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">comment</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">finalize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></div>

<div class="viewcode-block" id="DMIJ.export_to_hdf5"><a class="viewcode-back" href="../../../../reference/bdf/cards/pyNastran.bdf.cards.dmig.html#pyNastran.bdf.cards.dmig.DMIJ.export_to_hdf5">[docs]</a>    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">export_to_hdf5</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">h5_file</span><span class="p">,</span> <span class="n">model</span><span class="p">,</span> <span class="n">encoding</span><span class="p">):</span>
        <span class="n">_export_dmig_to_hdf5</span><span class="p">(</span><span class="n">h5_file</span><span class="p">,</span> <span class="n">model</span><span class="p">,</span> <span class="n">model</span><span class="o">.</span><span class="n">dmij</span><span class="p">,</span> <span class="n">encoding</span><span class="p">)</span></div>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">matrix_form</span><span class="p">,</span> <span class="n">tin</span><span class="p">,</span> <span class="n">tout</span><span class="p">,</span> <span class="n">polar</span><span class="p">,</span> <span class="n">ncols</span><span class="p">,</span>
                 <span class="n">GCj</span><span class="p">,</span> <span class="n">GCi</span><span class="p">,</span> <span class="n">Real</span><span class="p">,</span> <span class="n">Complex</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">comment</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span>
                 <span class="n">finalize</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Creates a DMIJ card</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        name : str</span>
<span class="sd">            the name of the matrix</span>
<span class="sd">        matrix_form : int</span>
<span class="sd">            matrix shape</span>
<span class="sd">            4=Lower Triangular</span>
<span class="sd">            5=Upper Triangular</span>
<span class="sd">            6=Symmetric</span>
<span class="sd">            8=Identity (m=nRows, n=m)</span>
<span class="sd">        tin : int</span>
<span class="sd">            matrix input precision</span>
<span class="sd">            1=Real, Single Precision</span>
<span class="sd">            2=Real, Double Precision</span>
<span class="sd">            3=Complex, Single Precision</span>
<span class="sd">            4=Complex, Double Precision</span>
<span class="sd">        tout : int</span>
<span class="sd">            matrix output precision</span>
<span class="sd">            0=same as tin</span>
<span class="sd">            1=Real, Single Precision</span>
<span class="sd">            2=Real, Double Precision</span>
<span class="sd">            3=Complex, Single Precision</span>
<span class="sd">            4=Complex, Double Precision</span>
<span class="sd">        polar : int; default=0</span>
<span class="sd">            Input format of Ai, Bi</span>
<span class="sd">            Integer=blank or 0 indicates real, imaginary format</span>
<span class="sd">            Integer &gt; 0 indicates amplitude, phase format</span>
<span class="sd">        ncols : int</span>
<span class="sd">            ???</span>
<span class="sd">        GCj  : List[(node, dof)]???</span>
<span class="sd">            the jnode, jDOFs</span>
<span class="sd">        GCi  : List[(node, dof)]???</span>
<span class="sd">            the inode, iDOFs</span>
<span class="sd">        Real : List[float]???</span>
<span class="sd">            The real values</span>
<span class="sd">        Complex : List[float]???; default=None</span>
<span class="sd">            The complex values (if the matrix is complex)</span>
<span class="sd">        comment : str; default=&#39;&#39;</span>
<span class="sd">            a comment for the card</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">NastranMatrix</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">matrix_form</span><span class="p">,</span> <span class="n">tin</span><span class="p">,</span> <span class="n">tout</span><span class="p">,</span> <span class="n">polar</span><span class="p">,</span> <span class="n">ncols</span><span class="p">,</span>
                               <span class="n">GCj</span><span class="p">,</span> <span class="n">GCi</span><span class="p">,</span> <span class="n">Real</span><span class="p">,</span> <span class="n">Complex</span><span class="p">,</span> <span class="n">comment</span><span class="o">=</span><span class="n">comment</span><span class="p">,</span>
                               <span class="n">finalize</span><span class="o">=</span><span class="n">finalize</span><span class="p">)</span></div>


<div class="viewcode-block" id="DMIJI"><a class="viewcode-back" href="../../../../reference/bdf/cards/pyNastran.bdf.cards.dmig.html#pyNastran.bdf.cards.dmig.DMIJI">[docs]</a><span class="k">class</span> <span class="nc">DMIJI</span><span class="p">(</span><span class="n">NastranMatrix</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Direct Matrix Input at js-Set of the Interference Body</span>
<span class="sd">    Defines direct input matrices related to collation degrees-of-freedom</span>
<span class="sd">    (js-set) of aerodynamic mesh points for the interference elements of CAERO2.</span>
<span class="sd">    These include W2GJ, FA2J and input pressures and downwashes associated with</span>
<span class="sd">    AEPRESS and AEDW entries. The matrix is described by a single header entry</span>
<span class="sd">    and one or more column entries. A column entry is required for each column</span>
<span class="sd">    with nonzero elements.  For entering data for the slender elements of a</span>
<span class="sd">    CAERO2, or a CAERO1, 3, 4 or 5 use DMIJ or DMI.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="nb">type</span> <span class="o">=</span> <span class="s1">&#39;DMIJI&#39;</span>
    <span class="n">_properties</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;shape&#39;</span><span class="p">,</span> <span class="s1">&#39;ifo&#39;</span><span class="p">,</span> <span class="s1">&#39;is_real&#39;</span><span class="p">,</span> <span class="s1">&#39;is_complex&#39;</span><span class="p">,</span> <span class="s1">&#39;is_polar&#39;</span><span class="p">,</span> <span class="s1">&#39;matrix_type&#39;</span><span class="p">,</span>
                   <span class="s1">&#39;tin_dtype&#39;</span><span class="p">,</span> <span class="s1">&#39;tout_dtype&#39;</span><span class="p">]</span>

    <span class="c1">#@classmethod</span>
    <span class="c1">#def _init_from_empty(cls):</span>
        <span class="c1">#name = &#39;name&#39;</span>
        <span class="c1">#ifo = 1</span>
        <span class="c1">#tin = 1</span>
        <span class="c1">#tout = 1</span>
        <span class="c1">#polar = 0</span>
        <span class="c1">#ncols = 1</span>
        <span class="c1">#GCj = []</span>
        <span class="c1">#GCi = []</span>
        <span class="c1">#Real = []</span>
        <span class="c1">#return DMIJI(name, ifo, tin, tout, polar, ncols, GCj, GCi, Real,</span>
                     <span class="c1">#Complex=None, comment=&#39;&#39;, finalize=True)</span>

<div class="viewcode-block" id="DMIJI.export_to_hdf5"><a class="viewcode-back" href="../../../../reference/bdf/cards/pyNastran.bdf.cards.dmig.html#pyNastran.bdf.cards.dmig.DMIJI.export_to_hdf5">[docs]</a>    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">export_to_hdf5</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">h5_file</span><span class="p">,</span> <span class="n">model</span><span class="p">,</span> <span class="n">encoding</span><span class="p">):</span>
        <span class="n">_export_dmig_to_hdf5</span><span class="p">(</span><span class="n">h5_file</span><span class="p">,</span> <span class="n">model</span><span class="p">,</span> <span class="n">model</span><span class="o">.</span><span class="n">dmiji</span><span class="p">,</span> <span class="n">encoding</span><span class="p">)</span></div>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">ifo</span><span class="p">,</span> <span class="n">tin</span><span class="p">,</span> <span class="n">tout</span><span class="p">,</span> <span class="n">polar</span><span class="p">,</span> <span class="n">ncols</span><span class="p">,</span>
                 <span class="n">GCj</span><span class="p">,</span> <span class="n">GCi</span><span class="p">,</span> <span class="n">Real</span><span class="p">,</span> <span class="n">Complex</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">comment</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">finalize</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Creates a DMIJI card</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        name : str</span>
<span class="sd">            the name of the matrix</span>
<span class="sd">        ifo : int</span>
<span class="sd">            matrix shape</span>
<span class="sd">            4=Lower Triangular</span>
<span class="sd">            5=Upper Triangular</span>
<span class="sd">            6=Symmetric</span>
<span class="sd">            8=Identity (m=nRows, n=m)</span>
<span class="sd">        tin : int</span>
<span class="sd">            matrix input precision</span>
<span class="sd">            1=Real, Single Precision</span>
<span class="sd">            2=Real, Double Precision</span>
<span class="sd">            3=Complex, Single Precision</span>
<span class="sd">            4=Complex, Double Precision</span>
<span class="sd">        tout : int</span>
<span class="sd">            matrix output precision</span>
<span class="sd">            0=same as tin</span>
<span class="sd">            1=Real, Single Precision</span>
<span class="sd">            2=Real, Double Precision</span>
<span class="sd">            3=Complex, Single Precision</span>
<span class="sd">            4=Complex, Double Precision</span>
<span class="sd">        polar : int; default=0</span>
<span class="sd">            Input format of Ai, Bi</span>
<span class="sd">            Integer=blank or 0 indicates real, imaginary format</span>
<span class="sd">            Integer &gt; 0 indicates amplitude, phase format</span>
<span class="sd">        ncols : int</span>
<span class="sd">            ???</span>
<span class="sd">        GCj  : List[(node, dof)]???</span>
<span class="sd">            the jnode, jDOFs</span>
<span class="sd">        GCi  : List[(node, dof)]???</span>
<span class="sd">            the inode, iDOFs</span>
<span class="sd">        Real : List[float]???</span>
<span class="sd">            The real values</span>
<span class="sd">        Complex : List[float]???; default=None</span>
<span class="sd">            The complex values (if the matrix is complex)</span>
<span class="sd">        comment : str; default=&#39;&#39;</span>
<span class="sd">            a comment for the card</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">NastranMatrix</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">ifo</span><span class="p">,</span> <span class="n">tin</span><span class="p">,</span> <span class="n">tout</span><span class="p">,</span> <span class="n">polar</span><span class="p">,</span> <span class="n">ncols</span><span class="p">,</span>
                               <span class="n">GCj</span><span class="p">,</span> <span class="n">GCi</span><span class="p">,</span> <span class="n">Real</span><span class="p">,</span> <span class="n">Complex</span><span class="p">,</span> <span class="n">comment</span><span class="o">=</span><span class="n">comment</span><span class="p">,</span>
                               <span class="n">finalize</span><span class="o">=</span><span class="n">finalize</span><span class="p">)</span></div>


<div class="viewcode-block" id="DMIK"><a class="viewcode-back" href="../../../../reference/bdf/cards/pyNastran.bdf.cards.dmig.html#pyNastran.bdf.cards.dmig.DMIK">[docs]</a><span class="k">class</span> <span class="nc">DMIK</span><span class="p">(</span><span class="n">NastranMatrix</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Direct Matrix Input at ks-Set of the Aerodynamic Mesh</span>
<span class="sd">    Defines direct input matrices related to physical (displacement)</span>
<span class="sd">    degrees-of-freedom (ks-set) of aerodynamic grid points. These include WKK,</span>
<span class="sd">    WTFACT and input forces associated with AEFORCE entries. The matrix is</span>
<span class="sd">    described by a single header entry and one or more column entries. A column</span>
<span class="sd">    entry is required for each column with nonzero elements.</span>

<span class="sd">    +------+-------+----+-----+-----+------+-------+----+------+</span>
<span class="sd">    |   1  |   2   | 3  |  4  |  5  |   6  |   7   | 8  |  9   |</span>
<span class="sd">    +======+=======+====+=====+=====+======+=======+====+======+</span>
<span class="sd">    | DMIK | NAME  | 0  | IFO | TIN | TOUT | POLAR |    | NCOL |</span>
<span class="sd">    +------+-------+----+-----+-----+------+-------+----+------+</span>
<span class="sd">    | DMIK | NAME  | GJ | CJ  |     |  G1  |  C1   | A1 |  B1  |</span>
<span class="sd">    +------+-------+----+-----+-----+------+-------+----+------+</span>
<span class="sd">    |      |  G2   | C2 | A2  |  B2 |      |       |    |      |</span>
<span class="sd">    +------+-------+----+-----+-----+------+-------+----+------+</span>
<span class="sd">    | DMIK | ALPH1 | 0  |  9  |  2  |  0   |   1   |    |      |</span>
<span class="sd">    +------+-------+----+-----+-----+------+-------+----+------+</span>
<span class="sd">    | DMIK | ALPH1 | 1  |  1  |  1  |  1   |  1.0  |    |      |</span>
<span class="sd">    +------+-------+----+-----+-----+------+-------+----+------+</span>
<span class="sd">    |      |   2   | 1  | 1.0 |     |      |       |    |      |</span>
<span class="sd">    +------+-------+----+-----+-----+------+-------+----+------+</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="nb">type</span> <span class="o">=</span> <span class="s1">&#39;DMIK&#39;</span>
    <span class="n">_properties</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;shape&#39;</span><span class="p">,</span> <span class="s1">&#39;ifo&#39;</span><span class="p">,</span> <span class="s1">&#39;is_real&#39;</span><span class="p">,</span> <span class="s1">&#39;is_complex&#39;</span><span class="p">,</span> <span class="s1">&#39;is_polar&#39;</span><span class="p">,</span> <span class="s1">&#39;matrix_type&#39;</span><span class="p">,</span>
                   <span class="s1">&#39;tin_dtype&#39;</span><span class="p">,</span> <span class="s1">&#39;tout_dtype&#39;</span><span class="p">]</span>

    <span class="c1">#@classmethod</span>
    <span class="c1">#def _init_from_empty(cls):</span>
        <span class="c1">#name = &#39;name&#39;</span>
        <span class="c1">#ifo = 1</span>
        <span class="c1">#tin = 1</span>
        <span class="c1">#tout = 1</span>
        <span class="c1">#polar = 0</span>
        <span class="c1">#ncols = 1</span>
        <span class="c1">#GCj = []</span>
        <span class="c1">#GCi = []</span>
        <span class="c1">#Real = []</span>
        <span class="c1">#return DMIK(name, ifo, tin, tout, polar, ncols, GCj, GCi, Real,</span>
                    <span class="c1">#Complex=None, comment=&#39;&#39;, finalize=True)</span>

<div class="viewcode-block" id="DMIK.export_to_hdf5"><a class="viewcode-back" href="../../../../reference/bdf/cards/pyNastran.bdf.cards.dmig.html#pyNastran.bdf.cards.dmig.DMIK.export_to_hdf5">[docs]</a>    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">export_to_hdf5</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">h5_file</span><span class="p">,</span> <span class="n">model</span><span class="p">,</span> <span class="n">encoding</span><span class="p">):</span>
        <span class="n">_export_dmig_to_hdf5</span><span class="p">(</span><span class="n">h5_file</span><span class="p">,</span> <span class="n">model</span><span class="p">,</span> <span class="n">model</span><span class="o">.</span><span class="n">dmik</span><span class="p">,</span> <span class="n">encoding</span><span class="p">)</span></div>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">ifo</span><span class="p">,</span> <span class="n">tin</span><span class="p">,</span> <span class="n">tout</span><span class="p">,</span> <span class="n">polar</span><span class="p">,</span> <span class="n">ncols</span><span class="p">,</span>
                 <span class="n">GCj</span><span class="p">,</span> <span class="n">GCi</span><span class="p">,</span> <span class="n">Real</span><span class="p">,</span> <span class="n">Complex</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">comment</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">finalize</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Creates a DMIK card</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        name : str</span>
<span class="sd">            the name of the matrix</span>
<span class="sd">        ifo : int</span>
<span class="sd">            matrix shape</span>
<span class="sd">            4=Lower Triangular</span>
<span class="sd">            5=Upper Triangular</span>
<span class="sd">            6=Symmetric</span>
<span class="sd">            8=Identity (m=nRows, n=m)</span>
<span class="sd">        tin : int</span>
<span class="sd">            matrix input precision</span>
<span class="sd">            1=Real, Single Precision</span>
<span class="sd">            2=Real, Double Precision</span>
<span class="sd">            3=Complex, Single Precision</span>
<span class="sd">            4=Complex, Double Precision</span>
<span class="sd">        tout : int</span>
<span class="sd">            matrix output precision</span>
<span class="sd">            0=same as tin</span>
<span class="sd">            1=Real, Single Precision</span>
<span class="sd">            2=Real, Double Precision</span>
<span class="sd">            3=Complex, Single Precision</span>
<span class="sd">            4=Complex, Double Precision</span>
<span class="sd">        polar : int; default=0</span>
<span class="sd">            Input format of Ai, Bi</span>
<span class="sd">            Integer=blank or 0 indicates real, imaginary format</span>
<span class="sd">            Integer &gt; 0 indicates amplitude, phase format</span>
<span class="sd">        ncols : int</span>
<span class="sd">            ???</span>
<span class="sd">        GCj  : List[(node, dof)]</span>
<span class="sd">            the jnode, jDOFs</span>
<span class="sd">        GCi  : List[(node, dof)]</span>
<span class="sd">            the inode, iDOFs</span>
<span class="sd">        Real : List[float]</span>
<span class="sd">            The real values</span>
<span class="sd">        Complex : List[float]; default=None</span>
<span class="sd">            The complex values (if the matrix is complex)</span>
<span class="sd">        comment : str; default=&#39;&#39;</span>
<span class="sd">            a comment for the card</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">NastranMatrix</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">ifo</span><span class="p">,</span> <span class="n">tin</span><span class="p">,</span> <span class="n">tout</span><span class="p">,</span> <span class="n">polar</span><span class="p">,</span> <span class="n">ncols</span><span class="p">,</span>
                               <span class="n">GCj</span><span class="p">,</span> <span class="n">GCi</span><span class="p">,</span> <span class="n">Real</span><span class="p">,</span> <span class="n">Complex</span><span class="p">,</span> <span class="n">comment</span><span class="o">=</span><span class="n">comment</span><span class="p">,</span>
                               <span class="n">finalize</span><span class="o">=</span><span class="n">finalize</span><span class="p">)</span></div>


<div class="viewcode-block" id="DMI"><a class="viewcode-back" href="../../../../reference/bdf/cards/pyNastran.bdf.cards.dmig.html#pyNastran.bdf.cards.dmig.DMI">[docs]</a><span class="k">class</span> <span class="nc">DMI</span><span class="p">(</span><span class="n">NastranMatrix</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    +------+-------+------+------+---------+----------+-----------+-----------+------+</span>
<span class="sd">    |  1   |   2   |  3   |   4  |    5    |    6     |     7     | 8         |  9   |</span>
<span class="sd">    +======+=======+======+======+=========+==========+===========+===========+======+</span>
<span class="sd">    | DMI  |  NAME |  0   | FORM |   TIN   |   TOUT   |           |     M     |  N   |</span>
<span class="sd">    +------+-------+------+------+---------+----------+-----------+-----------+------+</span>
<span class="sd">    | DMI  |  NAME |  J   |  I1  | A(I1,J) |  A(I1,J) | A(I1+1,J) | A(I1+2,J) | etc. |</span>
<span class="sd">    +------+-------+------+------+---------+----------+-----------+-----------+------+</span>
<span class="sd">    |      |  I2   | etc. |      |         |          |           |           |      |</span>
<span class="sd">    +------+-------+------+------+---------+----------+-----------+-----------+------+</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="nb">type</span> <span class="o">=</span> <span class="s1">&#39;DMI&#39;</span>
    <span class="n">_properties</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;shape&#39;</span><span class="p">,</span> <span class="s1">&#39;ifo&#39;</span><span class="p">,</span> <span class="s1">&#39;is_real&#39;</span><span class="p">,</span> <span class="s1">&#39;is_complex&#39;</span><span class="p">,</span> <span class="s1">&#39;is_polar&#39;</span><span class="p">,</span> <span class="s1">&#39;matrix_type&#39;</span><span class="p">,</span>
                   <span class="s1">&#39;tin_dtype&#39;</span><span class="p">,</span> <span class="s1">&#39;tout_dtype&#39;</span><span class="p">]</span>

<div class="viewcode-block" id="DMI._init_from_empty"><a class="viewcode-back" href="../../../../reference/bdf/cards/pyNastran.bdf.cards.dmig.html#pyNastran.bdf.cards.dmig.DMI._init_from_empty">[docs]</a>    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">_init_from_empty</span><span class="p">(</span><span class="bp">cls</span><span class="p">):</span>
        <span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;name&#39;</span>
        <span class="n">matrix_form</span> <span class="o">=</span> <span class="mi">8</span>
        <span class="n">tin</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="n">tout</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="n">nrows</span> <span class="o">=</span> <span class="mi">5</span>
        <span class="n">ncols</span> <span class="o">=</span> <span class="mi">5</span>
        <span class="n">GCj</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">GCi</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">Real</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">return</span> <span class="n">DMI</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">matrix_form</span><span class="p">,</span> <span class="n">tin</span><span class="p">,</span> <span class="n">tout</span><span class="p">,</span> <span class="n">nrows</span><span class="p">,</span> <span class="n">ncols</span><span class="p">,</span> <span class="n">GCj</span><span class="p">,</span> <span class="n">GCi</span><span class="p">,</span> <span class="n">Real</span><span class="p">,</span>
                   <span class="n">Complex</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">comment</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">finalize</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></div>

<div class="viewcode-block" id="DMI.export_to_hdf5"><a class="viewcode-back" href="../../../../reference/bdf/cards/pyNastran.bdf.cards.dmig.html#pyNastran.bdf.cards.dmig.DMI.export_to_hdf5">[docs]</a>    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">export_to_hdf5</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">h5_file</span><span class="p">,</span> <span class="n">model</span><span class="p">,</span> <span class="n">encoding</span><span class="p">):</span>
        <span class="n">_export_dmig_to_hdf5</span><span class="p">(</span><span class="n">h5_file</span><span class="p">,</span> <span class="n">model</span><span class="p">,</span> <span class="n">model</span><span class="o">.</span><span class="n">dmi</span><span class="p">,</span> <span class="n">encoding</span><span class="p">)</span></div>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">matrix_form</span><span class="p">,</span> <span class="n">tin</span><span class="p">,</span> <span class="n">tout</span><span class="p">,</span> <span class="n">nrows</span><span class="p">,</span> <span class="n">ncols</span><span class="p">,</span>
                 <span class="n">GCj</span><span class="p">,</span> <span class="n">GCi</span><span class="p">,</span> <span class="n">Real</span><span class="p">,</span> <span class="n">Complex</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">comment</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">finalize</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="c1">#NastranMatrix.__init__(self, name, ifo, tin, tout, polar, ncols,</span>
                               <span class="c1">#GCj, GCi, Real, Complex, comment=&#39;&#39;)</span>
        <span class="k">if</span> <span class="n">comment</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">comment</span> <span class="o">=</span> <span class="n">comment</span>

        <span class="k">if</span> <span class="n">Complex</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">Complex</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="k">if</span> <span class="n">tout</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">tout</span> <span class="o">=</span> <span class="mi">0</span>

        <span class="k">if</span> <span class="n">matrix_form</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">8</span><span class="p">]:</span>
            <span class="n">msg</span> <span class="o">=</span> <span class="p">(</span>
                <span class="s1">&#39;</span><span class="si">%s</span><span class="s1"> name=</span><span class="si">%r</span><span class="s1"> matrix_form=</span><span class="si">%r</span><span class="s1"> must be [1, 2, 3, 4, 5, 6, 8]</span><span class="se">\n</span><span class="s1">&#39;</span>
                <span class="s1">&#39;  1: Square</span><span class="se">\n</span><span class="s1">&#39;</span>
                <span class="s1">&#39;  2: Rectangular</span><span class="se">\n</span><span class="s1">&#39;</span>
                <span class="s1">&#39;  3: Diagonal matrix (M=number of rows, N=1)</span><span class="se">\n</span><span class="s1">&#39;</span>
                <span class="s1">&#39;  4: Lower Triangular</span><span class="se">\n</span><span class="s1">&#39;</span>
                <span class="s1">&#39;  5: Upper Triangular</span><span class="se">\n</span><span class="s1">&#39;</span>
                <span class="s1">&#39;  6: Symmetric</span><span class="se">\n</span><span class="s1">&#39;</span>
                <span class="s1">&#39;  8: Identity (m=nRows, n=m)</span><span class="se">\n</span><span class="s1">&#39;</span>
                <span class="c1">#&#39;  9: Rectangular\n&#39;</span>
                <span class="o">%</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">type</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">matrix_form</span><span class="p">))</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">name</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">matrix_form</span> <span class="o">=</span> <span class="n">matrix_form</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tin</span> <span class="o">=</span> <span class="n">tin</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tout</span> <span class="o">=</span> <span class="n">tout</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">nrows</span> <span class="o">=</span> <span class="n">nrows</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ncols</span> <span class="o">=</span> <span class="n">ncols</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">GCi</span> <span class="o">=</span> <span class="n">GCi</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">GCj</span> <span class="o">=</span> <span class="n">GCj</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Real</span> <span class="o">=</span> <span class="n">Real</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">Complex</span><span class="p">)</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_complex</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">Complex</span> <span class="o">=</span> <span class="n">Complex</span>
        <span class="k">if</span> <span class="n">finalize</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">finalize</span><span class="p">()</span>

    <span class="c1">#@property</span>
    <span class="c1">#def form(self):</span>
        <span class="c1">#&quot;&quot;&quot;gets the matrix_form&quot;&quot;&quot;</span>
        <span class="c1">#self.deprecated(&#39;form&#39;, &#39;matrix_form&#39;, &#39;1.1&#39;)</span>
        <span class="c1">#return self.matrix_form</span>

    <span class="c1">#@form.setter</span>
    <span class="c1">#def form(self, matrix_form):</span>
        <span class="c1">#&quot;&quot;&quot;sets the matrix_form&quot;&quot;&quot;</span>
        <span class="c1">#self.deprecated(&#39;form&#39;, &#39;matrix_form&#39;, &#39;1.1&#39;)</span>
        <span class="c1">#self.matrix_form = matrix_form</span>

<div class="viewcode-block" id="DMI.add_card"><a class="viewcode-back" href="../../../../reference/bdf/cards/pyNastran.bdf.cards.dmig.html#pyNastran.bdf.cards.dmig.DMI.add_card">[docs]</a>    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">add_card</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">card</span><span class="p">,</span> <span class="n">comment</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Adds a DMI card from ``BDF.add_card(...)``</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        card : BDFCard()</span>
<span class="sd">            a BDFCard object</span>
<span class="sd">        comment : str; default=&#39;&#39;</span>
<span class="sd">            a comment for the card</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">name</span> <span class="o">=</span> <span class="n">string</span><span class="p">(</span><span class="n">card</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;name&#39;</span><span class="p">)</span>
        <span class="c1">#zero</span>

        <span class="c1">#: Form of the matrix:  1=Square (not symmetric); 2=Rectangular;</span>
        <span class="c1">#: 3=Diagonal (m=nRows,n=1);  4=Lower Triangular; 5=Upper Triangular;</span>
        <span class="c1">#: 6=Symmetric; 8=Identity (m=nRows, n=m)</span>
        <span class="n">matrix_form</span> <span class="o">=</span> <span class="n">integer</span><span class="p">(</span><span class="n">card</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="s1">&#39;form&#39;</span><span class="p">)</span>

        <span class="c1">#: 1-Real, Single Precision; 2=Real,Double Precision;</span>
        <span class="c1">#: 3=Complex, Single; 4=Complex, Double</span>
        <span class="n">tin</span> <span class="o">=</span> <span class="n">integer</span><span class="p">(</span><span class="n">card</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="s1">&#39;tin&#39;</span><span class="p">)</span>

        <span class="c1">#: 0-Set by cell precision</span>
        <span class="n">tout</span> <span class="o">=</span> <span class="n">integer_or_blank</span><span class="p">(</span><span class="n">card</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="s1">&#39;tout&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>

        <span class="n">nrows</span> <span class="o">=</span> <span class="n">integer</span><span class="p">(</span><span class="n">card</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="s1">&#39;nrows&#39;</span><span class="p">)</span>
        <span class="n">ncols</span> <span class="o">=</span> <span class="n">integer</span><span class="p">(</span><span class="n">card</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="s1">&#39;ncols&#39;</span><span class="p">)</span>

        <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">card</span><span class="p">)</span> <span class="o">==</span> <span class="mi">9</span><span class="p">,</span> <span class="s1">&#39;len(DMI card) = </span><span class="si">%i</span><span class="se">\n</span><span class="s1">card=</span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">card</span><span class="p">),</span> <span class="n">card</span><span class="p">)</span>

        <span class="n">GCj</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">GCi</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">Real</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">Complex</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">return</span> <span class="n">DMI</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">matrix_form</span><span class="p">,</span> <span class="n">tin</span><span class="p">,</span> <span class="n">tout</span><span class="p">,</span> <span class="n">nrows</span><span class="p">,</span> <span class="n">ncols</span><span class="p">,</span>
                   <span class="n">GCj</span><span class="p">,</span> <span class="n">GCi</span><span class="p">,</span> <span class="n">Real</span><span class="p">,</span> <span class="n">Complex</span><span class="p">,</span> <span class="n">comment</span><span class="o">=</span><span class="n">comment</span><span class="p">,</span> <span class="n">finalize</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></div>

<div class="viewcode-block" id="DMI.finalize"><a class="viewcode-back" href="../../../../reference/bdf/cards/pyNastran.bdf.cards.dmig.html#pyNastran.bdf.cards.dmig.DMI.finalize">[docs]</a>    <span class="k">def</span> <span class="nf">finalize</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">GCi</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">GCi</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">GCj</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">GCj</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Real</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Real</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_complex</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">Complex</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Complex</span><span class="p">)</span></div>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">matrix_type</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        gets the matrix type</span>

<span class="sd">        1 Square matrix (not symmetric)</span>
<span class="sd">        2 General rectangular matrix</span>
<span class="sd">        3 Diagonal matrix (M=number of rows, N = 1)</span>
<span class="sd">        #4 Lower triangular factor</span>
<span class="sd">        #5 Upper triangular factor</span>
<span class="sd">        6 Symmetric matrix</span>
<span class="sd">        8 Identity matrix (M=number of rows, N = M)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">matrix_form</span><span class="p">,</span> <span class="n">integer_types</span><span class="p">):</span>
            <span class="n">msg</span> <span class="o">=</span> <span class="s1">&#39;ifo must be an integer; matrix_form=</span><span class="si">%r</span><span class="s1"> type=</span><span class="si">%s</span><span class="s1"> name=</span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">matrix_form</span><span class="p">,</span> <span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">matrix_form</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">matrix_form</span><span class="p">,</span> <span class="nb">bool</span><span class="p">):</span>
            <span class="n">msg</span> <span class="o">=</span> <span class="s1">&#39;matrix_form must not be a boolean; matrix_form=</span><span class="si">%r</span><span class="s1"> type=</span><span class="si">%s</span><span class="s1"> name=</span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">matrix_form</span><span class="p">,</span> <span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">matrix_form</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">matrix_form</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">matrix_type</span> <span class="o">=</span> <span class="s1">&#39;square&#39;</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">matrix_form</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span> <span class="c1"># 9 ???</span>
            <span class="n">matrix_type</span> <span class="o">=</span> <span class="s1">&#39;rectangular&#39;</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">matrix_form</span> <span class="o">==</span> <span class="mi">3</span><span class="p">:</span>
            <span class="n">matrix_type</span> <span class="o">=</span> <span class="s1">&#39;diagonal&#39;</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">matrix_form</span> <span class="o">==</span> <span class="mi">6</span><span class="p">:</span>
            <span class="n">matrix_type</span> <span class="o">=</span> <span class="s1">&#39;symmetric&#39;</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">matrix_form</span> <span class="o">==</span> <span class="mi">9</span><span class="p">:</span>
            <span class="n">matrix_type</span> <span class="o">=</span> <span class="s1">&#39;identity&#39;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%s</span><span class="s1"> matrix_form=</span><span class="si">%r</span><span class="s1"> is not supported&#39;</span> <span class="o">%</span> <span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">type</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">matrix_form</span><span class="p">))</span>
        <span class="k">return</span> <span class="n">matrix_type</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">is_polar</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">tin</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]:</span>
            <span class="n">is_polar</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">tin</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">]:</span>
            <span class="n">is_polar</span> <span class="o">=</span> <span class="kc">False</span> <span class="c1"># TODO: could be wrong...</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="s1">&#39;nrows=</span><span class="si">%s</span><span class="s1"> ncols=</span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nrows</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">ncols</span><span class="p">))</span>
        <span class="k">return</span> <span class="n">is_polar</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">shape</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nrows</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">ncols</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">ifo</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        ifo</span>
<span class="sd">        #: 4-Lower Triangular; 5=Upper Triangular; 6=Symmetric; 8=Identity (m=nRows, n=m)</span>

<span class="sd">        #: Form of the matrix:  1=Square (not symmetric); 2=Rectangular;</span>
<span class="sd">        #: 3=Diagonal (m=nRows,n=1);  4=Lower Triangular; 5=Upper Triangular;</span>
<span class="sd">        #: 6=Symmetric; 8=Identity (m=nRows, n=m)</span>
<span class="sd">        self.matrix_form = integer(card, 3, &#39;matrix_form&#39;)</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">matrix_form</span>
        <span class="c1">#if self.nrows == self.ncols:</span>
            <span class="c1">## symmetric</span>
            <span class="c1">#ifo = 6</span>
        <span class="c1">##elif self.nrows &gt; 1 and self.ncols &gt; 1:</span>
            <span class="c1">##ifo = 2</span>
        <span class="c1">#else:</span>
            <span class="c1">#raise NotImplementedError(&#39;matrix_form=%r nrows=%s ncols=%s&#39; % (</span>
                <span class="c1">#self.matrix_form, self.nrows, self.ncols))</span>
        <span class="c1">#return ifo</span>

    <span class="k">def</span> <span class="nf">_add_column</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">card</span><span class="p">,</span> <span class="n">comment</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        .. todo:: support comment</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_complex</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_read_complex</span><span class="p">(</span><span class="n">card</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_read_real</span><span class="p">(</span><span class="n">card</span><span class="p">)</span>

<div class="viewcode-block" id="DMI._read_real"><a class="viewcode-back" href="../../../../reference/bdf/cards/pyNastran.bdf.cards.dmig.html#pyNastran.bdf.cards.dmig.DMI._read_real">[docs]</a>    <span class="k">def</span> <span class="nf">_read_real</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">card</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;reads a real DMI column&quot;&quot;&quot;</span>
        <span class="c1"># column number</span>
        <span class="n">j</span> <span class="o">=</span> <span class="n">integer</span><span class="p">(</span><span class="n">card</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;icol&#39;</span><span class="p">)</span>

        <span class="c1"># counter</span>
        <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">fields</span> <span class="o">=</span> <span class="p">[</span><span class="n">interpret_value</span><span class="p">(</span><span class="n">field</span><span class="p">,</span> <span class="n">card</span><span class="p">)</span> <span class="k">for</span> <span class="n">field</span> <span class="ow">in</span> <span class="n">card</span><span class="p">[</span><span class="mi">3</span><span class="p">:]]</span>

        <span class="c1"># Real, starts at A(i1,j), goes to A(i2,j) in a column</span>
        <span class="k">while</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">fields</span><span class="p">):</span>
            <span class="n">i1</span> <span class="o">=</span> <span class="n">fields</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">i1</span><span class="p">,</span> <span class="n">integer_types</span><span class="p">):</span>
                <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span>
                <span class="n">is_done_reading_floats</span> <span class="o">=</span> <span class="kc">False</span>
                <span class="k">while</span> <span class="ow">not</span> <span class="n">is_done_reading_floats</span> <span class="ow">and</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">fields</span><span class="p">):</span>
                    <span class="n">real_value</span> <span class="o">=</span> <span class="n">fields</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
                    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">real_value</span><span class="p">,</span> <span class="n">integer_types</span><span class="p">):</span>
                        <span class="n">is_done_reading_floats</span> <span class="o">=</span> <span class="kc">True</span>
                    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">real_value</span><span class="p">,</span> <span class="nb">float</span><span class="p">):</span>
                        <span class="c1">#print(&#39;adding j=%s i1=%s val=%s&#39; % (j, i1, real_value))</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">GCj</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">j</span><span class="p">)</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">GCi</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">i1</span><span class="p">)</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">Real</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">real_value</span><span class="p">)</span>
                        <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span>
                        <span class="n">i1</span> <span class="o">+=</span> <span class="mi">1</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">real_value</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">Real</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
                        <span class="n">end_i</span> <span class="o">=</span> <span class="n">fields</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span>
                        <span class="k">for</span> <span class="n">ii</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">i1</span><span class="p">,</span> <span class="n">end_i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">):</span>
                            <span class="c1">#print(&#39;adding j=%s i1=%s val=%s&#39; % (j, ii, real_value))</span>
                            <span class="bp">self</span><span class="o">.</span><span class="n">GCj</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">j</span><span class="p">)</span>
                            <span class="bp">self</span><span class="o">.</span><span class="n">GCi</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ii</span><span class="p">)</span>
                            <span class="bp">self</span><span class="o">.</span><span class="n">Real</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">real_value</span><span class="p">)</span>
                        <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span>
                        <span class="n">is_done_reading_floats</span> <span class="o">=</span> <span class="kc">True</span></div>

<div class="viewcode-block" id="DMI._read_complex"><a class="viewcode-back" href="../../../../reference/bdf/cards/pyNastran.bdf.cards.dmig.html#pyNastran.bdf.cards.dmig.DMI._read_complex">[docs]</a>    <span class="k">def</span> <span class="nf">_read_complex</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">card</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;reads a complex DMI column&quot;&quot;&quot;</span>
        <span class="c1">#msg = &#39;complex matrices not supported in the DMI reader...&#39;</span>
        <span class="c1">#raise NotImplementedError(msg)</span>
        <span class="c1"># column number</span>
        <span class="n">j</span> <span class="o">=</span> <span class="n">integer</span><span class="p">(</span><span class="n">card</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;icol&#39;</span><span class="p">)</span>
        <span class="c1"># counter</span>
        <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">fields</span> <span class="o">=</span> <span class="p">[</span><span class="n">interpret_value</span><span class="p">(</span><span class="n">field</span><span class="p">,</span> <span class="n">card</span><span class="p">)</span> <span class="k">for</span> <span class="n">field</span> <span class="ow">in</span> <span class="n">card</span><span class="p">[</span><span class="mi">3</span><span class="p">:]]</span>
        <span class="c1"># Complex, starts at A(i1,j)+imag*A(i1,j), goes to A(i2,j) in a column</span>
        <span class="k">if</span> <span class="mi">0</span><span class="p">:</span> <span class="c1"># pragma: no cover</span>
            <span class="n">is_real</span> <span class="o">=</span> <span class="kc">True</span>
            <span class="n">gci</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="k">for</span> <span class="n">field</span> <span class="ow">in</span> <span class="n">fields</span><span class="p">:</span>
                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">field</span><span class="p">,</span> <span class="n">integer_types</span><span class="p">):</span>
                    <span class="n">gci</span> <span class="o">=</span> <span class="n">field</span>
                <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">field</span><span class="p">,</span> <span class="nb">float</span><span class="p">):</span>
                    <span class="k">if</span> <span class="n">is_real</span><span class="p">:</span>
                        <span class="n">real</span> <span class="o">=</span> <span class="n">field</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">GCj</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">j</span><span class="p">)</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">GCi</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">gci</span><span class="p">)</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">Real</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">real</span><span class="p">)</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">Complex</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">field</span><span class="p">)</span>
                    <span class="n">is_real</span> <span class="o">=</span> <span class="ow">not</span> <span class="n">is_real</span>

        <span class="k">while</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">fields</span><span class="p">):</span>
            <span class="n">i1</span> <span class="o">=</span> <span class="n">fields</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
            <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">i1</span><span class="p">,</span> <span class="nb">int</span><span class="p">),</span> <span class="n">card</span>
            <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="n">is_done_reading_floats</span> <span class="o">=</span> <span class="kc">False</span>
            <span class="k">while</span> <span class="ow">not</span> <span class="n">is_done_reading_floats</span> <span class="ow">and</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">fields</span><span class="p">):</span>
                <span class="n">value</span> <span class="o">=</span> <span class="n">fields</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
                <span class="c1">#print(&quot;i=%s len(fields)=%s value=%s&quot; % (</span>
                    <span class="c1">#i, len(fields), value))</span>
                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">integer_types</span><span class="p">):</span>
                    <span class="n">is_done_reading_floats</span> <span class="o">=</span> <span class="kc">True</span>
                <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="nb">float</span><span class="p">):</span>
                    <span class="n">complex_value</span> <span class="o">=</span> <span class="n">fields</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span>
                    <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">complex_value</span><span class="p">,</span> <span class="nb">float</span><span class="p">),</span> <span class="n">card</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">GCj</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">j</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">GCi</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">i1</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">Real</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">Complex</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">complex_value</span><span class="p">)</span>
                    <span class="n">i</span> <span class="o">+=</span> <span class="mi">2</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">()</span></div>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">is_real</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;real vs. complex attribute&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_complex</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">is_complex</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;real vs. complex attribute&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">tin</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">]:</span>
            <span class="k">return</span> <span class="kc">True</span>
        <span class="k">return</span> <span class="kc">False</span>

<div class="viewcode-block" id="DMI.raw_fields"><a class="viewcode-back" href="../../../../reference/bdf/cards/pyNastran.bdf.cards.dmig.html#pyNastran.bdf.cards.dmig.DMI.raw_fields">[docs]</a>    <span class="k">def</span> <span class="nf">raw_fields</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        .. warning:: All the writers are bad because Nastran insists on</span>
<span class="sd">                      making columns a single DMI card.  This makes</span>
<span class="sd">                      writing a card much harder, so there are a lot of</span>
<span class="sd">                      NotImplementedErrors floating about.</span>

<span class="sd">                      This is an invalid method, but is not disabled</span>
<span class="sd">                      because it&#39;s currently needed for checking results</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">list_fields</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;DMI&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">matrix_form</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">tin</span><span class="p">,</span>
                       <span class="bp">self</span><span class="o">.</span><span class="n">tout</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">nrows</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">ncols</span><span class="p">]</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_complex</span><span class="p">:</span>
            <span class="k">for</span> <span class="p">(</span><span class="n">gci</span><span class="p">,</span> <span class="n">gcj</span><span class="p">,</span> <span class="n">reali</span><span class="p">,</span> <span class="n">imagi</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">GCi</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">GCj</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">Real</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">Complex</span><span class="p">):</span>
                <span class="n">list_fields</span> <span class="o">+=</span> <span class="p">[</span><span class="s1">&#39;DMI&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">gcj</span><span class="p">,</span> <span class="n">gci</span><span class="p">,</span> <span class="n">reali</span><span class="p">,</span> <span class="n">imagi</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">for</span> <span class="p">(</span><span class="n">gci</span><span class="p">,</span> <span class="n">gcj</span><span class="p">,</span> <span class="n">reali</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">GCi</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">GCj</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">Real</span><span class="p">):</span>
                <span class="n">list_fields</span> <span class="o">+=</span> <span class="p">[</span><span class="s1">&#39;DMI&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">gcj</span><span class="p">,</span> <span class="n">gci</span><span class="p">,</span> <span class="n">reali</span><span class="p">]</span>
        <span class="k">return</span> <span class="n">list_fields</span></div>

<div class="viewcode-block" id="DMI.write_card_8"><a class="viewcode-back" href="../../../../reference/bdf/cards/pyNastran.bdf.cards.dmig.html#pyNastran.bdf.cards.dmig.DMI.write_card_8">[docs]</a>    <span class="k">def</span> <span class="nf">write_card_8</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;writes the card in single precision&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_write_card</span><span class="p">(</span><span class="n">print_card_8</span><span class="p">)</span></div>

<div class="viewcode-block" id="DMI._get_real_fields"><a class="viewcode-back" href="../../../../reference/bdf/cards/pyNastran.bdf.cards.dmig.html#pyNastran.bdf.cards.dmig.DMI._get_real_fields">[docs]</a>    <span class="k">def</span> <span class="nf">_get_real_fields</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">func</span><span class="p">):</span>
        <span class="n">msg</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
        <span class="n">uGCj</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">GCj</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">gcj</span> <span class="ow">in</span> <span class="n">uGCj</span><span class="p">:</span>
            <span class="n">i</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">gcj</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">GCj</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">gcis</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">GCi</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
            <span class="n">reals</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">Real</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
            <span class="n">isort</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argsort</span><span class="p">(</span><span class="n">gcis</span><span class="p">)</span>
            <span class="n">list_fields</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;DMI&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">gcj</span><span class="p">]</span>

            <span class="c1"># will always write the first one</span>
            <span class="n">gci_last</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
            <span class="k">for</span> <span class="n">gci</span><span class="p">,</span> <span class="n">real</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">gcis</span><span class="p">[</span><span class="n">isort</span><span class="p">],</span> <span class="n">reals</span><span class="p">[</span><span class="n">isort</span><span class="p">]):</span>
                <span class="k">if</span> <span class="n">gci</span> <span class="o">==</span> <span class="n">gci_last</span> <span class="o">+</span> <span class="mi">1</span><span class="p">:</span>
                    <span class="k">pass</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">list_fields</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">gci</span><span class="p">)</span>
                <span class="n">list_fields</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">real</span><span class="p">)</span>
                <span class="n">gci_last</span> <span class="o">=</span> <span class="n">gci</span>
            <span class="n">msg</span> <span class="o">+=</span> <span class="n">func</span><span class="p">(</span><span class="n">list_fields</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">msg</span></div>

<div class="viewcode-block" id="DMI._get_complex_fields"><a class="viewcode-back" href="../../../../reference/bdf/cards/pyNastran.bdf.cards.dmig.html#pyNastran.bdf.cards.dmig.DMI._get_complex_fields">[docs]</a>    <span class="k">def</span> <span class="nf">_get_complex_fields</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">func</span><span class="p">):</span>
        <span class="n">msg</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
        <span class="n">uGCj</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">GCj</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">gcj</span> <span class="ow">in</span> <span class="n">uGCj</span><span class="p">:</span>
            <span class="n">i</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">gcj</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">GCj</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">gcis</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">GCi</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
            <span class="n">reals</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">Real</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
            <span class="n">complexs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">Complex</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
            <span class="n">isort</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argsort</span><span class="p">(</span><span class="n">gcis</span><span class="p">)</span>
            <span class="n">list_fields</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;DMI&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">gcj</span><span class="p">]</span>

            <span class="c1"># will always write the first one</span>
            <span class="n">gci_last</span> <span class="o">=</span> <span class="o">-</span><span class="mi">10</span>
            <span class="c1">#print(&#39;gcis=%s \nreals=%s \ncomplexs=%s&#39; % (</span>
                <span class="c1">#gcis[isort], reals[isort], complexs[isort]))</span>
            <span class="k">if</span> <span class="nb">max</span><span class="p">(</span><span class="n">gcis</span><span class="p">)</span> <span class="o">==</span> <span class="nb">min</span><span class="p">(</span><span class="n">gcis</span><span class="p">):</span>
                <span class="n">list_fields</span> <span class="o">+=</span> <span class="p">[</span><span class="n">gcis</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span>
                <span class="k">for</span> <span class="n">reali</span><span class="p">,</span> <span class="n">complexi</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">reals</span><span class="p">,</span> <span class="n">complexs</span><span class="p">):</span>
                    <span class="n">list_fields</span><span class="o">.</span><span class="n">extend</span><span class="p">([</span><span class="n">reali</span><span class="p">,</span> <span class="n">complexi</span><span class="p">])</span>
                <span class="n">msg</span> <span class="o">+=</span> <span class="n">func</span><span class="p">(</span><span class="n">list_fields</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="c1">#print(f&#39;list_fields0 = {list_fields}&#39;)</span>
                <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">gci</span><span class="p">,</span> <span class="n">reali</span><span class="p">,</span> <span class="n">complexi</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">count</span><span class="p">(),</span> <span class="n">gcis</span><span class="p">[</span><span class="n">isort</span><span class="p">],</span> <span class="n">reals</span><span class="p">[</span><span class="n">isort</span><span class="p">],</span> <span class="n">complexs</span><span class="p">[</span><span class="n">isort</span><span class="p">]):</span>
                    <span class="c1">#print(&#39;B&#39;, gci, reali, complexi, gci_last)</span>
                    <span class="k">if</span> <span class="n">gci</span> <span class="o">!=</span> <span class="n">gci_last</span> <span class="o">+</span> <span class="mi">1</span> <span class="ow">and</span> <span class="n">i</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
                        <span class="k">pass</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">list_fields</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">gci</span><span class="p">)</span>
                    <span class="n">list_fields</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">reali</span><span class="p">)</span>
                    <span class="n">list_fields</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">complexi</span><span class="p">)</span>
                    <span class="n">gci_last</span> <span class="o">=</span> <span class="n">gci</span>
                <span class="c1">#print(f&#39;list_fields = {list_fields}&#39;)</span>
                <span class="n">msg</span> <span class="o">+=</span> <span class="n">func</span><span class="p">(</span><span class="n">list_fields</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">msg</span></div>

<div class="viewcode-block" id="DMI.get_matrix"><a class="viewcode-back" href="../../../../reference/bdf/cards/pyNastran.bdf.cards.dmig.html#pyNastran.bdf.cards.dmig.DMI.get_matrix">[docs]</a>    <span class="k">def</span> <span class="nf">get_matrix</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">is_sparse</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">apply_symmetry</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Builds the Matrix</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        is_sparse : bool; default=False</span>
<span class="sd">            should the matrix be returned as a sparse matrix.</span>
<span class="sd">            Slower for dense matrices.</span>
<span class="sd">        apply_symmetry : bool; default=True</span>
<span class="sd">            If the matrix is symmetric (ifo=6), returns a symmetric matrix.</span>
<span class="sd">            Supported as there are symmetric matrix routines.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        M : numpy.ndarray or scipy.coomatrix</span>
<span class="sd">            the matrix</span>
<span class="sd">        rows : dict[int] = [int, int]</span>
<span class="sd">            dictionary of keys=rowID, values=(Grid,Component) for the matrix</span>
<span class="sd">        cols: dict[int] = [int, int]</span>
<span class="sd">            dictionary of keys=columnID, values=(Grid,Component) for the matrix</span>

<span class="sd">        .. warning:: is_sparse=True WILL fail</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">get_dmi_matrix</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">is_sparse</span><span class="o">=</span><span class="n">is_sparse</span><span class="p">,</span> <span class="n">apply_symmetry</span><span class="o">=</span><span class="n">apply_symmetry</span><span class="p">)</span></div>

<div class="viewcode-block" id="DMI.write_card_16"><a class="viewcode-back" href="../../../../reference/bdf/cards/pyNastran.bdf.cards.dmig.html#pyNastran.bdf.cards.dmig.DMI.write_card_16">[docs]</a>    <span class="k">def</span> <span class="nf">write_card_16</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;writes the card in single precision&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_write_card</span><span class="p">(</span><span class="n">print_card_16</span><span class="p">)</span></div>

<div class="viewcode-block" id="DMI.write_card_double"><a class="viewcode-back" href="../../../../reference/bdf/cards/pyNastran.bdf.cards.dmig.html#pyNastran.bdf.cards.dmig.DMI.write_card_double">[docs]</a>    <span class="k">def</span> <span class="nf">write_card_double</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;writes the card in double precision&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_write_card</span><span class="p">(</span><span class="n">print_card_16</span><span class="p">)</span></div>

<div class="viewcode-block" id="DMI._write_card"><a class="viewcode-back" href="../../../../reference/bdf/cards/pyNastran.bdf.cards.dmig.html#pyNastran.bdf.cards.dmig.DMI._write_card">[docs]</a>    <span class="k">def</span> <span class="nf">_write_card</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">func</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;writes the card in single/double precision&quot;&quot;&quot;</span>
        <span class="n">msg</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">$&#39;</span> <span class="o">+</span> <span class="s1">&#39;-&#39;</span> <span class="o">*</span> <span class="mi">80</span>
        <span class="n">msg</span> <span class="o">+=</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">$ </span><span class="si">%s</span><span class="s1"> Matrix </span><span class="si">%s</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="s1">&#39;DMI&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
        <span class="n">list_fields</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;DMI&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">matrix_form</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">tin</span><span class="p">,</span>
                       <span class="bp">self</span><span class="o">.</span><span class="n">tout</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">nrows</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">ncols</span><span class="p">]</span>
        <span class="n">msg</span> <span class="o">+=</span> <span class="n">print_card_8</span><span class="p">(</span><span class="n">list_fields</span><span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_complex</span><span class="p">:</span>
            <span class="n">msg</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_complex_fields</span><span class="p">(</span><span class="n">func</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">msg</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_real_fields</span><span class="p">(</span><span class="n">func</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">msg</span></div>

<div class="viewcode-block" id="DMI.write_card"><a class="viewcode-back" href="../../../../reference/bdf/cards/pyNastran.bdf.cards.dmig.html#pyNastran.bdf.cards.dmig.DMI.write_card">[docs]</a>    <span class="k">def</span> <span class="nf">write_card</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">size</span><span class="p">:</span> <span class="nb">int</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span> <span class="n">is_double</span><span class="p">:</span> <span class="nb">bool</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">size</span> <span class="o">==</span> <span class="mi">8</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">write_card_8</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">is_double</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">write_card_double</span><span class="p">()</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">write_card_16</span><span class="p">()</span></div>

    <span class="k">def</span> <span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        .. todo:: support shortened output format.  There&#39;s a very low 1000</span>
<span class="sd">                  DMI cap, I assume this is entries and not matrices.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">write_card</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span> <span class="n">is_double</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></div>


<div class="viewcode-block" id="get_row_col_map"><a class="viewcode-back" href="../../../../reference/bdf/cards/pyNastran.bdf.cards.dmig.html#pyNastran.bdf.cards.dmig.get_row_col_map">[docs]</a><span class="k">def</span> <span class="nf">get_row_col_map</span><span class="p">(</span><span class="n">matrix</span><span class="p">,</span> <span class="n">GCi</span><span class="p">,</span> <span class="n">GCj</span><span class="p">,</span> <span class="n">ifo</span><span class="p">):</span>
    <span class="n">ndim</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">GCi</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
    <span class="c1">#print(&#39;ndim=%s&#39; % ndim)</span>
    <span class="c1">#print(&#39;GCj=%s&#39; % GCj)</span>
    <span class="c1">#print(&#39;GCi=%s&#39; % GCi)</span>
    <span class="k">if</span> <span class="n">ndim</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
        <span class="n">rows</span><span class="p">,</span> <span class="n">cols</span><span class="p">,</span> <span class="n">rows_reversed</span><span class="p">,</span> <span class="n">cols_reversed</span> <span class="o">=</span> <span class="n">_get_row_col_map_1d</span><span class="p">(</span><span class="n">matrix</span><span class="p">,</span> <span class="n">GCi</span><span class="p">,</span> <span class="n">GCj</span><span class="p">,</span> <span class="n">ifo</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">rows</span><span class="p">,</span> <span class="n">cols</span><span class="p">,</span> <span class="n">rows_reversed</span><span class="p">,</span> <span class="n">cols_reversed</span> <span class="o">=</span> <span class="n">_get_row_col_map_2d</span><span class="p">(</span><span class="n">matrix</span><span class="p">,</span> <span class="n">GCi</span><span class="p">,</span> <span class="n">GCj</span><span class="p">,</span> <span class="n">ifo</span><span class="p">)</span>

    <span class="n">nrows</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">rows</span><span class="p">)</span>
    <span class="n">ncols</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">cols</span><span class="p">)</span>
    <span class="k">assert</span> <span class="n">nrows</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;nrows=</span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">nrows</span>
    <span class="k">assert</span> <span class="n">ncols</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;ncols=</span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">ncols</span>
    <span class="k">return</span> <span class="n">nrows</span><span class="p">,</span> <span class="n">ncols</span><span class="p">,</span> <span class="n">ndim</span><span class="p">,</span> <span class="n">rows</span><span class="p">,</span> <span class="n">cols</span><span class="p">,</span> <span class="n">rows_reversed</span><span class="p">,</span> <span class="n">cols_reversed</span></div>

<div class="viewcode-block" id="_get_row_col_map_1d"><a class="viewcode-back" href="../../../../reference/bdf/cards/pyNastran.bdf.cards.dmig.html#pyNastran.bdf.cards.dmig._get_row_col_map_1d">[docs]</a><span class="k">def</span> <span class="nf">_get_row_col_map_1d</span><span class="p">(</span><span class="n">matrix</span><span class="p">,</span> <span class="n">GCi</span><span class="p">,</span> <span class="n">GCj</span><span class="p">,</span> <span class="n">ifo</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;helper for ``get_row_col_map``&quot;&quot;&quot;</span>
    <span class="n">rows</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="n">rows_reversed</span> <span class="o">=</span> <span class="p">{}</span>

    <span class="n">cols</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="n">cols_reversed</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="c1">#nrows = np.unique(GCi)</span>
    <span class="c1">#ncols = np.unique(GCj)</span>
    <span class="k">for</span> <span class="n">gci</span> <span class="ow">in</span> <span class="n">GCi</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">gci</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">rows</span><span class="p">:</span>
            <span class="n">rows</span><span class="p">[</span><span class="n">gci</span><span class="p">]</span> <span class="o">=</span> <span class="n">i</span>
            <span class="n">rows_reversed</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">gci</span>
            <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span>

    <span class="k">if</span> <span class="n">ifo</span> <span class="o">==</span> <span class="mi">6</span><span class="p">:</span>
        <span class="c1"># symmetric</span>
        <span class="c1">#print(GCj)</span>
        <span class="k">for</span> <span class="n">gcj</span> <span class="ow">in</span> <span class="n">GCj</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">gcj</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">rows</span><span class="p">:</span>
                <span class="c1">#print(&#39;row.gcj = %s&#39; % str(gcj))</span>
                <span class="n">rows</span><span class="p">[</span><span class="n">gcj</span><span class="p">]</span> <span class="o">=</span> <span class="n">i</span>
                <span class="n">rows_reversed</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">gcj</span>
                <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="n">cols</span> <span class="o">=</span> <span class="n">rows</span>
        <span class="n">cols_reversed</span> <span class="o">=</span> <span class="n">rows_reversed</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">j</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">for</span> <span class="n">gcj</span> <span class="ow">in</span> <span class="n">GCj</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">gcj</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">cols</span><span class="p">:</span>
                <span class="n">cols</span><span class="p">[</span><span class="n">gcj</span><span class="p">]</span> <span class="o">=</span> <span class="n">j</span>
                <span class="n">cols_reversed</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">gcj</span>
                <span class="n">j</span> <span class="o">+=</span> <span class="mi">1</span>
    <span class="k">return</span> <span class="n">rows</span><span class="p">,</span> <span class="n">cols</span><span class="p">,</span> <span class="n">rows_reversed</span><span class="p">,</span> <span class="n">cols_reversed</span></div>

<div class="viewcode-block" id="_get_row_col_map_2d"><a class="viewcode-back" href="../../../../reference/bdf/cards/pyNastran.bdf.cards.dmig.html#pyNastran.bdf.cards.dmig._get_row_col_map_2d">[docs]</a><span class="k">def</span> <span class="nf">_get_row_col_map_2d</span><span class="p">(</span><span class="n">matrix</span><span class="p">,</span> <span class="n">GCi</span><span class="p">,</span> <span class="n">GCj</span><span class="p">,</span> <span class="n">ifo</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;helper for ``get_row_col_map``&quot;&quot;&quot;</span>
    <span class="n">rows</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="n">rows_reversed</span> <span class="o">=</span> <span class="p">{}</span>

    <span class="n">cols</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="n">cols_reversed</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="c1">#print(&#39;i0=%s j0=%s&#39; % (i, j))</span>
    <span class="c1">#nrows = len(GCi)</span>
    <span class="c1">#ncols = len(GCj)</span>
    <span class="c1">#rows_array = np.zeros((nrows, 2), dtype=&#39;int32&#39;)</span>
    <span class="c1">#cols_array = np.zeros((ncols, 2), dtype=&#39;int32&#39;)</span>
    <span class="c1">#for i, (nid, comp) in enumerate(GCi):</span>
        <span class="c1">##print(&#39;i=%s nid=%s comp=%s nrows=%s rows_array.shape=%s&#39; % (</span>
            <span class="c1">##i, nid, comp, nrows, str(rows_array.shape)))</span>
        <span class="c1">#rows_array[i, :] = [nid, comp]</span>
    <span class="c1">#print(&#39;rows_array = \n%s&#39; % rows_array)</span>

    <span class="c1">#for j, (nid, comp) in enumerate(GCj):</span>
        <span class="c1">#cols_array[j, :] = [nid, comp]</span>
    <span class="c1">#print(&#39;cols_array = \n%s&#39; % cols_array)</span>

    <span class="c1">#print(GCi)</span>
    <span class="c1">#print(GCj)</span>
    <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">for</span> <span class="p">(</span><span class="n">nid</span><span class="p">,</span> <span class="n">comp</span><span class="p">)</span> <span class="ow">in</span> <span class="n">GCi</span><span class="p">:</span>
        <span class="n">gci</span> <span class="o">=</span> <span class="p">(</span><span class="n">nid</span><span class="p">,</span> <span class="n">comp</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">gci</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">rows</span><span class="p">:</span>
            <span class="c1">#print(&#39;row.gci = %s&#39; % str(gci))</span>
            <span class="n">rows</span><span class="p">[</span><span class="n">gci</span><span class="p">]</span> <span class="o">=</span> <span class="n">i</span>
            <span class="n">rows_reversed</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">gci</span>
            <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span>
    <span class="k">if</span> <span class="n">ifo</span> <span class="o">==</span> <span class="mi">6</span><span class="p">:</span>
        <span class="c1"># symmetric</span>
        <span class="k">for</span> <span class="p">(</span><span class="n">nid</span><span class="p">,</span> <span class="n">comp</span><span class="p">)</span> <span class="ow">in</span> <span class="n">GCj</span><span class="p">:</span>
            <span class="n">gcj</span> <span class="o">=</span> <span class="p">(</span><span class="n">nid</span><span class="p">,</span> <span class="n">comp</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">gcj</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">rows</span><span class="p">:</span>
                <span class="c1">#print(&#39;row.gcj = %s&#39; % str(gcj))</span>
                <span class="n">rows</span><span class="p">[</span><span class="n">gcj</span><span class="p">]</span> <span class="o">=</span> <span class="n">i</span>
                <span class="n">rows_reversed</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">gcj</span>
                <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="n">cols</span> <span class="o">=</span> <span class="n">rows</span>
        <span class="n">cols_reversed</span> <span class="o">=</span> <span class="n">rows_reversed</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">j</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">for</span> <span class="p">(</span><span class="n">nid</span><span class="p">,</span> <span class="n">comp</span><span class="p">)</span> <span class="ow">in</span> <span class="n">GCj</span><span class="p">:</span>
            <span class="n">gcj</span> <span class="o">=</span> <span class="p">(</span><span class="n">nid</span><span class="p">,</span> <span class="n">comp</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">gcj</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">cols</span><span class="p">:</span>
                <span class="c1">#print(&#39;col.gcj = %s&#39; % str(gcj))</span>
                <span class="n">cols</span><span class="p">[</span><span class="n">gcj</span><span class="p">]</span> <span class="o">=</span> <span class="n">j</span>
                <span class="n">cols_reversed</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">gcj</span>
                <span class="n">j</span> <span class="o">+=</span> <span class="mi">1</span>
    <span class="k">return</span> <span class="n">rows</span><span class="p">,</span> <span class="n">cols</span><span class="p">,</span> <span class="n">rows_reversed</span><span class="p">,</span> <span class="n">cols_reversed</span></div>

<div class="viewcode-block" id="_fill_sparse_matrix"><a class="viewcode-back" href="../../../../reference/bdf/cards/pyNastran.bdf.cards.dmig.html#pyNastran.bdf.cards.dmig._fill_sparse_matrix">[docs]</a><span class="k">def</span> <span class="nf">_fill_sparse_matrix</span><span class="p">(</span><span class="n">matrix</span><span class="p">,</span> <span class="n">nrows</span><span class="p">,</span> <span class="n">ncols</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;helper method for get_matrix&quot;&quot;&quot;</span>
    <span class="n">GCj</span> <span class="o">=</span> <span class="n">array</span><span class="p">(</span><span class="n">matrix</span><span class="o">.</span><span class="n">GCj</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="s1">&#39;int32&#39;</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span>
    <span class="n">GCi</span> <span class="o">=</span> <span class="n">array</span><span class="p">(</span><span class="n">matrix</span><span class="o">.</span><span class="n">GCi</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="s1">&#39;int32&#39;</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span>
    <span class="n">reals</span> <span class="o">=</span> <span class="n">array</span><span class="p">(</span><span class="n">matrix</span><span class="o">.</span><span class="n">Real</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="s1">&#39;float32&#39;</span><span class="p">)</span>

    <span class="c1"># TODO: matrix size:  is this correct?</span>
    <span class="n">nrows</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">GCi</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span>
    <span class="n">ncols</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">GCj</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span>

    <span class="n">dtype</span> <span class="o">=</span> <span class="n">_get_dtype</span><span class="p">(</span><span class="n">matrix</span><span class="o">.</span><span class="n">is_complex</span><span class="p">,</span> <span class="n">matrix</span><span class="o">.</span><span class="n">tin</span><span class="p">)</span>
    <span class="c1"># TODO: no check for symmetry</span>
    <span class="c1"># TODO: no check for dtype</span>
    <span class="k">if</span> <span class="n">matrix</span><span class="o">.</span><span class="n">is_complex</span><span class="p">:</span>
        <span class="n">complexs</span> <span class="o">=</span> <span class="n">array</span><span class="p">(</span><span class="n">matrix</span><span class="o">.</span><span class="n">Complex</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="s1">&#39;float32&#39;</span><span class="p">)</span>
        <span class="n">data</span> <span class="o">=</span> <span class="n">array</span><span class="p">([</span><span class="n">reals</span><span class="p">,</span> <span class="n">complexs</span><span class="p">])</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">complex</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">data</span> <span class="o">=</span> <span class="n">reals</span>

    <span class="k">if</span> <span class="n">matrix</span><span class="o">.</span><span class="n">matrix_form</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">6</span><span class="p">]:</span>
        <span class="n">nrows</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">nrows</span><span class="p">,</span> <span class="n">ncols</span><span class="p">)</span>
        <span class="n">ncols</span> <span class="o">=</span> <span class="n">nrows</span>

    <span class="c1">#A = coo_matrix( (entries,(rows,cols)),shape=(nrows,ncols),dtype=dtype) # test</span>
    <span class="n">sparse_matrix</span> <span class="o">=</span> <span class="n">coo_matrix</span><span class="p">((</span><span class="n">data</span><span class="p">,</span> <span class="p">(</span><span class="n">matrix</span><span class="o">.</span><span class="n">GCi</span><span class="p">,</span> <span class="n">matrix</span><span class="o">.</span><span class="n">GCj</span><span class="p">)),</span>
                               <span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="n">nrows</span><span class="p">,</span> <span class="n">ncols</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">dtype</span><span class="p">)</span>
    <span class="c1">#sparse_matrix = coo_matrix( (data,(matrix.GCi,matrix.GCj)),shape=(i,j)) # old</span>
    <span class="c1">#sparse_matrix = coo_matrix( (data,(matrix.GCi,matrix.GCj)),shape=(nrows,ncols))</span>
    <span class="c1">#print(sparse_matrix.toarray())</span>
    <span class="c1">#print(sparse_matrix)</span>
    <span class="k">return</span> <span class="n">sparse_matrix</span></div>


<div class="viewcode-block" id="_fill_dense_rectangular_matrix"><a class="viewcode-back" href="../../../../reference/bdf/cards/pyNastran.bdf.cards.dmig.html#pyNastran.bdf.cards.dmig._fill_dense_rectangular_matrix">[docs]</a><span class="k">def</span> <span class="nf">_fill_dense_rectangular_matrix</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">nrows</span><span class="p">,</span> <span class="n">ncols</span><span class="p">,</span> <span class="n">ndim</span><span class="p">,</span> <span class="n">rows</span><span class="p">,</span> <span class="n">cols</span><span class="p">,</span> <span class="n">apply_symmetry</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;helper method for get_matrix&quot;&quot;&quot;</span>
    <span class="n">is_sparse</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_complex</span><span class="p">:</span>
        <span class="n">dense_mat</span> <span class="o">=</span> <span class="n">zeros</span><span class="p">((</span><span class="n">nrows</span><span class="p">,</span> <span class="n">ncols</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="s1">&#39;complex128&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">matrix_form</span> <span class="o">==</span> <span class="mi">6</span> <span class="ow">and</span> <span class="n">apply_symmetry</span><span class="p">:</span>  <span class="c1"># symmetric</span>
            <span class="k">for</span> <span class="p">(</span><span class="n">gcj</span><span class="p">,</span> <span class="n">gci</span><span class="p">,</span> <span class="n">reali</span><span class="p">,</span> <span class="n">complexi</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">GCj</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">GCi</span><span class="p">,</span>
                                                   <span class="bp">self</span><span class="o">.</span><span class="n">Real</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">Complex</span><span class="p">):</span>
                <span class="n">i</span> <span class="o">=</span> <span class="n">rows</span><span class="p">[(</span><span class="n">gci</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">gci</span><span class="p">[</span><span class="mi">1</span><span class="p">])]</span>
                <span class="n">j</span> <span class="o">=</span> <span class="n">cols</span><span class="p">[(</span><span class="n">gcj</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">gcj</span><span class="p">[</span><span class="mi">1</span><span class="p">])]</span>
                <span class="n">dense_mat</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="nb">complex</span><span class="p">(</span><span class="n">reali</span><span class="p">,</span> <span class="n">complexi</span><span class="p">)</span>
                <span class="n">dense_mat</span><span class="p">[</span><span class="n">j</span><span class="p">,</span> <span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="nb">complex</span><span class="p">(</span><span class="n">reali</span><span class="p">,</span> <span class="n">complexi</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">for</span> <span class="p">(</span><span class="n">gcj</span><span class="p">,</span> <span class="n">gci</span><span class="p">,</span> <span class="n">reali</span><span class="p">,</span> <span class="n">complexi</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">GCj</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">GCi</span><span class="p">,</span>
                                                   <span class="bp">self</span><span class="o">.</span><span class="n">Real</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">Complex</span><span class="p">):</span>
                <span class="n">i</span> <span class="o">=</span> <span class="n">rows</span><span class="p">[(</span><span class="n">gci</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">gci</span><span class="p">[</span><span class="mi">1</span><span class="p">])]</span>
                <span class="n">j</span> <span class="o">=</span> <span class="n">cols</span><span class="p">[(</span><span class="n">gcj</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">gcj</span><span class="p">[</span><span class="mi">1</span><span class="p">])]</span>
                <span class="n">dense_mat</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="nb">complex</span><span class="p">(</span><span class="n">reali</span><span class="p">,</span> <span class="n">complexi</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">dense_mat</span> <span class="o">=</span> <span class="n">zeros</span><span class="p">((</span><span class="n">nrows</span><span class="p">,</span> <span class="n">ncols</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="s1">&#39;float64&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">matrix_form</span> <span class="o">==</span> <span class="mi">6</span> <span class="ow">and</span> <span class="n">apply_symmetry</span><span class="p">:</span>  <span class="c1"># symmetric</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="k">for</span> <span class="p">(</span><span class="n">gcj</span><span class="p">,</span> <span class="n">gci</span><span class="p">,</span> <span class="n">reali</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">GCj</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">GCi</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">Real</span><span class="p">):</span>
                    <span class="n">i</span> <span class="o">=</span> <span class="n">rows</span><span class="p">[(</span><span class="n">gci</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">gci</span><span class="p">[</span><span class="mi">1</span><span class="p">])]</span>
                    <span class="n">j</span> <span class="o">=</span> <span class="n">cols</span><span class="p">[(</span><span class="n">gcj</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">gcj</span><span class="p">[</span><span class="mi">1</span><span class="p">])]</span>
                    <span class="n">dense_mat</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">reali</span>
                    <span class="n">dense_mat</span><span class="p">[</span><span class="n">j</span><span class="p">,</span> <span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">reali</span>
            <span class="k">except</span> <span class="ne">IndexError</span><span class="p">:</span>
                <span class="n">msg</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;name=</span><span class="si">%s</span><span class="s1"> ndim=</span><span class="si">%s</span><span class="s1"> i=</span><span class="si">%s</span><span class="s1"> j=</span><span class="si">%s</span><span class="s1"> matrix_type=</span><span class="si">%s</span><span class="s1"> &#39;</span>
                       <span class="s1">&#39;is_polar=</span><span class="si">%s</span><span class="s1"> ncols=</span><span class="si">%s</span><span class="s1"> M.shape=</span><span class="si">%s</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span>
                           <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">ndim</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">matrix_type</span><span class="p">,</span>
                           <span class="bp">self</span><span class="o">.</span><span class="n">is_polar</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">ncols</span><span class="p">,</span> <span class="n">dense_mat</span><span class="o">.</span><span class="n">shape</span><span class="p">))</span>
                <span class="n">msg</span> <span class="o">+=</span> <span class="s1">&#39;Rows:</span><span class="se">\n</span><span class="s1">&#39;</span>
                <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">row</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">rows</span><span class="p">):</span>
                    <span class="n">msg</span> <span class="o">+=</span> <span class="s1">&#39;i=</span><span class="si">%s</span><span class="s1"> row=</span><span class="si">%s</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">row</span><span class="p">)</span>
                <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="k">for</span> <span class="p">(</span><span class="n">gcj</span><span class="p">,</span> <span class="n">gci</span><span class="p">,</span> <span class="n">reali</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">GCj</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">GCi</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">Real</span><span class="p">):</span>
                    <span class="n">i</span> <span class="o">=</span> <span class="n">rows</span><span class="p">[(</span><span class="n">gci</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">gci</span><span class="p">[</span><span class="mi">1</span><span class="p">])]</span>
                    <span class="n">j</span> <span class="o">=</span> <span class="n">cols</span><span class="p">[(</span><span class="n">gcj</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">gcj</span><span class="p">[</span><span class="mi">1</span><span class="p">])]</span>
                    <span class="n">dense_mat</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">reali</span>
            <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
                <span class="n">msg</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;name=</span><span class="si">%s</span><span class="s1"> ndim=</span><span class="si">%s</span><span class="s1"> gci=</span><span class="si">%s</span><span class="s1"> gcj=</span><span class="si">%s</span><span class="s1"> matrix_type=</span><span class="si">%s</span><span class="s1"> &#39;</span>
                       <span class="s1">&#39;is_polar=</span><span class="si">%s</span><span class="s1"> is_sparse=</span><span class="si">%s</span><span class="s1"> ncols=</span><span class="si">%s</span><span class="s1"> M.shape=</span><span class="si">%s</span><span class="se">\n\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span>
                           <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">ndim</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">gci</span><span class="p">),</span> <span class="nb">str</span><span class="p">(</span><span class="n">gcj</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">matrix_type</span><span class="p">,</span>
                           <span class="bp">self</span><span class="o">.</span><span class="n">is_polar</span><span class="p">,</span> <span class="n">is_sparse</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">ncols</span><span class="p">,</span> <span class="n">dense_mat</span><span class="o">.</span><span class="n">shape</span><span class="p">))</span>

                <span class="n">gci2</span> <span class="o">=</span> <span class="p">(</span><span class="n">gci</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">gci</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
                <span class="n">gcj2</span> <span class="o">=</span> <span class="p">(</span><span class="n">gcj</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">gcj</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
                <span class="k">if</span> <span class="n">gci2</span> <span class="ow">in</span> <span class="n">rows</span><span class="p">:</span>
                    <span class="n">msg</span> <span class="o">+=</span> <span class="s1">&#39;gci/row_key=</span><span class="si">%s</span><span class="s1"> found</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="nb">str</span><span class="p">(</span><span class="n">gci2</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">msg</span> <span class="o">+=</span> <span class="s1">&#39;gci/row_key=</span><span class="si">%s</span><span class="s1"> not found</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="nb">str</span><span class="p">(</span><span class="n">gci2</span><span class="p">)</span>
                    <span class="n">msg</span> <span class="o">+=</span> <span class="s1">&#39;Rows:</span><span class="se">\n</span><span class="s1">&#39;</span>
                    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">row</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">rows</span><span class="p">):</span>
                        <span class="n">msg</span> <span class="o">+=</span> <span class="s1">&#39;  i=</span><span class="si">%s</span><span class="s1"> row=</span><span class="si">%s</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">row</span><span class="p">)</span>

                <span class="k">if</span> <span class="n">gcj2</span> <span class="ow">in</span> <span class="n">cols</span><span class="p">:</span>
                    <span class="n">msg</span> <span class="o">+=</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">gcj/col_key=</span><span class="si">%s</span><span class="s1"> found</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="nb">str</span><span class="p">(</span><span class="n">gcj2</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">msg</span> <span class="o">+=</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">gcj/col_key=</span><span class="si">%s</span><span class="s1"> not found</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="nb">str</span><span class="p">(</span><span class="n">gcj2</span><span class="p">)</span>
                    <span class="n">msg</span> <span class="o">+=</span> <span class="s1">&#39;Cols:</span><span class="se">\n</span><span class="s1">&#39;</span>
                    <span class="k">for</span> <span class="n">j</span><span class="p">,</span> <span class="n">col</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">cols</span><span class="p">):</span>
                        <span class="n">msg</span> <span class="o">+=</span> <span class="s1">&#39;  j=</span><span class="si">%s</span><span class="s1"> row=</span><span class="si">%s</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">j</span><span class="p">,</span> <span class="n">col</span><span class="p">)</span>

                <span class="n">msg</span> <span class="o">+=</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span>
                <span class="nb">print</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
                <span class="k">raise</span> <span class="ne">KeyError</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
            <span class="k">except</span> <span class="ne">IndexError</span><span class="p">:</span>
                <span class="n">msg</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;name=</span><span class="si">%s</span><span class="s1"> ndim=</span><span class="si">%s</span><span class="s1"> i=</span><span class="si">%s</span><span class="s1"> j=</span><span class="si">%s</span><span class="s1"> matrix_type=</span><span class="si">%s</span><span class="s1"> &#39;</span>
                       <span class="s1">&#39;is_polar=</span><span class="si">%s</span><span class="s1"> is_sparse=</span><span class="si">%s</span><span class="s1"> ncols=</span><span class="si">%s</span><span class="s1"> M.shape=</span><span class="si">%s</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span>
                           <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">ndim</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">matrix_type</span><span class="p">,</span>
                           <span class="bp">self</span><span class="o">.</span><span class="n">is_polar</span><span class="p">,</span> <span class="n">is_sparse</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">ncols</span><span class="p">,</span> <span class="n">dense_mat</span><span class="o">.</span><span class="n">shape</span><span class="p">))</span>
                <span class="n">msg</span> <span class="o">+=</span> <span class="s1">&#39;Rows:</span><span class="se">\n</span><span class="s1">&#39;</span>
                <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">row</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">rows</span><span class="p">):</span>
                    <span class="n">msg</span> <span class="o">+=</span> <span class="s1">&#39;  i=</span><span class="si">%s</span><span class="s1"> row=</span><span class="si">%s</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">row</span><span class="p">)</span>

                <span class="n">msg</span> <span class="o">+=</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">Cols:</span><span class="se">\n</span><span class="s1">&#39;</span>
                <span class="k">for</span> <span class="n">j</span><span class="p">,</span> <span class="n">row</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">cols</span><span class="p">):</span>
                    <span class="n">msg</span> <span class="o">+=</span> <span class="s1">&#39;  j=</span><span class="si">%s</span><span class="s1"> row=</span><span class="si">%s</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">j</span><span class="p">,</span> <span class="n">col</span><span class="p">)</span>
                <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">dense_mat</span></div>


<div class="viewcode-block" id="_fill_dense_column_matrix"><a class="viewcode-back" href="../../../../reference/bdf/cards/pyNastran.bdf.cards.dmig.html#pyNastran.bdf.cards.dmig._fill_dense_column_matrix">[docs]</a><span class="k">def</span> <span class="nf">_fill_dense_column_matrix</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">nrows</span><span class="p">,</span> <span class="n">ncols</span><span class="p">,</span> <span class="n">ndim</span><span class="p">,</span> <span class="n">rows</span><span class="p">,</span> <span class="n">cols</span><span class="p">,</span> <span class="n">apply_symmetry</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;helper method for get_matrix&quot;&quot;&quot;</span>
    <span class="n">is_sparse</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_complex</span><span class="p">:</span>
        <span class="n">dense_mat</span> <span class="o">=</span> <span class="n">zeros</span><span class="p">((</span><span class="n">nrows</span><span class="p">,</span> <span class="n">ncols</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="s1">&#39;complex128&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">matrix_form</span> <span class="o">==</span> <span class="mi">6</span> <span class="ow">and</span> <span class="n">apply_symmetry</span><span class="p">:</span>  <span class="c1"># symmetric</span>
            <span class="k">assert</span> <span class="n">nrows</span> <span class="o">==</span> <span class="n">ncols</span><span class="p">,</span> <span class="s1">&#39;nrows=</span><span class="si">%s</span><span class="s1"> ncols=</span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">nrows</span><span class="p">,</span> <span class="n">ncols</span><span class="p">)</span>
            <span class="k">for</span> <span class="p">(</span><span class="n">gcj</span><span class="p">,</span> <span class="n">gci</span><span class="p">,</span> <span class="n">reali</span><span class="p">,</span> <span class="n">complexi</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">GCj</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">GCi</span><span class="p">,</span>
                                                   <span class="bp">self</span><span class="o">.</span><span class="n">Real</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">Complex</span><span class="p">):</span>
                <span class="n">i</span> <span class="o">=</span> <span class="n">rows</span><span class="p">[</span><span class="n">gci</span><span class="p">]</span>
                <span class="n">j</span> <span class="o">=</span> <span class="n">cols</span><span class="p">[</span><span class="n">gcj</span><span class="p">]</span>
                <span class="n">dense_mat</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="nb">complex</span><span class="p">(</span><span class="n">reali</span><span class="p">,</span> <span class="n">complexi</span><span class="p">)</span>
                <span class="n">dense_mat</span><span class="p">[</span><span class="n">j</span><span class="p">,</span> <span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="nb">complex</span><span class="p">(</span><span class="n">reali</span><span class="p">,</span> <span class="n">complexi</span><span class="p">)</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">matrix_form</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>  <span class="c1"># rectangular</span>
            <span class="k">assert</span> <span class="n">nrows</span> <span class="o">==</span> <span class="n">ncols</span><span class="p">,</span> <span class="s1">&#39;nrows=</span><span class="si">%s</span><span class="s1"> ncols=</span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">nrows</span><span class="p">,</span> <span class="n">ncols</span><span class="p">)</span>
            <span class="k">for</span> <span class="p">(</span><span class="n">gcj</span><span class="p">,</span> <span class="n">gci</span><span class="p">,</span> <span class="n">reali</span><span class="p">,</span> <span class="n">complexi</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">GCj</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">GCi</span><span class="p">,</span>
                                                   <span class="bp">self</span><span class="o">.</span><span class="n">Real</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">Complex</span><span class="p">):</span>
                <span class="n">i</span> <span class="o">=</span> <span class="n">rows</span><span class="p">[</span><span class="n">gci</span><span class="p">]</span>
                <span class="n">j</span> <span class="o">=</span> <span class="n">cols</span><span class="p">[</span><span class="n">gcj</span><span class="p">]</span>
                <span class="n">dense_mat</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="nb">complex</span><span class="p">(</span><span class="n">reali</span><span class="p">,</span> <span class="n">complexi</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">for</span> <span class="p">(</span><span class="n">gcj</span><span class="p">,</span> <span class="n">gci</span><span class="p">,</span> <span class="n">reali</span><span class="p">,</span> <span class="n">complexi</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">GCj</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">GCi</span><span class="p">,</span>
                                                   <span class="bp">self</span><span class="o">.</span><span class="n">Real</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">Complex</span><span class="p">):</span>
                <span class="n">i</span> <span class="o">=</span> <span class="n">rows</span><span class="p">[</span><span class="n">gci</span><span class="p">]</span>
                <span class="n">j</span> <span class="o">=</span> <span class="n">cols</span><span class="p">[</span><span class="n">gcj</span><span class="p">]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="c1">#print(&#39;nrows=%s ncols=%s&#39; % (nrows, ncols))</span>
        <span class="n">dense_mat</span> <span class="o">=</span> <span class="n">zeros</span><span class="p">((</span><span class="n">nrows</span><span class="p">,</span> <span class="n">ncols</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="s1">&#39;float64&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">matrix_form</span> <span class="o">==</span> <span class="mi">6</span> <span class="ow">and</span> <span class="n">apply_symmetry</span><span class="p">:</span>  <span class="c1"># symmetric</span>
            <span class="k">assert</span> <span class="n">nrows</span> <span class="o">==</span> <span class="n">ncols</span><span class="p">,</span> <span class="s1">&#39;nrows=</span><span class="si">%s</span><span class="s1"> ncols=</span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">nrows</span><span class="p">,</span> <span class="n">ncols</span><span class="p">)</span>
            <span class="k">for</span> <span class="p">(</span><span class="n">gcj</span><span class="p">,</span> <span class="n">gci</span><span class="p">,</span> <span class="n">reali</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">GCj</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">GCi</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">Real</span><span class="p">):</span>
                <span class="n">i</span> <span class="o">=</span> <span class="n">rows</span><span class="p">[</span><span class="n">gci</span><span class="p">]</span>
                <span class="n">j</span> <span class="o">=</span> <span class="n">cols</span><span class="p">[</span><span class="n">gcj</span><span class="p">]</span>
                <span class="n">dense_mat</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">reali</span>
                <span class="n">dense_mat</span><span class="p">[</span><span class="n">j</span><span class="p">,</span> <span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">reali</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="k">for</span> <span class="p">(</span><span class="n">gcj</span><span class="p">,</span> <span class="n">gci</span><span class="p">,</span> <span class="n">reali</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">GCj</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">GCi</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">Real</span><span class="p">):</span>
                    <span class="n">i</span> <span class="o">=</span> <span class="n">rows</span><span class="p">[</span><span class="n">gci</span><span class="p">]</span>
                    <span class="n">j</span> <span class="o">=</span> <span class="n">cols</span><span class="p">[</span><span class="n">gcj</span><span class="p">]</span>
                    <span class="n">dense_mat</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">reali</span>
            <span class="k">except</span> <span class="ne">IndexError</span><span class="p">:</span>
                <span class="n">msg</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;name=</span><span class="si">%s</span><span class="s1"> ndim=</span><span class="si">%s</span><span class="s1"> i=</span><span class="si">%s</span><span class="s1"> j=</span><span class="si">%s</span><span class="s1"> matrix_type=</span><span class="si">%s</span><span class="s1"> &#39;</span>
                       <span class="s1">&#39;is_polar=</span><span class="si">%s</span><span class="s1"> is_sparse=</span><span class="si">%s</span><span class="s1"> ncols=</span><span class="si">%s</span><span class="s1"> M.shape=</span><span class="si">%s</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span>
                           <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">ndim</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">matrix_type</span><span class="p">,</span>
                           <span class="bp">self</span><span class="o">.</span><span class="n">is_polar</span><span class="p">,</span> <span class="n">is_sparse</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">ncols</span><span class="p">,</span> <span class="n">dense_mat</span><span class="o">.</span><span class="n">shape</span><span class="p">))</span>
                <span class="n">msg</span> <span class="o">+=</span> <span class="s1">&#39;Rows:</span><span class="se">\n</span><span class="s1">&#39;</span>
                <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">row</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">rows</span><span class="p">):</span>
                    <span class="n">msg</span> <span class="o">+=</span> <span class="s1">&#39;  i=</span><span class="si">%s</span><span class="s1"> row=</span><span class="si">%s</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">row</span><span class="p">)</span>
                <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">dense_mat</span></div>

<div class="viewcode-block" id="get_dmi_matrix"><a class="viewcode-back" href="../../../../reference/bdf/cards/pyNastran.bdf.cards.dmig.html#pyNastran.bdf.cards.dmig.get_dmi_matrix">[docs]</a><span class="k">def</span> <span class="nf">get_dmi_matrix</span><span class="p">(</span><span class="n">matrix</span><span class="p">:</span> <span class="n">DMI</span><span class="p">,</span> <span class="n">is_sparse</span><span class="p">:</span> <span class="nb">bool</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                   <span class="n">apply_symmetry</span><span class="p">:</span> <span class="nb">bool</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">]:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Builds the Matrix</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    is_sparse : bool</span>
<span class="sd">        should the matrix be returned as a sparse matrix (default=True).</span>
<span class="sd">        Slower for dense matrices.</span>
<span class="sd">    apply_symmetry: bool</span>
<span class="sd">        If the matrix is symmetric (matrix_form=6), returns a symmetric matrix.</span>
<span class="sd">        Supported as there are symmetric matrix routines.</span>
<span class="sd">        TODO: unused...</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    M : ndarray</span>
<span class="sd">        the matrix</span>
<span class="sd">    rows : None</span>
<span class="sd">        unused</span>
<span class="sd">    cols : None</span>
<span class="sd">        unused</span>

<span class="sd">    .. warning:: is_sparse=True WILL fail</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">ifo</span> <span class="o">=</span> <span class="n">matrix</span><span class="o">.</span><span class="n">ifo</span>
    <span class="n">GCj</span> <span class="o">=</span> <span class="n">array</span><span class="p">(</span><span class="n">matrix</span><span class="o">.</span><span class="n">GCj</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="s1">&#39;int32&#39;</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span>
    <span class="n">GCi</span> <span class="o">=</span> <span class="n">array</span><span class="p">(</span><span class="n">matrix</span><span class="o">.</span><span class="n">GCi</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="s1">&#39;int32&#39;</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span>

    <span class="n">dtype</span> <span class="o">=</span> <span class="n">matrix</span><span class="o">.</span><span class="n">tin_dtype</span>

    <span class="k">if</span> <span class="n">matrix</span><span class="o">.</span><span class="n">is_complex</span><span class="p">:</span>
        <span class="n">data</span> <span class="o">=</span> <span class="n">matrix</span><span class="o">.</span><span class="n">Real</span> <span class="o">+</span> <span class="n">matrix</span><span class="o">.</span><span class="n">Complex</span> <span class="o">*</span> <span class="mi">1</span><span class="n">j</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">data</span> <span class="o">=</span> <span class="n">matrix</span><span class="o">.</span><span class="n">Real</span>

    <span class="k">if</span> <span class="n">ifo</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
        <span class="c1"># rectangular</span>
        <span class="n">nrows</span> <span class="o">=</span> <span class="n">matrix</span><span class="o">.</span><span class="n">nrows</span>
        <span class="n">ncols</span> <span class="o">=</span> <span class="n">matrix</span><span class="o">.</span><span class="n">ncols</span>

        <span class="n">M</span> <span class="o">=</span> <span class="n">coo_matrix</span><span class="p">((</span><span class="n">data</span><span class="p">,</span> <span class="p">(</span><span class="n">GCi</span><span class="p">,</span> <span class="n">GCj</span><span class="p">)),</span>
                       <span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="n">nrows</span><span class="p">,</span> <span class="n">ncols</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">dtype</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">is_sparse</span><span class="p">:</span>
            <span class="n">M</span> <span class="o">=</span> <span class="n">M</span><span class="o">.</span><span class="n">toarray</span><span class="p">()</span>

    <span class="k">else</span><span class="p">:</span>
        <span class="n">nrows</span> <span class="o">=</span> <span class="n">matrix</span><span class="o">.</span><span class="n">nrows</span>
        <span class="n">ncols</span> <span class="o">=</span> <span class="n">matrix</span><span class="o">.</span><span class="n">ncols</span>
        <span class="k">if</span> <span class="n">ifo</span> <span class="o">==</span> <span class="mi">6</span><span class="p">:</span>
            <span class="n">nrows</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">nrows</span><span class="p">,</span> <span class="n">ncols</span><span class="p">)</span>
            <span class="n">ncols</span> <span class="o">=</span> <span class="n">nrows</span>
        <span class="n">M</span> <span class="o">=</span> <span class="n">coo_matrix</span><span class="p">((</span><span class="n">data</span><span class="p">,</span> <span class="p">(</span><span class="n">GCi</span><span class="p">,</span> <span class="n">GCj</span><span class="p">)),</span>
                       <span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="n">nrows</span><span class="p">,</span> <span class="n">ncols</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">dtype</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">is_sparse</span><span class="p">:</span>
            <span class="n">M</span> <span class="o">=</span> <span class="n">M</span><span class="o">.</span><span class="n">toarray</span><span class="p">()</span>
    <span class="c1">#else:</span>
        <span class="c1">#ifo : int</span>
        <span class="c1">#    matrix shape</span>
        <span class="c1">#    4=Lower Triangular</span>
        <span class="c1">#    5=Upper Triangular</span>
        <span class="c1">#    6=Symmetric</span>
        <span class="c1">#    8=Identity (m=nRows, n=m)</span>
        <span class="c1">#raise RuntimeError(matrix.get_stats())</span>
    <span class="k">return</span> <span class="n">M</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span></div>

<div class="viewcode-block" id="get_matrix"><a class="viewcode-back" href="../../../../reference/bdf/cards/pyNastran.bdf.cards.dmig.html#pyNastran.bdf.cards.dmig.get_matrix">[docs]</a><span class="k">def</span> <span class="nf">get_matrix</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">is_sparse</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">apply_symmetry</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Builds the Matrix</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    is_sparse : bool</span>
<span class="sd">        should the matrix be returned as a sparse matrix (default=True).</span>
<span class="sd">        Slower for dense matrices.</span>
<span class="sd">    apply_symmetry: bool</span>
<span class="sd">        If the matrix is symmetric (matrix_form=6), returns a symmetric matrix.</span>
<span class="sd">        Supported as there are symmetric matrix routines.</span>
<span class="sd">        TODO: unused...</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    M : ndarray</span>
<span class="sd">        the matrix</span>
<span class="sd">    rows : Dict[(nid, nid)] = float</span>
<span class="sd">        dictionary of keys=rowID,    values=(Grid,Component) for the matrix</span>
<span class="sd">    cols : Dict[](int, int)] = float</span>
<span class="sd">        dictionary of keys=columnID, values=(Grid,Component) for the matrix</span>

<span class="sd">    .. warning:: is_sparse=True WILL fail</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">nrows</span><span class="p">,</span> <span class="n">ncols</span><span class="p">,</span> <span class="n">ndim</span><span class="p">,</span> <span class="n">rows</span><span class="p">,</span> <span class="n">cols</span><span class="p">,</span> <span class="n">rows_reversed</span><span class="p">,</span> <span class="n">cols_reversed</span> <span class="o">=</span> <span class="n">get_row_col_map</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">GCi</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">GCj</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">matrix_form</span><span class="p">)</span>
    <span class="c1">#print(&#39;rows = &#39;, rows)</span>
    <span class="c1">#print(&#39;cols = &#39;, cols)</span>
    <span class="c1">#print(&#39;i=%s j=%s&#39; % (i, j))</span>
    <span class="c1">#nrows = len(rows2)</span>
    <span class="c1">#ncols = len(cols2)</span>

    <span class="c1">#A = ss.lil_matrix((3,3), dtype=&#39;d&#39;) # double precision</span>
    <span class="c1">#rows = []</span>
    <span class="c1">#cols = []</span>
    <span class="c1">#data = []</span>
    <span class="c1">#for i in range(3):</span>
       <span class="c1">#for j in range(3):</span>
           <span class="c1">#k = float((i+1)*(j+1))</span>
           <span class="c1">#rows.append(i)</span>
           <span class="c1">#cols.append(j)</span>
           <span class="c1">#data.append(k)</span>
           <span class="c1">#A[i,j] = k</span>

    <span class="c1">#is_sparse = False</span>
    <span class="k">if</span> <span class="n">is_sparse</span><span class="p">:</span>
        <span class="n">M</span> <span class="o">=</span> <span class="n">_fill_sparse_matrix</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">nrows</span><span class="p">,</span> <span class="n">ncols</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">M</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">ndim</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">M</span> <span class="o">=</span> <span class="n">_fill_dense_column_matrix</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">nrows</span><span class="p">,</span> <span class="n">ncols</span><span class="p">,</span> <span class="n">ndim</span><span class="p">,</span> <span class="n">rows</span><span class="p">,</span> <span class="n">cols</span><span class="p">,</span> <span class="n">apply_symmetry</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">M</span> <span class="o">=</span> <span class="n">_fill_dense_rectangular_matrix</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">nrows</span><span class="p">,</span> <span class="n">ncols</span><span class="p">,</span> <span class="n">ndim</span><span class="p">,</span> <span class="n">rows</span><span class="p">,</span> <span class="n">cols</span><span class="p">,</span> <span class="n">apply_symmetry</span><span class="p">)</span>

        <span class="c1">#print(M)</span>
        <span class="k">return</span> <span class="p">(</span><span class="n">M</span><span class="p">,</span> <span class="n">rows_reversed</span><span class="p">,</span> <span class="n">cols_reversed</span><span class="p">)</span></div>


<div class="viewcode-block" id="_export_dmig_to_hdf5"><a class="viewcode-back" href="../../../../reference/bdf/cards/pyNastran.bdf.cards.dmig.html#pyNastran.bdf.cards.dmig._export_dmig_to_hdf5">[docs]</a><span class="k">def</span> <span class="nf">_export_dmig_to_hdf5</span><span class="p">(</span><span class="n">h5_file</span><span class="p">,</span> <span class="n">model</span><span class="p">,</span> <span class="n">dict_obj</span><span class="p">,</span> <span class="n">encoding</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;export dmigs, dmij, dmiji, dmik, dmi&quot;&quot;&quot;</span>
    <span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">dmig</span> <span class="ow">in</span> <span class="n">dict_obj</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="n">dmig_group</span> <span class="o">=</span> <span class="n">h5_file</span><span class="o">.</span><span class="n">create_group</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
        <span class="n">dmig_group</span><span class="o">.</span><span class="n">create_dataset</span><span class="p">(</span><span class="s1">&#39;tin&#39;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">dmig</span><span class="o">.</span><span class="n">tin</span><span class="p">)</span>

        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">dmig</span><span class="p">,</span> <span class="s1">&#39;tout&#39;</span><span class="p">):</span>
            <span class="n">dmig_group</span><span class="o">.</span><span class="n">create_dataset</span><span class="p">(</span><span class="s1">&#39;tout&#39;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">dmig</span><span class="o">.</span><span class="n">tout</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">dmig</span><span class="o">.</span><span class="n">type</span> <span class="o">==</span> <span class="s1">&#39;DMIG&#39;</span> <span class="ow">and</span> <span class="n">name</span> <span class="o">==</span> <span class="s1">&#39;UACCEL&#39;</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">dmig</span><span class="o">.</span><span class="n">ncol</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">dmig_group</span><span class="o">.</span><span class="n">create_dataset</span><span class="p">(</span><span class="s1">&#39;ncol&#39;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">dmig</span><span class="o">.</span><span class="n">ncol</span><span class="p">)</span>
            <span class="c1">#load_seq_group = dmig_group.create_group(&#39;load_sequences&#39;)</span>

            <span class="n">nids</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="n">dofs</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="n">values</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">for</span> <span class="n">lseq</span><span class="p">,</span> <span class="n">ncx</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">dmig</span><span class="o">.</span><span class="n">load_sequences</span><span class="o">.</span><span class="n">items</span><span class="p">()):</span>
                <span class="n">lseq_group</span> <span class="o">=</span> <span class="n">dmig_group</span><span class="o">.</span><span class="n">create_group</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">lseq</span><span class="p">))</span>
                <span class="c1">#list_fields += [lseq, None, None]</span>
                <span class="k">for</span> <span class="p">(</span><span class="n">nid</span><span class="p">,</span> <span class="n">dof</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span> <span class="ow">in</span> <span class="n">ncx</span><span class="p">:</span>
                    <span class="n">nids</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">nid</span><span class="p">)</span>
                    <span class="n">dofs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">dof</span><span class="p">))</span>
                    <span class="n">values</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>

                    <span class="c1">#print(&#39;nids =&#39;, nids)</span>
                    <span class="c1">#print(&#39;dofs =&#39;, dofs)</span>
                    <span class="c1">#print(&#39;values =&#39;, values)</span>
                <span class="n">lseq_group</span><span class="o">.</span><span class="n">create_dataset</span><span class="p">(</span><span class="s1">&#39;nids&#39;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">nids</span><span class="p">)</span>
                <span class="n">lseq_group</span><span class="o">.</span><span class="n">create_dataset</span><span class="p">(</span><span class="s1">&#39;dofs&#39;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">dofs</span><span class="p">)</span>
                <span class="n">lseq_group</span><span class="o">.</span><span class="n">create_dataset</span><span class="p">(</span><span class="s1">&#39;values&#39;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">values</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">dmig</span><span class="p">,</span> <span class="s1">&#39;nrows&#39;</span><span class="p">)</span> <span class="ow">and</span> <span class="n">dmig</span><span class="o">.</span><span class="n">nrows</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">dmig_group</span><span class="o">.</span><span class="n">create_dataset</span><span class="p">(</span><span class="s1">&#39;nrows&#39;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">dmig</span><span class="o">.</span><span class="n">nrows</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">dmig</span><span class="o">.</span><span class="n">ncols</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">dmig_group</span><span class="o">.</span><span class="n">create_dataset</span><span class="p">(</span><span class="s1">&#39;ncols&#39;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">dmig</span><span class="o">.</span><span class="n">ncols</span><span class="p">)</span>
            <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">dmig</span><span class="p">,</span> <span class="s1">&#39;polar&#39;</span><span class="p">):</span>
                <span class="n">dmig_group</span><span class="o">.</span><span class="n">create_dataset</span><span class="p">(</span><span class="s1">&#39;polar&#39;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">dmig</span><span class="o">.</span><span class="n">polar</span><span class="p">)</span>

            <span class="n">dmig_group</span><span class="o">.</span><span class="n">create_dataset</span><span class="p">(</span><span class="s1">&#39;matrix_form&#39;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">dmig</span><span class="o">.</span><span class="n">matrix_form</span><span class="p">)</span>
            <span class="n">dmig_group</span><span class="o">.</span><span class="n">create_dataset</span><span class="p">(</span><span class="s1">&#39;tin_dtype&#39;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">dmig</span><span class="o">.</span><span class="n">tin_dtype</span><span class="p">)</span>
            <span class="n">dmig_group</span><span class="o">.</span><span class="n">create_dataset</span><span class="p">(</span><span class="s1">&#39;tout_dtype&#39;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">dmig</span><span class="o">.</span><span class="n">tout_dtype</span><span class="p">)</span>

            <span class="n">dmig_group</span><span class="o">.</span><span class="n">create_dataset</span><span class="p">(</span><span class="s1">&#39;matrix_type&#39;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">dmig</span><span class="o">.</span><span class="n">matrix_type</span><span class="p">)</span>
            <span class="n">dmig_group</span><span class="o">.</span><span class="n">create_dataset</span><span class="p">(</span><span class="s1">&#39;is_complex&#39;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">dmig</span><span class="o">.</span><span class="n">is_complex</span><span class="p">)</span>
            <span class="n">dmig_group</span><span class="o">.</span><span class="n">create_dataset</span><span class="p">(</span><span class="s1">&#39;is_real&#39;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">dmig</span><span class="o">.</span><span class="n">is_real</span><span class="p">)</span>
            <span class="n">dmig_group</span><span class="o">.</span><span class="n">create_dataset</span><span class="p">(</span><span class="s1">&#39;is_polar&#39;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">dmig</span><span class="o">.</span><span class="n">is_polar</span><span class="p">)</span>

            <span class="n">dmig_group</span><span class="o">.</span><span class="n">create_dataset</span><span class="p">(</span><span class="s1">&#39;GCi&#39;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">dmig</span><span class="o">.</span><span class="n">GCi</span><span class="p">)</span>
            <span class="n">dmig_group</span><span class="o">.</span><span class="n">create_dataset</span><span class="p">(</span><span class="s1">&#39;GCj&#39;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">dmig</span><span class="o">.</span><span class="n">GCj</span><span class="p">)</span>
            <span class="n">dmig_group</span><span class="o">.</span><span class="n">create_dataset</span><span class="p">(</span><span class="s1">&#39;Real&#39;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">dmig</span><span class="o">.</span><span class="n">Real</span><span class="p">)</span>
            <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">dmig</span><span class="p">,</span> <span class="s1">&#39;Complex&#39;</span><span class="p">)</span> <span class="ow">and</span> <span class="n">dmig</span><span class="o">.</span><span class="n">Complex</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">dmig_group</span><span class="o">.</span><span class="n">create_dataset</span><span class="p">(</span><span class="s1">&#39;Complex&#39;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">dmig</span><span class="o">.</span><span class="n">Complex</span><span class="p">)</span></div>


<div class="viewcode-block" id="_export_dmiax_to_hdf5"><a class="viewcode-back" href="../../../../reference/bdf/cards/pyNastran.bdf.cards.dmig.html#pyNastran.bdf.cards.dmig._export_dmiax_to_hdf5">[docs]</a><span class="k">def</span> <span class="nf">_export_dmiax_to_hdf5</span><span class="p">(</span><span class="n">h5_file</span><span class="p">,</span> <span class="n">model</span><span class="p">,</span> <span class="n">dict_obj</span><span class="p">,</span> <span class="n">encoding</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;export dmiax&quot;&quot;&quot;</span>
    <span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">dmiax</span> <span class="ow">in</span> <span class="n">dict_obj</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="c1">#print(f&#39;exporting {dmiax.type} name={name!r}&#39;)</span>
        <span class="n">dmiax_group</span> <span class="o">=</span> <span class="n">h5_file</span><span class="o">.</span><span class="n">create_group</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
        <span class="n">dmiax_group</span><span class="o">.</span><span class="n">create_dataset</span><span class="p">(</span><span class="s1">&#39;tin&#39;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">dmiax</span><span class="o">.</span><span class="n">tin</span><span class="p">)</span>

        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">dmiax</span><span class="p">,</span> <span class="s1">&#39;tout&#39;</span><span class="p">):</span>
            <span class="n">dmiax_group</span><span class="o">.</span><span class="n">create_dataset</span><span class="p">(</span><span class="s1">&#39;tout&#39;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">dmiax</span><span class="o">.</span><span class="n">tout</span><span class="p">)</span>

        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">dmiax</span><span class="p">,</span> <span class="s1">&#39;nrows&#39;</span><span class="p">)</span> <span class="ow">and</span> <span class="n">dmiax</span><span class="o">.</span><span class="n">nrows</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">dmiax_group</span><span class="o">.</span><span class="n">create_dataset</span><span class="p">(</span><span class="s1">&#39;nrows&#39;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">dmiax</span><span class="o">.</span><span class="n">nrows</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">dmiax</span><span class="o">.</span><span class="n">ncols</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">dmiax_group</span><span class="o">.</span><span class="n">create_dataset</span><span class="p">(</span><span class="s1">&#39;ncols&#39;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">dmiax</span><span class="o">.</span><span class="n">ncols</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">dmiax</span><span class="p">,</span> <span class="s1">&#39;polar&#39;</span><span class="p">):</span>
            <span class="n">dmiax_group</span><span class="o">.</span><span class="n">create_dataset</span><span class="p">(</span><span class="s1">&#39;polar&#39;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">dmiax</span><span class="o">.</span><span class="n">polar</span><span class="p">)</span>

        <span class="n">dmiax_group</span><span class="o">.</span><span class="n">create_dataset</span><span class="p">(</span><span class="s1">&#39;matrix_form&#39;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">dmiax</span><span class="o">.</span><span class="n">matrix_form</span><span class="p">)</span>
        <span class="n">dmiax_group</span><span class="o">.</span><span class="n">create_dataset</span><span class="p">(</span><span class="s1">&#39;tin_dtype&#39;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">dmiax</span><span class="o">.</span><span class="n">tin_dtype</span><span class="p">)</span>
        <span class="n">dmiax_group</span><span class="o">.</span><span class="n">create_dataset</span><span class="p">(</span><span class="s1">&#39;tout_dtype&#39;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">dmiax</span><span class="o">.</span><span class="n">tout_dtype</span><span class="p">)</span>

        <span class="n">dmiax_group</span><span class="o">.</span><span class="n">create_dataset</span><span class="p">(</span><span class="s1">&#39;matrix_type&#39;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">dmiax</span><span class="o">.</span><span class="n">matrix_type</span><span class="p">)</span>
        <span class="n">dmiax_group</span><span class="o">.</span><span class="n">create_dataset</span><span class="p">(</span><span class="s1">&#39;is_complex&#39;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">dmiax</span><span class="o">.</span><span class="n">is_complex</span><span class="p">)</span>
        <span class="n">dmiax_group</span><span class="o">.</span><span class="n">create_dataset</span><span class="p">(</span><span class="s1">&#39;is_real&#39;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">dmiax</span><span class="o">.</span><span class="n">is_real</span><span class="p">)</span>
        <span class="n">dmiax_group</span><span class="o">.</span><span class="n">create_dataset</span><span class="p">(</span><span class="s1">&#39;is_polar&#39;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">dmiax</span><span class="o">.</span><span class="n">is_polar</span><span class="p">)</span>

        <span class="n">gcnj</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">j_none_flags</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="n">gcni</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">i_none_flags</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">j</span><span class="p">,</span> <span class="n">GCNj</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">dmiax</span><span class="o">.</span><span class="n">GCNj</span><span class="p">):</span>
            <span class="n">gj</span><span class="p">,</span> <span class="n">cj</span><span class="p">,</span> <span class="n">nj</span> <span class="o">=</span> <span class="n">GCNj</span>
            <span class="n">is_none_flag_j</span> <span class="o">=</span> <span class="kc">False</span>
            <span class="k">if</span> <span class="n">nj</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">nj</span> <span class="o">=</span> <span class="mi">0</span>
                <span class="n">is_none_flag_j</span> <span class="o">=</span> <span class="kc">True</span>
            <span class="n">j_none_flags</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">is_none_flag_j</span><span class="p">)</span>
            <span class="n">gcnj</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">gj</span><span class="p">,</span> <span class="n">cj</span><span class="p">,</span> <span class="n">nj</span><span class="p">))</span>
            <span class="k">for</span> <span class="n">unused_i</span><span class="p">,</span> <span class="n">GCNi</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">dmiax</span><span class="o">.</span><span class="n">GCNi</span><span class="p">[</span><span class="n">j</span><span class="p">]):</span>
                <span class="n">gi</span><span class="p">,</span> <span class="n">ci</span><span class="p">,</span> <span class="n">ni</span> <span class="o">=</span> <span class="n">GCNi</span>
                <span class="n">is_none_flag_i</span> <span class="o">=</span> <span class="kc">False</span>
                <span class="k">if</span> <span class="n">ni</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="n">ni</span> <span class="o">=</span> <span class="mi">0</span>
                    <span class="n">is_none_flag_i</span> <span class="o">=</span> <span class="kc">True</span>
                <span class="n">i_none_flags</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">is_none_flag_i</span><span class="p">)</span>
                <span class="n">gcni</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">gi</span><span class="p">,</span> <span class="n">ci</span><span class="p">,</span> <span class="n">ni</span><span class="p">,</span> <span class="n">j</span><span class="p">))</span>

        <span class="n">dmiax_group</span><span class="o">.</span><span class="n">create_dataset</span><span class="p">(</span><span class="s1">&#39;GCNi_j&#39;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">gcni</span><span class="p">)</span>
        <span class="n">dmiax_group</span><span class="o">.</span><span class="n">create_dataset</span><span class="p">(</span><span class="s1">&#39;GCNj&#39;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">gcnj</span><span class="p">)</span>
        <span class="n">dmiax_group</span><span class="o">.</span><span class="n">create_dataset</span><span class="p">(</span><span class="s1">&#39;i_none_flags&#39;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">i_none_flags</span><span class="p">)</span>
        <span class="n">dmiax_group</span><span class="o">.</span><span class="n">create_dataset</span><span class="p">(</span><span class="s1">&#39;j_none_flags&#39;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">j_none_flags</span><span class="p">)</span>

        <span class="n">dmiax_group</span><span class="o">.</span><span class="n">create_dataset</span><span class="p">(</span><span class="s1">&#39;Real&#39;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">dmiax</span><span class="o">.</span><span class="n">Real</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">dmiax</span><span class="p">,</span> <span class="s1">&#39;Complex&#39;</span><span class="p">)</span> <span class="ow">and</span> <span class="n">dmiax</span><span class="o">.</span><span class="n">Complex</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">dmiax_group</span><span class="o">.</span><span class="n">create_dataset</span><span class="p">(</span><span class="s1">&#39;Complex&#39;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">dmiax</span><span class="o">.</span><span class="n">Complex</span><span class="p">)</span></div>

<div class="viewcode-block" id="_set_polar"><a class="viewcode-back" href="../../../../reference/bdf/cards/pyNastran.bdf.cards.dmig.html#pyNastran.bdf.cards.dmig._set_polar">[docs]</a><span class="k">def</span> <span class="nf">_set_polar</span><span class="p">(</span><span class="n">polar</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">polar</span> <span class="ow">in</span> <span class="p">[</span><span class="kc">None</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="kc">False</span><span class="p">]:</span>
        <span class="n">polar</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">elif</span> <span class="n">polar</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="kc">True</span><span class="p">]:</span>
        <span class="n">polar</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;polar=</span><span class="si">%r</span><span class="s1"> and must be 0 or 1&#39;</span> <span class="o">%</span> <span class="n">polar</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">polar</span></div>

<span class="k">def</span> <span class="nf">_get_dtype</span><span class="p">(</span><span class="n">is_complex</span><span class="p">,</span> <span class="n">type_flag</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">type_flag</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
        <span class="n">dtype</span> <span class="o">=</span> <span class="s1">&#39;float32&#39;</span>
    <span class="k">elif</span> <span class="n">type_flag</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
        <span class="n">dtype</span> <span class="o">=</span> <span class="s1">&#39;float64&#39;</span>
    <span class="k">elif</span> <span class="n">type_flag</span> <span class="o">==</span> <span class="mi">3</span><span class="p">:</span>
        <span class="n">dtype</span> <span class="o">=</span> <span class="s1">&#39;complex64&#39;</span>
    <span class="k">elif</span> <span class="n">type_flag</span> <span class="o">==</span> <span class="mi">4</span><span class="p">:</span>
        <span class="n">dtype</span> <span class="o">=</span> <span class="s1">&#39;complex128&#39;</span>
    <span class="k">elif</span> <span class="n">type_flag</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">is_complex</span><span class="p">:</span>
            <span class="n">dtype</span> <span class="o">=</span> <span class="s1">&#39;complex128&#39;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">dtype</span> <span class="o">=</span> <span class="s1">&#39;float64&#39;</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s2">&quot;invalid option for matrix format&quot;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">dtype</span>

</pre></div>

           </div>
           
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>
        &#169; Copyright 2021, Steven Doyle.

    </p>
  </div>
    
    
    
    Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>
        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>