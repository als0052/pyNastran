

<!DOCTYPE html>
<html class="writer-html4" lang="en" >
<head>
  <meta charset="utf-8" />
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
  <title>pyNastran.bdf.bdf_interface.write_mesh &mdash; pyNastran 1.4-dev 1.4-dev documentation</title>
  

  
  <link rel="stylesheet" href="../../../../_static/css/my_theme.css" type="text/css" />
  <link rel="stylesheet" href="../../../../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../../../../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../../../../_static/css/my_theme.css" type="text/css" />
  <link rel="stylesheet" href="../../../../_static/graphviz.css" type="text/css" />

  
  

  
  

  

  
  <!--[if lt IE 9]>
    <script src="../../../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../../../" src="../../../../_static/documentation_options.js"></script>
        <script data-url_root="../../../../" id="documentation_options" src="../../../../_static/documentation_options.js"></script>
        <script src="../../../../_static/jquery.js"></script>
        <script src="../../../../_static/underscore.js"></script>
        <script src="../../../../_static/doctools.js"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    
    <script type="text/javascript" src="../../../../_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="../../../../genindex.html" />
    <link rel="search" title="Search" href="../../../../search.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../../../../index.html" class="icon icon-home"> pyNastran 1.4-dev
          

          
            
            <img src="../../../../_static/logo.png" class="logo" alt="Logo"/>
          
          </a>

          
            
            
              <div class="version">
                1.4-dev
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul>
<li class="toctree-l1"><a class="reference internal" href="../../../../installation/index.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../quick_start/index.html">Quick Start</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../how_to/index.html">How To: pyNastran</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../reference/pyNastran.html">pyNastran Package</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../manual/index.html">pyNastran Manual</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../../index.html">pyNastran 1.4-dev</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          

















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../../../index.html" class="icon icon-home"></a> &raquo;</li>
        
          <li><a href="../../../index.html">Module code</a> &raquo;</li>
        
      <li>pyNastran.bdf.bdf_interface.write_mesh</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <h1>Source code for pyNastran.bdf.bdf_interface.write_mesh</h1><div class="highlight"><pre>
<span></span><span class="c1"># coding: utf-8</span>
<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">This file defines:</span>
<span class="sd">  - WriteMesh</span>

<span class="sd">&quot;&quot;&quot;</span>
<span class="kn">import</span> <span class="nn">sys</span>
<span class="kn">from</span> <span class="nn">io</span> <span class="kn">import</span> <span class="n">StringIO</span><span class="p">,</span> <span class="n">IOBase</span>
<span class="kn">from</span> <span class="nn">collections</span> <span class="kn">import</span> <span class="n">defaultdict</span><span class="p">,</span> <span class="n">OrderedDict</span>
<span class="kn">from</span> <span class="nn">typing</span> <span class="kn">import</span> <span class="n">List</span><span class="p">,</span> <span class="n">Dict</span><span class="p">,</span> <span class="n">Union</span><span class="p">,</span> <span class="n">Optional</span><span class="p">,</span> <span class="n">Tuple</span><span class="p">,</span> <span class="n">Any</span><span class="p">,</span> <span class="n">cast</span>

<span class="kn">from</span> <span class="nn">pyNastran.bdf.field_writer_8</span> <span class="kn">import</span> <span class="n">print_card_8</span>
<span class="kn">from</span> <span class="nn">pyNastran.bdf.field_writer_16</span> <span class="kn">import</span> <span class="n">print_card_16</span>
<span class="kn">from</span> <span class="nn">pyNastran.bdf.bdf_interface.attributes</span> <span class="kn">import</span> <span class="n">BDFAttributes</span>
<span class="kn">from</span> <span class="nn">pyNastran.bdf.cards.nodes</span> <span class="kn">import</span> <span class="n">write_xpoints</span>


<span class="k">class</span> <span class="nc">WriteMesh</span><span class="p">(</span><span class="n">BDFAttributes</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Defines methods for writing cards</span>

<span class="sd">    Major methods:</span>
<span class="sd">      - model.write_bdf(...)</span>
<span class="sd">      - model.echo_bdf(...)</span>
<span class="sd">      - model.auto_reject_bdf(...)</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;creates methods for writing cards&quot;&quot;&quot;</span>
        <span class="n">BDFAttributes</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_auto_reject</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">cards_to_read</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">get_encoding</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">encoding</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;gets the file encoding&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">encoding</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">pass</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">encoding</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_encoding</span>
            <span class="k">if</span> <span class="n">encoding</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">encoding</span> <span class="o">=</span> <span class="n">sys</span><span class="o">.</span><span class="n">getdefaultencoding</span><span class="p">()</span>
        <span class="n">encoding</span> <span class="o">=</span> <span class="n">cast</span><span class="p">(</span><span class="nb">str</span><span class="p">,</span> <span class="n">encoding</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">encoding</span>

    <span class="k">def</span> <span class="nf">_output_helper</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">out_filename</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="n">interspersed</span><span class="p">:</span> <span class="nb">bool</span><span class="p">,</span>
                       <span class="n">size</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">is_double</span><span class="p">:</span> <span class="nb">bool</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Performs type checking on the write_bdf inputs</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">out_filename</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="kn">from</span> <span class="nn">pyNastran.utils.gui_io</span> <span class="kn">import</span> <span class="n">save_file_dialog</span>
            <span class="n">wildcard_wx</span> <span class="o">=</span> <span class="s2">&quot;Nastran BDF (*.bdf; *.dat; *.nas; *.pch)|&quot;</span> \
                <span class="s2">&quot;*.bdf;*.dat;*.nas;*.pch|&quot;</span> \
                <span class="s2">&quot;All files (*.*)|*.*&quot;</span>
            <span class="n">wildcard_qt</span> <span class="o">=</span> <span class="s2">&quot;Nastran BDF (*.bdf *.dat *.nas *.pch);;All files (*)&quot;</span>
            <span class="n">title</span> <span class="o">=</span> <span class="s1">&#39;Save BDF/DAT/PCH&#39;</span>
            <span class="n">out_filename</span> <span class="o">=</span> <span class="n">save_file_dialog</span><span class="p">(</span><span class="n">title</span><span class="p">,</span> <span class="n">wildcard_wx</span><span class="p">,</span> <span class="n">wildcard_qt</span><span class="p">)</span>
            <span class="k">assert</span> <span class="n">out_filename</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">,</span> <span class="n">out_filename</span>

        <span class="n">has_read_write</span> <span class="o">=</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">out_filename</span><span class="p">,</span> <span class="s1">&#39;read&#39;</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">out_filename</span><span class="p">,</span> <span class="s1">&#39;write&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">has_read_write</span> <span class="ow">or</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">out_filename</span><span class="p">,</span> <span class="n">IOBase</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">out_filename</span>
        <span class="k">elif</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">out_filename</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
            <span class="n">msg</span> <span class="o">=</span> <span class="s1">&#39;out_filename=</span><span class="si">%r</span><span class="s1"> must be a string; type=</span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span>
                <span class="n">out_filename</span><span class="p">,</span> <span class="nb">type</span><span class="p">(</span><span class="n">out_filename</span><span class="p">))</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">size</span> <span class="o">==</span> <span class="mi">8</span><span class="p">:</span>
            <span class="k">assert</span> <span class="n">is_double</span> <span class="ow">is</span> <span class="kc">False</span><span class="p">,</span> <span class="s1">&#39;is_double=</span><span class="si">%r</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">is_double</span>
        <span class="k">elif</span> <span class="n">size</span> <span class="o">==</span> <span class="mi">16</span><span class="p">:</span>
            <span class="k">assert</span> <span class="n">is_double</span> <span class="ow">in</span> <span class="p">[</span><span class="kc">True</span><span class="p">,</span> <span class="kc">False</span><span class="p">],</span> <span class="s1">&#39;is_double=</span><span class="si">%r</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">is_double</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">assert</span> <span class="n">size</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">8</span><span class="p">,</span> <span class="mi">16</span><span class="p">],</span> <span class="n">size</span>

        <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">interspersed</span><span class="p">,</span> <span class="nb">bool</span><span class="p">)</span>
        <span class="c1">#fname = print_filename(out_filename)</span>
        <span class="c1">#self.log.debug(&quot;***writing %s&quot; % fname)</span>
        <span class="k">return</span> <span class="n">out_filename</span>

    <span class="k">def</span> <span class="nf">write_bdf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">out_filename</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">StringIO</span><span class="p">]]</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                  <span class="n">encoding</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                  <span class="n">size</span><span class="p">:</span> <span class="nb">int</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span> <span class="n">is_double</span><span class="p">:</span> <span class="nb">bool</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                  <span class="n">interspersed</span><span class="p">:</span> <span class="nb">bool</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">enddata</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                  <span class="n">write_header</span><span class="p">:</span> <span class="nb">bool</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">close</span><span class="p">:</span> <span class="nb">bool</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Writes the BDF.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        out_filename : varies; default=None</span>
<span class="sd">            str        - the name to call the output bdf</span>
<span class="sd">            file       - a file object</span>
<span class="sd">            StringIO() - a StringIO object</span>
<span class="sd">            None       - pops a dialog</span>
<span class="sd">        encoding : str; default=None -&gt; system specified encoding</span>
<span class="sd">            the unicode encoding</span>
<span class="sd">            latin1, and utf8 are generally good options</span>
<span class="sd">        size : int; {8, 16}</span>
<span class="sd">            the field size</span>
<span class="sd">        is_double : bool; default=False</span>
<span class="sd">            False : small field</span>
<span class="sd">            True : large field</span>
<span class="sd">        interspersed : bool; default=True</span>
<span class="sd">            Writes a bdf with properties &amp; elements</span>
<span class="sd">            interspersed like how Patran writes the bdf.  This takes</span>
<span class="sd">            slightly longer than if interspersed=False, but makes it</span>
<span class="sd">            much easier to compare to a Patran-formatted bdf and is</span>
<span class="sd">            more clear.</span>
<span class="sd">        enddata : bool; default=None</span>
<span class="sd">            bool - enable/disable writing ENDDATA</span>
<span class="sd">            None - depends on input BDF</span>
<span class="sd">        write_header : bool; default=True</span>
<span class="sd">            flag for writing the pyNastran header</span>
<span class="sd">        close : bool; default=True</span>
<span class="sd">            should the output file be closed</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">is_long_ids</span> <span class="o">=</span> <span class="kc">False</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_bdf_vectorized</span><span class="p">:</span>
            <span class="k">pass</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># required for MasterModelTaxi</span>
            <span class="n">is_long_ids</span> <span class="o">=</span> <span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">nodes</span> <span class="ow">and</span> <span class="nb">max</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nodes</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">100000000</span> <span class="ow">or</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">coords</span> <span class="ow">and</span> <span class="nb">max</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">coords</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">100000000</span> <span class="ow">or</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">elements</span> <span class="ow">and</span> <span class="nb">max</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">elements</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">100000000</span> <span class="ow">or</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">properties</span> <span class="ow">and</span> <span class="nb">max</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">properties</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">100000000</span> <span class="ow">or</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">materials</span> <span class="ow">and</span> <span class="nb">max</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">materials</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">100000000</span> <span class="ow">or</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">thermal_materials</span> <span class="ow">and</span> <span class="nb">max</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">thermal_materials</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">100000000</span> <span class="ow">or</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">nsms</span> <span class="ow">and</span> <span class="nb">max</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nsms</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">100000000</span> <span class="ow">or</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">nsmadds</span> <span class="ow">and</span> <span class="nb">max</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nsmadds</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">100000000</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">is_long_ids</span><span class="p">:</span>
                <span class="n">size</span> <span class="o">=</span> <span class="mi">16</span>

        <span class="n">out_filename</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_output_helper</span><span class="p">(</span><span class="n">out_filename</span><span class="p">,</span>
                                           <span class="n">interspersed</span><span class="p">,</span> <span class="n">size</span><span class="p">,</span> <span class="n">is_double</span><span class="p">)</span>
        <span class="n">encoding</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_encoding</span><span class="p">(</span><span class="n">encoding</span><span class="p">)</span>
        <span class="c1">#assert encoding.lower() in [&#39;ascii&#39;, &#39;latin1&#39;, &#39;utf8&#39;], encoding</span>

        <span class="n">has_read_write</span> <span class="o">=</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">out_filename</span><span class="p">,</span> <span class="s1">&#39;read&#39;</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">out_filename</span><span class="p">,</span> <span class="s1">&#39;write&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">has_read_write</span><span class="p">:</span>
            <span class="n">bdf_file</span> <span class="o">=</span> <span class="n">out_filename</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s1">&#39;---starting BDF.write_bdf of </span><span class="si">%s</span><span class="s1">---&#39;</span> <span class="o">%</span> <span class="n">out_filename</span><span class="p">)</span>
            <span class="n">bdf_file</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">out_filename</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="n">encoding</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_write_header</span><span class="p">(</span><span class="n">bdf_file</span><span class="p">,</span> <span class="n">encoding</span><span class="p">,</span> <span class="n">write_header</span><span class="o">=</span><span class="n">write_header</span><span class="p">)</span>


        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">superelement_models</span><span class="p">:</span>
            <span class="n">bdf_file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;$&#39;</span> <span class="o">+</span> <span class="s1">&#39;*&#39;</span><span class="o">*</span><span class="mi">80</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">superelement_id</span><span class="p">,</span> <span class="n">superelement</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">superelement_models</span><span class="o">.</span><span class="n">items</span><span class="p">()):</span>
                <span class="n">bdf_file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;BEGIN SUPER=</span><span class="si">%s</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">superelement_id</span><span class="p">)</span>
                <span class="n">superelement</span><span class="o">.</span><span class="n">write_bdf</span><span class="p">(</span><span class="n">out_filename</span><span class="o">=</span><span class="n">bdf_file</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="n">encoding</span><span class="p">,</span>
                                       <span class="n">size</span><span class="o">=</span><span class="n">size</span><span class="p">,</span> <span class="n">is_double</span><span class="o">=</span><span class="n">is_double</span><span class="p">,</span>
                                       <span class="n">interspersed</span><span class="o">=</span><span class="n">interspersed</span><span class="p">,</span> <span class="n">enddata</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                                       <span class="n">write_header</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">close</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
                <span class="n">bdf_file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;$&#39;</span> <span class="o">+</span> <span class="s1">&#39;*&#39;</span><span class="o">*</span><span class="mi">80</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
            <span class="n">bdf_file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;BEGIN BULK</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_write_params</span><span class="p">(</span><span class="n">bdf_file</span><span class="p">,</span> <span class="n">size</span><span class="p">,</span> <span class="n">is_double</span><span class="p">,</span> <span class="n">is_long_ids</span><span class="o">=</span><span class="n">is_long_ids</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_write_nodes</span><span class="p">(</span><span class="n">bdf_file</span><span class="p">,</span> <span class="n">size</span><span class="p">,</span> <span class="n">is_double</span><span class="p">,</span> <span class="n">is_long_ids</span><span class="o">=</span><span class="n">is_long_ids</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">interspersed</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_write_elements_interspersed</span><span class="p">(</span><span class="n">bdf_file</span><span class="p">,</span> <span class="n">size</span><span class="p">,</span> <span class="n">is_double</span><span class="p">,</span> <span class="n">is_long_ids</span><span class="o">=</span><span class="n">is_long_ids</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_write_elements</span><span class="p">(</span><span class="n">bdf_file</span><span class="p">,</span> <span class="n">size</span><span class="p">,</span> <span class="n">is_double</span><span class="p">,</span> <span class="n">is_long_ids</span><span class="o">=</span><span class="n">is_long_ids</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_write_properties</span><span class="p">(</span><span class="n">bdf_file</span><span class="p">,</span> <span class="n">size</span><span class="p">,</span> <span class="n">is_double</span><span class="p">,</span> <span class="n">is_long_ids</span><span class="o">=</span><span class="n">is_long_ids</span><span class="p">)</span>
            <span class="c1">#self._write_properties_by_element_type(bdf_file, size, is_double, is_long_ids)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_write_materials</span><span class="p">(</span><span class="n">bdf_file</span><span class="p">,</span> <span class="n">size</span><span class="p">,</span> <span class="n">is_double</span><span class="p">,</span> <span class="n">is_long_ids</span><span class="o">=</span><span class="n">is_long_ids</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_write_masses</span><span class="p">(</span><span class="n">bdf_file</span><span class="p">,</span> <span class="n">size</span><span class="p">,</span> <span class="n">is_double</span><span class="p">,</span> <span class="n">is_long_ids</span><span class="o">=</span><span class="n">is_long_ids</span><span class="p">)</span>

        <span class="c1"># split out for write_bdf_symmetric</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_write_rigid_elements</span><span class="p">(</span><span class="n">bdf_file</span><span class="p">,</span> <span class="n">size</span><span class="p">,</span> <span class="n">is_double</span><span class="p">,</span> <span class="n">is_long_ids</span><span class="o">=</span><span class="n">is_long_ids</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_write_aero</span><span class="p">(</span><span class="n">bdf_file</span><span class="p">,</span> <span class="n">size</span><span class="p">,</span> <span class="n">is_double</span><span class="p">,</span> <span class="n">is_long_ids</span><span class="o">=</span><span class="n">is_long_ids</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_write_common</span><span class="p">(</span><span class="n">bdf_file</span><span class="p">,</span> <span class="n">size</span><span class="p">,</span> <span class="n">is_double</span><span class="p">,</span> <span class="n">is_long_ids</span><span class="o">=</span><span class="n">is_long_ids</span><span class="p">)</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">enddata</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="s1">&#39;ENDDATA&#39;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">card_count</span><span class="p">)</span> <span class="ow">or</span> <span class="n">enddata</span><span class="p">:</span>
            <span class="n">bdf_file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;ENDDATA</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">close</span><span class="p">:</span>
            <span class="n">bdf_file</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">_write_header</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">bdf_file</span><span class="p">:</span> <span class="n">Any</span><span class="p">,</span> <span class="n">encoding</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">write_header</span><span class="p">:</span> <span class="nb">bool</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Writes the executive and case control decks.&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">punch</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="c1"># writing a mesh without using read_bdf</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">system_command_lines</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">executive_control_lines</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">case_control_deck</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">punch</span> <span class="o">=</span> <span class="kc">False</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">punch</span> <span class="o">=</span> <span class="kc">True</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">nastran_format</span> <span class="ow">and</span> <span class="n">write_header</span><span class="p">:</span>
            <span class="n">bdf_file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;$pyNastran: version=</span><span class="si">%s</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">nastran_format</span><span class="p">)</span>
            <span class="n">bdf_file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;$pyNastran: punch=</span><span class="si">%s</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">punch</span><span class="p">)</span>
            <span class="n">bdf_file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;$pyNastran: encoding=</span><span class="si">%s</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">encoding</span><span class="p">)</span>
            <span class="n">bdf_file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;$pyNastran: nnodes=</span><span class="si">%s</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nodes</span><span class="p">))</span>
            <span class="n">bdf_file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;$pyNastran: nelements=</span><span class="si">%s</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">elements</span><span class="p">))</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">punch</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_write_executive_control_deck</span><span class="p">(</span><span class="n">bdf_file</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_write_case_control_deck</span><span class="p">(</span><span class="n">bdf_file</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_write_executive_control_deck</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">bdf_file</span><span class="p">:</span> <span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Writes the executive control deck.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">msg</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
        <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">system_command_lines</span><span class="p">:</span>
            <span class="n">msg</span> <span class="o">+=</span> <span class="n">line</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">executive_control_lines</span><span class="p">:</span>
            <span class="n">msg</span> <span class="o">+=</span> <span class="s1">&#39;$EXECUTIVE CONTROL DECK</span><span class="se">\n</span><span class="s1">&#39;</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">sol</span> <span class="o">==</span> <span class="mi">600</span><span class="p">:</span>
                <span class="n">new_sol</span> <span class="o">=</span> <span class="s1">&#39;SOL 600,</span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">sol_method</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">new_sol</span> <span class="o">=</span> <span class="s1">&#39;SOL </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">sol</span>

            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">sol_iline</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">executive_control_lines</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">sol_iline</span><span class="p">]</span> <span class="o">=</span> <span class="n">new_sol</span>

            <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">executive_control_lines</span><span class="p">:</span>
                <span class="n">msg</span> <span class="o">+=</span> <span class="n">line</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span>
            <span class="n">bdf_file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_write_case_control_deck</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">bdf_file</span><span class="p">:</span> <span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Writes the Case Control Deck.&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">case_control_deck</span><span class="p">:</span>
            <span class="n">msg</span> <span class="o">=</span> <span class="s1">&#39;$CASE CONTROL DECK</span><span class="se">\n</span><span class="s1">&#39;</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">superelement_models</span><span class="p">:</span>
                <span class="n">msg</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">case_control_deck</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">write_begin_bulk</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">msg</span> <span class="o">+=</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">case_control_deck</span><span class="p">)</span>
                <span class="k">assert</span> <span class="s1">&#39;BEGIN BULK&#39;</span> <span class="ow">in</span> <span class="n">msg</span><span class="p">,</span> <span class="n">msg</span>
            <span class="n">bdf_file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">msg</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">_write_elements</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">bdf_file</span><span class="p">:</span> <span class="n">Any</span><span class="p">,</span> <span class="n">size</span><span class="p">:</span> <span class="nb">int</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span> <span class="n">is_double</span><span class="p">:</span> <span class="nb">bool</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                        <span class="n">is_long_ids</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Writes the elements in a sorted order&quot;&quot;&quot;</span>
        <span class="n">size</span><span class="p">,</span> <span class="n">is_long_ids</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_write_mesh_long_ids_size</span><span class="p">(</span><span class="n">size</span><span class="p">,</span> <span class="n">is_long_ids</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">elements</span><span class="p">:</span>
            <span class="n">bdf_file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;$ELEMENTS</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">is_long_ids</span><span class="p">:</span>
                <span class="k">for</span> <span class="p">(</span><span class="n">eid</span><span class="p">,</span> <span class="n">element</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">elements</span><span class="o">.</span><span class="n">items</span><span class="p">()):</span>
                    <span class="n">bdf_file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">element</span><span class="o">.</span><span class="n">write_card_16</span><span class="p">(</span><span class="n">is_double</span><span class="p">))</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">for</span> <span class="p">(</span><span class="n">eid</span><span class="p">,</span> <span class="n">element</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">elements</span><span class="o">.</span><span class="n">items</span><span class="p">()):</span>
                    <span class="k">try</span><span class="p">:</span>
                        <span class="n">bdf_file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">element</span><span class="o">.</span><span class="n">write_card</span><span class="p">(</span><span class="n">size</span><span class="p">,</span> <span class="n">is_double</span><span class="p">))</span>
                    <span class="k">except</span><span class="p">:</span>
                        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;failed printing element...&#39;</span>
                              <span class="s1">&#39;type=</span><span class="si">%s</span><span class="s1"> eid=</span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">element</span><span class="o">.</span><span class="n">type</span><span class="p">,</span> <span class="n">eid</span><span class="p">))</span>
                        <span class="k">raise</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">ao_element_flags</span><span class="p">:</span>
            <span class="k">for</span> <span class="p">(</span><span class="n">eid</span><span class="p">,</span> <span class="n">element</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ao_element_flags</span><span class="o">.</span><span class="n">items</span><span class="p">()):</span>
                <span class="n">bdf_file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">element</span><span class="o">.</span><span class="n">write_card</span><span class="p">(</span><span class="n">size</span><span class="p">,</span> <span class="n">is_double</span><span class="p">))</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">normals</span><span class="p">:</span>
            <span class="k">for</span> <span class="p">(</span><span class="n">unused_nid</span><span class="p">,</span> <span class="n">snorm</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">normals</span><span class="o">.</span><span class="n">items</span><span class="p">()):</span>
                <span class="n">bdf_file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">snorm</span><span class="o">.</span><span class="n">write_card</span><span class="p">(</span><span class="n">size</span><span class="p">,</span> <span class="n">is_double</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_write_nsm</span><span class="p">(</span><span class="n">bdf_file</span><span class="p">,</span> <span class="n">size</span><span class="p">,</span> <span class="n">is_double</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_write_nsm</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">bdf_file</span><span class="p">:</span> <span class="n">Any</span><span class="p">,</span> <span class="n">size</span><span class="p">:</span> <span class="nb">int</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span> <span class="n">is_double</span><span class="p">:</span> <span class="nb">bool</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                   <span class="n">is_long_ids</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Writes the nsm in a sorted order&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">nsms</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">nsmadds</span><span class="p">:</span>
            <span class="n">bdf_file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;$NSM</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
            <span class="k">for</span> <span class="p">(</span><span class="n">unused_id</span><span class="p">,</span> <span class="n">nsmadds</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nsmadds</span><span class="o">.</span><span class="n">items</span><span class="p">()):</span>
                <span class="k">for</span> <span class="n">nsmadd</span> <span class="ow">in</span> <span class="n">nsmadds</span><span class="p">:</span>
                    <span class="n">bdf_file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">nsmadd</span><span class="p">))</span>
            <span class="k">for</span> <span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">nsms</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nsms</span><span class="o">.</span><span class="n">items</span><span class="p">()):</span>
                <span class="k">for</span> <span class="n">nsm</span> <span class="ow">in</span> <span class="n">nsms</span><span class="p">:</span>
                    <span class="k">try</span><span class="p">:</span>
                        <span class="n">bdf_file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">nsm</span><span class="o">.</span><span class="n">write_card</span><span class="p">(</span><span class="n">size</span><span class="p">,</span> <span class="n">is_double</span><span class="p">))</span>
                    <span class="k">except</span><span class="p">:</span>
                        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;failed printing nsm...type=</span><span class="si">%s</span><span class="s1"> key=</span><span class="si">%r</span><span class="s1">&#39;</span>
                              <span class="o">%</span> <span class="p">(</span><span class="n">nsm</span><span class="o">.</span><span class="n">type</span><span class="p">,</span> <span class="n">key</span><span class="p">))</span>
                        <span class="k">raise</span>

    <span class="k">def</span> <span class="nf">_write_elements_interspersed</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">bdf_file</span><span class="p">:</span> <span class="n">Any</span><span class="p">,</span> <span class="n">size</span><span class="p">:</span> <span class="nb">int</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span> <span class="n">is_double</span><span class="p">:</span> <span class="nb">bool</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                                     <span class="n">is_long_ids</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Writes the elements and properties in and interspersed order&quot;&quot;&quot;</span>
        <span class="n">missing_properties</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">properties</span><span class="p">:</span>
            <span class="n">bdf_file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;$ELEMENTS_WITH_PROPERTIES</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>

        <span class="n">eids_written</span> <span class="o">=</span> <span class="p">[]</span>  <span class="c1"># type: List[int]</span>
        <span class="n">pids</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">properties</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
        <span class="n">pid_eids</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_element_ids_dict_with_pids</span><span class="p">(</span><span class="n">pids</span><span class="p">,</span> <span class="n">stop_if_no_eids</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

        <span class="c1">#failed_element_types = set()</span>
        <span class="k">for</span> <span class="p">(</span><span class="n">pid</span><span class="p">,</span> <span class="n">eids</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">pid_eids</span><span class="o">.</span><span class="n">items</span><span class="p">()):</span>
            <span class="n">prop</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">properties</span><span class="p">[</span><span class="n">pid</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">eids</span><span class="p">:</span>
                <span class="n">bdf_file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">prop</span><span class="o">.</span><span class="n">write_card</span><span class="p">(</span><span class="n">size</span><span class="p">,</span> <span class="n">is_double</span><span class="p">))</span>
                <span class="n">eids</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>
                <span class="k">for</span> <span class="n">eid</span> <span class="ow">in</span> <span class="n">eids</span><span class="p">:</span>
                    <span class="n">element</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">elements</span><span class="p">[</span><span class="n">eid</span><span class="p">]</span>
                    <span class="k">try</span><span class="p">:</span>
                        <span class="n">bdf_file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">element</span><span class="o">.</span><span class="n">write_card</span><span class="p">(</span><span class="n">size</span><span class="p">,</span> <span class="n">is_double</span><span class="p">))</span>
                    <span class="k">except</span><span class="p">:</span>
                        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;failed printing element...&#39;</span> <span class="s1">&#39;type=</span><span class="si">%r</span><span class="s1"> eid=</span><span class="si">%s</span><span class="s1">&#39;</span>
                              <span class="o">%</span> <span class="p">(</span><span class="n">element</span><span class="o">.</span><span class="n">type</span><span class="p">,</span> <span class="n">eid</span><span class="p">))</span>
                        <span class="k">raise</span>
                <span class="n">eids_written</span> <span class="o">+=</span> <span class="n">eids</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">missing_properties</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">prop</span><span class="o">.</span><span class="n">write_card</span><span class="p">(</span><span class="n">size</span><span class="p">,</span> <span class="n">is_double</span><span class="p">))</span>

        <span class="n">eids_missing</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">elements</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span><span class="o">.</span><span class="n">difference</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">eids_written</span><span class="p">))</span>
        <span class="k">if</span> <span class="n">eids_missing</span><span class="p">:</span>
            <span class="n">bdf_file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;$ELEMENTS_WITH_NO_PROPERTIES &#39;</span>
                           <span class="s1">&#39;(PID=0 and unanalyzed properties)</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">eid</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">eids_missing</span><span class="p">):</span>
                <span class="n">element</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">elements</span><span class="p">[</span><span class="n">eid</span><span class="p">]</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="n">bdf_file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">element</span><span class="o">.</span><span class="n">write_card</span><span class="p">(</span><span class="n">size</span><span class="p">,</span> <span class="n">is_double</span><span class="p">))</span>
                <span class="k">except</span><span class="p">:</span>
                    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;failed printing element...&#39;</span>
                          <span class="s1">&#39;type=</span><span class="si">%s</span><span class="s1"> eid=</span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">element</span><span class="o">.</span><span class="n">type</span><span class="p">,</span> <span class="n">eid</span><span class="p">))</span>
                    <span class="k">raise</span>

        <span class="k">if</span> <span class="n">missing_properties</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">pdampt</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">pbusht</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">pelast</span><span class="p">:</span>
            <span class="n">bdf_file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;$UNASSOCIATED_PROPERTIES</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">card</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pbusht</span><span class="o">.</span><span class="n">values</span><span class="p">()):</span>
                <span class="n">bdf_file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">card</span><span class="o">.</span><span class="n">write_card</span><span class="p">(</span><span class="n">size</span><span class="p">,</span> <span class="n">is_double</span><span class="p">))</span>
            <span class="k">for</span> <span class="n">card</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pdampt</span><span class="o">.</span><span class="n">values</span><span class="p">()):</span>
                <span class="n">bdf_file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">card</span><span class="o">.</span><span class="n">write_card</span><span class="p">(</span><span class="n">size</span><span class="p">,</span> <span class="n">is_double</span><span class="p">))</span>
            <span class="k">for</span> <span class="n">card</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pelast</span><span class="o">.</span><span class="n">values</span><span class="p">()):</span>
                <span class="n">bdf_file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">card</span><span class="o">.</span><span class="n">write_card</span><span class="p">(</span><span class="n">size</span><span class="p">,</span> <span class="n">is_double</span><span class="p">))</span>
            <span class="k">for</span> <span class="n">card</span> <span class="ow">in</span> <span class="n">missing_properties</span><span class="p">:</span>
                <span class="c1"># this is a string...</span>
                <span class="c1">#print(&quot;missing_property = &quot;, card</span>
                <span class="n">bdf_file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">card</span><span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">ao_element_flags</span><span class="p">:</span>
            <span class="k">for</span> <span class="p">(</span><span class="n">eid</span><span class="p">,</span> <span class="n">element</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ao_element_flags</span><span class="o">.</span><span class="n">items</span><span class="p">()):</span>
                <span class="n">bdf_file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">element</span><span class="o">.</span><span class="n">write_card</span><span class="p">(</span><span class="n">size</span><span class="p">,</span> <span class="n">is_double</span><span class="p">))</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">normals</span><span class="p">:</span>
            <span class="k">for</span> <span class="p">(</span><span class="n">unused_nid</span><span class="p">,</span> <span class="n">snorm</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">normals</span><span class="o">.</span><span class="n">items</span><span class="p">()):</span>
                <span class="n">bdf_file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">snorm</span><span class="o">.</span><span class="n">write_card</span><span class="p">(</span><span class="n">size</span><span class="p">,</span> <span class="n">is_double</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_write_nsm</span><span class="p">(</span><span class="n">bdf_file</span><span class="p">,</span> <span class="n">size</span><span class="p">,</span> <span class="n">is_double</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_write_aero</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">bdf_file</span><span class="p">:</span> <span class="n">Any</span><span class="p">,</span> <span class="n">size</span><span class="p">:</span> <span class="nb">int</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span> <span class="n">is_double</span><span class="p">:</span> <span class="nb">bool</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                    <span class="n">is_long_ids</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Writes the aero cards&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">caeros</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">paeros</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">monitor_points</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">splines</span><span class="p">:</span>
            <span class="n">bdf_file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;$AERO</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
            <span class="k">for</span> <span class="p">(</span><span class="n">unused_id</span><span class="p">,</span> <span class="n">caero</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">caeros</span><span class="o">.</span><span class="n">items</span><span class="p">()):</span>
                <span class="n">bdf_file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">caero</span><span class="o">.</span><span class="n">write_card</span><span class="p">(</span><span class="n">size</span><span class="p">,</span> <span class="n">is_double</span><span class="p">))</span>
            <span class="k">for</span> <span class="p">(</span><span class="n">unused_id</span><span class="p">,</span> <span class="n">paero</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">paeros</span><span class="o">.</span><span class="n">items</span><span class="p">()):</span>
                <span class="n">bdf_file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">paero</span><span class="o">.</span><span class="n">write_card</span><span class="p">(</span><span class="n">size</span><span class="p">,</span> <span class="n">is_double</span><span class="p">))</span>
            <span class="k">for</span> <span class="p">(</span><span class="n">unused_id</span><span class="p">,</span> <span class="n">spline</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">splines</span><span class="o">.</span><span class="n">items</span><span class="p">()):</span>
                <span class="n">bdf_file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">spline</span><span class="o">.</span><span class="n">write_card</span><span class="p">(</span><span class="n">size</span><span class="p">,</span> <span class="n">is_double</span><span class="p">))</span>
            <span class="k">for</span> <span class="n">monitor_point</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">monitor_points</span><span class="p">:</span>
                <span class="n">bdf_file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">monitor_point</span><span class="o">.</span><span class="n">write_card</span><span class="p">(</span><span class="n">size</span><span class="p">,</span> <span class="n">is_double</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">zona</span><span class="o">.</span><span class="n">write_bdf</span><span class="p">(</span><span class="n">bdf_file</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span> <span class="n">is_double</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_write_aero_control</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">bdf_file</span><span class="p">:</span> <span class="n">Any</span><span class="p">,</span> <span class="n">size</span><span class="p">:</span> <span class="nb">int</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span> <span class="n">is_double</span><span class="p">:</span> <span class="nb">bool</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                           <span class="n">is_long_ids</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Writes the aero control surface cards&quot;&quot;&quot;</span>
        <span class="k">if</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">aecomps</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">aefacts</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">aeparams</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">aelinks</span> <span class="ow">or</span>
           <span class="bp">self</span><span class="o">.</span><span class="n">aelists</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">aestats</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">aesurf</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">aesurfs</span><span class="p">):</span>
            <span class="n">bdf_file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;$AERO CONTROL SURFACES</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
            <span class="k">for</span> <span class="p">(</span><span class="n">unused_id</span><span class="p">,</span> <span class="n">aelinks</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">aelinks</span><span class="o">.</span><span class="n">items</span><span class="p">()):</span>
                <span class="k">for</span> <span class="n">aelink</span> <span class="ow">in</span> <span class="n">aelinks</span><span class="p">:</span>
                    <span class="n">bdf_file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">aelink</span><span class="o">.</span><span class="n">write_card</span><span class="p">(</span><span class="n">size</span><span class="p">,</span> <span class="n">is_double</span><span class="p">))</span>

            <span class="k">for</span> <span class="p">(</span><span class="n">unused_id</span><span class="p">,</span> <span class="n">aecomp</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">aecomps</span><span class="o">.</span><span class="n">items</span><span class="p">()):</span>
                <span class="n">bdf_file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">aecomp</span><span class="o">.</span><span class="n">write_card</span><span class="p">(</span><span class="n">size</span><span class="p">,</span> <span class="n">is_double</span><span class="p">))</span>
            <span class="k">for</span> <span class="p">(</span><span class="n">unused_id</span><span class="p">,</span> <span class="n">aeparam</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">aeparams</span><span class="o">.</span><span class="n">items</span><span class="p">()):</span>
                <span class="n">bdf_file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">aeparam</span><span class="o">.</span><span class="n">write_card</span><span class="p">(</span><span class="n">size</span><span class="p">,</span> <span class="n">is_double</span><span class="p">))</span>
            <span class="k">for</span> <span class="p">(</span><span class="n">unused_id</span><span class="p">,</span> <span class="n">aestat</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">aestats</span><span class="o">.</span><span class="n">items</span><span class="p">()):</span>
                <span class="n">bdf_file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">aestat</span><span class="o">.</span><span class="n">write_card</span><span class="p">(</span><span class="n">size</span><span class="p">,</span> <span class="n">is_double</span><span class="p">))</span>

            <span class="k">for</span> <span class="p">(</span><span class="n">unused_id</span><span class="p">,</span> <span class="n">aelist</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">aelists</span><span class="o">.</span><span class="n">items</span><span class="p">()):</span>
                <span class="n">bdf_file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">aelist</span><span class="o">.</span><span class="n">write_card</span><span class="p">(</span><span class="n">size</span><span class="p">,</span> <span class="n">is_double</span><span class="p">))</span>
            <span class="k">for</span> <span class="p">(</span><span class="n">unused_id</span><span class="p">,</span> <span class="n">aesurf</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">aesurf</span><span class="o">.</span><span class="n">items</span><span class="p">()):</span>
                <span class="n">bdf_file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">aesurf</span><span class="o">.</span><span class="n">write_card</span><span class="p">(</span><span class="n">size</span><span class="p">,</span> <span class="n">is_double</span><span class="p">))</span>
            <span class="k">for</span> <span class="p">(</span><span class="n">unused_id</span><span class="p">,</span> <span class="n">aesurfs</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">aesurfs</span><span class="o">.</span><span class="n">items</span><span class="p">()):</span>
                <span class="n">bdf_file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">aesurfs</span><span class="o">.</span><span class="n">write_card</span><span class="p">(</span><span class="n">size</span><span class="p">,</span> <span class="n">is_double</span><span class="p">))</span>
            <span class="k">for</span> <span class="p">(</span><span class="n">unused_id</span><span class="p">,</span> <span class="n">aefact</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">aefacts</span><span class="o">.</span><span class="n">items</span><span class="p">()):</span>
                <span class="n">bdf_file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">aefact</span><span class="o">.</span><span class="n">write_card</span><span class="p">(</span><span class="n">size</span><span class="p">,</span> <span class="n">is_double</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">_write_static_aero</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">bdf_file</span><span class="p">:</span> <span class="n">Any</span><span class="p">,</span> <span class="n">size</span><span class="p">:</span> <span class="nb">int</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span> <span class="n">is_double</span><span class="p">:</span> <span class="nb">bool</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                           <span class="n">is_long_ids</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Writes the static aero cards&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">aeros</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">trims</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">divergs</span><span class="p">:</span>
            <span class="n">bdf_file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;$STATIC AERO</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
            <span class="c1"># static aero</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">aeros</span><span class="p">:</span>
                <span class="n">bdf_file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">aeros</span><span class="o">.</span><span class="n">write_card</span><span class="p">(</span><span class="n">size</span><span class="p">,</span> <span class="n">is_double</span><span class="p">))</span>
            <span class="k">for</span> <span class="p">(</span><span class="n">unused_id</span><span class="p">,</span> <span class="n">trim</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">trims</span><span class="o">.</span><span class="n">items</span><span class="p">()):</span>
                <span class="n">bdf_file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">trim</span><span class="o">.</span><span class="n">write_card</span><span class="p">(</span><span class="n">size</span><span class="p">,</span> <span class="n">is_double</span><span class="p">))</span>
            <span class="k">for</span> <span class="p">(</span><span class="n">unused_id</span><span class="p">,</span> <span class="n">diverg</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">divergs</span><span class="o">.</span><span class="n">items</span><span class="p">()):</span>
                <span class="n">bdf_file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">diverg</span><span class="o">.</span><span class="n">write_card</span><span class="p">(</span><span class="n">size</span><span class="p">,</span> <span class="n">is_double</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">_find_aero_location</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="nb">bool</span><span class="p">,</span> <span class="nb">bool</span><span class="p">]:</span>
        <span class="sd">&quot;&quot;&quot;Determines where the AERO card should be written&quot;&quot;&quot;</span>
        <span class="n">write_aero_in_flutter</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="n">write_aero_in_gust</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">aero</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">flfacts</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">flutters</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">mkaeros</span><span class="p">:</span>
                <span class="n">write_aero_in_flutter</span> <span class="o">=</span> <span class="kc">True</span>
            <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">gusts</span><span class="p">:</span>
                <span class="n">write_aero_in_gust</span> <span class="o">=</span> <span class="kc">True</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="c1"># an AERO card exists, but no FLUTTER, FLFACT, MKAEROx or GUST card</span>
                <span class="n">write_aero_in_flutter</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="k">return</span> <span class="n">write_aero_in_flutter</span><span class="p">,</span> <span class="n">write_aero_in_gust</span>

    <span class="k">def</span> <span class="nf">_write_flutter</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">bdf_file</span><span class="p">:</span> <span class="n">Any</span><span class="p">,</span> <span class="n">size</span><span class="p">:</span> <span class="nb">int</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span> <span class="n">is_double</span><span class="p">:</span> <span class="nb">bool</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                       <span class="n">write_aero_in_flutter</span><span class="p">:</span> <span class="nb">bool</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                       <span class="n">is_long_ids</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Writes the flutter cards&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">write_aero_in_flutter</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">aero</span><span class="p">)</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">flfacts</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">flutters</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">mkaeros</span><span class="p">:</span>
            <span class="n">bdf_file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;$FLUTTER</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">write_aero_in_flutter</span><span class="p">:</span>
                <span class="n">bdf_file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">aero</span><span class="o">.</span><span class="n">write_card</span><span class="p">(</span><span class="n">size</span><span class="p">,</span> <span class="n">is_double</span><span class="p">))</span>
            <span class="k">for</span> <span class="p">(</span><span class="n">unused_id</span><span class="p">,</span> <span class="n">flutter</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">flutters</span><span class="o">.</span><span class="n">items</span><span class="p">()):</span>
                <span class="n">bdf_file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">flutter</span><span class="o">.</span><span class="n">write_card</span><span class="p">(</span><span class="n">size</span><span class="p">,</span> <span class="n">is_double</span><span class="p">))</span>
            <span class="k">for</span> <span class="p">(</span><span class="n">unused_id</span><span class="p">,</span> <span class="n">flfact</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">flfacts</span><span class="o">.</span><span class="n">items</span><span class="p">()):</span>
                <span class="n">bdf_file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">flfact</span><span class="o">.</span><span class="n">write_card</span><span class="p">(</span><span class="n">size</span><span class="p">,</span> <span class="n">is_double</span><span class="p">))</span>
            <span class="k">for</span> <span class="n">mkaero</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">mkaeros</span><span class="p">:</span>
                <span class="n">bdf_file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">mkaero</span><span class="o">.</span><span class="n">write_card</span><span class="p">(</span><span class="n">size</span><span class="p">,</span> <span class="n">is_double</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">_write_gust</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">bdf_file</span><span class="p">:</span> <span class="n">Any</span><span class="p">,</span> <span class="n">size</span><span class="p">:</span> <span class="nb">int</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span> <span class="n">is_double</span><span class="p">:</span> <span class="nb">bool</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                    <span class="n">write_aero_in_gust</span><span class="p">:</span> <span class="nb">bool</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                    <span class="n">is_long_ids</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Writes the gust cards&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">write_aero_in_gust</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">aero</span><span class="p">)</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">gusts</span><span class="p">:</span>
            <span class="n">bdf_file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;$GUST</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">write_aero_in_gust</span><span class="p">:</span>
                <span class="k">for</span> <span class="p">(</span><span class="n">unused_id</span><span class="p">,</span> <span class="n">aero</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">aero</span><span class="o">.</span><span class="n">items</span><span class="p">()):</span>
                    <span class="n">bdf_file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">aero</span><span class="o">.</span><span class="n">write_card</span><span class="p">(</span><span class="n">size</span><span class="p">,</span> <span class="n">is_double</span><span class="p">))</span>
            <span class="k">for</span> <span class="p">(</span><span class="n">unused_id</span><span class="p">,</span> <span class="n">gust</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">gusts</span><span class="o">.</span><span class="n">items</span><span class="p">()):</span>
                <span class="n">bdf_file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">gust</span><span class="o">.</span><span class="n">write_card</span><span class="p">(</span><span class="n">size</span><span class="p">,</span> <span class="n">is_double</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">_write_common</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">bdf_file</span><span class="p">:</span> <span class="n">Any</span><span class="p">,</span> <span class="n">size</span><span class="p">:</span> <span class="nb">int</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span> <span class="n">is_double</span><span class="p">:</span> <span class="nb">bool</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                      <span class="n">is_long_ids</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Write the common outputs so none get missed...</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        bdf_file : file</span>
<span class="sd">            the file object</span>
<span class="sd">        size : int (default=8)</span>
<span class="sd">            the field width</span>
<span class="sd">        is_double : bool (default=False)</span>
<span class="sd">            is this double precision</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_write_dmigs</span><span class="p">(</span><span class="n">bdf_file</span><span class="p">,</span> <span class="n">size</span><span class="p">,</span> <span class="n">is_double</span><span class="p">,</span> <span class="n">is_long_ids</span><span class="o">=</span><span class="n">is_long_ids</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_write_loads</span><span class="p">(</span><span class="n">bdf_file</span><span class="p">,</span> <span class="n">size</span><span class="p">,</span> <span class="n">is_double</span><span class="p">,</span> <span class="n">is_long_ids</span><span class="o">=</span><span class="n">is_long_ids</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_write_dynamic</span><span class="p">(</span><span class="n">bdf_file</span><span class="p">,</span> <span class="n">size</span><span class="p">,</span> <span class="n">is_double</span><span class="p">,</span> <span class="n">is_long_ids</span><span class="o">=</span><span class="n">is_long_ids</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_write_aero_control</span><span class="p">(</span><span class="n">bdf_file</span><span class="p">,</span> <span class="n">size</span><span class="p">,</span> <span class="n">is_double</span><span class="p">,</span> <span class="n">is_long_ids</span><span class="o">=</span><span class="n">is_long_ids</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_write_static_aero</span><span class="p">(</span><span class="n">bdf_file</span><span class="p">,</span> <span class="n">size</span><span class="p">,</span> <span class="n">is_double</span><span class="p">,</span> <span class="n">is_long_ids</span><span class="o">=</span><span class="n">is_long_ids</span><span class="p">)</span>

        <span class="n">write_aero_in_flutter</span><span class="p">,</span> <span class="n">write_aero_in_gust</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_find_aero_location</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_write_flutter</span><span class="p">(</span><span class="n">bdf_file</span><span class="p">,</span> <span class="n">size</span><span class="p">,</span> <span class="n">is_double</span><span class="p">,</span> <span class="n">write_aero_in_flutter</span><span class="p">,</span>
                            <span class="n">is_long_ids</span><span class="o">=</span><span class="n">is_long_ids</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_write_gust</span><span class="p">(</span><span class="n">bdf_file</span><span class="p">,</span> <span class="n">size</span><span class="p">,</span> <span class="n">is_double</span><span class="p">,</span> <span class="n">write_aero_in_gust</span><span class="p">,</span> <span class="n">is_long_ids</span><span class="o">=</span><span class="n">is_long_ids</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_write_thermal</span><span class="p">(</span><span class="n">bdf_file</span><span class="p">,</span> <span class="n">size</span><span class="p">,</span> <span class="n">is_double</span><span class="p">,</span> <span class="n">is_long_ids</span><span class="o">=</span><span class="n">is_long_ids</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_write_thermal_materials</span><span class="p">(</span><span class="n">bdf_file</span><span class="p">,</span> <span class="n">size</span><span class="p">,</span> <span class="n">is_double</span><span class="p">,</span> <span class="n">is_long_ids</span><span class="o">=</span><span class="n">is_long_ids</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_write_constraints</span><span class="p">(</span><span class="n">bdf_file</span><span class="p">,</span> <span class="n">size</span><span class="p">,</span> <span class="n">is_double</span><span class="p">,</span> <span class="n">is_long_ids</span><span class="o">=</span><span class="n">is_long_ids</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_write_optimization</span><span class="p">(</span><span class="n">bdf_file</span><span class="p">,</span> <span class="n">size</span><span class="p">,</span> <span class="n">is_double</span><span class="p">,</span> <span class="n">is_long_ids</span><span class="o">=</span><span class="n">is_long_ids</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_write_tables</span><span class="p">(</span><span class="n">bdf_file</span><span class="p">,</span> <span class="n">size</span><span class="p">,</span> <span class="n">is_double</span><span class="p">,</span> <span class="n">is_long_ids</span><span class="o">=</span><span class="n">is_long_ids</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_write_sets</span><span class="p">(</span><span class="n">bdf_file</span><span class="p">,</span> <span class="n">size</span><span class="p">,</span> <span class="n">is_double</span><span class="p">,</span> <span class="n">is_long_ids</span><span class="o">=</span><span class="n">is_long_ids</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_write_superelements</span><span class="p">(</span><span class="n">bdf_file</span><span class="p">,</span> <span class="n">size</span><span class="p">,</span> <span class="n">is_double</span><span class="p">,</span> <span class="n">is_long_ids</span><span class="o">=</span><span class="n">is_long_ids</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_write_contact</span><span class="p">(</span><span class="n">bdf_file</span><span class="p">,</span> <span class="n">size</span><span class="p">,</span> <span class="n">is_double</span><span class="p">,</span> <span class="n">is_long_ids</span><span class="o">=</span><span class="n">is_long_ids</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_write_parametric</span><span class="p">(</span><span class="n">bdf_file</span><span class="p">,</span> <span class="n">size</span><span class="p">,</span> <span class="n">is_double</span><span class="p">,</span> <span class="n">is_long_ids</span><span class="o">=</span><span class="n">is_long_ids</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_write_rejects</span><span class="p">(</span><span class="n">bdf_file</span><span class="p">,</span> <span class="n">size</span><span class="p">,</span> <span class="n">is_double</span><span class="p">,</span> <span class="n">is_long_ids</span><span class="o">=</span><span class="n">is_long_ids</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_write_coords</span><span class="p">(</span><span class="n">bdf_file</span><span class="p">,</span> <span class="n">size</span><span class="p">,</span> <span class="n">is_double</span><span class="p">,</span> <span class="n">is_long_ids</span><span class="o">=</span><span class="n">is_long_ids</span><span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">acmodl</span><span class="p">:</span>
            <span class="n">bdf_file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">acmodl</span><span class="o">.</span><span class="n">write_card</span><span class="p">(</span><span class="n">size</span><span class="p">,</span> <span class="n">is_double</span><span class="p">))</span>


    <span class="k">def</span> <span class="nf">_write_constraints</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">bdf_file</span><span class="p">:</span> <span class="n">Any</span><span class="p">,</span> <span class="n">size</span><span class="p">:</span> <span class="nb">int</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span> <span class="n">is_double</span><span class="p">:</span> <span class="nb">bool</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                           <span class="n">is_long_ids</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Writes the constraint cards sorted by ID&quot;&quot;&quot;</span>
        <span class="n">size</span><span class="p">,</span> <span class="n">is_long_ids</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_write_mesh_long_ids_size</span><span class="p">(</span><span class="n">size</span><span class="p">,</span> <span class="n">is_long_ids</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">suport</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">suport1</span><span class="p">:</span>
            <span class="n">bdf_file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;$CONSTRAINTS</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">suport</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">suport</span><span class="p">:</span>
                <span class="n">bdf_file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">suport</span><span class="o">.</span><span class="n">write_card</span><span class="p">(</span><span class="n">size</span><span class="p">,</span> <span class="n">is_double</span><span class="p">))</span>
            <span class="k">for</span> <span class="n">unused_suport_id</span><span class="p">,</span> <span class="n">suport</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">suport1</span><span class="o">.</span><span class="n">items</span><span class="p">()):</span>
                <span class="n">bdf_file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">suport</span><span class="o">.</span><span class="n">write_card</span><span class="p">(</span><span class="n">size</span><span class="p">,</span> <span class="n">is_double</span><span class="p">))</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">spcs</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">spcadds</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">spcoffs</span><span class="p">:</span>
            <span class="c1">#bdf_file.write(&#39;$SPCs\n&#39;)</span>
            <span class="c1">#str_spc = str(self.spcObject) # old</span>
            <span class="c1">#if str_spc:</span>
                <span class="c1">#bdf_file.write(str_spc)</span>
            <span class="c1">#else:</span>
            <span class="n">bdf_file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;$SPCs</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
            <span class="k">for</span> <span class="p">(</span><span class="n">unused_id</span><span class="p">,</span> <span class="n">spcadds</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">spcadds</span><span class="o">.</span><span class="n">items</span><span class="p">()):</span>
                <span class="k">for</span> <span class="n">spcadd</span> <span class="ow">in</span> <span class="n">spcadds</span><span class="p">:</span>
                    <span class="n">bdf_file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">spcadd</span><span class="p">))</span>
            <span class="k">for</span> <span class="p">(</span><span class="n">unused_id</span><span class="p">,</span> <span class="n">spcs</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">spcs</span><span class="o">.</span><span class="n">items</span><span class="p">()):</span>
                <span class="k">for</span> <span class="n">spc</span> <span class="ow">in</span> <span class="n">spcs</span><span class="p">:</span>
                    <span class="n">bdf_file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">spc</span><span class="p">))</span>
            <span class="k">for</span> <span class="p">(</span><span class="n">unused_id</span><span class="p">,</span> <span class="n">spcoffs</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">spcoffs</span><span class="o">.</span><span class="n">items</span><span class="p">()):</span>
                <span class="k">for</span> <span class="n">spc</span> <span class="ow">in</span> <span class="n">spcoffs</span><span class="p">:</span>
                    <span class="n">bdf_file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">spc</span><span class="p">))</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">mpcs</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">mpcadds</span><span class="p">:</span>
            <span class="n">bdf_file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;$MPCs</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
            <span class="k">for</span> <span class="p">(</span><span class="n">unused_id</span><span class="p">,</span> <span class="n">mpcadds</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mpcadds</span><span class="o">.</span><span class="n">items</span><span class="p">()):</span>
                <span class="k">for</span> <span class="n">mpcadd</span> <span class="ow">in</span> <span class="n">mpcadds</span><span class="p">:</span>
                    <span class="n">bdf_file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">mpcadd</span><span class="p">))</span>
            <span class="k">for</span> <span class="p">(</span><span class="n">unused_id</span><span class="p">,</span> <span class="n">mpcs</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mpcs</span><span class="o">.</span><span class="n">items</span><span class="p">()):</span>
                <span class="k">for</span> <span class="n">mpc</span> <span class="ow">in</span> <span class="n">mpcs</span><span class="p">:</span>
                    <span class="n">bdf_file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">mpc</span><span class="o">.</span><span class="n">write_card</span><span class="p">(</span><span class="n">size</span><span class="p">,</span> <span class="n">is_double</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">_write_contact</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">bdf_file</span><span class="p">:</span> <span class="n">Any</span><span class="p">,</span> <span class="n">size</span><span class="p">:</span> <span class="nb">int</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span> <span class="n">is_double</span><span class="p">:</span> <span class="nb">bool</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                       <span class="n">is_long_ids</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Writes the contact cards sorted by ID&quot;&quot;&quot;</span>
        <span class="n">is_contact</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">bcrparas</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">bctadds</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">bctparas</span>
                      <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">bctsets</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">bsurf</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">bsurfs</span>
                      <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">bconp</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">blseg</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">bfric</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">is_contact</span><span class="p">:</span>
            <span class="n">bdf_file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;$CONTACT</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
            <span class="k">for</span> <span class="p">(</span><span class="n">unused_id</span><span class="p">,</span> <span class="n">bcrpara</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">bcrparas</span><span class="o">.</span><span class="n">items</span><span class="p">()):</span>
                <span class="n">bdf_file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">bcrpara</span><span class="o">.</span><span class="n">write_card</span><span class="p">(</span><span class="n">size</span><span class="p">,</span> <span class="n">is_double</span><span class="p">))</span>
            <span class="k">for</span> <span class="p">(</span><span class="n">unused_id</span><span class="p">,</span> <span class="n">bctadds</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">bctadds</span><span class="o">.</span><span class="n">items</span><span class="p">()):</span>
                <span class="n">bdf_file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">bctadds</span><span class="o">.</span><span class="n">write_card</span><span class="p">(</span><span class="n">size</span><span class="p">,</span> <span class="n">is_double</span><span class="p">))</span>
            <span class="k">for</span> <span class="p">(</span><span class="n">unused_id</span><span class="p">,</span> <span class="n">bctpara</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">bctparas</span><span class="o">.</span><span class="n">items</span><span class="p">()):</span>
                <span class="n">bdf_file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">bctpara</span><span class="o">.</span><span class="n">write_card</span><span class="p">(</span><span class="n">size</span><span class="p">,</span> <span class="n">is_double</span><span class="p">))</span>

            <span class="k">for</span> <span class="p">(</span><span class="n">unused_id</span><span class="p">,</span> <span class="n">bctset</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">bctsets</span><span class="o">.</span><span class="n">items</span><span class="p">()):</span>
                <span class="n">bdf_file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">bctset</span><span class="o">.</span><span class="n">write_card</span><span class="p">(</span><span class="n">size</span><span class="p">,</span> <span class="n">is_double</span><span class="p">))</span>
            <span class="k">for</span> <span class="p">(</span><span class="n">unused_id</span><span class="p">,</span> <span class="n">bsurfi</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">bsurf</span><span class="o">.</span><span class="n">items</span><span class="p">()):</span>
                <span class="n">bdf_file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">bsurfi</span><span class="o">.</span><span class="n">write_card</span><span class="p">(</span><span class="n">size</span><span class="p">,</span> <span class="n">is_double</span><span class="p">))</span>
            <span class="k">for</span> <span class="p">(</span><span class="n">unused_id</span><span class="p">,</span> <span class="n">bsurfsi</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">bsurfs</span><span class="o">.</span><span class="n">items</span><span class="p">()):</span>
                <span class="n">bdf_file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">bsurfsi</span><span class="o">.</span><span class="n">write_card</span><span class="p">(</span><span class="n">size</span><span class="p">,</span> <span class="n">is_double</span><span class="p">))</span>
            <span class="k">for</span> <span class="p">(</span><span class="n">unused_id</span><span class="p">,</span> <span class="n">bconp</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">bconp</span><span class="o">.</span><span class="n">items</span><span class="p">()):</span>
                <span class="n">bdf_file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">bconp</span><span class="o">.</span><span class="n">write_card</span><span class="p">(</span><span class="n">size</span><span class="p">,</span> <span class="n">is_double</span><span class="p">))</span>
            <span class="k">for</span> <span class="p">(</span><span class="n">unused_id</span><span class="p">,</span> <span class="n">blseg</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">blseg</span><span class="o">.</span><span class="n">items</span><span class="p">()):</span>
                <span class="n">bdf_file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">blseg</span><span class="o">.</span><span class="n">write_card</span><span class="p">(</span><span class="n">size</span><span class="p">,</span> <span class="n">is_double</span><span class="p">))</span>
            <span class="k">for</span> <span class="p">(</span><span class="n">unused_id</span><span class="p">,</span> <span class="n">bfric</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">bfric</span><span class="o">.</span><span class="n">items</span><span class="p">()):</span>
                <span class="n">bdf_file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">bfric</span><span class="o">.</span><span class="n">write_card</span><span class="p">(</span><span class="n">size</span><span class="p">,</span> <span class="n">is_double</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">_write_coords</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">bdf_file</span><span class="p">:</span> <span class="n">Any</span><span class="p">,</span> <span class="n">size</span><span class="p">:</span> <span class="nb">int</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span> <span class="n">is_double</span><span class="p">:</span> <span class="nb">bool</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                      <span class="n">is_long_ids</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Writes the coordinate cards in a sorted order&quot;&quot;&quot;</span>
        <span class="n">size</span><span class="p">,</span> <span class="n">is_long_ids</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_write_mesh_long_ids_size</span><span class="p">(</span><span class="n">size</span><span class="p">,</span> <span class="n">is_long_ids</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">coords</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">bdf_file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;$COORDS</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="k">for</span> <span class="p">(</span><span class="n">coord_id</span><span class="p">,</span> <span class="n">coord</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">coords</span><span class="o">.</span><span class="n">items</span><span class="p">()):</span>
            <span class="k">if</span> <span class="n">coord_id</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="k">continue</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">bdf_file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">coord</span><span class="o">.</span><span class="n">write_card</span><span class="p">(</span><span class="n">size</span><span class="p">,</span> <span class="n">is_double</span><span class="p">))</span>
            <span class="k">except</span> <span class="ne">RuntimeError</span><span class="p">:</span>
                <span class="n">bdf_file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">coord</span><span class="o">.</span><span class="n">write_card_16</span><span class="p">(</span><span class="n">is_double</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">_write_dmigs</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">bdf_file</span><span class="p">:</span> <span class="n">Any</span><span class="p">,</span> <span class="n">size</span><span class="p">:</span> <span class="nb">int</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span> <span class="n">is_double</span><span class="p">:</span> <span class="nb">bool</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                     <span class="n">is_long_ids</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Writes the DMIG cards</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        size : int</span>
<span class="sd">            large field (16) or small field (8)</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="p">(</span><span class="n">unused_name</span><span class="p">,</span> <span class="n">dmig</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dmig</span><span class="o">.</span><span class="n">items</span><span class="p">()):</span>
            <span class="n">bdf_file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">dmig</span><span class="o">.</span><span class="n">write_card</span><span class="p">(</span><span class="n">size</span><span class="p">,</span> <span class="n">is_double</span><span class="p">))</span>
        <span class="k">for</span> <span class="p">(</span><span class="n">unused_name</span><span class="p">,</span> <span class="n">dmi</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dmi</span><span class="o">.</span><span class="n">items</span><span class="p">()):</span>
            <span class="n">bdf_file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">dmi</span><span class="o">.</span><span class="n">write_card</span><span class="p">(</span><span class="n">size</span><span class="p">,</span> <span class="n">is_double</span><span class="p">))</span>
        <span class="k">for</span> <span class="p">(</span><span class="n">unused_name</span><span class="p">,</span> <span class="n">dmij</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dmij</span><span class="o">.</span><span class="n">items</span><span class="p">()):</span>
            <span class="n">bdf_file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">dmij</span><span class="o">.</span><span class="n">write_card</span><span class="p">(</span><span class="n">size</span><span class="p">,</span> <span class="n">is_double</span><span class="p">))</span>
        <span class="k">for</span> <span class="p">(</span><span class="n">unused_name</span><span class="p">,</span> <span class="n">dmiji</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dmiji</span><span class="o">.</span><span class="n">items</span><span class="p">()):</span>
            <span class="n">bdf_file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">dmiji</span><span class="o">.</span><span class="n">write_card</span><span class="p">(</span><span class="n">size</span><span class="p">,</span> <span class="n">is_double</span><span class="p">))</span>
        <span class="k">for</span> <span class="p">(</span><span class="n">unused_name</span><span class="p">,</span> <span class="n">dmik</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dmik</span><span class="o">.</span><span class="n">items</span><span class="p">()):</span>
            <span class="n">bdf_file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">dmik</span><span class="o">.</span><span class="n">write_card</span><span class="p">(</span><span class="n">size</span><span class="p">,</span> <span class="n">is_double</span><span class="p">))</span>
        <span class="k">for</span> <span class="p">(</span><span class="n">unused_name</span><span class="p">,</span> <span class="n">dmiax</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dmiax</span><span class="o">.</span><span class="n">items</span><span class="p">()):</span>
            <span class="n">bdf_file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">dmiax</span><span class="o">.</span><span class="n">write_card</span><span class="p">(</span><span class="n">size</span><span class="p">,</span> <span class="n">is_double</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">_write_dynamic</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">bdf_file</span><span class="p">:</span> <span class="n">Any</span><span class="p">,</span> <span class="n">size</span><span class="p">:</span> <span class="nb">int</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span> <span class="n">is_double</span><span class="p">:</span> <span class="nb">bool</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                       <span class="n">is_long_ids</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Writes the dynamic cards sorted by ID&quot;&quot;&quot;</span>
        <span class="n">is_dynamic</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dareas</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">dphases</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">nlparms</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">frequencies</span> <span class="ow">or</span>
                      <span class="bp">self</span><span class="o">.</span><span class="n">methods</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">cMethods</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">tsteps</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">tstepnls</span> <span class="ow">or</span>
                      <span class="bp">self</span><span class="o">.</span><span class="n">transfer_functions</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">delays</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">rotors</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">tics</span> <span class="ow">or</span>
                      <span class="bp">self</span><span class="o">.</span><span class="n">nlpcis</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">is_dynamic</span><span class="p">:</span>
            <span class="n">bdf_file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;$DYNAMIC</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
            <span class="k">for</span> <span class="p">(</span><span class="n">unused_id</span><span class="p">,</span> <span class="n">method</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">methods</span><span class="o">.</span><span class="n">items</span><span class="p">()):</span>
                <span class="n">bdf_file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">method</span><span class="o">.</span><span class="n">write_card</span><span class="p">(</span><span class="n">size</span><span class="p">,</span> <span class="n">is_double</span><span class="p">))</span>
            <span class="k">for</span> <span class="p">(</span><span class="n">unused_id</span><span class="p">,</span> <span class="n">cmethod</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">cMethods</span><span class="o">.</span><span class="n">items</span><span class="p">()):</span>
                <span class="n">bdf_file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">cmethod</span><span class="o">.</span><span class="n">write_card</span><span class="p">(</span><span class="n">size</span><span class="p">,</span> <span class="n">is_double</span><span class="p">))</span>
            <span class="k">for</span> <span class="p">(</span><span class="n">unused_id</span><span class="p">,</span> <span class="n">darea</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dareas</span><span class="o">.</span><span class="n">items</span><span class="p">()):</span>
                <span class="n">bdf_file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">darea</span><span class="o">.</span><span class="n">write_card</span><span class="p">(</span><span class="n">size</span><span class="p">,</span> <span class="n">is_double</span><span class="p">))</span>
            <span class="k">for</span> <span class="p">(</span><span class="n">unused_id</span><span class="p">,</span> <span class="n">dphase</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dphases</span><span class="o">.</span><span class="n">items</span><span class="p">()):</span>
                <span class="n">bdf_file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">dphase</span><span class="o">.</span><span class="n">write_card</span><span class="p">(</span><span class="n">size</span><span class="p">,</span> <span class="n">is_double</span><span class="p">))</span>
            <span class="k">for</span> <span class="p">(</span><span class="n">unused_id</span><span class="p">,</span> <span class="n">nlparm</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nlparms</span><span class="o">.</span><span class="n">items</span><span class="p">()):</span>
                <span class="n">bdf_file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">nlparm</span><span class="o">.</span><span class="n">write_card</span><span class="p">(</span><span class="n">size</span><span class="p">,</span> <span class="n">is_double</span><span class="p">))</span>
            <span class="k">for</span> <span class="p">(</span><span class="n">unused_id</span><span class="p">,</span> <span class="n">nlpci</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nlpcis</span><span class="o">.</span><span class="n">items</span><span class="p">()):</span>
                <span class="n">bdf_file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">nlpci</span><span class="o">.</span><span class="n">write_card</span><span class="p">(</span><span class="n">size</span><span class="p">,</span> <span class="n">is_double</span><span class="p">))</span>
            <span class="k">for</span> <span class="p">(</span><span class="n">unused_id</span><span class="p">,</span> <span class="n">tstep</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tsteps</span><span class="o">.</span><span class="n">items</span><span class="p">()):</span>
                <span class="n">bdf_file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">tstep</span><span class="o">.</span><span class="n">write_card</span><span class="p">(</span><span class="n">size</span><span class="p">,</span> <span class="n">is_double</span><span class="p">))</span>
            <span class="k">for</span> <span class="p">(</span><span class="n">unused_id</span><span class="p">,</span> <span class="n">tstepnl</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tstepnls</span><span class="o">.</span><span class="n">items</span><span class="p">()):</span>
                <span class="n">bdf_file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">tstepnl</span><span class="o">.</span><span class="n">write_card</span><span class="p">(</span><span class="n">size</span><span class="p">,</span> <span class="n">is_double</span><span class="p">))</span>
            <span class="k">for</span> <span class="p">(</span><span class="n">unused_id</span><span class="p">,</span> <span class="n">freqs</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">frequencies</span><span class="o">.</span><span class="n">items</span><span class="p">()):</span>
                <span class="k">for</span> <span class="n">freq</span> <span class="ow">in</span> <span class="n">freqs</span><span class="p">:</span>
                    <span class="n">bdf_file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">freq</span><span class="o">.</span><span class="n">write_card</span><span class="p">(</span><span class="n">size</span><span class="p">,</span> <span class="n">is_double</span><span class="p">))</span>
            <span class="k">for</span> <span class="p">(</span><span class="n">unused_id</span><span class="p">,</span> <span class="n">delay</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">delays</span><span class="o">.</span><span class="n">items</span><span class="p">()):</span>
                <span class="n">bdf_file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">delay</span><span class="o">.</span><span class="n">write_card</span><span class="p">(</span><span class="n">size</span><span class="p">,</span> <span class="n">is_double</span><span class="p">))</span>
            <span class="k">for</span> <span class="p">(</span><span class="n">unused_id</span><span class="p">,</span> <span class="n">rotor</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">rotors</span><span class="o">.</span><span class="n">items</span><span class="p">()):</span>
                <span class="n">bdf_file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">rotor</span><span class="o">.</span><span class="n">write_card</span><span class="p">(</span><span class="n">size</span><span class="p">,</span> <span class="n">is_double</span><span class="p">))</span>
            <span class="k">for</span> <span class="p">(</span><span class="n">unused_id</span><span class="p">,</span> <span class="n">tic</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tics</span><span class="o">.</span><span class="n">items</span><span class="p">()):</span>
                <span class="n">bdf_file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">tic</span><span class="o">.</span><span class="n">write_card</span><span class="p">(</span><span class="n">size</span><span class="p">,</span> <span class="n">is_double</span><span class="p">))</span>

            <span class="k">for</span> <span class="p">(</span><span class="n">unused_id</span><span class="p">,</span> <span class="n">tfs</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">transfer_functions</span><span class="o">.</span><span class="n">items</span><span class="p">()):</span>
                <span class="k">for</span> <span class="n">transfer_function</span> <span class="ow">in</span> <span class="n">tfs</span><span class="p">:</span>
                    <span class="n">bdf_file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">transfer_function</span><span class="o">.</span><span class="n">write_card</span><span class="p">(</span><span class="n">size</span><span class="p">,</span> <span class="n">is_double</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">_write_mesh_long_ids_size</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">size</span><span class="p">:</span> <span class="nb">bool</span><span class="p">,</span> <span class="n">is_long_ids</span><span class="p">:</span> <span class="nb">bool</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">bool</span><span class="p">]:</span>
        <span class="sd">&quot;&quot;&quot;helper method&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">is_long_ids</span> <span class="ow">and</span> <span class="n">size</span> <span class="o">==</span> <span class="mi">16</span> <span class="ow">or</span> <span class="n">is_long_ids</span> <span class="ow">is</span> <span class="kc">False</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">size</span><span class="p">,</span> <span class="n">is_long_ids</span>

        <span class="k">if</span> <span class="n">size</span> <span class="o">==</span> <span class="mi">16</span> <span class="ow">and</span> <span class="n">is_long_ids</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_long_ids</span><span class="p">:</span>
            <span class="n">size</span> <span class="o">=</span> <span class="mi">16</span>
            <span class="n">is_long_ids</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">is_long_ids</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="k">return</span> <span class="n">size</span><span class="p">,</span> <span class="n">is_long_ids</span>

    <span class="k">def</span> <span class="nf">_write_loads</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">bdf_file</span><span class="p">:</span> <span class="n">Any</span><span class="p">,</span> <span class="n">size</span><span class="p">:</span> <span class="nb">int</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span> <span class="n">is_double</span><span class="p">:</span> <span class="nb">bool</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                     <span class="n">is_long_ids</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Writes the load cards sorted by ID&quot;&quot;&quot;</span>
        <span class="n">size</span><span class="p">,</span> <span class="n">is_long_ids</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_write_mesh_long_ids_size</span><span class="p">(</span><span class="n">size</span><span class="p">,</span> <span class="n">is_long_ids</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">load_combinations</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">loads</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">tempds</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">cyjoin</span><span class="p">:</span>
            <span class="n">bdf_file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;$LOADS</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
            <span class="k">for</span> <span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">load_combinations</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">load_combinations</span><span class="o">.</span><span class="n">items</span><span class="p">()):</span>
                <span class="k">for</span> <span class="n">load_combination</span> <span class="ow">in</span> <span class="n">load_combinations</span><span class="p">:</span>
                    <span class="k">try</span><span class="p">:</span>
                        <span class="n">bdf_file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">load_combination</span><span class="o">.</span><span class="n">write_card</span><span class="p">(</span><span class="n">size</span><span class="p">,</span> <span class="n">is_double</span><span class="p">))</span>
                    <span class="k">except</span><span class="p">:</span>
                        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;failed printing load...type=</span><span class="si">%s</span><span class="s1"> key=</span><span class="si">%r</span><span class="s1">&#39;</span>
                              <span class="o">%</span> <span class="p">(</span><span class="n">load_combination</span><span class="o">.</span><span class="n">type</span><span class="p">,</span> <span class="n">key</span><span class="p">))</span>
                        <span class="k">raise</span>

            <span class="k">if</span> <span class="n">is_long_ids</span><span class="p">:</span>
                <span class="k">for</span> <span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">loadcase</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">loads</span><span class="o">.</span><span class="n">items</span><span class="p">()):</span>
                    <span class="k">for</span> <span class="n">load</span> <span class="ow">in</span> <span class="n">loadcase</span><span class="p">:</span>
                        <span class="k">try</span><span class="p">:</span>
                            <span class="n">bdf_file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">load</span><span class="o">.</span><span class="n">write_card_16</span><span class="p">(</span><span class="n">is_double</span><span class="p">))</span>
                        <span class="k">except</span><span class="p">:</span>
                            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;failed printing load...type=</span><span class="si">%s</span><span class="s1"> key=</span><span class="si">%r</span><span class="s1">&#39;</span>
                                  <span class="o">%</span> <span class="p">(</span><span class="n">load</span><span class="o">.</span><span class="n">type</span><span class="p">,</span> <span class="n">key</span><span class="p">))</span>
                            <span class="k">raise</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">for</span> <span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">loadcase</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">loads</span><span class="o">.</span><span class="n">items</span><span class="p">()):</span>
                    <span class="k">for</span> <span class="n">load</span> <span class="ow">in</span> <span class="n">loadcase</span><span class="p">:</span>
                        <span class="k">try</span><span class="p">:</span>
                            <span class="n">bdf_file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">load</span><span class="o">.</span><span class="n">write_card</span><span class="p">(</span><span class="n">size</span><span class="p">,</span> <span class="n">is_double</span><span class="p">))</span>
                        <span class="k">except</span><span class="p">:</span>
                            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;failed printing load...type=</span><span class="si">%s</span><span class="s1"> key=</span><span class="si">%r</span><span class="s1">&#39;</span>
                                  <span class="o">%</span> <span class="p">(</span><span class="n">load</span><span class="o">.</span><span class="n">type</span><span class="p">,</span> <span class="n">key</span><span class="p">))</span>
                            <span class="k">raise</span>

            <span class="k">for</span> <span class="n">unused_key</span><span class="p">,</span> <span class="n">tempd</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tempds</span><span class="o">.</span><span class="n">items</span><span class="p">()):</span>
                <span class="n">bdf_file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">tempd</span><span class="o">.</span><span class="n">write_card</span><span class="p">(</span><span class="n">size</span><span class="p">,</span> <span class="n">is_double</span><span class="p">))</span>
            <span class="k">for</span> <span class="n">unused_key</span><span class="p">,</span> <span class="n">cyjoin</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">cyjoin</span><span class="o">.</span><span class="n">items</span><span class="p">()):</span>
                <span class="n">bdf_file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">cyjoin</span><span class="o">.</span><span class="n">write_card</span><span class="p">(</span><span class="n">size</span><span class="p">,</span> <span class="n">is_double</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_write_dloads</span><span class="p">(</span><span class="n">bdf_file</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="n">size</span><span class="p">,</span> <span class="n">is_double</span><span class="o">=</span><span class="n">is_double</span><span class="p">,</span> <span class="n">is_long_ids</span><span class="o">=</span><span class="n">is_long_ids</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_write_dloads</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">bdf_file</span><span class="p">:</span> <span class="n">Any</span><span class="p">,</span> <span class="n">size</span><span class="p">:</span> <span class="nb">int</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span> <span class="n">is_double</span><span class="p">:</span> <span class="nb">bool</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                      <span class="n">is_long_ids</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Writes the dload cards sorted by ID&quot;&quot;&quot;</span>
        <span class="n">size</span><span class="p">,</span> <span class="n">is_long_ids</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_write_mesh_long_ids_size</span><span class="p">(</span><span class="n">size</span><span class="p">,</span> <span class="n">is_long_ids</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">dloads</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">dload_entries</span><span class="p">:</span>
            <span class="n">bdf_file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;$DLOADS</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
            <span class="k">for</span> <span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">loadcase</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dloads</span><span class="o">.</span><span class="n">items</span><span class="p">()):</span>
                <span class="k">for</span> <span class="n">load</span> <span class="ow">in</span> <span class="n">loadcase</span><span class="p">:</span>
                    <span class="k">try</span><span class="p">:</span>
                        <span class="n">bdf_file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">load</span><span class="o">.</span><span class="n">write_card</span><span class="p">(</span><span class="n">size</span><span class="p">,</span> <span class="n">is_double</span><span class="p">))</span>
                    <span class="k">except</span><span class="p">:</span>
                        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;failed printing load...type=</span><span class="si">%s</span><span class="s1"> key=</span><span class="si">%r</span><span class="s1">&#39;</span>
                              <span class="o">%</span> <span class="p">(</span><span class="n">load</span><span class="o">.</span><span class="n">type</span><span class="p">,</span> <span class="n">key</span><span class="p">))</span>
                        <span class="k">raise</span>

            <span class="k">for</span> <span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">loadcase</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dload_entries</span><span class="o">.</span><span class="n">items</span><span class="p">()):</span>
                <span class="k">for</span> <span class="n">load</span> <span class="ow">in</span> <span class="n">loadcase</span><span class="p">:</span>
                    <span class="k">try</span><span class="p">:</span>
                        <span class="n">bdf_file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">load</span><span class="o">.</span><span class="n">write_card</span><span class="p">(</span><span class="n">size</span><span class="p">,</span> <span class="n">is_double</span><span class="p">))</span>
                    <span class="k">except</span><span class="p">:</span>
                        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;failed printing load...type=</span><span class="si">%s</span><span class="s1"> key=</span><span class="si">%r</span><span class="s1">&#39;</span>
                              <span class="o">%</span> <span class="p">(</span><span class="n">load</span><span class="o">.</span><span class="n">type</span><span class="p">,</span> <span class="n">key</span><span class="p">))</span>
                        <span class="k">raise</span>


    <span class="k">def</span> <span class="nf">_write_masses</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">bdf_file</span><span class="p">:</span> <span class="n">Any</span><span class="p">,</span> <span class="n">size</span><span class="p">:</span> <span class="nb">int</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span> <span class="n">is_double</span><span class="p">:</span> <span class="nb">bool</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                      <span class="n">is_long_ids</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Writes the mass cards sorted by ID&quot;&quot;&quot;</span>
        <span class="n">size</span><span class="p">,</span> <span class="n">is_long_ids</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_write_mesh_long_ids_size</span><span class="p">(</span><span class="n">size</span><span class="p">,</span> <span class="n">is_long_ids</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">properties_mass</span><span class="p">:</span>
            <span class="n">bdf_file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;$PROPERTIES_MASS</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
            <span class="k">for</span> <span class="p">(</span><span class="n">pid</span><span class="p">,</span> <span class="n">mass</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">properties_mass</span><span class="o">.</span><span class="n">items</span><span class="p">()):</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="n">bdf_file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">mass</span><span class="o">.</span><span class="n">write_card</span><span class="p">(</span><span class="n">size</span><span class="p">,</span> <span class="n">is_double</span><span class="p">))</span>
                <span class="k">except</span><span class="p">:</span>
                    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;failed printing mass property...&#39;</span>
                          <span class="s1">&#39;type=</span><span class="si">%s</span><span class="s1"> eid=</span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">mass</span><span class="o">.</span><span class="n">type</span><span class="p">,</span> <span class="n">pid</span><span class="p">))</span>
                    <span class="k">raise</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">masses</span><span class="p">:</span>
            <span class="n">bdf_file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;$MASSES</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
            <span class="k">for</span> <span class="p">(</span><span class="n">eid</span><span class="p">,</span> <span class="n">mass</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">masses</span><span class="o">.</span><span class="n">items</span><span class="p">()):</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="n">bdf_file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">mass</span><span class="o">.</span><span class="n">write_card</span><span class="p">(</span><span class="n">size</span><span class="p">,</span> <span class="n">is_double</span><span class="p">))</span>
                <span class="k">except</span><span class="p">:</span>
                    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;failed printing masses...&#39;</span>
                          <span class="s1">&#39;type=</span><span class="si">%s</span><span class="s1"> eid=</span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">mass</span><span class="o">.</span><span class="n">type</span><span class="p">,</span> <span class="n">eid</span><span class="p">))</span>
                    <span class="k">raise</span>

    <span class="k">def</span> <span class="nf">_write_materials</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">bdf_file</span><span class="p">:</span> <span class="n">Any</span><span class="p">,</span> <span class="n">size</span><span class="p">:</span> <span class="nb">int</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span> <span class="n">is_double</span><span class="p">:</span> <span class="nb">bool</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                         <span class="n">is_long_ids</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Writes the materials in a sorted order&quot;&quot;&quot;</span>
        <span class="n">size</span><span class="p">,</span> <span class="n">is_long_ids</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_write_mesh_long_ids_size</span><span class="p">(</span><span class="n">size</span><span class="p">,</span> <span class="n">is_long_ids</span><span class="p">)</span>
        <span class="n">is_big_materials</span> <span class="o">=</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;big_materials&#39;</span><span class="p">)</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">big_materials</span>
        <span class="n">is_materials</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">materials</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">hyperelastic_materials</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">creep_materials</span> <span class="ow">or</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">MATS1</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">MATS3</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">MATS8</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">MATT1</span> <span class="ow">or</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">MATT2</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">MATT3</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">MATT4</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">MATT5</span> <span class="ow">or</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">MATT8</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">MATT9</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">nxstrats</span> <span class="ow">or</span> <span class="n">is_big_materials</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">is_materials</span><span class="p">:</span>
            <span class="n">bdf_file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;$MATERIALS</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
            <span class="k">for</span> <span class="p">(</span><span class="n">unused_mid</span><span class="p">,</span> <span class="n">material</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">materials</span><span class="o">.</span><span class="n">items</span><span class="p">()):</span>
                <span class="n">bdf_file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">material</span><span class="o">.</span><span class="n">write_card</span><span class="p">(</span><span class="n">size</span><span class="p">,</span> <span class="n">is_double</span><span class="p">))</span>
            <span class="k">for</span> <span class="p">(</span><span class="n">unused_mid</span><span class="p">,</span> <span class="n">material</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">hyperelastic_materials</span><span class="o">.</span><span class="n">items</span><span class="p">()):</span>
                <span class="n">bdf_file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">material</span><span class="o">.</span><span class="n">write_card</span><span class="p">(</span><span class="n">size</span><span class="p">,</span> <span class="n">is_double</span><span class="p">))</span>
            <span class="k">for</span> <span class="p">(</span><span class="n">unused_mid</span><span class="p">,</span> <span class="n">material</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">creep_materials</span><span class="o">.</span><span class="n">items</span><span class="p">()):</span>
                <span class="n">bdf_file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">material</span><span class="o">.</span><span class="n">write_card</span><span class="p">(</span><span class="n">size</span><span class="p">,</span> <span class="n">is_double</span><span class="p">))</span>

            <span class="k">for</span> <span class="p">(</span><span class="n">unused_mid</span><span class="p">,</span> <span class="n">material</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">MATS1</span><span class="o">.</span><span class="n">items</span><span class="p">()):</span>
                <span class="n">bdf_file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">material</span><span class="o">.</span><span class="n">write_card</span><span class="p">(</span><span class="n">size</span><span class="p">,</span> <span class="n">is_double</span><span class="p">))</span>
            <span class="k">for</span> <span class="p">(</span><span class="n">unused_mid</span><span class="p">,</span> <span class="n">material</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">MATS3</span><span class="o">.</span><span class="n">items</span><span class="p">()):</span>
                <span class="n">bdf_file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">material</span><span class="o">.</span><span class="n">write_card</span><span class="p">(</span><span class="n">size</span><span class="p">,</span> <span class="n">is_double</span><span class="p">))</span>
            <span class="k">for</span> <span class="p">(</span><span class="n">unused_mid</span><span class="p">,</span> <span class="n">material</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">MATS8</span><span class="o">.</span><span class="n">items</span><span class="p">()):</span>
                <span class="n">bdf_file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">material</span><span class="o">.</span><span class="n">write_card</span><span class="p">(</span><span class="n">size</span><span class="p">,</span> <span class="n">is_double</span><span class="p">))</span>

            <span class="k">for</span> <span class="p">(</span><span class="n">unused_mid</span><span class="p">,</span> <span class="n">material</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">MATT1</span><span class="o">.</span><span class="n">items</span><span class="p">()):</span>
                <span class="n">bdf_file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">material</span><span class="o">.</span><span class="n">write_card</span><span class="p">(</span><span class="n">size</span><span class="p">,</span> <span class="n">is_double</span><span class="p">))</span>
            <span class="k">for</span> <span class="p">(</span><span class="n">unused_mid</span><span class="p">,</span> <span class="n">material</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">MATT2</span><span class="o">.</span><span class="n">items</span><span class="p">()):</span>
                <span class="n">bdf_file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">material</span><span class="o">.</span><span class="n">write_card</span><span class="p">(</span><span class="n">size</span><span class="p">,</span> <span class="n">is_double</span><span class="p">))</span>
            <span class="k">for</span> <span class="p">(</span><span class="n">unused_mid</span><span class="p">,</span> <span class="n">material</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">MATT3</span><span class="o">.</span><span class="n">items</span><span class="p">()):</span>
                <span class="n">bdf_file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">material</span><span class="o">.</span><span class="n">write_card</span><span class="p">(</span><span class="n">size</span><span class="p">,</span> <span class="n">is_double</span><span class="p">))</span>
            <span class="k">for</span> <span class="p">(</span><span class="n">unused_mid</span><span class="p">,</span> <span class="n">material</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">MATT4</span><span class="o">.</span><span class="n">items</span><span class="p">()):</span>
                <span class="n">bdf_file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">material</span><span class="o">.</span><span class="n">write_card</span><span class="p">(</span><span class="n">size</span><span class="p">,</span> <span class="n">is_double</span><span class="p">))</span>
            <span class="k">for</span> <span class="p">(</span><span class="n">unused_mid</span><span class="p">,</span> <span class="n">material</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">MATT5</span><span class="o">.</span><span class="n">items</span><span class="p">()):</span>
                <span class="n">bdf_file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">material</span><span class="o">.</span><span class="n">write_card</span><span class="p">(</span><span class="n">size</span><span class="p">,</span> <span class="n">is_double</span><span class="p">))</span>
            <span class="k">for</span> <span class="p">(</span><span class="n">unused_mid</span><span class="p">,</span> <span class="n">material</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">MATT8</span><span class="o">.</span><span class="n">items</span><span class="p">()):</span>
                <span class="n">bdf_file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">material</span><span class="o">.</span><span class="n">write_card</span><span class="p">(</span><span class="n">size</span><span class="p">,</span> <span class="n">is_double</span><span class="p">))</span>
            <span class="k">for</span> <span class="p">(</span><span class="n">unused_mid</span><span class="p">,</span> <span class="n">material</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">MATT9</span><span class="o">.</span><span class="n">items</span><span class="p">()):</span>
                <span class="n">bdf_file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">material</span><span class="o">.</span><span class="n">write_card</span><span class="p">(</span><span class="n">size</span><span class="p">,</span> <span class="n">is_double</span><span class="p">))</span>
            <span class="k">for</span> <span class="p">(</span><span class="n">unused_sid</span><span class="p">,</span> <span class="n">nxstrat</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nxstrats</span><span class="o">.</span><span class="n">items</span><span class="p">()):</span>
                <span class="n">bdf_file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">nxstrat</span><span class="o">.</span><span class="n">write_card</span><span class="p">(</span><span class="n">size</span><span class="p">,</span> <span class="n">is_double</span><span class="p">))</span>

            <span class="k">if</span> <span class="n">is_big_materials</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">unused_mid</span><span class="p">,</span> <span class="n">mat</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">big_materials</span><span class="o">.</span><span class="n">items</span><span class="p">()):</span>
                    <span class="n">bdf_file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">mat</span><span class="o">.</span><span class="n">write_card_16</span><span class="p">(</span><span class="n">is_double</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">_write_nodes</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">bdf_file</span><span class="p">:</span> <span class="n">Any</span><span class="p">,</span> <span class="n">size</span><span class="p">:</span> <span class="nb">int</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span> <span class="n">is_double</span><span class="p">:</span> <span class="nb">bool</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                     <span class="n">is_long_ids</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Writes the NODE-type cards&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">spoints</span><span class="p">:</span>
            <span class="n">bdf_file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;$SPOINTS</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
            <span class="n">bdf_file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">write_xpoints</span><span class="p">(</span><span class="s1">&#39;SPOINT&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">spoints</span><span class="p">))</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">epoints</span><span class="p">:</span>
            <span class="n">bdf_file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;$EPOINTS</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
            <span class="n">bdf_file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">write_xpoints</span><span class="p">(</span><span class="s1">&#39;EPOINT&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">epoints</span><span class="p">))</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">points</span><span class="p">:</span>
            <span class="n">bdf_file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;$POINTS</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">unused_point_id</span><span class="p">,</span> <span class="n">point</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">points</span><span class="o">.</span><span class="n">items</span><span class="p">()):</span>
                <span class="n">bdf_file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">point</span><span class="o">.</span><span class="n">write_card</span><span class="p">(</span><span class="n">size</span><span class="p">,</span> <span class="n">is_double</span><span class="p">))</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_is_axis_symmetric</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">axic</span><span class="p">:</span>
                <span class="n">bdf_file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">axic</span><span class="o">.</span><span class="n">write_card</span><span class="p">(</span><span class="n">size</span><span class="p">,</span> <span class="n">is_double</span><span class="p">))</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">axif</span><span class="p">:</span>
                <span class="n">bdf_file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">axif</span><span class="o">.</span><span class="n">write_card</span><span class="p">(</span><span class="n">size</span><span class="p">,</span> <span class="n">is_double</span><span class="p">))</span>
            <span class="k">for</span> <span class="n">unused_nid</span><span class="p">,</span> <span class="n">ringax_pointax</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ringaxs</span><span class="o">.</span><span class="n">items</span><span class="p">()):</span>
                <span class="n">bdf_file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">ringax_pointax</span><span class="o">.</span><span class="n">write_card</span><span class="p">(</span><span class="n">size</span><span class="p">,</span> <span class="n">is_double</span><span class="p">))</span>
            <span class="k">for</span> <span class="n">unused_ringfl</span><span class="p">,</span> <span class="n">ringfl</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ringfl</span><span class="o">.</span><span class="n">items</span><span class="p">()):</span>
                <span class="n">bdf_file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">ringfl</span><span class="o">.</span><span class="n">write_card</span><span class="p">(</span><span class="n">size</span><span class="p">,</span> <span class="n">is_double</span><span class="p">))</span>
            <span class="k">for</span> <span class="n">unused_nid</span><span class="p">,</span> <span class="n">gridb</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">gridb</span><span class="o">.</span><span class="n">items</span><span class="p">()):</span>
                <span class="n">bdf_file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">gridb</span><span class="o">.</span><span class="n">write_card</span><span class="p">(</span><span class="n">size</span><span class="p">,</span> <span class="n">is_double</span><span class="p">))</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">cyax</span><span class="p">:</span>
            <span class="n">bdf_file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">cyax</span><span class="o">.</span><span class="n">write_card</span><span class="p">(</span><span class="n">size</span><span class="p">,</span> <span class="n">is_double</span><span class="p">))</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_write_grids</span><span class="p">(</span><span class="n">bdf_file</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="n">size</span><span class="p">,</span> <span class="n">is_double</span><span class="o">=</span><span class="n">is_double</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">seqgp</span><span class="p">:</span>
            <span class="n">bdf_file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">seqgp</span><span class="o">.</span><span class="n">write_card</span><span class="p">(</span><span class="n">size</span><span class="p">,</span> <span class="n">is_double</span><span class="p">))</span>

        <span class="c1">#if 0:  # not finished</span>
            <span class="c1">#self._write_nodes_associated(bdf_file, size, is_double)</span>

    <span class="k">def</span> <span class="nf">_write_grids</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">bdf_file</span><span class="p">:</span> <span class="n">Any</span><span class="p">,</span> <span class="n">size</span><span class="p">:</span> <span class="nb">int</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span> <span class="n">is_double</span><span class="p">:</span> <span class="nb">bool</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                     <span class="n">is_long_ids</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Writes the GRID-type cards&quot;&quot;&quot;</span>
        <span class="n">size</span><span class="p">,</span> <span class="n">is_long_ids</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_write_mesh_long_ids_size</span><span class="p">(</span><span class="n">size</span><span class="p">,</span> <span class="n">is_long_ids</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">nodes</span><span class="p">:</span>
            <span class="n">bdf_file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;$NODES</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">grdset</span><span class="p">:</span>
                <span class="n">bdf_file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">grdset</span><span class="o">.</span><span class="n">write_card</span><span class="p">(</span><span class="n">size</span><span class="p">))</span>
            <span class="n">_write_dict</span><span class="p">(</span><span class="n">bdf_file</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">nodes</span><span class="p">,</span> <span class="n">size</span><span class="p">,</span> <span class="n">is_double</span><span class="p">,</span> <span class="n">is_long_ids</span><span class="p">)</span>

    <span class="c1">#def _write_nodes_associated(self, bdf_file, size=8, is_double=False):</span>
        <span class="c1">#&quot;&quot;&quot;</span>
        <span class="c1">#Writes the NODE-type in associated and unassociated groups.</span>

        <span class="c1">#.. warning:: Sometimes crashes, probably on invalid BDFs.</span>
        <span class="c1">#&quot;&quot;&quot;</span>
        <span class="c1">#associated_nodes = set()</span>
        <span class="c1">#for (eid, element) in self.elements.items():</span>
            <span class="c1">#associated_nodes = associated_nodes.union(set(element.node_ids))</span>

        <span class="c1">#all_nodes = set(self.nodes.keys())</span>
        <span class="c1">#unassociated_nodes = list(all_nodes.difference(associated_nodes))</span>
        <span class="c1">##missing_nodes = all_nodes.difference(</span>

        <span class="c1">## TODO: this really shouldn&#39;t be a list...???</span>
        <span class="c1">#associated_nodes = list(associated_nodes)</span>

        <span class="c1">#if associated_nodes:</span>
            <span class="c1">#bdf_file.write(&#39;$ASSOCIATED NODES\n&#39;)</span>
            <span class="c1">#if self.grdset:</span>
                <span class="c1">#bdf_file.write(self.grdset.write_card(size, is_double))</span>
            <span class="c1">## TODO: this really shouldn&#39;t be a dictionary...???</span>
            <span class="c1">#for key, node in sorted(associated_nodes.items()):</span>
                <span class="c1">#bdf_file.write(node.write_card(size, is_double))</span>

        <span class="c1">#if unassociated_nodes:</span>
            <span class="c1">#bdf_file.write(&#39;$UNASSOCIATED NODES\n&#39;)</span>
            <span class="c1">#if self.grdset and not associated_nodes:</span>
                <span class="c1">#v(self.grdset.write_card(size, is_double))</span>
            <span class="c1">#for key, node in sorted(unassociated_nodes.items()):</span>
                <span class="c1">#if key in self.nodes:</span>
                    <span class="c1">#bdf_file.write(node.write_card(size, is_double))</span>
                <span class="c1">#else:</span>
                    <span class="c1">#bdf_file.write(&#39;$ Missing NodeID=%s&#39; % key)</span>

    <span class="k">def</span> <span class="nf">_write_optimization</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">bdf_file</span><span class="p">:</span> <span class="n">Any</span><span class="p">,</span> <span class="n">size</span><span class="p">:</span> <span class="nb">int</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span> <span class="n">is_double</span><span class="p">:</span> <span class="nb">bool</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                            <span class="n">is_long_ids</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Writes the optimization cards sorted by ID&quot;&quot;&quot;</span>
        <span class="n">is_optimization</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dconadds</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">dconstrs</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">desvars</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">ddvals</span> <span class="ow">or</span>
                           <span class="bp">self</span><span class="o">.</span><span class="n">dresps</span> <span class="ow">or</span>
                           <span class="bp">self</span><span class="o">.</span><span class="n">dvprels</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">dvmrels</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">dvcrels</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">doptprm</span> <span class="ow">or</span>
                           <span class="bp">self</span><span class="o">.</span><span class="n">dlinks</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">dequations</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">dtable</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">or</span>
                           <span class="bp">self</span><span class="o">.</span><span class="n">dvgrids</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">dscreen</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">topvar</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">modtrak</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">is_optimization</span><span class="p">:</span>
            <span class="n">bdf_file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;$OPTIMIZATION</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
            <span class="k">for</span> <span class="p">(</span><span class="n">unused_id</span><span class="p">,</span> <span class="n">dconadd</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dconadds</span><span class="o">.</span><span class="n">items</span><span class="p">()):</span>
                <span class="n">bdf_file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">dconadd</span><span class="o">.</span><span class="n">write_card</span><span class="p">(</span><span class="n">size</span><span class="p">,</span> <span class="n">is_double</span><span class="p">))</span>
            <span class="k">for</span> <span class="p">(</span><span class="n">unused_id</span><span class="p">,</span> <span class="n">dconstrs</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dconstrs</span><span class="o">.</span><span class="n">items</span><span class="p">()):</span>
                <span class="k">for</span> <span class="n">dconstr</span> <span class="ow">in</span> <span class="n">dconstrs</span><span class="p">:</span>
                    <span class="n">bdf_file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">dconstr</span><span class="o">.</span><span class="n">write_card</span><span class="p">(</span><span class="n">size</span><span class="p">,</span> <span class="n">is_double</span><span class="p">))</span>
            <span class="k">for</span> <span class="p">(</span><span class="n">unused_id</span><span class="p">,</span> <span class="n">desvar</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">desvars</span><span class="o">.</span><span class="n">items</span><span class="p">()):</span>
                <span class="n">bdf_file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">desvar</span><span class="o">.</span><span class="n">write_card</span><span class="p">(</span><span class="n">size</span><span class="p">,</span> <span class="n">is_double</span><span class="p">))</span>
            <span class="k">for</span> <span class="p">(</span><span class="n">unused_id</span><span class="p">,</span> <span class="n">topvar</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">topvar</span><span class="o">.</span><span class="n">items</span><span class="p">()):</span>
                <span class="n">bdf_file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">topvar</span><span class="o">.</span><span class="n">write_card</span><span class="p">(</span><span class="n">size</span><span class="p">,</span> <span class="n">is_double</span><span class="p">))</span>
            <span class="k">for</span> <span class="p">(</span><span class="n">unused_id</span><span class="p">,</span> <span class="n">ddval</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ddvals</span><span class="o">.</span><span class="n">items</span><span class="p">()):</span>
                <span class="n">bdf_file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">ddval</span><span class="o">.</span><span class="n">write_card</span><span class="p">(</span><span class="n">size</span><span class="p">,</span> <span class="n">is_double</span><span class="p">))</span>
            <span class="k">for</span> <span class="p">(</span><span class="n">unused_id</span><span class="p">,</span> <span class="n">dlink</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dlinks</span><span class="o">.</span><span class="n">items</span><span class="p">()):</span>
                <span class="n">bdf_file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">dlink</span><span class="o">.</span><span class="n">write_card</span><span class="p">(</span><span class="n">size</span><span class="p">,</span> <span class="n">is_double</span><span class="p">))</span>
            <span class="k">for</span> <span class="p">(</span><span class="n">unused_id</span><span class="p">,</span> <span class="n">dresp</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dresps</span><span class="o">.</span><span class="n">items</span><span class="p">()):</span>
                <span class="n">bdf_file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">dresp</span><span class="o">.</span><span class="n">write_card</span><span class="p">(</span><span class="n">size</span><span class="p">,</span> <span class="n">is_double</span><span class="p">))</span>

            <span class="k">for</span> <span class="p">(</span><span class="n">unused_id</span><span class="p">,</span> <span class="n">dvcrel</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dvcrels</span><span class="o">.</span><span class="n">items</span><span class="p">()):</span>
                <span class="n">bdf_file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">dvcrel</span><span class="o">.</span><span class="n">write_card</span><span class="p">(</span><span class="n">size</span><span class="p">,</span> <span class="n">is_double</span><span class="p">))</span>
            <span class="k">for</span> <span class="p">(</span><span class="n">unused_id</span><span class="p">,</span> <span class="n">dvmrel</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dvmrels</span><span class="o">.</span><span class="n">items</span><span class="p">()):</span>
                <span class="n">bdf_file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">dvmrel</span><span class="o">.</span><span class="n">write_card</span><span class="p">(</span><span class="n">size</span><span class="p">,</span> <span class="n">is_double</span><span class="p">))</span>
            <span class="k">for</span> <span class="p">(</span><span class="n">unused_id</span><span class="p">,</span> <span class="n">dvprel</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dvprels</span><span class="o">.</span><span class="n">items</span><span class="p">()):</span>
                <span class="n">bdf_file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">dvprel</span><span class="o">.</span><span class="n">write_card</span><span class="p">(</span><span class="n">size</span><span class="p">,</span> <span class="n">is_double</span><span class="p">))</span>
            <span class="k">for</span> <span class="p">(</span><span class="n">unused_id</span><span class="p">,</span> <span class="n">dvgrids</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dvgrids</span><span class="o">.</span><span class="n">items</span><span class="p">()):</span>
                <span class="k">for</span> <span class="n">dvgrid</span> <span class="ow">in</span> <span class="n">dvgrids</span><span class="p">:</span>
                    <span class="n">bdf_file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">dvgrid</span><span class="o">.</span><span class="n">write_card</span><span class="p">(</span><span class="n">size</span><span class="p">,</span> <span class="n">is_double</span><span class="p">))</span>
            <span class="k">for</span> <span class="p">(</span><span class="n">unused_id</span><span class="p">,</span> <span class="n">dscreen</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dscreen</span><span class="o">.</span><span class="n">items</span><span class="p">()):</span>
                <span class="n">bdf_file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">dscreen</span><span class="p">))</span>

            <span class="k">for</span> <span class="p">(</span><span class="n">unused_id</span><span class="p">,</span> <span class="n">equation</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dequations</span><span class="o">.</span><span class="n">items</span><span class="p">()):</span>
                <span class="n">bdf_file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">equation</span><span class="p">))</span>

            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">dtable</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">bdf_file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dtable</span><span class="o">.</span><span class="n">write_card</span><span class="p">(</span><span class="n">size</span><span class="p">,</span> <span class="n">is_double</span><span class="p">))</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">doptprm</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">bdf_file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">doptprm</span><span class="o">.</span><span class="n">write_card</span><span class="p">(</span><span class="n">size</span><span class="p">,</span> <span class="n">is_double</span><span class="p">))</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">modtrak</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">bdf_file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">modtrak</span><span class="o">.</span><span class="n">write_card</span><span class="p">(</span><span class="n">size</span><span class="p">,</span> <span class="n">is_double</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">_write_parametric</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">bdf_file</span><span class="p">:</span> <span class="n">Any</span><span class="p">,</span> <span class="n">size</span><span class="p">:</span> <span class="nb">int</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span> <span class="n">is_double</span><span class="p">:</span> <span class="nb">bool</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                          <span class="n">is_long_ids</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Writes the optimization cards sorted by ID&quot;&quot;&quot;</span>
        <span class="n">is_parametric</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">pset</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">pval</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">gmcurv</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">feedge</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">feface</span>
        <span class="k">if</span> <span class="n">is_parametric</span><span class="p">:</span>
            <span class="k">for</span> <span class="p">(</span><span class="n">unused_id</span><span class="p">,</span> <span class="n">pset</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pset</span><span class="o">.</span><span class="n">items</span><span class="p">()):</span>
                <span class="n">bdf_file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">pset</span><span class="o">.</span><span class="n">write_card</span><span class="p">(</span><span class="n">size</span><span class="p">,</span> <span class="n">is_double</span><span class="p">))</span>

            <span class="k">for</span> <span class="p">(</span><span class="n">unused_adapt_id</span><span class="p">,</span> <span class="n">pvals</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pval</span><span class="o">.</span><span class="n">items</span><span class="p">()):</span>
                <span class="k">for</span> <span class="n">pval</span> <span class="ow">in</span> <span class="n">pvals</span><span class="p">:</span>
                    <span class="n">bdf_file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">pval</span><span class="o">.</span><span class="n">write_card</span><span class="p">(</span><span class="n">size</span><span class="p">,</span> <span class="n">is_double</span><span class="p">))</span>

            <span class="k">for</span> <span class="p">(</span><span class="n">unused_id</span><span class="p">,</span> <span class="n">gmcurv</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">gmcurv</span><span class="o">.</span><span class="n">items</span><span class="p">()):</span>
                <span class="n">bdf_file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">gmcurv</span><span class="o">.</span><span class="n">write_card</span><span class="p">(</span><span class="n">size</span><span class="p">,</span> <span class="n">is_double</span><span class="p">))</span>

            <span class="k">for</span> <span class="p">(</span><span class="n">unused_id</span><span class="p">,</span> <span class="n">gmsurf</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">gmsurf</span><span class="o">.</span><span class="n">items</span><span class="p">()):</span>
                <span class="n">bdf_file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">gmsurf</span><span class="o">.</span><span class="n">write_card</span><span class="p">(</span><span class="n">size</span><span class="p">,</span> <span class="n">is_double</span><span class="p">))</span>

            <span class="k">for</span> <span class="p">(</span><span class="n">unused_id</span><span class="p">,</span> <span class="n">feedge</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">feedge</span><span class="o">.</span><span class="n">items</span><span class="p">()):</span>
                <span class="n">bdf_file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">feedge</span><span class="o">.</span><span class="n">write_card</span><span class="p">(</span><span class="n">size</span><span class="p">,</span> <span class="n">is_double</span><span class="p">))</span>

            <span class="k">for</span> <span class="p">(</span><span class="n">unused_id</span><span class="p">,</span> <span class="n">feface</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">feface</span><span class="o">.</span><span class="n">items</span><span class="p">()):</span>
                <span class="n">bdf_file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">feface</span><span class="o">.</span><span class="n">write_card</span><span class="p">(</span><span class="n">size</span><span class="p">,</span> <span class="n">is_double</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">_write_params</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">bdf_file</span><span class="p">:</span> <span class="n">Any</span><span class="p">,</span> <span class="n">size</span><span class="p">:</span> <span class="nb">int</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span> <span class="n">is_double</span><span class="p">:</span> <span class="nb">bool</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                      <span class="n">is_long_ids</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Writes the PARAM cards&quot;&quot;&quot;</span>
        <span class="n">size</span><span class="p">,</span> <span class="n">is_long_ids</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_write_mesh_long_ids_size</span><span class="p">(</span><span class="n">size</span><span class="p">,</span> <span class="n">is_long_ids</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">params</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">dti</span><span class="p">:</span>
            <span class="n">bdf_file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;$PARAMS</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>  <span class="c1"># type: List[str]</span>
            <span class="k">for</span> <span class="n">unused_name</span><span class="p">,</span> <span class="n">dti</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dti</span><span class="o">.</span><span class="n">items</span><span class="p">()):</span>
                <span class="n">bdf_file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">dti</span><span class="o">.</span><span class="n">write_card</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="n">size</span><span class="p">,</span> <span class="n">is_double</span><span class="o">=</span><span class="n">is_double</span><span class="p">))</span>

            <span class="k">for</span> <span class="p">(</span><span class="n">unused_key</span><span class="p">,</span> <span class="n">param</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="o">.</span><span class="n">items</span><span class="p">()):</span>
                <span class="n">bdf_file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">param</span><span class="o">.</span><span class="n">write_card</span><span class="p">(</span><span class="n">size</span><span class="p">,</span> <span class="n">is_double</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">_write_properties</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">bdf_file</span><span class="p">:</span> <span class="n">Any</span><span class="p">,</span> <span class="n">size</span><span class="p">:</span> <span class="nb">int</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span> <span class="n">is_double</span><span class="p">:</span> <span class="nb">bool</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                          <span class="n">is_long_ids</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Writes the properties in a sorted order&quot;&quot;&quot;</span>
        <span class="n">size</span><span class="p">,</span> <span class="n">is_long_ids</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_write_mesh_long_ids_size</span><span class="p">(</span><span class="n">size</span><span class="p">,</span> <span class="n">is_long_ids</span><span class="p">)</span>
        <span class="n">is_big_properties</span> <span class="o">=</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;big_properties&#39;</span><span class="p">)</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">big_properties</span>
        <span class="n">is_properties</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">properties</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">pelast</span> <span class="ow">or</span>
                         <span class="bp">self</span><span class="o">.</span><span class="n">pdampt</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">pbusht</span> <span class="ow">or</span> <span class="n">is_big_properties</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">is_properties</span><span class="p">:</span>
            <span class="n">bdf_file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;$PROPERTIES</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
            <span class="n">prop_groups</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">properties</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">pelast</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">pdampt</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">pbusht</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">is_long_ids</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">prop_group</span> <span class="ow">in</span> <span class="n">prop_groups</span><span class="p">:</span>
                    <span class="k">for</span> <span class="n">unused_pid</span><span class="p">,</span> <span class="n">prop</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">prop_group</span><span class="o">.</span><span class="n">items</span><span class="p">()):</span>
                        <span class="n">bdf_file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">prop</span><span class="o">.</span><span class="n">write_card_16</span><span class="p">(</span><span class="n">is_double</span><span class="p">))</span>
                <span class="c1">#except:</span>
                    <span class="c1">#print(&#39;failed printing property type=%s&#39; % prop.type)</span>
                    <span class="c1">#raise</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">prop_group</span> <span class="ow">in</span> <span class="n">prop_groups</span><span class="p">:</span>
                    <span class="k">for</span> <span class="n">unused_pid</span><span class="p">,</span> <span class="n">prop</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">prop_group</span><span class="o">.</span><span class="n">items</span><span class="p">()):</span>
                        <span class="n">bdf_file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">prop</span><span class="o">.</span><span class="n">write_card</span><span class="p">(</span><span class="n">size</span><span class="p">,</span> <span class="n">is_double</span><span class="p">))</span>

            <span class="k">if</span> <span class="n">is_big_properties</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">unused_pid</span><span class="p">,</span> <span class="n">prop</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">big_properties</span><span class="o">.</span><span class="n">items</span><span class="p">()):</span>
                    <span class="n">bdf_file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">prop</span><span class="o">.</span><span class="n">write_card_16</span><span class="p">(</span><span class="n">is_double</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">_write_properties_by_element_type</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">bdf_file</span><span class="p">:</span> <span class="n">Any</span><span class="p">,</span> <span class="n">size</span><span class="p">:</span> <span class="nb">int</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span> <span class="n">is_double</span><span class="p">:</span> <span class="nb">bool</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                                          <span class="n">is_long_ids</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Writes the properties in a sorted order by property type grouping</span>

<span class="sd">        TODO: Missing some property types.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">size</span><span class="p">,</span> <span class="n">is_long_ids</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_write_mesh_long_ids_size</span><span class="p">(</span><span class="n">size</span><span class="p">,</span> <span class="n">is_long_ids</span><span class="p">)</span>
        <span class="n">is_properties</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">properties</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">pelast</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">pdampt</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">pbusht</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">is_properties</span><span class="p">:</span>
            <span class="k">return</span>

        <span class="n">out</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_properties_by_element_type</span><span class="p">()</span>
        <span class="n">propertys_class_to_property_types</span><span class="p">,</span> <span class="n">property_type_to_property_class</span><span class="p">,</span> <span class="n">properties_by_class</span> <span class="o">=</span> <span class="n">out</span>

        <span class="n">bdf_file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;$PROPERTIES</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">prop_class</span><span class="p">,</span> <span class="n">prop_types</span> <span class="ow">in</span> <span class="n">propertys_class_to_property_types</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">prop_class</span><span class="p">,</span> <span class="n">prop_types</span><span class="p">)</span>
            <span class="c1">#for prop_type in prop_types:</span>
                <span class="c1">#if prop_type not in properties_by_class:</span>
                    <span class="c1">#continue</span>
                <span class="c1">#print(&#39;  &#39;, prop_type)</span>
            <span class="n">props</span> <span class="o">=</span> <span class="n">properties_by_class</span><span class="p">[</span><span class="n">prop_class</span><span class="p">]</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">props</span><span class="p">:</span>
                <span class="k">continue</span>
            <span class="n">bdf_file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;$&#39;</span> <span class="o">+</span> <span class="s1">&#39;-&#39;</span> <span class="o">*</span> <span class="mi">80</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
            <span class="n">bdf_file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;$ </span><span class="si">%s</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">prop_class</span><span class="p">)</span>

            <span class="k">for</span> <span class="n">prop</span> <span class="ow">in</span> <span class="n">props</span><span class="p">:</span>
                <span class="n">bdf_file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">prop</span><span class="o">.</span><span class="n">write_card</span><span class="p">(</span><span class="n">size</span><span class="p">,</span> <span class="n">is_double</span><span class="p">))</span>
        <span class="n">bdf_file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;$&#39;</span> <span class="o">+</span> <span class="s1">&#39;-&#39;</span> <span class="o">*</span> <span class="mi">80</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_get_properties_by_element_type</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]],</span>
                                                       <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">],</span>
                                                       <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]]:</span>
        <span class="sd">&quot;&quot;&quot;helper for ``_write_properties_by_element_type``&quot;&quot;&quot;</span>
        <span class="n">propertys_class_to_property_types</span> <span class="o">=</span> <span class="n">OrderedDict</span><span class="p">()</span>
        <span class="c1"># prop_class -&gt; property types</span>
        <span class="n">propertys_class_to_property_types</span><span class="p">[</span><span class="s1">&#39;spring&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;PELAS&#39;</span><span class="p">,</span> <span class="s1">&#39;PELAST&#39;</span><span class="p">]</span>
        <span class="n">propertys_class_to_property_types</span><span class="p">[</span><span class="s1">&#39;damper&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;PDAMP&#39;</span><span class="p">,</span> <span class="s1">&#39;PDAMPT&#39;</span><span class="p">]</span>
        <span class="n">propertys_class_to_property_types</span><span class="p">[</span><span class="s1">&#39;rod&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;PROD&#39;</span><span class="p">,</span> <span class="s1">&#39;PTUBE&#39;</span><span class="p">]</span>
        <span class="n">propertys_class_to_property_types</span><span class="p">[</span><span class="s1">&#39;bar&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;PBAR&#39;</span><span class="p">,</span> <span class="s1">&#39;PBARL&#39;</span><span class="p">,</span> <span class="s1">&#39;PBRSECT&#39;</span><span class="p">]</span>
        <span class="n">propertys_class_to_property_types</span><span class="p">[</span><span class="s1">&#39;beam&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;PBEAM&#39;</span><span class="p">,</span> <span class="s1">&#39;PBEAML&#39;</span><span class="p">,</span> <span class="s1">&#39;PBMSECT&#39;</span><span class="p">]</span>
        <span class="n">propertys_class_to_property_types</span><span class="p">[</span><span class="s1">&#39;bush&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;PBUSH&#39;</span><span class="p">,</span> <span class="s1">&#39;PBUSH1D&#39;</span><span class="p">,</span> <span class="s1">&#39;PBUSH2D&#39;</span><span class="p">]</span>
        <span class="n">propertys_class_to_property_types</span><span class="p">[</span><span class="s1">&#39;shell&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;PSHEAR&#39;</span><span class="p">,</span> <span class="s1">&#39;PSHELL&#39;</span><span class="p">,</span> <span class="s1">&#39;PCOMP&#39;</span><span class="p">,</span> <span class="s1">&#39;PCOMPG&#39;</span><span class="p">]</span>
        <span class="n">propertys_class_to_property_types</span><span class="p">[</span><span class="s1">&#39;solid&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;PSOLID&#39;</span><span class="p">,</span> <span class="s1">&#39;PLSOLID&#39;</span><span class="p">]</span>

        <span class="n">property_type_to_property_class</span> <span class="o">=</span> <span class="p">{</span>
            <span class="c1">#&#39;other&#39; : [],</span>
        <span class="p">}</span>
        <span class="c1"># the inverse of propertys_class_to_property_types</span>
        <span class="k">for</span> <span class="n">prop_class</span><span class="p">,</span> <span class="n">prop_types</span> <span class="ow">in</span> <span class="n">propertys_class_to_property_types</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">for</span> <span class="n">prop_type</span> <span class="ow">in</span> <span class="n">prop_types</span><span class="p">:</span>
                <span class="n">property_type_to_property_class</span><span class="p">[</span><span class="n">prop_type</span><span class="p">]</span> <span class="o">=</span> <span class="n">prop_class</span>

        <span class="c1">#if is_properties:</span>

        <span class="c1"># put each property object into a class (e.g., CQUAD4 -&gt; PCOMP)</span>
        <span class="n">properties_by_class</span> <span class="o">=</span> <span class="n">defaultdict</span><span class="p">(</span><span class="nb">list</span><span class="p">)</span>
        <span class="n">prop_groups</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">properties</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">pelast</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">pdampt</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">pbusht</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">properties</span> <span class="ow">in</span> <span class="n">prop_groups</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">unused_pid</span><span class="p">,</span> <span class="n">prop</span> <span class="ow">in</span> <span class="n">properties</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                <span class="n">prop_class</span> <span class="o">=</span> <span class="n">property_type_to_property_class</span><span class="p">[</span><span class="n">prop</span><span class="o">.</span><span class="n">type</span><span class="p">]</span>
                <span class="n">properties_by_class</span><span class="p">[</span><span class="n">prop_class</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">prop</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">propertys_class_to_property_types</span><span class="p">,</span> <span class="n">property_type_to_property_class</span><span class="p">,</span> <span class="n">properties_by_class</span>

    <span class="k">def</span> <span class="nf">_write_rejects</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">bdf_file</span><span class="p">:</span> <span class="n">Any</span><span class="p">,</span> <span class="n">size</span><span class="p">:</span> <span class="nb">int</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span> <span class="n">is_double</span><span class="p">:</span> <span class="nb">bool</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                       <span class="n">is_long_ids</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Writes the rejected (processed) cards and the rejected unprocessed</span>
<span class="sd">        cardlines</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">size</span> <span class="o">==</span> <span class="mi">8</span><span class="p">:</span>
            <span class="n">print_func</span> <span class="o">=</span> <span class="n">print_card_8</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">print_func</span> <span class="o">=</span> <span class="n">print_card_16</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">reject_cards</span><span class="p">:</span>
            <span class="n">bdf_file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;$REJECT_CARDS</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">reject_card</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">reject_cards</span><span class="p">:</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="n">bdf_file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">print_func</span><span class="p">(</span><span class="n">reject_card</span><span class="p">))</span>
                <span class="k">except</span> <span class="ne">RuntimeError</span><span class="p">:</span>
                    <span class="k">for</span> <span class="n">field</span> <span class="ow">in</span> <span class="n">reject_card</span><span class="p">:</span>
                        <span class="k">if</span> <span class="n">field</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="s1">&#39;=&#39;</span> <span class="ow">in</span> <span class="n">field</span><span class="p">:</span>
                            <span class="k">raise</span> <span class="ne">SyntaxError</span><span class="p">(</span><span class="s1">&#39;cannot reject equal signed &#39;</span>
                                              <span class="s1">&#39;cards</span><span class="se">\n</span><span class="s1">card=</span><span class="si">%s</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">reject_card</span><span class="p">)</span>
                    <span class="k">raise</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">reject_lines</span><span class="p">:</span>
            <span class="n">bdf_file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;$REJECT_LINES</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">reject_lines</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">reject_lines</span><span class="p">:</span>
                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">reject_lines</span><span class="p">,</span> <span class="p">(</span><span class="nb">list</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">)):</span>
                    <span class="k">for</span> <span class="n">reject</span> <span class="ow">in</span> <span class="n">reject_lines</span><span class="p">:</span>
                        <span class="n">reject2</span> <span class="o">=</span> <span class="n">reject</span><span class="o">.</span><span class="n">rstrip</span><span class="p">()</span>
                        <span class="k">if</span> <span class="n">reject2</span><span class="p">:</span>
                            <span class="n">bdf_file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%s</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">reject2</span><span class="p">)</span>
                <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">reject_lines</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
                    <span class="n">reject2</span> <span class="o">=</span> <span class="n">reject_lines</span><span class="o">.</span><span class="n">rstrip</span><span class="p">()</span>
                    <span class="k">if</span> <span class="n">reject2</span><span class="p">:</span>
                        <span class="n">bdf_file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%s</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">reject2</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="n">reject_lines</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_write_rigid_elements</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">bdf_file</span><span class="p">:</span> <span class="n">Any</span><span class="p">,</span> <span class="n">size</span><span class="p">:</span> <span class="nb">int</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span> <span class="n">is_double</span><span class="p">:</span> <span class="nb">bool</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                              <span class="n">is_long_ids</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Writes the rigid elements in a sorted order&quot;&quot;&quot;</span>
        <span class="n">size</span><span class="p">,</span> <span class="n">is_long_ids</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_write_mesh_long_ids_size</span><span class="p">(</span><span class="n">size</span><span class="p">,</span> <span class="n">is_long_ids</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">rigid_elements</span><span class="p">:</span>
            <span class="n">bdf_file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;$RIGID ELEMENTS</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">is_long_ids</span><span class="p">:</span>
                <span class="k">for</span> <span class="p">(</span><span class="n">eid</span><span class="p">,</span> <span class="n">element</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">rigid_elements</span><span class="o">.</span><span class="n">items</span><span class="p">()):</span>
                    <span class="k">try</span><span class="p">:</span>
                        <span class="n">bdf_file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">element</span><span class="o">.</span><span class="n">write_card_16</span><span class="p">(</span><span class="n">is_double</span><span class="p">))</span>
                    <span class="k">except</span><span class="p">:</span>
                        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;failed printing element...&#39;</span>
                              <span class="s1">&#39;type=</span><span class="si">%s</span><span class="s1"> eid=</span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">element</span><span class="o">.</span><span class="n">type</span><span class="p">,</span> <span class="n">eid</span><span class="p">))</span>
                        <span class="k">raise</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">for</span> <span class="p">(</span><span class="n">eid</span><span class="p">,</span> <span class="n">element</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">rigid_elements</span><span class="o">.</span><span class="n">items</span><span class="p">()):</span>
                    <span class="k">try</span><span class="p">:</span>
                        <span class="n">bdf_file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">element</span><span class="o">.</span><span class="n">write_card</span><span class="p">(</span><span class="n">size</span><span class="p">,</span> <span class="n">is_double</span><span class="p">))</span>
                    <span class="k">except</span><span class="p">:</span>
                        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;failed printing element...&#39;</span>
                              <span class="s1">&#39;type=</span><span class="si">%s</span><span class="s1"> eid=</span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">element</span><span class="o">.</span><span class="n">type</span><span class="p">,</span> <span class="n">eid</span><span class="p">))</span>
                        <span class="k">raise</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">plotels</span><span class="p">:</span>
            <span class="n">bdf_file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;$PLOT ELEMENTS</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
            <span class="n">_write_dict</span><span class="p">(</span><span class="n">bdf_file</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">plotels</span><span class="p">,</span> <span class="n">size</span><span class="p">,</span> <span class="n">is_double</span><span class="p">,</span> <span class="n">is_long_ids</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_write_sets</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">bdf_file</span><span class="p">:</span> <span class="n">Any</span><span class="p">,</span> <span class="n">size</span><span class="p">:</span> <span class="nb">int</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span> <span class="n">is_double</span><span class="p">:</span> <span class="nb">bool</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                    <span class="n">is_long_ids</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Writes the SETx cards sorted by ID&quot;&quot;&quot;</span>
        <span class="n">is_sets</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sets</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">asets</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">omits</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">bsets</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">csets</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">qsets</span>
                   <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">usets</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">is_sets</span><span class="p">:</span>
            <span class="n">bdf_file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;$SETS</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>  <span class="c1"># type: List[str]</span>
            <span class="k">for</span> <span class="p">(</span><span class="n">unused_id</span><span class="p">,</span> <span class="n">set_obj</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sets</span><span class="o">.</span><span class="n">items</span><span class="p">()):</span>  <span class="c1"># dict</span>
                <span class="n">bdf_file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">set_obj</span><span class="o">.</span><span class="n">write_card</span><span class="p">(</span><span class="n">size</span><span class="p">,</span> <span class="n">is_double</span><span class="p">))</span>
            <span class="k">for</span> <span class="n">set_obj</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">asets</span><span class="p">:</span>  <span class="c1"># list</span>
                <span class="n">bdf_file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">set_obj</span><span class="o">.</span><span class="n">write_card</span><span class="p">(</span><span class="n">size</span><span class="p">,</span> <span class="n">is_double</span><span class="p">))</span>
            <span class="k">for</span> <span class="n">set_obj</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">omits</span><span class="p">:</span>  <span class="c1"># list</span>
                <span class="n">bdf_file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">set_obj</span><span class="o">.</span><span class="n">write_card</span><span class="p">(</span><span class="n">size</span><span class="p">,</span> <span class="n">is_double</span><span class="p">))</span>
            <span class="k">for</span> <span class="n">set_obj</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">bsets</span><span class="p">:</span>  <span class="c1"># list</span>
                <span class="n">bdf_file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">set_obj</span><span class="o">.</span><span class="n">write_card</span><span class="p">(</span><span class="n">size</span><span class="p">,</span> <span class="n">is_double</span><span class="p">))</span>
            <span class="k">for</span> <span class="n">set_obj</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">csets</span><span class="p">:</span>  <span class="c1"># list</span>
                <span class="n">bdf_file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">set_obj</span><span class="o">.</span><span class="n">write_card</span><span class="p">(</span><span class="n">size</span><span class="p">,</span> <span class="n">is_double</span><span class="p">))</span>
            <span class="k">for</span> <span class="n">set_obj</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">qsets</span><span class="p">:</span>  <span class="c1"># list</span>
                <span class="n">bdf_file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">set_obj</span><span class="o">.</span><span class="n">write_card</span><span class="p">(</span><span class="n">size</span><span class="p">,</span> <span class="n">is_double</span><span class="p">))</span>
            <span class="k">for</span> <span class="n">unused_name</span><span class="p">,</span> <span class="n">usets</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">usets</span><span class="o">.</span><span class="n">items</span><span class="p">()):</span>  <span class="c1"># dict</span>
                <span class="k">for</span> <span class="n">set_obj</span> <span class="ow">in</span> <span class="n">usets</span><span class="p">:</span>  <span class="c1"># list</span>
                    <span class="n">bdf_file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">set_obj</span><span class="o">.</span><span class="n">write_card</span><span class="p">(</span><span class="n">size</span><span class="p">,</span> <span class="n">is_double</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">_write_superelements</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">bdf_file</span><span class="p">:</span> <span class="n">Any</span><span class="p">,</span> <span class="n">size</span><span class="p">:</span> <span class="nb">int</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span> <span class="n">is_double</span><span class="p">:</span> <span class="nb">bool</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                             <span class="n">is_long_ids</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Writes the Superelement cards</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        size : int</span>
<span class="sd">            large field (16) or small field (8)</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">is_sets</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">se_sets</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">se_bsets</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">se_csets</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">se_qsets</span>
                   <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">se_usets</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">is_sets</span><span class="p">:</span>
            <span class="n">bdf_file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;$SUPERELEMENTS</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>  <span class="c1"># type: List[str]</span>
            <span class="k">for</span> <span class="n">set_obj</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">se_bsets</span><span class="p">:</span>  <span class="c1"># list</span>
                <span class="n">bdf_file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">set_obj</span><span class="o">.</span><span class="n">write_card</span><span class="p">(</span><span class="n">size</span><span class="p">,</span> <span class="n">is_double</span><span class="p">))</span>
            <span class="k">for</span> <span class="n">set_obj</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">se_csets</span><span class="p">:</span>  <span class="c1"># list</span>
                <span class="n">bdf_file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">set_obj</span><span class="o">.</span><span class="n">write_card</span><span class="p">(</span><span class="n">size</span><span class="p">,</span> <span class="n">is_double</span><span class="p">))</span>
            <span class="k">for</span> <span class="n">set_obj</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">se_qsets</span><span class="p">:</span>  <span class="c1"># list</span>
                <span class="n">bdf_file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">set_obj</span><span class="o">.</span><span class="n">write_card</span><span class="p">(</span><span class="n">size</span><span class="p">,</span> <span class="n">is_double</span><span class="p">))</span>
            <span class="k">for</span> <span class="p">(</span><span class="n">unused_set_id</span><span class="p">,</span> <span class="n">set_obj</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">se_sets</span><span class="o">.</span><span class="n">items</span><span class="p">()):</span>  <span class="c1"># dict</span>
                <span class="n">bdf_file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">set_obj</span><span class="o">.</span><span class="n">write_card</span><span class="p">(</span><span class="n">size</span><span class="p">,</span> <span class="n">is_double</span><span class="p">))</span>
            <span class="k">for</span> <span class="n">unused_name</span><span class="p">,</span> <span class="n">usets</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">se_usets</span><span class="o">.</span><span class="n">items</span><span class="p">()):</span>  <span class="c1"># dict</span>
                <span class="k">for</span> <span class="n">set_obj</span> <span class="ow">in</span> <span class="n">usets</span><span class="p">:</span>  <span class="c1"># list</span>
                    <span class="n">bdf_file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">set_obj</span><span class="o">.</span><span class="n">write_card</span><span class="p">(</span><span class="n">size</span><span class="p">,</span> <span class="n">is_double</span><span class="p">))</span>
            <span class="k">for</span> <span class="n">suport</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">se_suport</span><span class="p">:</span>  <span class="c1"># list</span>
                <span class="n">bdf_file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">suport</span><span class="o">.</span><span class="n">write_card</span><span class="p">(</span><span class="n">size</span><span class="p">,</span> <span class="n">is_double</span><span class="p">))</span>

        <span class="k">for</span> <span class="n">unused_seid</span><span class="p">,</span> <span class="n">csuper</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">csuper</span><span class="o">.</span><span class="n">items</span><span class="p">()):</span>
            <span class="n">bdf_file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">csuper</span><span class="o">.</span><span class="n">write_card</span><span class="p">(</span><span class="n">size</span><span class="p">,</span> <span class="n">is_double</span><span class="p">))</span>
        <span class="k">for</span> <span class="n">unused_seid</span><span class="p">,</span> <span class="n">csupext</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">csupext</span><span class="o">.</span><span class="n">items</span><span class="p">()):</span>
            <span class="n">bdf_file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">csupext</span><span class="o">.</span><span class="n">write_card</span><span class="p">(</span><span class="n">size</span><span class="p">,</span> <span class="n">is_double</span><span class="p">))</span>

        <span class="k">for</span> <span class="n">unused_seid</span><span class="p">,</span> <span class="n">sebulk</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sebulk</span><span class="o">.</span><span class="n">items</span><span class="p">()):</span>
            <span class="n">bdf_file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">sebulk</span><span class="o">.</span><span class="n">write_card</span><span class="p">(</span><span class="n">size</span><span class="p">,</span> <span class="n">is_double</span><span class="p">))</span>
        <span class="k">for</span> <span class="n">unused_seid</span><span class="p">,</span> <span class="n">seconct</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">seconct</span><span class="o">.</span><span class="n">items</span><span class="p">()):</span>
            <span class="n">bdf_file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">seconct</span><span class="o">.</span><span class="n">write_card</span><span class="p">(</span><span class="n">size</span><span class="p">,</span> <span class="n">is_double</span><span class="p">))</span>

        <span class="k">for</span> <span class="n">unused_seid</span><span class="p">,</span> <span class="n">sebndry</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sebndry</span><span class="o">.</span><span class="n">items</span><span class="p">()):</span>
            <span class="n">bdf_file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">sebndry</span><span class="o">.</span><span class="n">write_card</span><span class="p">(</span><span class="n">size</span><span class="p">,</span> <span class="n">is_double</span><span class="p">))</span>
        <span class="k">for</span> <span class="n">unused_seid</span><span class="p">,</span> <span class="n">seelt</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">seelt</span><span class="o">.</span><span class="n">items</span><span class="p">()):</span>
            <span class="n">bdf_file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">seelt</span><span class="o">.</span><span class="n">write_card</span><span class="p">(</span><span class="n">size</span><span class="p">,</span> <span class="n">is_double</span><span class="p">))</span>
        <span class="k">for</span> <span class="n">unused_seid</span><span class="p">,</span> <span class="n">seexcld</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">seexcld</span><span class="o">.</span><span class="n">items</span><span class="p">()):</span>
            <span class="n">bdf_file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">seexcld</span><span class="o">.</span><span class="n">write_card</span><span class="p">(</span><span class="n">size</span><span class="p">,</span> <span class="n">is_double</span><span class="p">))</span>

        <span class="k">for</span> <span class="n">unused_seid</span><span class="p">,</span> <span class="n">selabel</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">selabel</span><span class="o">.</span><span class="n">items</span><span class="p">()):</span>
            <span class="n">bdf_file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">selabel</span><span class="o">.</span><span class="n">write_card</span><span class="p">(</span><span class="n">size</span><span class="p">,</span> <span class="n">is_double</span><span class="p">))</span>
        <span class="k">for</span> <span class="n">unused_seid</span><span class="p">,</span> <span class="n">seloc</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">seloc</span><span class="o">.</span><span class="n">items</span><span class="p">()):</span>
            <span class="n">bdf_file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">seloc</span><span class="o">.</span><span class="n">write_card</span><span class="p">(</span><span class="n">size</span><span class="p">,</span> <span class="n">is_double</span><span class="p">))</span>
        <span class="k">for</span> <span class="n">unused_seid</span><span class="p">,</span> <span class="n">seload</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">seload</span><span class="o">.</span><span class="n">items</span><span class="p">()):</span>
            <span class="n">bdf_file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">seload</span><span class="o">.</span><span class="n">write_card</span><span class="p">(</span><span class="n">size</span><span class="p">,</span> <span class="n">is_double</span><span class="p">))</span>
        <span class="k">for</span> <span class="n">unused_seid</span><span class="p">,</span> <span class="n">sempln</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sempln</span><span class="o">.</span><span class="n">items</span><span class="p">()):</span>
            <span class="n">bdf_file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">sempln</span><span class="o">.</span><span class="n">write_card</span><span class="p">(</span><span class="n">size</span><span class="p">,</span> <span class="n">is_double</span><span class="p">))</span>
        <span class="k">for</span> <span class="n">unused_setid</span><span class="p">,</span> <span class="n">senqset</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">senqset</span><span class="o">.</span><span class="n">items</span><span class="p">()):</span>
            <span class="n">bdf_file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">senqset</span><span class="o">.</span><span class="n">write_card</span><span class="p">(</span><span class="n">size</span><span class="p">,</span> <span class="n">is_double</span><span class="p">))</span>
        <span class="k">for</span> <span class="n">unused_seid</span><span class="p">,</span> <span class="n">setree</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">setree</span><span class="o">.</span><span class="n">items</span><span class="p">()):</span>
            <span class="n">bdf_file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">setree</span><span class="o">.</span><span class="n">write_card</span><span class="p">(</span><span class="n">size</span><span class="p">,</span> <span class="n">is_double</span><span class="p">))</span>
        <span class="k">for</span> <span class="n">unused_seid</span><span class="p">,</span> <span class="n">release</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">release</span><span class="o">.</span><span class="n">items</span><span class="p">()):</span>
            <span class="n">bdf_file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">release</span><span class="o">.</span><span class="n">write_card</span><span class="p">(</span><span class="n">size</span><span class="p">,</span> <span class="n">is_double</span><span class="p">))</span>


    <span class="k">def</span> <span class="nf">_write_tables</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">bdf_file</span><span class="p">:</span> <span class="n">Any</span><span class="p">,</span> <span class="n">size</span><span class="p">:</span> <span class="nb">int</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span> <span class="n">is_double</span><span class="p">:</span> <span class="nb">bool</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                      <span class="n">is_long_ids</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Writes the TABLEx cards sorted by ID&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">tables</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">tables_d</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">tables_m</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">tables_sdamping</span><span class="p">:</span>
            <span class="n">bdf_file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;$TABLES</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>  <span class="c1"># type: List[str]</span>
            <span class="k">for</span> <span class="p">(</span><span class="n">unused_id</span><span class="p">,</span> <span class="n">table</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tables</span><span class="o">.</span><span class="n">items</span><span class="p">()):</span>
                <span class="n">bdf_file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">table</span><span class="o">.</span><span class="n">write_card</span><span class="p">(</span><span class="n">size</span><span class="p">,</span> <span class="n">is_double</span><span class="p">))</span>
            <span class="k">for</span> <span class="p">(</span><span class="n">unused_id</span><span class="p">,</span> <span class="n">table</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tables_d</span><span class="o">.</span><span class="n">items</span><span class="p">()):</span>
                <span class="n">bdf_file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">table</span><span class="o">.</span><span class="n">write_card</span><span class="p">(</span><span class="n">size</span><span class="p">,</span> <span class="n">is_double</span><span class="p">))</span>
            <span class="k">for</span> <span class="p">(</span><span class="n">unused_id</span><span class="p">,</span> <span class="n">table</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tables_m</span><span class="o">.</span><span class="n">items</span><span class="p">()):</span>
                <span class="n">bdf_file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">table</span><span class="o">.</span><span class="n">write_card</span><span class="p">(</span><span class="n">size</span><span class="p">,</span> <span class="n">is_double</span><span class="p">))</span>
            <span class="k">for</span> <span class="p">(</span><span class="n">unused_id</span><span class="p">,</span> <span class="n">table</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tables_sdamping</span><span class="o">.</span><span class="n">items</span><span class="p">()):</span>
                <span class="n">bdf_file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">table</span><span class="o">.</span><span class="n">write_card</span><span class="p">(</span><span class="n">size</span><span class="p">,</span> <span class="n">is_double</span><span class="p">))</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">random_tables</span><span class="p">:</span>
            <span class="n">bdf_file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;$RANDOM TABLES</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
            <span class="k">for</span> <span class="p">(</span><span class="n">unused_id</span><span class="p">,</span> <span class="n">table</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">random_tables</span><span class="o">.</span><span class="n">items</span><span class="p">()):</span>
                <span class="n">bdf_file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">table</span><span class="o">.</span><span class="n">write_card</span><span class="p">(</span><span class="n">size</span><span class="p">,</span> <span class="n">is_double</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">_write_thermal</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">bdf_file</span><span class="p">:</span> <span class="n">Any</span><span class="p">,</span> <span class="n">size</span><span class="p">:</span> <span class="nb">int</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span> <span class="n">is_double</span><span class="p">:</span> <span class="nb">bool</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                       <span class="n">is_long_ids</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Writes the thermal cards&quot;&quot;&quot;</span>
        <span class="c1"># PHBDY</span>
        <span class="n">is_thermal</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">phbdys</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">convection_properties</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">bcs</span> <span class="ow">or</span>
                      <span class="bp">self</span><span class="o">.</span><span class="n">views</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">view3ds</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">radset</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">radcavs</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">is_thermal</span><span class="p">:</span>
            <span class="n">bdf_file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;$THERMAL</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>

            <span class="k">for</span> <span class="p">(</span><span class="n">unused_key</span><span class="p">,</span> <span class="n">phbdy</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">phbdys</span><span class="o">.</span><span class="n">items</span><span class="p">()):</span>
                <span class="n">bdf_file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">phbdy</span><span class="o">.</span><span class="n">write_card</span><span class="p">(</span><span class="n">size</span><span class="p">,</span> <span class="n">is_double</span><span class="p">))</span>

            <span class="c1">#for unused_key, prop in sorted(self.thermal_properties.items()):</span>
            <span class="c1">#    bdf_file.write(str(prop))</span>
            <span class="k">for</span> <span class="p">(</span><span class="n">unused_key</span><span class="p">,</span> <span class="n">prop</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">convection_properties</span><span class="o">.</span><span class="n">items</span><span class="p">()):</span>
                <span class="n">bdf_file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">prop</span><span class="o">.</span><span class="n">write_card</span><span class="p">(</span><span class="n">size</span><span class="p">,</span> <span class="n">is_double</span><span class="p">))</span>

            <span class="c1"># BCs</span>
            <span class="k">for</span> <span class="p">(</span><span class="n">unused_key</span><span class="p">,</span> <span class="n">bcs</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">bcs</span><span class="o">.</span><span class="n">items</span><span class="p">()):</span>
                <span class="k">for</span> <span class="n">boundary_condition</span> <span class="ow">in</span> <span class="n">bcs</span><span class="p">:</span>  <span class="c1"># list</span>
                    <span class="n">bdf_file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">boundary_condition</span><span class="o">.</span><span class="n">write_card</span><span class="p">(</span><span class="n">size</span><span class="p">,</span> <span class="n">is_double</span><span class="p">))</span>

            <span class="k">for</span> <span class="p">(</span><span class="n">unused_key</span><span class="p">,</span> <span class="n">view</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">views</span><span class="o">.</span><span class="n">items</span><span class="p">()):</span>
                <span class="n">bdf_file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">view</span><span class="o">.</span><span class="n">write_card</span><span class="p">(</span><span class="n">size</span><span class="p">,</span> <span class="n">is_double</span><span class="p">))</span>
            <span class="k">for</span> <span class="p">(</span><span class="n">unused_key</span><span class="p">,</span> <span class="n">view3d</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">view3ds</span><span class="o">.</span><span class="n">items</span><span class="p">()):</span>
                <span class="n">bdf_file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">view3d</span><span class="o">.</span><span class="n">write_card</span><span class="p">(</span><span class="n">size</span><span class="p">,</span> <span class="n">is_double</span><span class="p">))</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">radset</span><span class="p">:</span>
                <span class="n">bdf_file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">radset</span><span class="o">.</span><span class="n">write_card</span><span class="p">(</span><span class="n">size</span><span class="p">,</span> <span class="n">is_double</span><span class="p">))</span>
            <span class="k">for</span> <span class="n">unused_icavity</span><span class="p">,</span> <span class="n">radcav</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">radcavs</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                <span class="n">bdf_file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">radcav</span><span class="o">.</span><span class="n">write_card</span><span class="p">(</span><span class="n">size</span><span class="p">,</span> <span class="n">is_double</span><span class="p">))</span>


    <span class="k">def</span> <span class="nf">_write_thermal_materials</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">bdf_file</span><span class="p">:</span> <span class="n">Any</span><span class="p">,</span> <span class="n">size</span><span class="p">:</span> <span class="nb">int</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span> <span class="n">is_double</span><span class="p">:</span> <span class="nb">bool</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                                 <span class="n">is_long_ids</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Writes the thermal materials in a sorted order&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">thermal_materials</span><span class="p">:</span>
            <span class="n">bdf_file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;$THERMAL MATERIALS</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
            <span class="k">for</span> <span class="p">(</span><span class="n">unused_mid</span><span class="p">,</span> <span class="n">material</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">thermal_materials</span><span class="o">.</span><span class="n">items</span><span class="p">()):</span>
                <span class="n">bdf_file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">material</span><span class="o">.</span><span class="n">write_card</span><span class="p">(</span><span class="n">size</span><span class="p">,</span> <span class="n">is_double</span><span class="p">))</span>

<div class="viewcode-block" id="_write_dict"><a class="viewcode-back" href="../../../../reference/bdf/bdf_interface/pyNastran.bdf.bdf_interface.write_mesh.html#pyNastran.bdf.bdf_interface.write_mesh._write_dict">[docs]</a><span class="k">def</span> <span class="nf">_write_dict</span><span class="p">(</span><span class="n">bdf_file</span><span class="p">,</span> <span class="n">my_dict</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="n">Any</span><span class="p">],</span> <span class="n">size</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">is_double</span><span class="p">:</span> <span class="nb">bool</span><span class="p">,</span> <span class="n">is_long_ids</span><span class="p">:</span> <span class="nb">bool</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;writes a dictionary that may require long format&quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">is_long_ids</span><span class="p">:</span>
        <span class="k">for</span> <span class="p">(</span><span class="n">unused_nid</span><span class="p">,</span> <span class="n">node</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">my_dict</span><span class="o">.</span><span class="n">items</span><span class="p">()):</span>
            <span class="n">bdf_file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">node</span><span class="o">.</span><span class="n">write_card_16</span><span class="p">(</span><span class="n">is_double</span><span class="p">))</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">for</span> <span class="p">(</span><span class="n">unused_nid</span><span class="p">,</span> <span class="n">node</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">my_dict</span><span class="o">.</span><span class="n">items</span><span class="p">()):</span>
            <span class="n">bdf_file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">node</span><span class="o">.</span><span class="n">write_card</span><span class="p">(</span><span class="n">size</span><span class="p">,</span> <span class="n">is_double</span><span class="p">))</span></div>
</pre></div>

           </div>
           
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>
        &#169; Copyright 2021, Steven Doyle.

    </p>
  </div>
    
    
    
    Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>
        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>