

<!DOCTYPE html>
<html class="writer-html4" lang="en" >
<head>
  <meta charset="utf-8" />
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
  <title>pyNastran.op2.tables.geom.geom4 &mdash; pyNastran 1.4-dev 1.4-dev documentation</title>
  

  
  <link rel="stylesheet" href="../../../../../_static/css/my_theme.css" type="text/css" />
  <link rel="stylesheet" href="../../../../../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../../../../../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../../../../../_static/css/my_theme.css" type="text/css" />
  <link rel="stylesheet" href="../../../../../_static/graphviz.css" type="text/css" />

  
  

  
  

  

  
  <!--[if lt IE 9]>
    <script src="../../../../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../../../../" src="../../../../../_static/documentation_options.js"></script>
        <script data-url_root="../../../../../" id="documentation_options" src="../../../../../_static/documentation_options.js"></script>
        <script src="../../../../../_static/jquery.js"></script>
        <script src="../../../../../_static/underscore.js"></script>
        <script src="../../../../../_static/doctools.js"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    
    <script type="text/javascript" src="../../../../../_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="../../../../../genindex.html" />
    <link rel="search" title="Search" href="../../../../../search.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../../../../../index.html" class="icon icon-home"> pyNastran 1.4-dev
          

          
            
            <img src="../../../../../_static/logo.png" class="logo" alt="Logo"/>
          
          </a>

          
            
            
              <div class="version">
                1.4-dev
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul>
<li class="toctree-l1"><a class="reference internal" href="../../../../../installation/index.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../quick_start/index.html">Quick Start</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../how_to/index.html">How To: pyNastran</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../reference/pyNastran.html">pyNastran Package</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../manual/index.html">pyNastran Manual</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../../../index.html">pyNastran 1.4-dev</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          

















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../../../../index.html" class="icon icon-home"></a> &raquo;</li>
        
          <li><a href="../../../../index.html">Module code</a> &raquo;</li>
        
      <li>pyNastran.op2.tables.geom.geom4</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <h1>Source code for pyNastran.op2.tables.geom.geom4</h1><div class="highlight"><pre>
<span></span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">defines readers for BDF objects in the OP2 GEOM4/GEOM4S table</span>
<span class="sd">&quot;&quot;&quot;</span>
<span class="c1">#pylint: disable=C0111,C0103,C1801</span>
<span class="kn">from</span> <span class="nn">struct</span> <span class="kn">import</span> <span class="n">unpack</span><span class="p">,</span> <span class="n">Struct</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="kn">from</span> <span class="nn">pyNastran.bdf.cards.elements.rigid</span> <span class="kn">import</span> <span class="n">RBAR</span><span class="p">,</span> <span class="n">RBE2</span><span class="p">,</span> <span class="n">RBE3</span><span class="p">,</span> <span class="n">RROD</span>
<span class="kn">from</span> <span class="nn">pyNastran.bdf.cards.bdf_sets</span> <span class="kn">import</span> <span class="p">(</span>
    <span class="n">ASET</span><span class="p">,</span> <span class="n">ASET1</span><span class="p">,</span> <span class="n">BSET</span><span class="p">,</span> <span class="n">BSET1</span><span class="p">,</span> <span class="n">CSET</span><span class="p">,</span> <span class="n">CSET1</span><span class="p">,</span> <span class="n">QSET</span><span class="p">,</span> <span class="n">QSET1</span><span class="p">,</span> <span class="n">USET</span><span class="p">,</span> <span class="n">USET1</span><span class="p">,</span> <span class="n">SEQSET1</span><span class="p">,</span>
    <span class="n">OMIT1</span><span class="p">,</span> <span class="c1"># SEQSET</span>
<span class="p">)</span>
<span class="kn">from</span> <span class="nn">pyNastran.op2.errors</span> <span class="kn">import</span> <span class="n">MixedVersionCard</span>
<span class="kn">from</span> <span class="nn">pyNastran.op2.op2_interface.op2_reader</span> <span class="kn">import</span> <span class="n">mapfmt</span><span class="p">,</span> <span class="n">reshape_bytes_block</span>
<span class="kn">from</span> <span class="nn">pyNastran.op2.tables.geom.geom_common</span> <span class="kn">import</span> <span class="n">GeomCommon</span>
<span class="kn">from</span> <span class="nn">pyNastran.bdf.cards.loads.loads</span> <span class="kn">import</span> <span class="n">SPCD</span>
<span class="kn">from</span> <span class="nn">pyNastran.bdf.cards.constraints</span> <span class="kn">import</span> <span class="p">(</span>
    <span class="n">SUPORT1</span><span class="p">,</span> <span class="n">SUPORT</span><span class="p">,</span>
    <span class="n">SPC</span><span class="p">,</span> <span class="n">SPC1</span><span class="p">,</span> <span class="n">SPCADD</span><span class="p">,</span> <span class="n">SPCOFF</span><span class="p">,</span> <span class="n">SPCOFF1</span><span class="p">,</span>
    <span class="n">MPC</span><span class="p">,</span> <span class="n">MPCADD</span><span class="p">,</span> <span class="c1">#SPCAX, SESUP, GMSPC</span>
<span class="p">)</span>

<div class="viewcode-block" id="GEOM4"><a class="viewcode-back" href="../../../../../reference/op2/tables/geom/pyNastran.op2.tables.geom.geom4.html#pyNastran.op2.tables.geom.geom4.GEOM4">[docs]</a><span class="k">class</span> <span class="nc">GEOM4</span><span class="p">(</span><span class="n">GeomCommon</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;defines methods for reading op2 constraints&quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">_read_geom4_4</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">ndata</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;reads the GEOM4/GEOM4OLD table&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_read_geom_4</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_geom4_map</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">ndata</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">GeomCommon</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_geom4_map</span> <span class="o">=</span> <span class="p">{</span>
            <span class="p">(</span><span class="mi">5561</span><span class="p">,</span> <span class="mi">76</span><span class="p">,</span> <span class="mi">215</span><span class="p">):</span> <span class="p">[</span><span class="s1">&#39;ASET&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_read_aset</span><span class="p">],</span>          <span class="c1"># record 1</span>
            <span class="p">(</span><span class="mi">5571</span><span class="p">,</span> <span class="mi">77</span><span class="p">,</span> <span class="mi">216</span><span class="p">):</span> <span class="p">[</span><span class="s1">&#39;ASET1&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_read_aset1</span><span class="p">],</span>        <span class="c1"># record 2</span>
            <span class="p">(</span><span class="mi">10200</span><span class="p">,</span> <span class="mi">102</span><span class="p">,</span> <span class="mi">473</span><span class="p">):</span> <span class="p">[</span><span class="s1">&#39;BNDGRID&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_read_bndgrid</span><span class="p">],</span>  <span class="c1"># record 3  - not done</span>

            <span class="p">(</span><span class="mi">110</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">311</span><span class="p">):</span> <span class="p">[</span><span class="s1">&#39;BSET&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_read_bset</span><span class="p">],</span>            <span class="c1"># record 5  - not done</span>
            <span class="p">(</span><span class="mi">410</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">314</span><span class="p">):</span> <span class="p">[</span><span class="s1">&#39;BSET1&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_read_bset1</span><span class="p">],</span>          <span class="c1"># record 6  - not done</span>
            <span class="p">(</span><span class="mi">310</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">313</span><span class="p">):</span> <span class="p">[</span><span class="s1">&#39;CSET&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_read_cset</span><span class="p">],</span>            <span class="c1"># record 7  - not done</span>
            <span class="p">(</span><span class="mi">210</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">312</span><span class="p">):</span> <span class="p">[</span><span class="s1">&#39;CSET1&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_read_cset1</span><span class="p">],</span>          <span class="c1"># record 8  - not done</span>

            <span class="p">(</span><span class="mi">1510</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="mi">328</span><span class="p">):</span> <span class="p">[</span><span class="s1">&#39;CYAX&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_read_cyax</span><span class="p">],</span>          <span class="c1"># record 9  - not done</span>
            <span class="p">(</span><span class="mi">5210</span><span class="p">,</span> <span class="mi">52</span><span class="p">,</span> <span class="mi">257</span><span class="p">):</span> <span class="p">[</span><span class="s1">&#39;CYJOIN&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_read_cyjoin</span><span class="p">],</span>      <span class="c1"># record 10 - not done</span>
            <span class="p">(</span><span class="mi">1610</span><span class="p">,</span> <span class="mi">16</span><span class="p">,</span> <span class="mi">329</span><span class="p">)</span> <span class="p">:</span> <span class="p">[</span><span class="s1">&#39;CYSUP&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_read_cysup</span><span class="p">],</span>       <span class="c1"># record 11 - not done</span>
            <span class="p">(</span><span class="mi">1710</span><span class="p">,</span> <span class="mi">17</span><span class="p">,</span> <span class="mi">330</span><span class="p">):</span> <span class="p">[</span><span class="s1">&#39;CYSYM&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_read_cysym</span><span class="p">],</span>        <span class="c1"># record 12 - not done</span>
            <span class="p">(</span><span class="mi">8801</span><span class="p">,</span> <span class="mi">88</span><span class="p">,</span> <span class="mi">9022</span><span class="p">)</span> <span class="p">:</span> <span class="p">[</span><span class="s1">&#39;EGENDT&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_read_egendt</span><span class="p">],</span>    <span class="c1"># record 13 - not done (NX)</span>
            <span class="p">(</span><span class="mi">9001</span><span class="p">,</span> <span class="mi">90</span><span class="p">,</span> <span class="mi">9024</span><span class="p">):</span> <span class="p">[</span><span class="s1">&#39;FCENDT&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_read_fcendt</span><span class="p">],</span>     <span class="c1"># record 14 - not done (NX)</span>
            <span class="p">(</span><span class="mi">8001</span><span class="p">,</span> <span class="mi">80</span><span class="p">,</span> <span class="mi">395</span><span class="p">):</span> <span class="p">[</span><span class="s1">&#39;GMBC&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_read_gmbc</span><span class="p">],</span>          <span class="c1"># record 15 - not done</span>
            <span class="p">(</span><span class="mi">7801</span><span class="p">,</span> <span class="mi">78</span><span class="p">,</span> <span class="mi">393</span><span class="p">):</span> <span class="p">[</span><span class="s1">&#39;GMSPC&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_read_gmspc</span><span class="p">],</span>        <span class="c1"># record 16 - not done</span>
            <span class="c1">#: [&#39;&#39;, self._read_fake],</span>


            <span class="c1">#(4901, 49, 420017): [&#39;&#39;, self._read_fake],    # record</span>
            <span class="p">(</span><span class="mi">4901</span><span class="p">,</span> <span class="mi">49</span><span class="p">,</span> <span class="mi">420017</span><span class="p">)</span> <span class="p">:</span> <span class="p">[</span><span class="s1">&#39;MPC&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_read_mpc2</span><span class="p">],</span>  <span class="c1"># this theoretically shouldn&#39;t exist</span>
            <span class="p">(</span><span class="mi">4901</span><span class="p">,</span> <span class="mi">49</span><span class="p">,</span> <span class="mi">17</span><span class="p">)</span> <span class="p">:</span> <span class="p">[</span><span class="s1">&#39;MPC&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_read_mpc</span><span class="p">],</span>             <span class="c1"># record 17</span>
            <span class="p">(</span><span class="mi">4891</span><span class="p">,</span> <span class="mi">60</span><span class="p">,</span> <span class="mi">83</span><span class="p">)</span> <span class="p">:</span> <span class="p">[</span><span class="s1">&#39;MPCADD&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_read_mpcadd</span><span class="p">],</span>       <span class="c1"># record 18</span>
            <span class="p">(</span><span class="mi">5001</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">15</span><span class="p">)</span> <span class="p">:</span> <span class="p">[</span><span class="s1">&#39;OMIT&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_read_omit</span><span class="p">],</span>           <span class="c1"># record 19 - not done</span>
            <span class="p">(</span><span class="mi">4951</span><span class="p">,</span> <span class="mi">63</span><span class="p">,</span> <span class="mi">92</span><span class="p">)</span> <span class="p">:</span> <span class="p">[</span><span class="s1">&#39;OMIT1&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_read_omit1</span><span class="p">],</span>         <span class="c1"># record 20</span>
            <span class="p">(</span><span class="mi">510</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">315</span><span class="p">)</span> <span class="p">:</span> <span class="p">[</span><span class="s1">&#39;QSET&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_read_qset</span><span class="p">],</span>            <span class="c1"># record 21</span>
            <span class="p">(</span><span class="mi">610</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">316</span><span class="p">)</span> <span class="p">:</span> <span class="p">[</span><span class="s1">&#39;QSET1&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_read_qset1</span><span class="p">],</span>          <span class="c1"># record 22</span>

            <span class="p">(</span><span class="mi">6601</span><span class="p">,</span> <span class="mi">66</span><span class="p">,</span> <span class="mi">292</span><span class="p">)</span> <span class="p">:</span> <span class="p">[</span><span class="s1">&#39;RBAR&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_read_rbar</span><span class="p">],</span>          <span class="c1"># record 23 - not done</span>
            <span class="p">(</span><span class="mi">6801</span><span class="p">,</span> <span class="mi">68</span><span class="p">,</span> <span class="mi">294</span><span class="p">)</span> <span class="p">:</span> <span class="p">[</span><span class="s1">&#39;RBE1&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_read_rbe1</span><span class="p">],</span>          <span class="c1"># record 24 - not done</span>
            <span class="p">(</span><span class="mi">6901</span><span class="p">,</span> <span class="mi">69</span><span class="p">,</span> <span class="mi">295</span><span class="p">)</span> <span class="p">:</span> <span class="p">[</span><span class="s1">&#39;RBE2&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_read_rbe2</span><span class="p">],</span>          <span class="c1"># record 25 - buggy</span>
            <span class="p">(</span><span class="mi">7101</span><span class="p">,</span> <span class="mi">71</span><span class="p">,</span> <span class="mi">187</span><span class="p">)</span> <span class="p">:</span> <span class="p">[</span><span class="s1">&#39;RBE3&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_read_rbe3</span><span class="p">],</span>          <span class="c1"># record 26 - not done</span>
            <span class="p">(</span><span class="mi">14201</span><span class="p">,</span> <span class="mi">142</span><span class="p">,</span> <span class="mi">652</span><span class="p">)</span> <span class="p">:</span> <span class="p">[</span><span class="s1">&#39;RBJOINT&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_read_rbjoint</span><span class="p">],</span>  <span class="c1"># record 27 - not done</span>
            <span class="p">(</span><span class="mi">14301</span><span class="p">,</span> <span class="mi">143</span><span class="p">,</span> <span class="mi">653</span><span class="p">)</span> <span class="p">:</span> <span class="p">[</span><span class="s1">&#39;RBJSTIF&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_read_rbjstif</span><span class="p">],</span>  <span class="c1"># record 28 - not done</span>
            <span class="p">(</span><span class="mi">1310</span><span class="p">,</span> <span class="mi">13</span><span class="p">,</span> <span class="mi">247</span><span class="p">)</span> <span class="p">:</span> <span class="p">[</span><span class="s1">&#39;RELEASE&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_read_release</span><span class="p">],</span>    <span class="c1"># record 29 - not done</span>
            <span class="p">(</span><span class="mi">14101</span><span class="p">,</span> <span class="mi">141</span><span class="p">,</span> <span class="mi">640</span><span class="p">):</span> <span class="p">[</span><span class="s1">&#39;RPNOM&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_read_rpnom</span><span class="p">],</span>       <span class="c1"># record 30 - not done</span>
            <span class="p">(</span><span class="mi">6501</span><span class="p">,</span> <span class="mi">65</span><span class="p">,</span> <span class="mi">291</span><span class="p">):</span> <span class="p">[</span><span class="s1">&#39;RROD&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_read_rrod</span><span class="p">],</span>           <span class="c1"># record 31 - not done</span>
            <span class="p">(</span><span class="mi">7001</span><span class="p">,</span> <span class="mi">70</span><span class="p">,</span> <span class="mi">186</span><span class="p">):</span> <span class="p">[</span><span class="s1">&#39;RSPLINE&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_read_rspline</span><span class="p">],</span>     <span class="c1"># record 32 - not done</span>
            <span class="p">(</span><span class="mi">7201</span><span class="p">,</span> <span class="mi">72</span><span class="p">,</span> <span class="mi">398</span><span class="p">):</span> <span class="p">[</span><span class="s1">&#39;RSSCON&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_read_rsscon</span><span class="p">],</span>       <span class="c1"># record 33 - not done</span>
            <span class="c1">#: [&#39;&#39;, self._read_fake],</span>
            <span class="c1">#: [&#39;&#39;, self._read_fake],</span>
            <span class="c1">#: [&#39;&#39;, self._read_fake],</span>
            <span class="p">(</span><span class="mi">1110</span><span class="p">,</span> <span class="mi">11</span><span class="p">,</span> <span class="mi">321</span><span class="p">):</span> <span class="p">[</span><span class="s1">&#39;SEQSET&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_read_seqset</span><span class="p">],</span>      <span class="c1"># record 40</span>
            <span class="p">(</span><span class="mi">1210</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">322</span><span class="p">):</span> <span class="p">[</span><span class="s1">&#39;SEQSET1&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_read_seqset1</span><span class="p">],</span>    <span class="c1"># record 41</span>
            <span class="p">(</span><span class="mi">5110</span><span class="p">,</span> <span class="mi">51</span><span class="p">,</span> <span class="mi">256</span><span class="p">):</span> <span class="p">[</span><span class="s1">&#39;SPCD&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_read_spcd</span><span class="p">],</span>          <span class="c1"># record 48 - buggy</span>

            <span class="c1"># these ones are not fully marked...</span>
            <span class="p">(</span><span class="mi">5501</span><span class="p">,</span> <span class="mi">55</span><span class="p">,</span> <span class="mi">16</span><span class="p">):</span> <span class="p">[</span><span class="s1">&#39;SPC&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_read_spc</span><span class="p">],</span>             <span class="c1"># record 44 - buggy</span>
            <span class="p">(</span><span class="mi">5481</span><span class="p">,</span> <span class="mi">58</span><span class="p">,</span> <span class="mi">12</span><span class="p">):</span> <span class="p">[</span><span class="s1">&#39;SPC1&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_read_spc1</span><span class="p">],</span>           <span class="c1"># record 45 - not done</span>
            <span class="p">(</span><span class="mi">5491</span><span class="p">,</span> <span class="mi">59</span><span class="p">,</span> <span class="mi">13</span><span class="p">):</span> <span class="p">[</span><span class="s1">&#39;SPCADD&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_read_spcadd</span><span class="p">],</span>       <span class="c1"># record 46 - not done</span>
            <span class="p">(</span><span class="mi">5601</span><span class="p">,</span> <span class="mi">56</span><span class="p">,</span> <span class="mi">14</span><span class="p">):</span> <span class="p">[</span><span class="s1">&#39;SUPORT&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_read_suport</span><span class="p">],</span>       <span class="c1"># record 59 - not done</span>
            <span class="p">(</span><span class="mi">10100</span><span class="p">,</span> <span class="mi">101</span><span class="p">,</span> <span class="mi">472</span><span class="p">):</span> <span class="p">[</span><span class="s1">&#39;SUPORT1&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_read_suport1</span><span class="p">],</span>  <span class="c1"># record 60 - not done</span>
            <span class="p">(</span><span class="mi">2010</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">193</span><span class="p">)</span> <span class="p">:</span> <span class="p">[</span><span class="s1">&#39;USET&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_read_uset</span><span class="p">],</span>         <span class="c1"># Record 62</span>

            <span class="p">(</span><span class="mi">6210</span><span class="p">,</span> <span class="mi">62</span><span class="p">,</span> <span class="mi">344</span><span class="p">):</span> <span class="p">[</span><span class="s1">&#39;SPCOFF1&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_read_spcoff1</span><span class="p">],</span>    <span class="c1"># record</span>
            <span class="p">(</span><span class="mi">2110</span><span class="p">,</span> <span class="mi">21</span><span class="p">,</span> <span class="mi">194</span><span class="p">)</span> <span class="p">:</span> <span class="p">[</span><span class="s1">&#39;USET1&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_read_uset1</span><span class="p">],</span>  <span class="c1"># record</span>
            <span class="p">(</span><span class="mi">1010</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">320</span><span class="p">):</span> <span class="p">[</span><span class="s1">&#39;SECSET1&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_read_secset1</span><span class="p">],</span>  <span class="c1"># record</span>

            <span class="p">(</span><span class="mi">5561</span><span class="p">,</span> <span class="mi">76</span><span class="p">,</span> <span class="mi">0</span><span class="p">):</span> <span class="p">[</span><span class="s1">&#39;PLOTEL/SESET/SEQSET1?&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_read_fake</span><span class="p">],</span>         <span class="c1"># record</span>
            <span class="c1">#(5561, 76, 0): [&#39;PLOTEL/SESET/SEQSET1?&#39;, self._read_seqset1b],         # record</span>
            <span class="p">(</span><span class="mi">610</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">0</span><span class="p">):</span> <span class="p">[</span><span class="s1">&#39;SESET/SEQSET1?&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_read_fake</span><span class="p">],</span>           <span class="c1"># record</span>
            <span class="p">(</span><span class="mi">5110</span><span class="p">,</span> <span class="mi">51</span><span class="p">,</span> <span class="mi">620256</span><span class="p">):</span> <span class="p">[</span><span class="s1">&#39;SPCD?&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_read_fake</span><span class="p">],</span>    <span class="c1"># record</span>
            <span class="p">(</span><span class="mi">5501</span><span class="p">,</span> <span class="mi">55</span><span class="p">,</span> <span class="mi">620016</span><span class="p">):</span> <span class="p">[</span><span class="s1">&#39;SPC/SPC1?&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_read_fake</span><span class="p">],</span>    <span class="c1"># record</span>
            <span class="p">(</span><span class="mi">410</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">0</span><span class="p">):</span> <span class="p">[</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_read_fake</span><span class="p">],</span>    <span class="c1"># record</span>
            <span class="p">(</span><span class="mi">6701</span><span class="p">,</span> <span class="mi">67</span><span class="p">,</span> <span class="mi">293</span><span class="p">):</span> <span class="p">[</span><span class="s1">&#39;RTRPLT&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_read_rtrplt</span><span class="p">],</span>    <span class="c1"># record 34</span>
            <span class="p">(</span><span class="mi">9801</span><span class="p">,</span> <span class="mi">98</span><span class="p">,</span> <span class="mi">79</span><span class="p">):</span> <span class="p">[</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_read_fake</span><span class="p">],</span>  <span class="c1"># record</span>
            <span class="p">(</span><span class="mi">9901</span><span class="p">,</span> <span class="mi">99</span><span class="p">,</span> <span class="mi">80</span><span class="p">):</span> <span class="p">[</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_read_fake</span><span class="p">],</span>  <span class="c1"># record</span>
            <span class="p">(</span><span class="mi">12001</span><span class="p">,</span> <span class="mi">120</span><span class="p">,</span> <span class="mi">601</span><span class="p">)</span> <span class="p">:</span> <span class="p">[</span><span class="s1">&#39;BLTMPC&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_read_bltmpc</span><span class="p">],</span>  <span class="c1"># record (NX)</span>

            <span class="c1"># GEOM4705 - pre MSC 2001</span>
            <span class="p">(</span><span class="mi">110</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">584</span><span class="p">):</span> <span class="p">[</span><span class="s1">&#39;BNDFIX&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_read_bndfix</span><span class="p">],</span>    <span class="c1"># record 3 (NX)</span>
            <span class="p">(</span><span class="mi">210</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">585</span><span class="p">):</span> <span class="p">[</span><span class="s1">&#39;BNDFIX1&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_read_bndfix1</span><span class="p">],</span>    <span class="c1"># record 4 (NX)</span>
            <span class="p">(</span><span class="mi">310</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">586</span><span class="p">)</span> <span class="p">:</span> <span class="p">[</span><span class="s1">&#39;BNDFREE&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_read_bndfree</span><span class="p">],</span>  <span class="c1"># record 5 (NX)</span>

            <span class="p">(</span><span class="mi">9801</span><span class="p">,</span> <span class="mi">98</span><span class="p">,</span> <span class="mi">609</span><span class="p">)</span> <span class="p">:</span> <span class="p">[</span><span class="s1">&#39;RVDOF&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_read_fake</span><span class="p">],</span>
            <span class="p">(</span><span class="mi">9901</span><span class="p">,</span> <span class="mi">99</span><span class="p">,</span> <span class="mi">610</span><span class="p">)</span> <span class="p">:</span> <span class="p">[</span><span class="s1">&#39;RVDOF1&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_read_fake</span><span class="p">],</span>
            <span class="p">(</span><span class="mi">11901</span><span class="p">,</span> <span class="mi">119</span><span class="p">,</span> <span class="mi">561</span><span class="p">)</span> <span class="p">:</span> <span class="p">[</span><span class="s1">&#39;RWELD&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_read_fake</span><span class="p">],</span>
            <span class="p">(</span><span class="mi">5571</span><span class="p">,</span> <span class="mi">77</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span> <span class="p">:</span> <span class="p">[</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_read_fake</span><span class="p">],</span>

            <span class="c1"># F:\work\pyNastran\pyNastran\master2\pyNastran\bdf\test\nx_spike\out_sdr_s111se.op2</span>
            <span class="p">(</span><span class="mi">210</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span> <span class="p">:</span> <span class="p">[</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_read_fake</span><span class="p">],</span>
            <span class="p">(</span><span class="mi">810</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">318</span><span class="p">)</span> <span class="p">:</span> <span class="p">[</span><span class="s1">&#39;SESET?&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_read_fake</span><span class="p">],</span>
        <span class="p">}</span>

    <span class="k">def</span> <span class="nf">_read_aset</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">:</span> <span class="nb">bytes</span><span class="p">,</span> <span class="n">n</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;ASET(5561,76,215) - Record 1&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_read_xset</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="s1">&#39;ASET&#39;</span><span class="p">,</span> <span class="n">ASET</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_add_aset_object</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_read_qset</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">:</span> <span class="nb">bytes</span><span class="p">,</span> <span class="n">n</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;QSET(610, 6, 316) - Record 21&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_read_xset</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="s1">&#39;QSET&#39;</span><span class="p">,</span> <span class="n">QSET</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_add_qset_object</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_read_aset1</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">:</span> <span class="nb">bytes</span><span class="p">,</span> <span class="n">n</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        ASET1(5571,77,216) - Record 22</span>

<span class="sd">        ASET1=(5, 0, 4, 10, -1,</span>
<span class="sd">               12345, 0, 1, 2, 3, -1,</span>
<span class="sd">               12345, 0, 8, 9)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_read_xset1</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="s1">&#39;ASET1&#39;</span><span class="p">,</span> <span class="n">ASET1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_add_aset_object</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_read_xset</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">card_name</span><span class="p">,</span> <span class="bp">cls</span><span class="p">,</span> <span class="n">add_method</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;common method for ASET, QSET; not USET</span>

<span class="sd">        Word Name Type Description</span>
<span class="sd">        1 ID I Grid or scalar point identification number</span>
<span class="sd">        2  C I Component numbers</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">struct_2i</span> <span class="o">=</span> <span class="n">Struct</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_endian</span> <span class="o">+</span> <span class="sa">b</span><span class="s1">&#39;2i&#39;</span><span class="p">)</span>
        <span class="c1">#self.show_data(data, types=&#39;ifs&#39;)</span>
        <span class="n">ntotal</span> <span class="o">=</span> <span class="mi">8</span>
        <span class="n">nelements</span> <span class="o">=</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">)</span> <span class="o">-</span> <span class="n">n</span><span class="p">)</span> <span class="o">//</span> <span class="n">ntotal</span>
        <span class="k">for</span> <span class="n">unused_i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nelements</span><span class="p">):</span>
            <span class="n">edata</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">n</span><span class="p">:</span><span class="n">n</span> <span class="o">+</span> <span class="n">ntotal</span><span class="p">]</span>
            <span class="n">out</span> <span class="o">=</span> <span class="n">struct_2i</span><span class="o">.</span><span class="n">unpack</span><span class="p">(</span><span class="n">edata</span><span class="p">)</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_debug_file</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">binary_debug</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;  </span><span class="si">%s</span><span class="s1">=</span><span class="si">%s</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">card_name</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">out</span><span class="p">)))</span>
            <span class="c1">#(id, component) = out</span>
            <span class="n">set_obj</span> <span class="o">=</span> <span class="bp">cls</span><span class="o">.</span><span class="n">add_op2_data</span><span class="p">(</span><span class="n">out</span><span class="p">)</span>
            <span class="n">add_method</span><span class="p">(</span><span class="n">set_obj</span><span class="p">)</span>
            <span class="n">n</span> <span class="o">+=</span> <span class="n">ntotal</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">increase_card_count</span><span class="p">(</span><span class="n">card_name</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">n</span>

    <span class="k">def</span> <span class="nf">_read_xset1</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">card_name</span><span class="p">,</span> <span class="bp">cls</span><span class="p">,</span> <span class="n">add_method</span><span class="p">,</span> <span class="n">debug</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        common method for ASET1, QSET1; not USET1</span>

<span class="sd">        F:\work\pyNastran\pyNastran\master2\pyNastran\bdf\test\nx_spike\out_cntlmtlboltld02.op2</span>
<span class="sd">        [123   0   6  10  -1]</span>

<span class="sd">        C:\Users\sdoyle\Dropbox\move_tpl\cc439e.op2</span>
<span class="sd">        # this should be 4 cards</span>
<span class="sd">        [3, 1, 1, 8,</span>
<span class="sd">         3, 1, 10, 16,</span>
<span class="sd">         3, 1, 18, 24,</span>
<span class="sd">         3, 1, 26, 40]</span>

<span class="sd">         C:\Users\sdoyle\Dropbox\move_tpl\dogdr.op2</span>
<span class="sd">        [0, 1, 10001, 10050,</span>
<span class="sd">         3, 0, 101, 102, -1,</span>
<span class="sd">         3, 0, 201, 202, -1,</span>
<span class="sd">         3, 0, 301, 302, -1,</span>
<span class="sd">         3, 0, 1001, 1002, -1,</span>
<span class="sd">         3, 0, 2001, 2002, -1,</span>
<span class="sd">         3, 0, 3001, 3002, -1]</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">def</span> <span class="nf">break_by_thru_type</span><span class="p">(</span><span class="n">data</span><span class="p">):</span>
            <span class="sd">&quot;&quot;&quot;helper for ``read_xset1``&quot;&quot;&quot;</span>
            <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="n">packs</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">while</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">):</span>
                <span class="c1">#print(&#39;data[i:] = &#39;, data[i:])</span>
                <span class="k">if</span> <span class="n">data</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                    <span class="n">pack</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">i</span><span class="p">:</span><span class="n">i</span><span class="o">+</span><span class="mi">4</span><span class="p">]</span>
                    <span class="c1">#print(&#39;pack1 = %s&#39; % pack)</span>
                    <span class="n">packs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">pack</span><span class="p">)</span>
                    <span class="n">i</span> <span class="o">+=</span> <span class="mi">4</span>
                    <span class="k">continue</span>

                <span class="n">i1</span> <span class="o">=</span> <span class="n">i</span>
                <span class="n">i</span> <span class="o">+=</span> <span class="mi">3</span>
                <span class="k">while</span> <span class="n">data</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">!=</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>
                    <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span>
                <span class="c1">#print(&#39;pack2&#39;, data[i1:i])</span>
                <span class="n">pack</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">i1</span><span class="p">:</span><span class="n">i</span><span class="p">]</span>
                <span class="n">packs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">pack</span><span class="p">)</span>

                <span class="c1"># get rid of the trailing -1</span>
                <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="k">return</span> <span class="n">packs</span>

        <span class="n">ndata</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
        <span class="n">out</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">frombuffer</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">n</span><span class="p">:],</span> <span class="bp">self</span><span class="o">.</span><span class="n">idtype8</span><span class="p">)</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

        <span class="c1">#print(out)</span>
        <span class="c1">#izero = np.where(out == -1)[0]</span>
        <span class="n">nentries</span> <span class="o">=</span> <span class="mi">0</span>

        <span class="n">packs</span> <span class="o">=</span> <span class="n">break_by_thru_type</span><span class="p">(</span><span class="n">out</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">pack</span> <span class="ow">in</span> <span class="n">packs</span><span class="p">:</span>
            <span class="n">card</span> <span class="o">=</span> <span class="bp">cls</span><span class="o">.</span><span class="n">add_op2_data</span><span class="p">(</span><span class="n">pack</span><span class="p">)</span>
            <span class="n">add_method</span><span class="p">(</span><span class="n">card</span><span class="p">)</span>
            <span class="n">nentries</span> <span class="o">+=</span> <span class="mi">1</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">increase_card_count</span><span class="p">(</span><span class="n">card_name</span><span class="p">,</span> <span class="n">nentries</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">ndata</span>

    <span class="k">def</span> <span class="nf">_add_superset_card</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="bp">cls</span><span class="p">,</span> <span class="n">card_name</span><span class="p">,</span> <span class="n">add_method</span><span class="p">,</span> <span class="n">out</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;helper method for ``_read_superxset1``&quot;&quot;&quot;</span>
        <span class="c1">#print(&#39;out =&#39;, out)</span>
        <span class="n">seid</span> <span class="o">=</span> <span class="n">out</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">components</span> <span class="o">=</span> <span class="n">out</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">thru_flag</span> <span class="o">=</span> <span class="n">out</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">thru_flag</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">nids</span> <span class="o">=</span> <span class="n">out</span><span class="p">[</span><span class="mi">3</span><span class="p">:]</span>
            <span class="n">thru_check</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">nids</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">out</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span> <span class="n">out</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span>
            <span class="n">thru_check</span> <span class="o">=</span> <span class="kc">True</span>

        <span class="n">in_data</span> <span class="o">=</span> <span class="p">[</span><span class="n">seid</span><span class="p">,</span> <span class="n">components</span><span class="p">,</span> <span class="n">nids</span><span class="p">]</span>
        <span class="k">assert</span> <span class="o">-</span><span class="mi">1</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">nids</span><span class="p">,</span> <span class="p">(</span><span class="n">seid</span><span class="p">,</span> <span class="n">components</span><span class="p">,</span> <span class="n">nids</span><span class="o">.</span><span class="n">tolist</span><span class="p">())</span>
        <span class="n">card</span> <span class="o">=</span> <span class="bp">cls</span><span class="o">.</span><span class="n">add_op2_data</span><span class="p">(</span><span class="n">in_data</span><span class="p">)</span>
        <span class="n">add_method</span><span class="p">(</span><span class="n">card</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">increase_card_count</span><span class="p">(</span><span class="n">card_name</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">thru_check</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">out</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">5</span><span class="p">:</span>
            <span class="n">card</span> <span class="o">=</span> <span class="n">out</span><span class="p">[</span><span class="mi">5</span><span class="p">:]</span>
            <span class="c1">#print(&#39;out[5:] =&#39;, out[5:])</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_add_superset_card</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">card_name</span><span class="p">,</span> <span class="n">add_method</span><span class="p">,</span> <span class="n">out</span><span class="p">[</span><span class="mi">5</span><span class="p">:])</span>

    <span class="k">def</span> <span class="nf">_read_superxset1</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">card_name</span><span class="p">,</span> <span class="bp">cls</span><span class="p">,</span> <span class="n">add_method</span><span class="p">,</span> <span class="n">debug</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        common method for ASET1, QSET1; not USET1</span>

<span class="sd">        F:\work\pyNastran\pyNastran\master2\pyNastran\bdf\test\nx_spike\out_cntlmtlboltld02.op2</span>
<span class="sd">        [123   0   6  10  -1]</span>
<span class="sd">        [  1   0   1 101 112</span>
<span class="sd">           2   0   1 113 124]</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">ndata</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
        <span class="c1">#nfields = (ndata - n) // 4</span>
        <span class="c1">#fmt = &#39;%ii&#39; % nfields</span>
        <span class="n">out</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">frombuffer</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">n</span><span class="p">:],</span> <span class="bp">self</span><span class="o">.</span><span class="n">idtype8</span><span class="p">)</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="c1">#print(out)</span>
        <span class="n">iminus1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">out</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">iminus1</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_add_superset_card</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">card_name</span><span class="p">,</span> <span class="n">add_method</span><span class="p">,</span> <span class="n">out</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">i</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">hstack</span><span class="p">([[</span><span class="mi">0</span><span class="p">],</span> <span class="n">iminus1</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span><span class="mi">1</span><span class="p">])</span>
            <span class="n">j</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">hstack</span><span class="p">([</span><span class="n">iminus1</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="o">-</span><span class="mi">1</span><span class="p">])</span>
            <span class="c1">#print(i, j)</span>
            <span class="k">for</span> <span class="n">ii</span><span class="p">,</span> <span class="n">jj</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">):</span>
                <span class="n">outi</span> <span class="o">=</span> <span class="n">out</span><span class="p">[</span><span class="n">ii</span><span class="p">:</span><span class="n">jj</span><span class="p">]</span>
                <span class="k">assert</span> <span class="o">-</span><span class="mi">1</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">outi</span><span class="p">,</span> <span class="n">outi</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_debug_file</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">binary_debug</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;  </span><span class="si">%s</span><span class="s1">=</span><span class="si">%s</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">card_name</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">out</span><span class="p">)))</span>

                <span class="bp">self</span><span class="o">.</span><span class="n">_add_superset_card</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">card_name</span><span class="p">,</span> <span class="n">add_method</span><span class="p">,</span> <span class="n">outi</span><span class="p">)</span>

                <span class="c1">#seid = data[0]</span>
                <span class="c1">#components = data[1]</span>
                <span class="c1">#thru_flag = outi[2]</span>
                <span class="c1">#if thru_flag == 0:</span>
                    <span class="c1">#nids = outi[3:]</span>
                <span class="c1">#else:</span>
                    <span class="c1">#assert len(outi) == 5, outi</span>
                    <span class="c1">#nids = list(range(outi[3], outi[4]+1))</span>

                <span class="c1">#in_data = [seid, components, nids]</span>

                <span class="c1">#card = cls.add_op2_data(in_data)</span>
                <span class="c1">#add_method(card)</span>
            <span class="c1">#self.increase_card_count(card_name, len(i))</span>
        <span class="k">return</span> <span class="n">ndata</span>

    <span class="k">def</span> <span class="nf">_read_bndgrid</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">:</span> <span class="nb">bytes</span><span class="p">,</span> <span class="n">n</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;BNDGRID(10200,102,473) - Record 3 &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s1">&#39;skipping BNDGRID in GEOM4&#39;</span><span class="p">)</span>
        <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_read_bset</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">:</span> <span class="nb">bytes</span><span class="p">,</span> <span class="n">n</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_read_xset</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="s1">&#39;BSET&#39;</span><span class="p">,</span> <span class="n">BSET</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_add_bset_object</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_read_bset1</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">:</span> <span class="nb">bytes</span><span class="p">,</span> <span class="n">n</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_read_xset1</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="s1">&#39;BSET1&#39;</span><span class="p">,</span> <span class="n">BSET1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_add_bset_object</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_read_cset</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">:</span> <span class="nb">bytes</span><span class="p">,</span> <span class="n">n</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_read_xset</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="s1">&#39;CSET&#39;</span><span class="p">,</span> <span class="n">CSET</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_add_cset_object</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_read_cset1</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">:</span> <span class="nb">bytes</span><span class="p">,</span> <span class="n">n</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_read_xset1</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="s1">&#39;CSET1&#39;</span><span class="p">,</span> <span class="n">CSET1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_add_cset_object</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_read_cyax</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">:</span> <span class="nb">bytes</span><span class="p">,</span> <span class="n">n</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;CYAX(1510,15,328) - Record 8 &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s1">&#39;skipping CYAX in GEOM4&#39;</span><span class="p">)</span>
        <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_read_cyjoin</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">:</span> <span class="nb">bytes</span><span class="p">,</span> <span class="n">n</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;CYJOIN(5210,52,257) - Record 9 &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s1">&#39;skipping CYJOIN in GEOM4&#39;</span><span class="p">)</span>
        <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_read_cysup</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">:</span> <span class="nb">bytes</span><span class="p">,</span> <span class="n">n</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s1">&#39;skipping CYSUP in GEOM4&#39;</span><span class="p">)</span>
        <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_read_cysym</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">:</span> <span class="nb">bytes</span><span class="p">,</span> <span class="n">n</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;CYSYM(1710,17,330) - Record 11&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s1">&#39;skipping CYSYM in GEOM4&#39;</span><span class="p">)</span>
        <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_read_egendt</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">:</span> <span class="nb">bytes</span><span class="p">,</span> <span class="n">n</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s1">&#39;skipping EGENDT in GEOM4&#39;</span><span class="p">)</span>
        <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_read_fcendt</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">:</span> <span class="nb">bytes</span><span class="p">,</span> <span class="n">n</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s1">&#39;skipping FCENDT in GEOM4&#39;</span><span class="p">)</span>
        <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_read_gmbc</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">:</span> <span class="nb">bytes</span><span class="p">,</span> <span class="n">n</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s1">&#39;skipping GMBC in GEOM4&#39;</span><span class="p">)</span>
        <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_read_gmspc</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">:</span> <span class="nb">bytes</span><span class="p">,</span> <span class="n">n</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s1">&#39;skipping GMSPC in GEOM4&#39;</span><span class="p">)</span>
        <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_read_mpc2</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">:</span> <span class="nb">bytes</span><span class="p">,</span> <span class="n">n</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;MPC(4901,49,420017) - Record 16&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s1">&#39;skipping MPC? in GEOM4&#39;</span><span class="p">)</span>
        <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_read_mpc</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">:</span> <span class="nb">bytes</span><span class="p">,</span> <span class="n">n</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;MPC(4901,49,17) - Record 16&quot;&quot;&quot;</span>
        <span class="n">ndata</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
        <span class="n">nfields</span> <span class="o">=</span> <span class="p">(</span><span class="n">ndata</span> <span class="o">-</span> <span class="n">n</span><span class="p">)</span> <span class="o">//</span> <span class="bp">self</span><span class="o">.</span><span class="n">size</span>
        <span class="n">datan</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">n</span><span class="p">:]</span>
        <span class="n">ints</span> <span class="o">=</span> <span class="n">unpack</span><span class="p">(</span><span class="n">mapfmt</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_endian</span> <span class="o">+</span> <span class="sa">b</span><span class="s1">&#39;</span><span class="si">%i</span><span class="s1">i&#39;</span> <span class="o">%</span> <span class="n">nfields</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">size</span><span class="p">),</span> <span class="n">datan</span><span class="p">)</span>
        <span class="n">floats</span> <span class="o">=</span> <span class="n">unpack</span><span class="p">(</span><span class="n">mapfmt</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_endian</span> <span class="o">+</span> <span class="sa">b</span><span class="s1">&#39;</span><span class="si">%i</span><span class="s1">f&#39;</span> <span class="o">%</span> <span class="n">nfields</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">size</span><span class="p">),</span> <span class="n">datan</span><span class="p">)</span>

        <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">nentries</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">while</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">nfields</span><span class="p">:</span>
            <span class="n">sid</span><span class="p">,</span> <span class="n">grid</span><span class="p">,</span> <span class="n">comp</span> <span class="o">=</span> <span class="n">ints</span><span class="p">[</span><span class="n">i</span><span class="p">:</span><span class="n">i</span><span class="o">+</span><span class="mi">3</span><span class="p">]</span>
            <span class="n">coeff</span> <span class="o">=</span> <span class="n">floats</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">3</span><span class="p">]</span>
            <span class="n">mpc_data</span> <span class="o">=</span> <span class="p">[</span><span class="n">sid</span><span class="p">,</span> <span class="n">grid</span><span class="p">,</span> <span class="n">comp</span><span class="p">,</span> <span class="n">coeff</span><span class="p">]</span>
            <span class="n">nodes</span> <span class="o">=</span> <span class="p">[</span><span class="n">grid</span><span class="p">]</span>
            <span class="n">components</span> <span class="o">=</span> <span class="p">[</span><span class="n">comp</span><span class="p">]</span>
            <span class="n">coefficients</span> <span class="o">=</span> <span class="p">[</span><span class="n">coeff</span><span class="p">]</span>

            <span class="n">intsi</span> <span class="o">=</span> <span class="n">ints</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">4</span><span class="p">:</span><span class="n">i</span><span class="o">+</span><span class="mi">7</span><span class="p">]</span>
            <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">intsi</span><span class="p">)</span> <span class="o">==</span> <span class="mi">3</span><span class="p">,</span> <span class="n">intsi</span>
            <span class="k">while</span> <span class="n">intsi</span> <span class="o">!=</span> <span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">):</span>
                <span class="n">gridi</span><span class="p">,</span> <span class="n">compi</span><span class="p">,</span> <span class="n">coeffi</span> <span class="o">=</span> <span class="n">ints</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">4</span><span class="p">],</span> <span class="n">ints</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">5</span><span class="p">],</span> <span class="n">floats</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">6</span><span class="p">]</span>
                <span class="n">mpc_data</span><span class="o">.</span><span class="n">extend</span><span class="p">([</span><span class="n">gridi</span><span class="p">,</span> <span class="n">compi</span><span class="p">,</span> <span class="n">coeffi</span><span class="p">])</span>
                <span class="n">nodes</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">gridi</span><span class="p">)</span>
                <span class="n">components</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">compi</span><span class="p">)</span>
                <span class="n">coefficients</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">coeffi</span><span class="p">)</span>
                <span class="n">i</span> <span class="o">+=</span> <span class="mi">3</span>
                <span class="n">intsi</span> <span class="o">=</span> <span class="n">ints</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">4</span><span class="p">:</span><span class="n">i</span><span class="o">+</span><span class="mi">7</span><span class="p">]</span>
            <span class="n">mpc_data</span><span class="o">.</span><span class="n">extend</span><span class="p">([</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">])</span>
            <span class="n">i</span> <span class="o">+=</span> <span class="mi">7</span> <span class="c1"># 3 + 4 from (-1,-1,-1) and (sid,grid,comp,coeff)</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_debug_file</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">binary_debug</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;  MPC=</span><span class="si">%s</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="nb">str</span><span class="p">(</span><span class="n">mpc_data</span><span class="p">))</span>
            <span class="n">mpci</span> <span class="o">=</span> <span class="n">MPC</span><span class="o">.</span><span class="n">add_op2_data</span><span class="p">((</span><span class="n">sid</span><span class="p">,</span> <span class="n">nodes</span><span class="p">,</span> <span class="n">components</span><span class="p">,</span> <span class="n">coefficients</span><span class="p">))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_add_constraint_mpc_object</span><span class="p">(</span><span class="n">mpci</span><span class="p">)</span>

            <span class="n">nentries</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">increase_card_count</span><span class="p">(</span><span class="s1">&#39;MPC&#39;</span><span class="p">,</span> <span class="n">nentries</span><span class="p">)</span>
        <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_read_mpcadd</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">:</span> <span class="nb">bytes</span><span class="p">,</span> <span class="n">n</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        MPCADD(4891,60,83) - Record 17</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">datai</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">frombuffer</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">n</span><span class="p">:],</span> <span class="bp">self</span><span class="o">.</span><span class="n">idtype8</span><span class="p">)</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="n">_read_spcadd_mpcadd</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;MPCADD&#39;</span><span class="p">,</span> <span class="n">datai</span><span class="p">)</span>
        <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_read_omit1</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">:</span> <span class="nb">bytes</span><span class="p">,</span> <span class="n">n</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;OMIT1(4951,63,92) - Record 19&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_read_xset1</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="s1">&#39;OMIT1&#39;</span><span class="p">,</span> <span class="n">OMIT1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_add_omit_object</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_read_qset1</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">:</span> <span class="nb">bytes</span><span class="p">,</span> <span class="n">n</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;QSET1(610,6,316) - Record 22&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_read_xset1</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="s1">&#39;QSET1&#39;</span><span class="p">,</span> <span class="n">QSET1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_add_qset_object</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_read_rbar_nx</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">n</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        RBAR(6601,66,292) - Record 22 - NX version</span>

<span class="sd">        1 EID I Element identification number</span>
<span class="sd">        2 GA  I Grid point A identification number</span>
<span class="sd">        3 GB  I Grid point B identification number</span>
<span class="sd">        4 CNA I Component numbers of independent degrees-of-freedom at end A</span>
<span class="sd">        5 CNB I Component numbers of independent degrees-of-freedom at end B</span>
<span class="sd">        6 CMA I Component numbers of dependent degrees-of-freedom at end A</span>
<span class="sd">        7 CMB I Component numbers of dependent degrees-of-freedom at end B</span>

<span class="sd">        50501, 50001, 52125, 123456, 0, 0, 654321,</span>
<span class="sd">        50502, 50002, 52126, 123456, 0, 0, 654321,</span>
<span class="sd">        50503, 50003, 52127, 123456, 0, 0, 654321,</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">s</span> <span class="o">=</span> <span class="n">Struct</span><span class="p">(</span><span class="n">mapfmt</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_endian</span> <span class="o">+</span> <span class="sa">b</span><span class="s1">&#39;7i&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">size</span><span class="p">))</span>
        <span class="n">ntotal</span> <span class="o">=</span> <span class="mi">28</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">factor</span>
        <span class="n">nelements</span> <span class="o">=</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">)</span> <span class="o">-</span> <span class="n">n</span><span class="p">)</span> <span class="o">//</span> <span class="n">ntotal</span>
        <span class="k">assert</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">)</span> <span class="o">-</span> <span class="n">n</span><span class="p">)</span> <span class="o">%</span> <span class="n">ntotal</span> <span class="o">==</span> <span class="mi">0</span>
        <span class="n">elems</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">unused_i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nelements</span><span class="p">):</span>
            <span class="n">edata</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">n</span><span class="p">:</span><span class="n">n</span> <span class="o">+</span> <span class="n">ntotal</span><span class="p">]</span>  <span class="c1"># 8*4</span>
            <span class="n">out</span> <span class="o">=</span> <span class="n">s</span><span class="o">.</span><span class="n">unpack</span><span class="p">(</span><span class="n">edata</span><span class="p">)</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_debug_file</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">binary_debug</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;  RBAR NX=</span><span class="si">%s</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="nb">str</span><span class="p">(</span><span class="n">out</span><span class="p">))</span>
            <span class="p">(</span><span class="n">eid</span><span class="p">,</span> <span class="n">unused_ga</span><span class="p">,</span> <span class="n">unused_gb</span><span class="p">,</span> <span class="n">unused_cna</span><span class="p">,</span> <span class="n">unused_cnb</span><span class="p">,</span> <span class="n">unused_cma</span><span class="p">,</span> <span class="n">unused_cmb</span><span class="p">)</span> <span class="o">=</span> <span class="n">out</span>
            <span class="k">assert</span> <span class="n">eid</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">,</span> <span class="n">out</span>
            <span class="n">out</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">out</span><span class="p">)</span>
            <span class="n">out</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mf">0.</span><span class="p">)</span>
            <span class="n">elem</span> <span class="o">=</span> <span class="n">RBAR</span><span class="o">.</span><span class="n">add_op2_data</span><span class="p">(</span><span class="n">out</span><span class="p">)</span>
            <span class="n">elems</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">elem</span><span class="p">)</span>
            <span class="c1">#if self.is_debug_file:</span>
                <span class="c1">#self.binary_debug.write(&#39;	eid	ga	gb	cna	cnb	cma	cmb	alpha\n&#39;)</span>
                <span class="c1">#self.binary_debug.write(str(elem))</span>
            <span class="n">n</span> <span class="o">+=</span> <span class="n">ntotal</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">to_nx</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">n</span><span class="p">,</span> <span class="n">elems</span>

    <span class="k">def</span> <span class="nf">_read_rbar_msc</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">n</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;RBAR(6601,66,292) - Record 22 - MSC version&quot;&quot;&quot;</span>
        <span class="n">s</span> <span class="o">=</span> <span class="n">Struct</span><span class="p">(</span><span class="n">mapfmt</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_endian</span> <span class="o">+</span> <span class="sa">b</span><span class="s1">&#39;7if&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">size</span><span class="p">))</span>
        <span class="n">ntotal</span> <span class="o">=</span> <span class="mi">32</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">factor</span>  <span class="c1"># 8*4</span>
        <span class="n">nelements</span> <span class="o">=</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">)</span> <span class="o">-</span> <span class="n">n</span><span class="p">)</span> <span class="o">//</span> <span class="n">ntotal</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">)</span> <span class="o">-</span> <span class="n">n</span><span class="p">)</span> <span class="o">%</span> <span class="n">ntotal</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">MixedVersionCard</span><span class="p">(</span><span class="s1">&#39;failed reading as MSC&#39;</span><span class="p">)</span>
        <span class="n">elems</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">unused_i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nelements</span><span class="p">):</span>
            <span class="n">edata</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">n</span><span class="p">:</span><span class="n">n</span> <span class="o">+</span> <span class="n">ntotal</span><span class="p">]</span>
            <span class="n">out</span> <span class="o">=</span> <span class="n">s</span><span class="o">.</span><span class="n">unpack</span><span class="p">(</span><span class="n">edata</span><span class="p">)</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_debug_file</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">binary_debug</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;  RBAR MSC=</span><span class="si">%s</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="nb">str</span><span class="p">(</span><span class="n">out</span><span class="p">))</span>
            <span class="c1">#(eid, ga, gb, cna, cnb, cma, cmb, alpha) = out</span>
            <span class="k">assert</span> <span class="n">out</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">,</span> <span class="n">out</span>
            <span class="n">elem</span> <span class="o">=</span> <span class="n">RBAR</span><span class="o">.</span><span class="n">add_op2_data</span><span class="p">(</span><span class="n">out</span><span class="p">)</span>
            <span class="n">elems</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">elem</span><span class="p">)</span>
            <span class="n">n</span> <span class="o">+=</span> <span class="n">ntotal</span>
        <span class="k">return</span> <span class="n">n</span><span class="p">,</span> <span class="n">elems</span>

    <span class="k">def</span> <span class="nf">_read_rbe1</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">:</span> <span class="nb">bytes</span><span class="p">,</span> <span class="n">n</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        RBE1(6801,68,294) - Record 23</span>

<span class="sd">        MSC/NX</span>
<span class="sd">        Word Name Type Description</span>
<span class="sd">        1 EID I Element identification number</span>
<span class="sd">        2 GN  I Grid point identification number for independent degrees-of-freedom</span>
<span class="sd">        3 CN  I Component numbers of independent degrees-of-freedom</span>
<span class="sd">        Words 2 through 3 repeat until (-2,-2) occurs</span>

<span class="sd">        4 GM  I Grid point identification number for dependent degrees-of-freedom</span>
<span class="sd">        5 CM  I Component numbers of dependent degreesof-freedom</span>
<span class="sd">        Words 4 through 5 repeat until (-1,-1) occurs</span>

<span class="sd">        6 ALPHA RS Thermal expansion coefficient</span>
<span class="sd">        7 UNDEF none Not used</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># TODO: neither reader or writer considers alpha; no current examples</span>
        <span class="n">idata</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">frombuffer</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">n</span><span class="p">:],</span> <span class="bp">self</span><span class="o">.</span><span class="n">idtype8</span><span class="p">)</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">nelements</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">nfields</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">idata</span><span class="p">)</span>
        <span class="k">while</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">nfields</span><span class="p">:</span>
            <span class="n">eid</span><span class="p">,</span> <span class="n">gn</span><span class="p">,</span> <span class="n">cn</span> <span class="o">=</span> <span class="n">idata</span><span class="p">[</span><span class="n">i</span><span class="p">:</span><span class="n">i</span><span class="o">+</span><span class="mi">3</span><span class="p">]</span>
            <span class="n">gni</span><span class="p">,</span> <span class="n">cni</span> <span class="o">=</span> <span class="n">idata</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">3</span><span class="p">:</span><span class="n">i</span><span class="o">+</span><span class="mi">5</span><span class="p">]</span>
            <span class="n">Gni</span> <span class="o">=</span> <span class="p">[</span><span class="n">gn</span><span class="p">]</span>
            <span class="n">Cni</span> <span class="o">=</span> <span class="p">[</span><span class="n">cn</span><span class="p">]</span>
            <span class="k">while</span> <span class="p">(</span><span class="n">gni</span><span class="p">,</span> <span class="n">cni</span><span class="p">)</span> <span class="o">!=</span> <span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">):</span>
                <span class="c1">#print(eid, gn, cn, (gni, cni))</span>
                <span class="n">Gni</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">gni</span><span class="p">)</span>
                <span class="n">Cni</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">cni</span><span class="p">)</span>
                <span class="n">i</span> <span class="o">+=</span> <span class="mi">2</span>
                <span class="n">gni</span><span class="p">,</span> <span class="n">cni</span> <span class="o">=</span> <span class="n">idata</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">3</span><span class="p">:</span><span class="n">i</span><span class="o">+</span><span class="mi">5</span><span class="p">]</span>
                <span class="c1">#print((gni, cni))</span>
                <span class="c1">#print(&#39;----&#39;)</span>
            <span class="n">i</span> <span class="o">+=</span> <span class="mi">2</span>

            <span class="n">gmi</span><span class="p">,</span> <span class="n">cmi</span> <span class="o">=</span> <span class="n">idata</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">3</span><span class="p">:</span><span class="n">i</span><span class="o">+</span><span class="mi">5</span><span class="p">]</span>
            <span class="c1">#print(&quot;gmi,cmi=&quot;, gmi, cmi)</span>
            <span class="n">Gmi</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="n">Cmi</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">while</span> <span class="p">(</span><span class="n">gmi</span><span class="p">,</span> <span class="n">cmi</span><span class="p">)</span> <span class="o">!=</span> <span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">):</span>
                <span class="n">Gmi</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">gmi</span><span class="p">)</span>
                <span class="n">Cmi</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">cmi</span><span class="p">)</span>
                <span class="n">i</span> <span class="o">+=</span> <span class="mi">2</span>
                <span class="n">gmi</span><span class="p">,</span> <span class="n">cmi</span> <span class="o">=</span> <span class="n">idata</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">3</span><span class="p">:</span><span class="n">i</span><span class="o">+</span><span class="mi">5</span><span class="p">]</span>
            <span class="n">i</span> <span class="o">+=</span> <span class="mi">5</span>
            <span class="c1">#print(idata[i+3:])</span>
            <span class="c1">#idata</span>
            <span class="c1">#print(idata[i:])</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">add_rbe1</span><span class="p">(</span><span class="n">eid</span><span class="p">,</span> <span class="n">Gni</span><span class="p">,</span> <span class="n">Cni</span><span class="p">,</span> <span class="n">Gmi</span><span class="p">,</span> <span class="n">Cmi</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.</span><span class="p">)</span>

            <span class="n">nelements</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">card_count</span><span class="p">[</span><span class="s1">&#39;RBE1&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">nelements</span>
        <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_read_rbe2</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">:</span> <span class="nb">bytes</span><span class="p">,</span> <span class="n">n</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        RBE2(6901,69,295) - Record 24</span>

<span class="sd">        Word Name Type Description</span>
<span class="sd">        1 EID I Element identification number</span>
<span class="sd">        2  GN I Grid point identification number for independent degrees-of-freedom</span>
<span class="sd">        3  CM I Component numbers of dependent degrees of-freedom</span>
<span class="sd">        4  GM I Grid point identification number for dependent degrees-of-freedom</span>
<span class="sd">        Word 4 repeats until End of Record</span>
<span class="sd">        5 ALPHA RS Thermal expansion coefficient</span>

<span class="sd">        ::</span>

<span class="sd">          data = (1, 1, 123456, 10000, -1, 0.0,</span>
<span class="sd">                  2, 2, 123456, 20000, -1, 0.0,</span>
<span class="sd">                  3, 3, 12345,  30000, 30001, 30002, 30003, 30004, 30005, -1, 0.0,</span>
<span class="sd">                  4, 4, 123,    40000, 40001, 40010, 40011, 40020, 40021, -1, 0.0,</span>
<span class="sd">                  5, 5, 123,    50000, 50001, 50010, 50011, 50020, 50021, -1, 0.0)</span>
<span class="sd">        (1,  35,  2, 33, 34, 36, 37, 133, 134, 135, 136, 137, -1, 0.0,</span>
<span class="sd">         3,  3,   2,  1,  2,  4,  5, 101, 102, 103, 104, 105, -1, 0.0,</span>
<span class="sd">         5,  8,   2,  6,  7,  9, 10, 106, 107, 108, 109, 110, -1, 0.0,</span>
<span class="sd">         6,  13,  2, 11, 12, 14, 15, 111, 112, 113, 114, 115, -1, 0.0</span>
<span class="sd">         0,  9,  30,  2, 28, 29, 31, 32,  128, 129, 130, 131, 132, -1, 0.0,</span>
<span class="sd">         10, 25,  2, 23, 24, 26, 27, 123, 124, 125, 126, 127, -1, 0.0)</span>

<span class="sd">        idata = [</span>
<span class="sd">            10101, 10101, 123456, 1, 2, -1,</span>
<span class="sd">            10102, 10102, 123456, 3, 4, -1,</span>
<span class="sd">            10103, 10103, 123456, 5, -1,</span>
<span class="sd">        ]</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">idata</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">frombuffer</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">n</span><span class="p">:],</span> <span class="bp">self</span><span class="o">.</span><span class="n">idtype8</span><span class="p">)</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="n">iminus1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">idata</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">idata</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>
            <span class="n">is_alpha</span> <span class="o">=</span> <span class="kc">False</span>
            <span class="n">i</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">hstack</span><span class="p">([[</span><span class="mi">0</span><span class="p">],</span> <span class="n">iminus1</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span><span class="mi">1</span><span class="p">])</span>
            <span class="n">j</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">hstack</span><span class="p">([</span><span class="n">iminus1</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="nb">len</span><span class="p">(</span><span class="n">idata</span><span class="p">)])</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">is_alpha</span> <span class="o">=</span> <span class="kc">True</span>
            <span class="n">i</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">hstack</span><span class="p">([[</span><span class="mi">0</span><span class="p">],</span> <span class="n">iminus1</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span><span class="mi">2</span><span class="p">])</span>
            <span class="n">fdata</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">frombuffer</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">n</span><span class="p">:],</span> <span class="bp">self</span><span class="o">.</span><span class="n">fdtype8</span><span class="p">)</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
            <span class="n">j</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">hstack</span><span class="p">([</span><span class="n">iminus1</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">idata</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
        <span class="c1">#print(&#39;is_alpha=%s&#39; % is_alpha)</span>
        <span class="c1">#print(&#39;i=%s&#39; % i)</span>
        <span class="c1">#print(&#39;j=%s&#39; % j)</span>
        <span class="c1">#print(&#39;idata=%s&#39; % idata.tolist())</span>
        <span class="c1">#print(fdata, len(fdata))</span>
        <span class="n">nelements</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">j</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">is_alpha</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">ii</span><span class="p">,</span> <span class="n">jj</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">):</span>
                <span class="n">eid</span><span class="p">,</span> <span class="n">gn</span><span class="p">,</span> <span class="n">cm</span> <span class="o">=</span> <span class="n">idata</span><span class="p">[</span><span class="n">ii</span><span class="p">:</span><span class="n">ii</span> <span class="o">+</span> <span class="mi">3</span><span class="p">]</span>
                <span class="n">gm</span> <span class="o">=</span> <span class="n">idata</span><span class="p">[</span><span class="n">ii</span><span class="o">+</span><span class="mi">3</span><span class="p">:</span><span class="n">jj</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
                <span class="c1">#print(&#39;eid=%s gn=%s cm=%s gm=%s&#39; % (eid, gn, cm, gm))</span>
                <span class="c1">#alpha = fdata[jj]</span>
                <span class="n">alpha</span> <span class="o">=</span> <span class="n">fdata</span><span class="p">[</span><span class="n">jj</span><span class="p">]</span>
                <span class="c1">#print(&#39;eid=%s gn=%s cm=%s gm=%s alpha=%s&#39; % (eid, gn, cm, gm, alpha))</span>

                <span class="n">out</span> <span class="o">=</span> <span class="p">(</span><span class="n">eid</span><span class="p">,</span> <span class="n">gn</span><span class="p">,</span> <span class="n">cm</span><span class="p">,</span> <span class="n">gm</span><span class="p">,</span> <span class="n">alpha</span><span class="p">)</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_debug_file</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">binary_debug</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;  RBE2=</span><span class="si">%s</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="nb">str</span><span class="p">(</span><span class="n">out</span><span class="p">))</span>
                <span class="c1">#print(&#39;  RBE2=%s\n&#39; % str(out))</span>
                <span class="n">elem</span> <span class="o">=</span> <span class="n">RBE2</span><span class="o">.</span><span class="n">add_op2_data</span><span class="p">(</span><span class="n">out</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_add_op2_rigid_element</span><span class="p">(</span><span class="n">elem</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">alpha</span> <span class="o">=</span> <span class="mf">0.0</span>
            <span class="k">for</span> <span class="n">ii</span><span class="p">,</span> <span class="n">jj</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">):</span>
                <span class="c1">#eid, gn, cm, gm1, gm2 = idata[ii:ii + 5]</span>
                <span class="n">eid</span><span class="p">,</span> <span class="n">gn</span><span class="p">,</span> <span class="n">cm</span> <span class="o">=</span> <span class="n">idata</span><span class="p">[</span><span class="n">ii</span><span class="p">:</span><span class="n">ii</span> <span class="o">+</span> <span class="mi">3</span><span class="p">]</span>
                <span class="n">gm</span> <span class="o">=</span> <span class="n">idata</span><span class="p">[</span><span class="n">ii</span><span class="o">+</span><span class="mi">3</span><span class="p">:</span><span class="n">jj</span><span class="p">]</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
                <span class="k">if</span> <span class="o">-</span><span class="mi">1</span> <span class="ow">in</span> <span class="n">gm</span><span class="p">:</span>
                    <span class="n">gm</span> <span class="o">=</span> <span class="n">gm</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
                <span class="k">assert</span> <span class="o">-</span><span class="mi">1</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">gm</span><span class="p">,</span> <span class="s1">&#39;eid=</span><span class="si">%s</span><span class="s1"> gn=</span><span class="si">%s</span><span class="s1"> cm=</span><span class="si">%s</span><span class="s1"> gm=</span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">eid</span><span class="p">,</span> <span class="n">gn</span><span class="p">,</span> <span class="n">cm</span><span class="p">,</span> <span class="n">gm</span><span class="p">)</span>
                <span class="c1">#print(&#39;eid=%s gn=%s cm=%s gm=%s&#39; % (eid, gn, cm, gm))</span>

                <span class="n">out</span> <span class="o">=</span> <span class="p">(</span><span class="n">eid</span><span class="p">,</span> <span class="n">gn</span><span class="p">,</span> <span class="n">cm</span><span class="p">,</span> <span class="n">gm</span><span class="p">,</span> <span class="n">alpha</span><span class="p">)</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_debug_file</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">binary_debug</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;  RBE2=</span><span class="si">%s</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="nb">str</span><span class="p">(</span><span class="n">out</span><span class="p">))</span>
                <span class="c1">#print(&#39;  RBE2=%s\n&#39; % str(out))</span>
                <span class="n">elem</span> <span class="o">=</span> <span class="n">RBE2</span><span class="o">.</span><span class="n">add_op2_data</span><span class="p">(</span><span class="n">out</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_add_op2_rigid_element</span><span class="p">(</span><span class="n">elem</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">card_count</span><span class="p">[</span><span class="s1">&#39;RBE2&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">nelements</span>
        <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

        <span class="c1">#while n &lt; len(data):</span>
            <span class="c1">## (eid, gn, cm, gm, ..., alpha)</span>
            <span class="c1">#out = s_msc.unpack(data[n:n+20])</span>
            <span class="c1">#eid, gn, cm, gm1, gm2 = out</span>
            <span class="c1">#n += 20</span>

            <span class="c1">#Gmi = [gm1, gm2]</span>
            <span class="c1">#while gm2 != -1:</span>
                <span class="c1">#gm2, = struct_i.unpack(data[n:n+4])</span>
                <span class="c1">#Gmi.append(gm2)</span>
                <span class="c1">#n += 4</span>
            <span class="c1">#Gmi = [gmi for gmi in Gmi if gmi != -1]</span>

            <span class="c1">### TODO: according to the MSC/NX manual, alpha should be here,</span>
            <span class="c1">###       but it&#39;s not...</span>
            <span class="c1">#alpha = 0.</span>

            <span class="c1">#if self.is_debug_file:</span>
                <span class="c1">#self.binary_debug.write(&#39;  RBE2=%s\n&#39; % str(out))</span>
            <span class="c1">#print(&#39;  RBE2=%s\n&#39; % str(out))</span>
            <span class="c1">#out = (eid, gn, cm, Gmi, alpha)</span>
            <span class="c1">#elem = RBE2.add_op2_data(out)</span>
            <span class="c1">#self._add_op2_rigid_element(elem)</span>
            <span class="c1">#nelements += 1</span>
        <span class="c1">#self.card_count[&#39;RBE2&#39;] = nelements</span>
        <span class="c1">#return n</span>

    <span class="k">def</span> <span class="nf">_read_rbe3</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">:</span> <span class="nb">bytes</span><span class="p">,</span> <span class="n">n</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;RBE3(7101,71,187) - Record 25&quot;&quot;&quot;</span>
        <span class="c1">#self.show_data(data[n+80:], &#39;ifs&#39;)</span>
        <span class="n">idata</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">frombuffer</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">n</span><span class="p">:],</span> <span class="bp">self</span><span class="o">.</span><span class="n">idtype8</span><span class="p">)</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="n">fdata</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">frombuffer</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">n</span><span class="p">:],</span> <span class="bp">self</span><span class="o">.</span><span class="n">fdtype8</span><span class="p">)</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="n">read_rbe3s_from_idata_fdata</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">idata</span><span class="p">,</span> <span class="n">fdata</span><span class="p">)</span>
        <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_read_rbjoint</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">:</span> <span class="nb">bytes</span><span class="p">,</span> <span class="n">n</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s1">&#39;skipping RBJOINT in GEOM4&#39;</span><span class="p">)</span>
        <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_read_rbjstif</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">:</span> <span class="nb">bytes</span><span class="p">,</span> <span class="n">n</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s1">&#39;skipping RBJSTIF in GEOM4&#39;</span><span class="p">)</span>
        <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_read_release</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">:</span> <span class="nb">bytes</span><span class="p">,</span> <span class="n">n</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Record - RELEASE(1310,13,247)</span>

<span class="sd">        Word Name Type Description</span>
<span class="sd">        1 SEID     I Superelement identification number</span>
<span class="sd">        2 C        I Component numbers</span>
<span class="sd">        3 THRUFLAG I Thru range flag</span>
<span class="sd">        THRUFLAG=0 No</span>
<span class="sd">            4 ID I Grid or scalar point identification number</span>
<span class="sd">            Word 4 repeats until End of Record</span>
<span class="sd">        THRUFLAG=1 Yes</span>
<span class="sd">            4 ID1 I First grid or scalar point identification number</span>
<span class="sd">            5 ID2</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1">#[1310, 13, 247,</span>
         <span class="c1">#10, 456, 0, 10, -1,</span>
         <span class="c1">#20, 456, 0, 11, -1]</span>
        <span class="kn">from</span> <span class="nn">pyNastran.bdf.field_writer_16</span> <span class="kn">import</span> <span class="n">print_card_16</span>
        <span class="n">ints</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">frombuffer</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">n</span><span class="p">:],</span> <span class="bp">self</span><span class="o">.</span><span class="n">idtype</span><span class="p">)</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="n">nfields</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">ints</span><span class="p">)</span>
        <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">while</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">nfields</span><span class="p">:</span>
            <span class="n">seid</span> <span class="o">=</span> <span class="n">ints</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
            <span class="n">comp</span> <span class="o">=</span> <span class="n">ints</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span>
            <span class="n">thru_flag</span> <span class="o">=</span> <span class="n">ints</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">2</span><span class="p">]</span>
            <span class="n">i</span> <span class="o">+=</span> <span class="mi">3</span>
            <span class="k">if</span> <span class="n">thru_flag</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">value</span> <span class="o">=</span> <span class="n">ints</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
                <span class="n">values</span> <span class="o">=</span> <span class="p">[]</span>
                <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span>
                <span class="k">while</span> <span class="n">value</span> <span class="o">!=</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>
                    <span class="n">values</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
                    <span class="n">value</span> <span class="o">=</span> <span class="n">ints</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
                    <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span>
                <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">values</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;seid=</span><span class="si">%s</span><span class="s1"> comp=</span><span class="si">%s</span><span class="s1"> thru_flag=</span><span class="si">%s</span><span class="s1"> values=</span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">seid</span><span class="p">,</span> <span class="n">comp</span><span class="p">,</span> <span class="n">thru_flag</span><span class="p">,</span> <span class="n">values</span><span class="p">)</span>
                <span class="n">fields</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;RELEASE&#39;</span><span class="p">,</span> <span class="n">seid</span><span class="p">,</span> <span class="n">comp</span><span class="p">]</span> <span class="o">+</span> <span class="n">values</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">reject_lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">print_card_16</span><span class="p">(</span><span class="n">fields</span><span class="p">))</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="n">thru_flag</span><span class="p">)</span>
        <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_read_rpnom</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">:</span> <span class="nb">bytes</span><span class="p">,</span> <span class="n">n</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s1">&#39;skipping RPNOM in GEOM4&#39;</span><span class="p">)</span>
        <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_read_rrod</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">:</span> <span class="nb">bytes</span><span class="p">,</span> <span class="n">n</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;common method for reading RROD&quot;&quot;&quot;</span>
        <span class="n">n</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_read_dual_card</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_read_rrod_nx</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_read_rrod_msc</span><span class="p">,</span>
                                 <span class="s1">&#39;RROD&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_add_op2_rigid_element</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">n</span>

    <span class="k">def</span> <span class="nf">_read_rrod_nx</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">n</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;RROD(6501,65,291) - Record 30&quot;&quot;&quot;</span>
        <span class="n">struct_5i</span> <span class="o">=</span> <span class="n">Struct</span><span class="p">(</span><span class="n">mapfmt</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_endian</span> <span class="o">+</span> <span class="sa">b</span><span class="s1">&#39;5i&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">size</span><span class="p">))</span>
        <span class="n">ntotal</span> <span class="o">=</span> <span class="mi">20</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">factor</span>
        <span class="n">nelements</span> <span class="o">=</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">)</span> <span class="o">-</span> <span class="n">n</span><span class="p">)</span> <span class="o">//</span> <span class="n">ntotal</span>
        <span class="k">assert</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">)</span> <span class="o">-</span> <span class="n">n</span><span class="p">)</span> <span class="o">%</span> <span class="n">ntotal</span> <span class="o">==</span> <span class="mi">0</span>
        <span class="n">elements</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">unused_i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nelements</span><span class="p">):</span>
            <span class="n">edata</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">n</span><span class="p">:</span><span class="n">n</span> <span class="o">+</span> <span class="n">ntotal</span><span class="p">]</span>
            <span class="n">out</span> <span class="o">=</span> <span class="n">struct_5i</span><span class="o">.</span><span class="n">unpack</span><span class="p">(</span><span class="n">edata</span><span class="p">)</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_debug_file</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">binary_debug</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;  RROD=</span><span class="si">%s</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="nb">str</span><span class="p">(</span><span class="n">out</span><span class="p">))</span>
            <span class="p">(</span><span class="n">eid</span><span class="p">,</span> <span class="n">ga</span><span class="p">,</span> <span class="n">gb</span><span class="p">,</span> <span class="n">cma</span><span class="p">,</span> <span class="n">cmb</span><span class="p">)</span> <span class="o">=</span> <span class="n">out</span>
            <span class="k">assert</span> <span class="n">eid</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">,</span> <span class="n">out</span>
            <span class="n">out</span> <span class="o">=</span> <span class="p">(</span><span class="n">eid</span><span class="p">,</span> <span class="n">ga</span><span class="p">,</span> <span class="n">gb</span><span class="p">,</span> <span class="n">cma</span><span class="p">,</span> <span class="n">cmb</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">)</span> <span class="c1"># alpha</span>
            <span class="n">elem</span> <span class="o">=</span> <span class="n">RROD</span><span class="o">.</span><span class="n">add_op2_data</span><span class="p">(</span><span class="n">out</span><span class="p">)</span>
            <span class="n">elements</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">elem</span><span class="p">)</span>
            <span class="n">n</span> <span class="o">+=</span> <span class="n">ntotal</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">to_nx</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">n</span><span class="p">,</span> <span class="n">elements</span>

    <span class="k">def</span> <span class="nf">_read_rrod_msc</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">n</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;RROD(6501,65,291) - Record 30&quot;&quot;&quot;</span>
        <span class="n">s</span> <span class="o">=</span> <span class="n">Struct</span><span class="p">(</span><span class="n">mapfmt</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_endian</span> <span class="o">+</span> <span class="sa">b</span><span class="s1">&#39;5if&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">size</span><span class="p">))</span>
        <span class="n">ntotal</span> <span class="o">=</span> <span class="mi">24</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">factor</span>
        <span class="n">nelements</span> <span class="o">=</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">)</span> <span class="o">-</span> <span class="n">n</span><span class="p">)</span> <span class="o">//</span> <span class="n">ntotal</span>
        <span class="k">assert</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">)</span> <span class="o">-</span> <span class="n">n</span><span class="p">)</span> <span class="o">%</span> <span class="n">ntotal</span> <span class="o">==</span> <span class="mi">0</span>
        <span class="n">elements</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">unused_i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nelements</span><span class="p">):</span>
            <span class="n">edata</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">n</span><span class="p">:</span><span class="n">n</span> <span class="o">+</span> <span class="n">ntotal</span><span class="p">]</span>
            <span class="n">out</span> <span class="o">=</span> <span class="n">s</span><span class="o">.</span><span class="n">unpack</span><span class="p">(</span><span class="n">edata</span><span class="p">)</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_debug_file</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">binary_debug</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;  RROD=</span><span class="si">%s</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="nb">str</span><span class="p">(</span><span class="n">out</span><span class="p">))</span>
            <span class="c1">#(eid, ga, gb, cma, cmb, alpha) = out</span>
            <span class="k">assert</span> <span class="n">out</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">,</span> <span class="n">out</span>
            <span class="n">elem</span> <span class="o">=</span> <span class="n">RROD</span><span class="o">.</span><span class="n">add_op2_data</span><span class="p">(</span><span class="n">out</span><span class="p">)</span>
            <span class="n">elements</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">elem</span><span class="p">)</span>
            <span class="n">n</span> <span class="o">+=</span> <span class="n">ntotal</span>
        <span class="k">return</span> <span class="n">n</span><span class="p">,</span> <span class="n">elements</span>

    <span class="k">def</span> <span class="nf">_read_rspline</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">:</span> <span class="nb">bytes</span><span class="p">,</span> <span class="n">n</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;RSPLINE(7001,70,186) - Record 31&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s1">&#39;skipping RSPLINE in GEOM4&#39;</span><span class="p">)</span>
        <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_read_rsscon</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">:</span> <span class="nb">bytes</span><span class="p">,</span> <span class="n">n</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;RSSCON(7201,72,398) - Record 32&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s1">&#39;skipping RSSCON in GEOM4&#39;</span><span class="p">)</span>
        <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_read_rweld</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">:</span> <span class="nb">bytes</span><span class="p">,</span> <span class="n">n</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s1">&#39;skipping RWELD in GEOM4&#39;</span><span class="p">)</span>
        <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_read_sebset</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">:</span> <span class="nb">bytes</span><span class="p">,</span> <span class="n">n</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s1">&#39;skipping SEBSET in GEOM4&#39;</span><span class="p">)</span>
        <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_read_sebset1</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">:</span> <span class="nb">bytes</span><span class="p">,</span> <span class="n">n</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s1">&#39;skipping SEBSET1 in GEOM4&#39;</span><span class="p">)</span>
        <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_read_secset</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">:</span> <span class="nb">bytes</span><span class="p">,</span> <span class="n">n</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s1">&#39;skipping SECSET in GEOM4&#39;</span><span class="p">)</span>
        <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_read_secset1</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">:</span> <span class="nb">bytes</span><span class="p">,</span> <span class="n">n</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s1">&#39;skipping SECSET1 in GEOM4&#39;</span><span class="p">)</span>
        <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_read_seqset</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">:</span> <span class="nb">bytes</span><span class="p">,</span> <span class="n">n</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;SEQSET(1110,11,321) - Record 40&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s1">&#39;skipping SEQSET in GEOM4&#39;</span><span class="p">)</span>
        <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
        <span class="c1">#return self._read_xset(data, n, &#39;SEQSET&#39;, SEQSET, self.add_SEQSET)</span>

    <span class="k">def</span> <span class="nf">_read_seqset1</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">:</span> <span class="nb">bytes</span><span class="p">,</span> <span class="n">n</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        SEQSET1(1210,12,322) - Record 41</span>

<span class="sd">        SEQSET1=(1, 0, 0, 700, -1,</span>
<span class="sd">                 2, 0, 0, 200, -1,</span>
<span class="sd">                 3, 0, 0, 300, -1,</span>
<span class="sd">                 4, 0, 0, 400, -1,</span>
<span class="sd">                 5, 0, 0, 500, -1,</span>
<span class="sd">                 6, 0, 0, 600)</span>
<span class="sd">        SEQSET1=[1   0   1 101 112</span>
<span class="sd">                 2   0   1 113 124]</span>

<span class="sd">        data = (</span>
<span class="sd">             1, 0, 0, 700, -1,</span>
<span class="sd">             2, 0, 0, 200, -1,</span>
<span class="sd">             3, 0, 0, 300, -1,</span>
<span class="sd">             4, 0, 0, 400, -1,</span>
<span class="sd">             5, 0, 0, 500, -1,</span>
<span class="sd">             6, 0, 0, 600, -1)</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_read_superxset1</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="s1">&#39;SEQSET1&#39;</span><span class="p">,</span> <span class="n">SEQSET1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_add_seqset_object</span><span class="p">,</span>
                                     <span class="n">debug</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_read_sesup</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">:</span> <span class="nb">bytes</span><span class="p">,</span> <span class="n">n</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s1">&#39;skipping SESUP in GEOM4&#39;</span><span class="p">)</span>
        <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_read_seuset</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">:</span> <span class="nb">bytes</span><span class="p">,</span> <span class="n">n</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s1">&#39;skipping SEUSET in GEOM4&#39;</span><span class="p">)</span>
        <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_read_seuset1</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">:</span> <span class="nb">bytes</span><span class="p">,</span> <span class="n">n</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s1">&#39;skipping SEUSET1 in GEOM4&#39;</span><span class="p">)</span>
        <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_read_spcoff</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">:</span> <span class="nb">bytes</span><span class="p">,</span> <span class="n">n</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;SPCOFF(5501,55,16) - Record 44&quot;&quot;&quot;</span>
        <span class="n">ntotal</span> <span class="o">=</span> <span class="mi">16</span>
        <span class="n">nentries</span> <span class="o">=</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">)</span> <span class="o">-</span> <span class="n">n</span><span class="p">)</span> <span class="o">//</span> <span class="n">ntotal</span>
        <span class="n">struct_3if</span> <span class="o">=</span> <span class="n">Struct</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_endian</span> <span class="o">+</span> <span class="sa">b</span><span class="s1">&#39;iiif&#39;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">unused_i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nentries</span><span class="p">):</span>
            <span class="n">edata</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">n</span><span class="p">:</span><span class="n">n</span> <span class="o">+</span> <span class="mi">16</span><span class="p">]</span>
            <span class="p">(</span><span class="n">sid</span><span class="p">,</span> <span class="n">ID</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">dx</span><span class="p">)</span> <span class="o">=</span> <span class="n">struct_3if</span><span class="o">.</span><span class="n">unpack</span><span class="p">(</span><span class="n">edata</span><span class="p">)</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_debug_file</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">binary_debug</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;SPCOFF sid=</span><span class="si">%s</span><span class="s1"> id=</span><span class="si">%s</span><span class="s1"> c=</span><span class="si">%s</span><span class="s1"> dx=</span><span class="si">%s</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">sid</span><span class="p">,</span> <span class="n">ID</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">dx</span><span class="p">))</span>
            <span class="n">constraint</span> <span class="o">=</span> <span class="n">SPCOFF</span><span class="o">.</span><span class="n">add_op2_data</span><span class="p">([</span><span class="n">sid</span><span class="p">,</span> <span class="n">ID</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">dx</span><span class="p">])</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_add_constraint_spcoff_object</span><span class="p">(</span><span class="n">constraint</span><span class="p">)</span>
            <span class="n">n</span> <span class="o">+=</span> <span class="mi">16</span>
        <span class="k">return</span> <span class="n">n</span>

    <span class="k">def</span> <span class="nf">_read_spc</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">:</span> <span class="nb">bytes</span><span class="p">,</span> <span class="n">n</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;common method for reading SPCs&quot;&quot;&quot;</span>
        <span class="n">n</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_read_dual_card</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_read_spc_nx</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_read_spc_msc</span><span class="p">,</span>
                                 <span class="s1">&#39;SPC&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_add_constraint_spc_object</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">n</span>

    <span class="k">def</span> <span class="nf">_read_spc_msc</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">n</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;SPC(5501,55,16) - Record 44</span>

<span class="sd">        1 SID   I    Set identification number</span>
<span class="sd">        2 ID    I    Grid or scalar point identification number</span>
<span class="sd">        3 C     I    Component numbers</span>
<span class="sd">        4 UNDEF none Not used</span>
<span class="sd">        5 D     RX   Enforced displacement</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">ntotal</span> <span class="o">=</span> <span class="mi">20</span>
        <span class="n">nentries</span> <span class="o">=</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">)</span> <span class="o">-</span> <span class="n">n</span><span class="p">)</span> <span class="o">//</span> <span class="n">ntotal</span>
        <span class="k">assert</span> <span class="n">nentries</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">,</span> <span class="n">nentries</span>
        <span class="k">assert</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">)</span> <span class="o">-</span> <span class="n">n</span><span class="p">)</span> <span class="o">%</span> <span class="n">ntotal</span> <span class="o">==</span> <span class="mi">0</span>
        <span class="c1">#self.show_data(data, types=&#39;if&#39;)</span>

        <span class="n">constraints</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">struc</span> <span class="o">=</span> <span class="n">Struct</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_endian</span> <span class="o">+</span> <span class="sa">b</span><span class="s1">&#39;iiiif&#39;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">unused_i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nentries</span><span class="p">):</span>
            <span class="n">edata</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">n</span><span class="p">:</span><span class="n">n</span> <span class="o">+</span> <span class="n">ntotal</span><span class="p">]</span>
            <span class="p">(</span><span class="n">sid</span><span class="p">,</span> <span class="n">nid</span><span class="p">,</span> <span class="n">comp</span><span class="p">,</span> <span class="n">xxx</span><span class="p">,</span> <span class="n">dx</span><span class="p">)</span> <span class="o">=</span> <span class="n">struc</span><span class="o">.</span><span class="n">unpack</span><span class="p">(</span><span class="n">edata</span><span class="p">)</span>
            <span class="k">assert</span> <span class="n">xxx</span> <span class="o">==</span> <span class="mi">0</span><span class="p">,</span> <span class="n">xxx</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_debug_file</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">binary_debug</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;SPC-MSC sid=</span><span class="si">%s</span><span class="s1"> id=</span><span class="si">%s</span><span class="s1"> comp=</span><span class="si">%s</span><span class="s1"> dx=</span><span class="si">%s</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span>
                    <span class="n">sid</span><span class="p">,</span> <span class="n">nid</span><span class="p">,</span> <span class="n">comp</span><span class="p">,</span> <span class="n">dx</span><span class="p">))</span>
            <span class="k">assert</span> <span class="n">comp</span> <span class="o">!=</span> <span class="mi">7</span><span class="p">,</span> <span class="s1">&#39;SPC-MSC sid=</span><span class="si">%s</span><span class="s1"> id=</span><span class="si">%s</span><span class="s1"> comp=</span><span class="si">%s</span><span class="s1"> dx=</span><span class="si">%s</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">sid</span><span class="p">,</span> <span class="n">nid</span><span class="p">,</span> <span class="n">comp</span><span class="p">,</span> <span class="n">dx</span><span class="p">)</span>
            <span class="n">constraint</span> <span class="o">=</span> <span class="n">SPC</span><span class="o">.</span><span class="n">add_op2_data</span><span class="p">([</span><span class="n">sid</span><span class="p">,</span> <span class="n">nid</span><span class="p">,</span> <span class="n">comp</span><span class="p">,</span> <span class="n">dx</span><span class="p">])</span>
            <span class="n">constraints</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">constraint</span><span class="p">)</span>
            <span class="n">n</span> <span class="o">+=</span> <span class="n">ntotal</span>
        <span class="k">return</span> <span class="n">n</span><span class="p">,</span> <span class="n">constraints</span>

    <span class="k">def</span> <span class="nf">_read_spc_nx</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">n</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;SPC(5501,55,16) - Record 44</span>

<span class="sd">        1 SID I  Set identification number</span>
<span class="sd">        2 ID  I  Grid or scalar point identification number</span>
<span class="sd">        3 C   I  Component numbers</span>
<span class="sd">        4 D   RS Enforced displacement</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">msg</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
        <span class="n">ntotal</span> <span class="o">=</span> <span class="mi">16</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">factor</span>
        <span class="n">ndatai</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">)</span> <span class="o">-</span> <span class="n">n</span>
        <span class="n">nentries</span> <span class="o">=</span> <span class="n">ndatai</span> <span class="o">//</span> <span class="n">ntotal</span>
        <span class="k">assert</span> <span class="n">nentries</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">,</span> <span class="n">nentries</span>
        <span class="k">assert</span> <span class="n">ndatai</span> <span class="o">%</span> <span class="n">ntotal</span> <span class="o">==</span> <span class="mi">0</span>
        <span class="c1">#self.show_data(data, types=&#39;if&#39;)</span>

        <span class="n">struc</span> <span class="o">=</span> <span class="n">Struct</span><span class="p">(</span><span class="n">mapfmt</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_endian</span> <span class="o">+</span> <span class="sa">b</span><span class="s1">&#39;iiif&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">size</span><span class="p">))</span>
        <span class="n">constraints</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">def</span> <span class="nf">check_component</span><span class="p">(</span><span class="n">component</span><span class="p">,</span> <span class="n">msg</span><span class="p">):</span>
            <span class="n">scomponent</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">component</span><span class="p">)</span>
            <span class="n">sorted_components</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">scomponent</span><span class="p">))</span>
            <span class="n">ssorted_components</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">sorted_components</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">component</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">11</span><span class="p">,</span> <span class="mi">22</span><span class="p">,</span> <span class="mi">33</span><span class="p">,</span> <span class="mi">44</span><span class="p">,</span> <span class="mi">66</span><span class="p">]:</span>
                <span class="c1"># 11 : C:\Users\sdoyle\Dropbox\move_tpl\ifct23.op2</span>
                <span class="c1"># 22 : C:\Users\sdoyle\Dropbox\move_tpl\ifcpi44.op2</span>
                <span class="c1"># 33 : C:\Users\sdoyle\Dropbox\move_tpl\ifcq11.op2</span>
                <span class="c1"># 44 : C:\Users\sdoyle\Dropbox\move_tpl\pshp54.op2</span>
                <span class="c1"># 66 : C:\Users\sdoyle\Dropbox\move_tpl\ifsh12p.op2</span>
                <span class="k">pass</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">msg2</span> <span class="o">=</span> <span class="n">msg</span> <span class="o">+</span> <span class="s1">&#39;scomponent=</span><span class="si">%r</span><span class="s1"> sorted_components=</span><span class="si">%r</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">scomponent</span><span class="p">,</span> <span class="n">ssorted_components</span><span class="p">)</span>
                <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">scomponent</span><span class="p">)</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="n">ssorted_components</span><span class="p">),</span> <span class="n">msg2</span>
            <span class="k">for</span> <span class="n">componenti</span> <span class="ow">in</span> <span class="n">scomponent</span><span class="p">:</span>
                <span class="c1"># 8 : C:\Users\sdoyle\Dropbox\move_tpl\beamp13.op2</span>
                <span class="c1"># 9 : C:\Users\sdoyle\Dropbox\move_tpl\ifcq11r.op2</span>
                <span class="k">assert</span> <span class="n">componenti</span> <span class="ow">in</span> <span class="s1">&#39;0123456789&#39;</span><span class="p">,</span> <span class="n">msg</span>

        <span class="k">for</span> <span class="n">unused_i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nentries</span><span class="p">):</span>
            <span class="n">edata</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">n</span><span class="p">:</span><span class="n">n</span> <span class="o">+</span> <span class="n">ntotal</span><span class="p">]</span>
            <span class="p">(</span><span class="n">sid</span><span class="p">,</span> <span class="n">nid</span><span class="p">,</span> <span class="n">comp</span><span class="p">,</span> <span class="n">dx</span><span class="p">)</span> <span class="o">=</span> <span class="n">struc</span><span class="o">.</span><span class="n">unpack</span><span class="p">(</span><span class="n">edata</span><span class="p">)</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_debug_file</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">binary_debug</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;SPC-NX sid=</span><span class="si">%s</span><span class="s1"> nid=</span><span class="si">%s</span><span class="s1"> comp=</span><span class="si">%s</span><span class="s1"> dx=</span><span class="si">%s</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span>
                    <span class="n">sid</span><span class="p">,</span> <span class="n">nid</span><span class="p">,</span> <span class="n">comp</span><span class="p">,</span> <span class="n">dx</span><span class="p">))</span>

            <span class="n">msg</span> <span class="o">=</span> <span class="s1">&#39;SPC-NX sid=</span><span class="si">%s</span><span class="s1"> nid=</span><span class="si">%s</span><span class="s1"> comp=</span><span class="si">%s</span><span class="s1"> dx=</span><span class="si">%s</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">sid</span><span class="p">,</span> <span class="n">nid</span><span class="p">,</span> <span class="n">comp</span><span class="p">,</span> <span class="n">dx</span><span class="p">)</span>
            <span class="n">check_component</span><span class="p">(</span><span class="n">comp</span><span class="p">,</span> <span class="n">msg</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">nid</span> <span class="o">&gt;</span> <span class="mi">100000000</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_is_long_ids</span> <span class="o">=</span> <span class="kc">True</span>
            <span class="n">constraint</span> <span class="o">=</span> <span class="n">SPC</span><span class="o">.</span><span class="n">add_op2_data</span><span class="p">([</span><span class="n">sid</span><span class="p">,</span> <span class="n">nid</span><span class="p">,</span> <span class="n">comp</span><span class="p">,</span> <span class="n">dx</span><span class="p">])</span>
            <span class="n">constraints</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">constraint</span><span class="p">)</span>
            <span class="c1">#msg += &#39;  SPC-NX sid=%s nid=%s comp=%s dx=%s\n&#39; % (sid, nid, comp, dx)</span>
            <span class="c1">#else:</span>
                <span class="c1">#msg += &#39;  SPC-NX sid=%s nid=%s comp=%s dx=%s\n&#39; % (sid, nid, comp, dx)</span>
            <span class="n">n</span> <span class="o">+=</span> <span class="n">ntotal</span>
        <span class="c1">#if msg:</span>
            <span class="c1">#self.log.warning(&#39;Invalid Node IDs; skipping\n&#39; + msg)</span>
        <span class="c1">#self.to_nx()</span>
        <span class="k">return</span> <span class="n">n</span><span class="p">,</span> <span class="n">constraints</span>

    <span class="k">def</span> <span class="nf">_read_spcoff1</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">:</span> <span class="nb">bytes</span><span class="p">,</span> <span class="n">n</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        SPCOFF1(6210, 62, 344) - Record</span>
<span class="sd">        see SPC1</span>

<span class="sd">        Record - SPC1(5481,58,12)</span>
<span class="sd">        Word Name Type Description</span>
<span class="sd">        1 SID I Set identification number  &lt;------ removing...</span>
<span class="sd">        2 C I Component numbers</span>
<span class="sd">        3 THRUFLAG I Thru range flag</span>
<span class="sd">        THRUFLAG=0 No</span>
<span class="sd">        4 ID I Grid or scalar point identification number</span>
<span class="sd">        Word 4 repeats until End of Record</span>
<span class="sd">        THRUFLAG=1 Yes</span>
<span class="sd">        4 ID1 I First grid or scalar point identification number</span>
<span class="sd">        5 ID2 I Second grid or scalar point identification number</span>
<span class="sd">        End THRUFLAG</span>

<span class="sd">        Word Name Type Description</span>
<span class="sd">        1 C I Component numbers</span>
<span class="sd">        2 THRUFLAG I Thru range flag</span>
<span class="sd">        THRUFLAG=0 No</span>
<span class="sd">        3 ID I Grid or scalar point identification number</span>
<span class="sd">        Word 3 repeats until End of Record</span>
<span class="sd">        THRUFLAG=1 Yes</span>
<span class="sd">        3 ID1 I First grid or scalar point identification number</span>
<span class="sd">        4 ID2 I Second grid or scalar point identification number</span>
<span class="sd">        End THRUFLAG</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1">#nentries = 0</span>
        <span class="c1">#nints = (len(data) - n) // 4</span>
        <span class="n">idata</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">frombuffer</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">n</span><span class="p">:],</span> <span class="bp">self</span><span class="o">.</span><span class="n">idtype</span><span class="p">)</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">idata</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>
            <span class="n">idata</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">hstack</span><span class="p">([</span><span class="n">idata</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">])</span>
        <span class="n">iminus1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">idata</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">iminus1</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">,</span> <span class="n">idata</span>

        <span class="n">i</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">hstack</span><span class="p">([[</span><span class="mi">0</span><span class="p">],</span> <span class="n">iminus1</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span><span class="mi">1</span><span class="p">])</span>
        <span class="n">j</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">hstack</span><span class="p">([</span><span class="n">iminus1</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="o">-</span><span class="mi">1</span><span class="p">])</span>
        <span class="k">for</span> <span class="n">ii</span><span class="p">,</span> <span class="n">jj</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">):</span>
            <span class="n">outi</span> <span class="o">=</span> <span class="n">idata</span><span class="p">[</span><span class="n">ii</span><span class="p">:</span><span class="n">jj</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_add_spcoff1_card</span><span class="p">(</span><span class="n">outi</span><span class="p">)</span>
        <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_add_spcoff1_card</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">out</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;helper method for ``_read_spcoff1``&quot;&quot;&quot;</span>
        <span class="n">components</span><span class="p">,</span> <span class="n">thru_flag</span> <span class="o">=</span> <span class="n">out</span><span class="p">[:</span><span class="mi">2</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">thru_flag</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>  <span class="c1"># repeat 4 to end</span>
            <span class="n">nids</span> <span class="o">=</span> <span class="n">out</span><span class="p">[</span><span class="mi">2</span><span class="p">:]</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
            <span class="n">thru_check</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="k">elif</span> <span class="n">thru_flag</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">n1</span> <span class="o">=</span> <span class="n">out</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
            <span class="n">n2</span> <span class="o">=</span> <span class="n">out</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span>
            <span class="n">nids</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">n1</span><span class="p">,</span> <span class="n">n2</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span>
            <span class="n">thru_check</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="s1">&#39;SPCOFF1; thru_flag=</span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">thru_flag</span><span class="p">)</span>

        <span class="k">assert</span> <span class="o">-</span><span class="mi">1</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">out</span><span class="p">,</span> <span class="n">out</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_debug_file</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">binary_debug</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;SPCOFF1: components=</span><span class="si">%s</span><span class="s1"> thru_flag=</span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span>
                <span class="n">components</span><span class="p">,</span> <span class="n">thru_flag</span><span class="p">))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">binary_debug</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;   nids=</span><span class="si">%s</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="nb">str</span><span class="p">(</span><span class="n">nids</span><span class="p">))</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">nids</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="c1">#self.log.warning(&#39;skipping SPC1 because its empty...%s&#39; % out)</span>
            <span class="k">return</span>
        <span class="k">if</span> <span class="nb">max</span><span class="p">(</span><span class="n">nids</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">100000000</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_is_long_ids</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="n">in_data</span> <span class="o">=</span> <span class="p">[</span><span class="n">components</span><span class="p">,</span> <span class="n">nids</span><span class="p">]</span>
        <span class="n">constraint</span> <span class="o">=</span> <span class="n">SPCOFF1</span><span class="o">.</span><span class="n">add_op2_data</span><span class="p">(</span><span class="n">in_data</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_add_constraint_spcoff_object</span><span class="p">(</span><span class="n">constraint</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">increase_card_count</span><span class="p">(</span><span class="s1">&#39;SPCOFF1&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">thru_check</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">out</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">5</span><span class="p">:</span>
            <span class="c1">#card = out[5:]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_add_spcoff1_card</span><span class="p">(</span><span class="n">out</span><span class="p">[</span><span class="mi">5</span><span class="p">:])</span>

    <span class="k">def</span> <span class="nf">_read_spc1</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">:</span> <span class="nb">bytes</span><span class="p">,</span> <span class="n">n</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
        <span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        SPC1(5481,58,12) - Record 45</span>

<span class="sd">        odd case = (</span>
<span class="sd">            # sid, comp, thru_flag</span>
<span class="sd">            12, 12345, 0, 110039, 110040, 110041, 110042, 110043, 110044, 110045,</span>
<span class="sd">                          110046, 110047, 110048, 110049, -1,</span>
<span class="sd">            # sid, comp, thru_flag, ???</span>
<span class="sd">            12, 12345, 0, -1)</span>

<span class="sd">        F:\work\pyNastran\pyNastran\master2\pyNastran\bdf\test\nx_spike\out_acmsnnns.op2</span>

<span class="sd">        [1, 123456, 0, 31, 35, 39, 43, 47, 48, 53, 63, 64, 69, 70, 71, 72, -1,</span>
<span class="sd">         3, 456, 1, 1]</span>
<span class="sd">        TestOP2.test_op2_solid_bending_02_geom</span>

<span class="sd">        [123456, 456, 1, 5, 13,</span>
<span class="sd">         123456, 123456, 0, 22, 23, 24, 25, -1]</span>
<span class="sd">        TestOP2.test_op2_solid_shell_bar_01_geom</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1">#nentries = 0</span>
        <span class="c1">#nints = (len(data) - n) // 4</span>
        <span class="n">idata</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">frombuffer</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">n</span><span class="p">:],</span> <span class="bp">self</span><span class="o">.</span><span class="n">idtype8</span><span class="p">)</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">idata</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>
            <span class="n">idata</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">hstack</span><span class="p">([</span><span class="n">idata</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">])</span>
        <span class="n">iminus1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">idata</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">iminus1</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">,</span> <span class="n">idata</span>

        <span class="n">i</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">hstack</span><span class="p">([[</span><span class="mi">0</span><span class="p">],</span> <span class="n">iminus1</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span><span class="mi">1</span><span class="p">])</span>
        <span class="n">j</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">hstack</span><span class="p">([</span><span class="n">iminus1</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="o">-</span><span class="mi">1</span><span class="p">])</span>
        <span class="k">for</span> <span class="n">ii</span><span class="p">,</span> <span class="n">jj</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">):</span>
            <span class="n">outi</span> <span class="o">=</span> <span class="n">idata</span><span class="p">[</span><span class="n">ii</span><span class="p">:</span><span class="n">jj</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_add_spc1_card</span><span class="p">(</span><span class="n">outi</span><span class="p">)</span>
        <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_add_spc1_card</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">out</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;helper method for ``_read_spc1``&quot;&quot;&quot;</span>
        <span class="n">sid</span><span class="p">,</span> <span class="n">components</span> <span class="o">=</span> <span class="n">out</span><span class="p">[:</span><span class="mi">2</span><span class="p">]</span>
        <span class="n">thru_flag</span> <span class="o">=</span> <span class="n">out</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">thru_flag</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>  <span class="c1"># repeat 4 to end</span>
            <span class="n">nids</span> <span class="o">=</span> <span class="n">out</span><span class="p">[</span><span class="mi">3</span><span class="p">:]</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
            <span class="n">thru_check</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="k">elif</span> <span class="n">thru_flag</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">n1</span> <span class="o">=</span> <span class="n">out</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span>
            <span class="n">n2</span> <span class="o">=</span> <span class="n">out</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span>
            <span class="n">nids</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">n1</span><span class="p">,</span> <span class="n">n2</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span>
            <span class="n">thru_check</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="s1">&#39;SPC1; thru_flag=</span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">thru_flag</span><span class="p">)</span>

        <span class="k">assert</span> <span class="o">-</span><span class="mi">1</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">out</span><span class="p">,</span> <span class="n">out</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_debug_file</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">binary_debug</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;SPC1: sid=</span><span class="si">%s</span><span class="s1"> components=</span><span class="si">%s</span><span class="s1"> thru_flag=</span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span>
                <span class="n">sid</span><span class="p">,</span> <span class="n">components</span><span class="p">,</span> <span class="n">thru_flag</span><span class="p">))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">binary_debug</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;   nids=</span><span class="si">%s</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="nb">str</span><span class="p">(</span><span class="n">nids</span><span class="p">))</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">nids</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="c1">#self.log.warning(&#39;skipping SPC1 because its empty...%s&#39; % out)</span>
            <span class="k">return</span>
        <span class="n">in_data</span> <span class="o">=</span> <span class="p">[</span><span class="n">sid</span><span class="p">,</span> <span class="n">components</span><span class="p">,</span> <span class="n">nids</span><span class="p">]</span>
        <span class="n">constraint</span> <span class="o">=</span> <span class="n">SPC1</span><span class="o">.</span><span class="n">add_op2_data</span><span class="p">(</span><span class="n">in_data</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_add_constraint_spc_object</span><span class="p">(</span><span class="n">constraint</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">increase_card_count</span><span class="p">(</span><span class="s1">&#39;SPC1&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">thru_check</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">out</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">5</span><span class="p">:</span>
            <span class="c1">#card = out[5:]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_add_spc1_card</span><span class="p">(</span><span class="n">out</span><span class="p">[</span><span class="mi">5</span><span class="p">:])</span>

    <span class="k">def</span> <span class="nf">_read_spcadd</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">:</span> <span class="nb">bytes</span><span class="p">,</span> <span class="n">n</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;SPCADD(5491,59,13) - Record 46&quot;&quot;&quot;</span>
        <span class="c1">#nentries = (len(data) - n) // 4</span>
        <span class="n">datai</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">frombuffer</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">n</span><span class="p">:],</span> <span class="bp">self</span><span class="o">.</span><span class="n">idtype8</span><span class="p">)</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="n">_read_spcadd_mpcadd</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;SPCADD&#39;</span><span class="p">,</span> <span class="n">datai</span><span class="p">)</span>
        <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_read_spcd</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">:</span> <span class="nb">bytes</span><span class="p">,</span> <span class="n">n</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;common method for reading SPCDs&quot;&quot;&quot;</span>
        <span class="n">n</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_read_dual_card</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_read_spcd_nx</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_read_spcd_msc</span><span class="p">,</span>
                                 <span class="s1">&#39;SPCD&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_add_load_object</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">n</span>

    <span class="k">def</span> <span class="nf">_read_spcd_nx</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">n</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;SPCD(5110,51,256) - NX specific&quot;&quot;&quot;</span>
        <span class="n">struct_3if</span> <span class="o">=</span> <span class="n">Struct</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_endian</span> <span class="o">+</span> <span class="sa">b</span><span class="s1">&#39;3if&#39;</span><span class="p">)</span>
        <span class="n">ntotal</span> <span class="o">=</span> <span class="mi">16</span> <span class="c1"># 4*4</span>
        <span class="n">nentries</span> <span class="o">=</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">)</span> <span class="o">-</span> <span class="n">n</span><span class="p">)</span> <span class="o">//</span> <span class="n">ntotal</span>
        <span class="k">assert</span> <span class="n">nentries</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">,</span> <span class="n">nentries</span>
        <span class="k">assert</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">)</span> <span class="o">-</span> <span class="n">n</span><span class="p">)</span> <span class="o">%</span> <span class="n">ntotal</span> <span class="o">==</span> <span class="mi">0</span>
        <span class="n">constraints</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">is_long_ids</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="k">for</span> <span class="n">unused_i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nentries</span><span class="p">):</span>
            <span class="n">edata</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">n</span><span class="p">:</span><span class="n">n</span> <span class="o">+</span> <span class="n">ntotal</span><span class="p">]</span>
            <span class="n">out</span> <span class="o">=</span> <span class="n">struct_3if</span><span class="o">.</span><span class="n">unpack</span><span class="p">(</span><span class="n">edata</span><span class="p">)</span>
            <span class="p">(</span><span class="n">sid</span><span class="p">,</span> <span class="n">node_id</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">dx</span><span class="p">)</span> <span class="o">=</span> <span class="n">out</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_debug_file</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">binary_debug</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;  SPCD-NX=</span><span class="si">%s</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="nb">str</span><span class="p">(</span><span class="n">out</span><span class="p">))</span>

            <span class="k">if</span> <span class="n">node_id</span> <span class="o">&gt;</span> <span class="mi">100000000</span><span class="p">:</span>
                <span class="n">is_long_ids</span> <span class="o">=</span> <span class="kc">True</span>
            <span class="n">constraint</span> <span class="o">=</span> <span class="n">SPCD</span><span class="o">.</span><span class="n">add_op2_data</span><span class="p">([</span><span class="n">sid</span><span class="p">,</span> <span class="n">node_id</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">dx</span><span class="p">])</span>
            <span class="n">constraints</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">constraint</span><span class="p">)</span>
            <span class="n">n</span> <span class="o">+=</span> <span class="n">ntotal</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_is_long_ids</span> <span class="o">=</span> <span class="n">is_long_ids</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">to_nx</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">n</span><span class="p">,</span> <span class="n">constraints</span>

    <span class="k">def</span> <span class="nf">_read_spcd_msc</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">n</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        SPCD(5110,51,256) - MSC specific - Record 47</span>

<span class="sd">        Word Name Type Description</span>
<span class="sd">        1 SID   I    Superelement identification number</span>
<span class="sd">        2 ID    I    Grid or scalar point identification number</span>
<span class="sd">        3 C     I    Component numbers</span>
<span class="sd">        4 UNDEF none Not used</span>
<span class="sd">        5 D     RX   Enforced displacement</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">struct_4if</span> <span class="o">=</span> <span class="n">Struct</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_endian</span> <span class="o">+</span> <span class="sa">b</span><span class="s1">&#39;4if&#39;</span><span class="p">)</span>
        <span class="n">ntotal</span> <span class="o">=</span> <span class="mi">20</span> <span class="c1"># 5*4</span>
        <span class="n">nentries</span> <span class="o">=</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">)</span> <span class="o">-</span> <span class="n">n</span><span class="p">)</span> <span class="o">//</span> <span class="n">ntotal</span>
        <span class="k">assert</span> <span class="n">nentries</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">,</span> <span class="n">nentries</span>
        <span class="k">assert</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">)</span> <span class="o">-</span> <span class="n">n</span><span class="p">)</span> <span class="o">%</span> <span class="n">ntotal</span> <span class="o">==</span> <span class="mi">0</span>
        <span class="n">constraints</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">unused_i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nentries</span><span class="p">):</span>
            <span class="n">edata</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">n</span><span class="p">:</span><span class="n">n</span> <span class="o">+</span> <span class="n">ntotal</span><span class="p">]</span>
            <span class="n">out</span> <span class="o">=</span> <span class="n">struct_4if</span><span class="o">.</span><span class="n">unpack</span><span class="p">(</span><span class="n">edata</span><span class="p">)</span>
            <span class="p">(</span><span class="n">sid</span><span class="p">,</span> <span class="n">ID</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">xxx</span><span class="p">,</span> <span class="n">dx</span><span class="p">)</span> <span class="o">=</span> <span class="n">out</span>
            <span class="k">assert</span> <span class="n">xxx</span> <span class="o">==</span> <span class="mi">0</span><span class="p">,</span> <span class="n">xxx</span>

            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_debug_file</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">binary_debug</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;  SPCD-MSC=</span><span class="si">%s</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="nb">str</span><span class="p">(</span><span class="n">out</span><span class="p">))</span>
            <span class="n">constraint</span> <span class="o">=</span> <span class="n">SPCD</span><span class="o">.</span><span class="n">add_op2_data</span><span class="p">([</span><span class="n">sid</span><span class="p">,</span> <span class="n">ID</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">dx</span><span class="p">])</span>
            <span class="n">constraints</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">constraint</span><span class="p">)</span>
            <span class="n">n</span> <span class="o">+=</span> <span class="n">ntotal</span>
        <span class="k">return</span> <span class="n">n</span><span class="p">,</span> <span class="n">constraints</span>

    <span class="k">def</span> <span class="nf">_read_spcde</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">:</span> <span class="nb">bytes</span><span class="p">,</span> <span class="n">n</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s1">&#39;skipping SPCDE in GEOM4&#39;</span><span class="p">)</span>
        <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_read_spcf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">:</span> <span class="nb">bytes</span><span class="p">,</span> <span class="n">n</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s1">&#39;skipping SPCDF in GEOM4&#39;</span><span class="p">)</span>
        <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_read_spcdg</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">:</span> <span class="nb">bytes</span><span class="p">,</span> <span class="n">n</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s1">&#39;skipping SPCDG in GEOM4&#39;</span><span class="p">)</span>
        <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_read_spce</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">:</span> <span class="nb">bytes</span><span class="p">,</span> <span class="n">n</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s1">&#39;skipping SPCE in GEOM4&#39;</span><span class="p">)</span>
        <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_read_spceb</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">:</span> <span class="nb">bytes</span><span class="p">,</span> <span class="n">n</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s1">&#39;skipping SPCEB in GEOM4&#39;</span><span class="p">)</span>
        <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_read_spcfb</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">:</span> <span class="nb">bytes</span><span class="p">,</span> <span class="n">n</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s1">&#39;skipping SPCFB in GEOM4&#39;</span><span class="p">)</span>
        <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_read_spcgb</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">:</span> <span class="nb">bytes</span><span class="p">,</span> <span class="n">n</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s1">&#39;skipping SPCGB in GEOM4&#39;</span><span class="p">)</span>
        <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_read_spcgrid</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">:</span> <span class="nb">bytes</span><span class="p">,</span> <span class="n">n</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s1">&#39;skipping SPCGRID in GEOM4&#39;</span><span class="p">)</span>
        <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_read_suport</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">:</span> <span class="nb">bytes</span><span class="p">,</span> <span class="n">n</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;SUPORT(5601,56, 14) - Record 59&quot;&quot;&quot;</span>
        <span class="n">nentries</span> <span class="o">=</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">)</span> <span class="o">-</span> <span class="n">n</span><span class="p">)</span> <span class="o">//</span> <span class="mi">8</span> <span class="c1"># 2*4</span>
        <span class="n">struct_2i</span> <span class="o">=</span> <span class="n">Struct</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_endian</span> <span class="o">+</span> <span class="sa">b</span><span class="s1">&#39;2i&#39;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">unused_i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nentries</span><span class="p">):</span>
            <span class="n">out</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">struct_2i</span><span class="o">.</span><span class="n">unpack</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">n</span><span class="p">:</span><span class="n">n</span> <span class="o">+</span> <span class="mi">8</span><span class="p">]))</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_debug_file</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">binary_debug</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;  SUPORT=</span><span class="si">%s</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="nb">str</span><span class="p">(</span><span class="n">out</span><span class="p">))</span>
                <span class="c1">#self.log.info(out)</span>
            <span class="n">suport</span> <span class="o">=</span> <span class="n">SUPORT</span><span class="o">.</span><span class="n">add_op2_data</span><span class="p">(</span><span class="n">out</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_add_suport_object</span><span class="p">(</span><span class="n">suport</span><span class="p">)</span> <span class="c1"># extracts [sid, c]</span>
            <span class="n">n</span> <span class="o">+=</span> <span class="mi">8</span>
        <span class="k">return</span> <span class="n">n</span>

    <span class="k">def</span> <span class="nf">_read_suport1</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">:</span> <span class="nb">bytes</span><span class="p">,</span> <span class="n">n</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;SUPORT1(10100,101,472) - Record 60&quot;&quot;&quot;</span>
        <span class="n">nfields</span> <span class="o">=</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">)</span> <span class="o">-</span> <span class="n">n</span><span class="p">)</span> <span class="o">//</span> <span class="mi">4</span> <span class="o">-</span> <span class="mi">2</span>
        <span class="n">out</span> <span class="o">=</span> <span class="n">unpack</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_endian</span> <span class="o">+</span> <span class="sa">b</span><span class="s1">&#39;</span><span class="si">%i</span><span class="s1">i&#39;</span> <span class="o">%</span> <span class="n">nfields</span><span class="p">,</span> <span class="n">data</span><span class="p">[</span><span class="n">n</span><span class="p">:</span><span class="n">n</span><span class="o">+</span><span class="n">nfields</span><span class="o">*</span><span class="mi">4</span><span class="p">])</span>

        <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">nsuports</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">suport</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">while</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">out</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">out</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>
                <span class="k">assert</span> <span class="n">out</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">out</span>
                <span class="n">suporti</span> <span class="o">=</span> <span class="n">SUPORT1</span><span class="o">.</span><span class="n">add_op2_data</span><span class="p">(</span><span class="n">suport</span><span class="p">)</span>
                <span class="c1">#self.log.info(suporti)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_add_suport_object</span><span class="p">(</span><span class="n">suporti</span><span class="p">)</span> <span class="c1"># extracts [sid, nid, c]</span>
                <span class="n">nsuports</span> <span class="o">+=</span> <span class="mi">1</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_debug_file</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">binary_debug</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;  SUPORT1=</span><span class="si">%s</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="nb">str</span><span class="p">(</span><span class="n">suport</span><span class="p">))</span>
                <span class="n">suport</span> <span class="o">=</span> <span class="p">[]</span>
                <span class="n">i</span> <span class="o">+=</span> <span class="mi">2</span>
                <span class="k">continue</span>
            <span class="n">suport</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">out</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
            <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="k">assert</span> <span class="o">-</span><span class="mi">1</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">suport</span><span class="p">,</span> <span class="n">suport</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_debug_file</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">binary_debug</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;  SUPORT1=</span><span class="si">%s</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="nb">str</span><span class="p">(</span><span class="n">suport</span><span class="p">))</span>

        <span class="n">suporti</span> <span class="o">=</span> <span class="n">SUPORT1</span><span class="o">.</span><span class="n">add_op2_data</span><span class="p">(</span><span class="n">suport</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_add_suport_object</span><span class="p">(</span><span class="n">suporti</span><span class="p">)</span> <span class="c1"># extracts [sid, nid, c]</span>
        <span class="n">nsuports</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">card_count</span><span class="p">[</span><span class="s1">&#39;SUPOT1&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">nsuports</span>
        <span class="k">assert</span> <span class="n">n</span><span class="o">+</span><span class="n">nfields</span><span class="o">*</span><span class="mi">4</span><span class="o">+</span><span class="mi">8</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">),</span> <span class="s1">&#39;a=</span><span class="si">%s</span><span class="s1"> b=</span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">n</span><span class="o">+</span><span class="n">nfields</span><span class="o">*</span><span class="mi">4</span><span class="o">+</span><span class="mi">8</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">))</span>
        <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_read_tempbc</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">:</span> <span class="nb">bytes</span><span class="p">,</span> <span class="n">n</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s1">&#39;skipping TEMPBC in GEOM4&#39;</span><span class="p">)</span>
        <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_read_uset</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">:</span> <span class="nb">bytes</span><span class="p">,</span> <span class="n">n</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        USET(2010,20,193) - Record 63</span>
<span class="sd">        (sid, nid, comp), ...</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">struct_3i</span> <span class="o">=</span> <span class="n">Struct</span><span class="p">(</span><span class="n">mapfmt</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_endian</span> <span class="o">+</span> <span class="sa">b</span><span class="s1">&#39;3i&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">size</span><span class="p">))</span>
        <span class="n">ntotal</span> <span class="o">=</span> <span class="mi">12</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">factor</span>
        <span class="c1">#self.show_data(data, types=&#39;is&#39;)</span>
        <span class="n">nelements</span> <span class="o">=</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">)</span> <span class="o">-</span> <span class="n">n</span><span class="p">)</span> <span class="o">//</span> <span class="n">ntotal</span>
        <span class="k">for</span> <span class="n">unused_i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nelements</span><span class="p">):</span>
            <span class="n">edata</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">n</span><span class="p">:</span><span class="n">n</span> <span class="o">+</span> <span class="n">ntotal</span><span class="p">]</span>
            <span class="n">out</span> <span class="o">=</span> <span class="n">struct_3i</span><span class="o">.</span><span class="n">unpack</span><span class="p">(</span><span class="n">edata</span><span class="p">)</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_debug_file</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">binary_debug</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;  USET=</span><span class="si">%s</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="nb">str</span><span class="p">(</span><span class="n">out</span><span class="p">))</span>
            <span class="c1">#(sid, id, component) = out</span>
            <span class="n">set_obj</span> <span class="o">=</span> <span class="n">USET</span><span class="o">.</span><span class="n">add_op2_data</span><span class="p">(</span><span class="n">out</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_add_uset_object</span><span class="p">(</span><span class="n">set_obj</span><span class="p">)</span>
            <span class="n">n</span> <span class="o">+=</span> <span class="n">ntotal</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">increase_card_count</span><span class="p">(</span><span class="s1">&#39;USET&#39;</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">usets</span><span class="p">))</span>
        <span class="k">return</span> <span class="n">n</span>

    <span class="k">def</span> <span class="nf">_read_seqset1b</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">:</span> <span class="nb">bytes</span><span class="p">,</span> <span class="n">n</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>  <span class="c1"># pragma: no cover</span>
        <span class="sd">&quot;&quot;&quot;</span>

<span class="sd">        SEQSET1(1210,12,322)</span>
<span class="sd">        SESET, 0, 120</span>
<span class="sd">        SEQSET1, 11, 0, 2001, THRU, 2008</span>

<span class="sd">        (5561, 76, 0, 120, -1,</span>
<span class="sd">         2001, -1,</span>
<span class="sd">         2002, -1,</span>
<span class="sd">         2003, -1,</span>
<span class="sd">         2004, -1,</span>
<span class="sd">         2005, -1,</span>
<span class="sd">         2006, -1,</span>
<span class="sd">         2007, -1,</span>
<span class="sd">         2008, -1)</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1">#C:\NASA\m4\formats\git\examples\move_tpl\fsp11j.op2</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">show_data</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
        <span class="c1">#sss</span>

    <span class="k">def</span> <span class="nf">_read_uset1</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">:</span> <span class="nb">bytes</span><span class="p">,</span> <span class="n">n</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;USET1(2110,21,194) - Record 65</span>

<span class="sd">        odd case = (</span>
<span class="sd">            # sid, comp, thru_flag</span>
<span class="sd">            12, 12345, 0, 110039, 110040, 110041, 110042, 110043, 110044, 110045,</span>
<span class="sd">                          110046, 110047, 110048, 110049, -1,</span>
<span class="sd">            # sid, comp, thru_flag, ???</span>
<span class="sd">            12, 12345, 0, -1)</span>

<span class="sd">        data =(2110, 21, 194,</span>
<span class="sd">               2.0, 123456, 0, 44, 45, 48, 49, -1)</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">assert</span> <span class="bp">self</span><span class="o">.</span><span class="n">factor</span> <span class="o">==</span> <span class="mi">1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">factor</span>
        <span class="n">nentries</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">size</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">size</span>
        <span class="n">ints</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">frombuffer</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">n</span><span class="p">:],</span> <span class="bp">self</span><span class="o">.</span><span class="n">idtype8</span><span class="p">)</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="n">floats</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">frombuffer</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">n</span><span class="p">:],</span> <span class="bp">self</span><span class="o">.</span><span class="n">fdtype8</span><span class="p">)</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="c1">#print(&#39;ints = %s&#39; % ints)</span>
        <span class="n">nidata</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">ints</span><span class="p">)</span>
        <span class="k">while</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">nidata</span><span class="p">:</span>
            <span class="n">sname</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">n</span><span class="o">+</span><span class="n">i</span><span class="o">*</span><span class="n">size</span> <span class="p">:</span> <span class="n">n</span><span class="o">+</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">size</span><span class="p">]</span>
            <span class="n">sname_str</span> <span class="o">=</span> <span class="s1">&#39;U</span><span class="si">%i</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="nb">int</span><span class="p">(</span><span class="n">floats</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
            <span class="c1">#print(&#39;sname_str = %r&#39; % sname_str)</span>
            <span class="c1">#print(&#39;sname_str2 = %r&#39; % sname_str2)</span>

            <span class="n">comp</span><span class="p">,</span> <span class="n">thru_flag</span> <span class="o">=</span> <span class="n">ints</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">:</span><span class="n">i</span><span class="o">+</span><span class="mi">3</span><span class="p">]</span>
            <span class="n">comp_str</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">comp</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">comp_stri</span> <span class="ow">in</span> <span class="n">comp_str</span><span class="p">:</span>
                <span class="k">assert</span> <span class="n">comp_stri</span> <span class="ow">in</span> <span class="s1">&#39;123456&#39;</span><span class="p">,</span> <span class="n">comp_str</span>
            <span class="n">i</span> <span class="o">+=</span> <span class="mi">3</span>
            <span class="k">assert</span> <span class="n">thru_flag</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="n">ints</span><span class="p">[:</span><span class="n">i</span><span class="o">+</span><span class="mi">5</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">thru_flag</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>  <span class="c1"># repeat 4 to end</span>
                <span class="n">nid</span> <span class="o">=</span> <span class="n">ints</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
                <span class="n">nids</span> <span class="o">=</span> <span class="p">[</span><span class="n">nid</span><span class="p">]</span>
                <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span>
                <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="n">nidata</span><span class="p">:</span>
                    <span class="k">break</span>
                <span class="k">while</span> <span class="n">ints</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">!=</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>
                    <span class="n">nid</span> <span class="o">=</span> <span class="n">ints</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
                    <span class="n">nids</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">nid</span><span class="p">)</span>
                    <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span>
                <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="k">elif</span> <span class="n">thru_flag</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                <span class="n">n1</span><span class="p">,</span> <span class="n">n2</span> <span class="o">=</span> <span class="n">ints</span><span class="p">[</span><span class="n">i</span><span class="p">:</span><span class="n">i</span><span class="o">+</span><span class="mi">2</span><span class="p">]</span>
                <span class="n">nids</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">n1</span><span class="p">,</span> <span class="n">n2</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span>
                <span class="n">i</span> <span class="o">+=</span> <span class="mi">2</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="s1">&#39;USET1; thru_flag=</span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">thru_flag</span><span class="p">)</span>

            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_debug_file</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">binary_debug</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;USET1: sname=</span><span class="si">%s</span><span class="s1"> comp=</span><span class="si">%s</span><span class="s1"> thru_flag=</span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span>
                    <span class="n">sname_str</span><span class="p">,</span> <span class="n">comp</span><span class="p">,</span> <span class="n">thru_flag</span><span class="p">))</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">binary_debug</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;   nids=</span><span class="si">%s</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="nb">str</span><span class="p">(</span><span class="n">nids</span><span class="p">))</span>
            <span class="c1">#print(&#39;USET1: sid=%s comp=%s thru_flag=%s&#39; % (</span>
            <span class="c1">#    sid, comp, thru_flag))</span>
            <span class="c1">#print(&#39;   nids=%s\n&#39; % str(nids))</span>
            <span class="n">in_data</span> <span class="o">=</span> <span class="p">[</span><span class="n">sname_str</span><span class="p">,</span> <span class="n">comp_str</span><span class="p">,</span> <span class="n">nids</span><span class="p">]</span>
            <span class="c1">#print(in_data)</span>

            <span class="n">constraint</span> <span class="o">=</span> <span class="n">USET1</span><span class="o">.</span><span class="n">add_op2_data</span><span class="p">(</span><span class="n">in_data</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_add_uset_object</span><span class="p">(</span><span class="n">constraint</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">card_count</span><span class="p">[</span><span class="s1">&#39;USET1&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">nentries</span>
        <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>


    <span class="k">def</span> <span class="nf">_read_omit</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">:</span> <span class="nb">bytes</span><span class="p">,</span> <span class="n">n</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s1">&#39;skipping OMIT in GEOM4&#39;</span><span class="p">)</span>
        <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_read_rtrplt</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">:</span> <span class="nb">bytes</span><span class="p">,</span> <span class="n">n</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s1">&#39;skipping RTRPLT in GEOM4&#39;</span><span class="p">)</span>
        <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_read_bndfix</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">:</span> <span class="nb">bytes</span><span class="p">,</span> <span class="n">n</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s1">&#39;skipping BNDFIX in GEOM4&#39;</span><span class="p">)</span>
        <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_read_bndfix1</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">:</span> <span class="nb">bytes</span><span class="p">,</span> <span class="n">n</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s1">&#39;skipping BNDFIX1 in GEOM4&#39;</span><span class="p">)</span>
        <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_read_bndfree</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">:</span> <span class="nb">bytes</span><span class="p">,</span> <span class="n">n</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s1">&#39;skipping BNDFREE in GEOM4&#39;</span><span class="p">)</span>
        <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_read_bltmpc</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">:</span> <span class="nb">bytes</span><span class="p">,</span> <span class="n">n</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s1">&#39;skipping BLTMPC in GEOM4&#39;</span><span class="p">)</span>
        <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">)</span></div>

<div class="viewcode-block" id="read_rbe3s_from_idata_fdata"><a class="viewcode-back" href="../../../../../reference/op2/tables/geom/pyNastran.op2.tables.geom.geom4.html#pyNastran.op2.tables.geom.geom4.read_rbe3s_from_idata_fdata">[docs]</a><span class="k">def</span> <span class="nf">read_rbe3s_from_idata_fdata</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">idata</span><span class="p">,</span> <span class="n">fdata</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    1 EID   I Element identification number</span>
<span class="sd">    2 REFG  I Reference grid point identification number</span>
<span class="sd">    3 REFC  I Component numbers at the reference grid point</span>

<span class="sd">    4 WT1  RS Weighting factor for components of motion at G</span>
<span class="sd">    5 C     I Component numbers</span>
<span class="sd">    6 G     I Grid point identification number</span>
<span class="sd">    Word 6 repeats until -1 occurs</span>

<span class="sd">    Words 4 through 6 repeat until -2 occurs</span>

<span class="sd">    7 GM    I Grid point identification number for dependent degrees-of-freedom</span>
<span class="sd">    8 CM    I Component numbers of dependent degrees-of-freedom</span>

<span class="sd">    Words 7 through 8 repeat until -3 occurs</span>

<span class="sd">    data = [99           99 123456 1.0    123    44    45  48  49  -1    -3]</span>
<span class="sd">    data = [61           71 123456 1.0    123    70    75  77      -1    -3</span>
<span class="sd">            62           71 123456 1.0    123    58    59  72      -1    -3]</span>
<span class="sd">    data = [1001100 1001100 123456 1.0 123456 10011 10002          -1 -2 -3</span>
<span class="sd">            1002500 1002500 123456 1.0 123456 10025 10020          -1 -2 -3]</span>
<span class="sd">            eid     refg    refc   wt  c      g     ...</span>
<span class="sd">    data = [107, 1, 123456, 1.0, 1234, 10600, 10601, -1, -2, -3, 0/0.0,</span>
<span class="sd">            207, 2, 123456, 1.0, 1234, 20600, 20601, -1, -2, -3, 0/0.0,</span>
<span class="sd">            307, 3, 123456, 1.0, 1234, 30600, 30601, -1, -2, -3, 0/0.0]]</span>

<span class="sd">    data = [</span>
<span class="sd">    407, 4, 123, 1.0, 123, 41201, 41210, 41212, 41221, -1,</span>
<span class="sd">    -0.25, 123, 41200, 41202, 41220, 41222, -1, -2, -3, 0,</span>
<span class="sd">    408, 4, 456, 1.0, 123, 41201, 41210, 41212, 41221, -1,</span>
<span class="sd">    1.0, 123, 41200, 41202, 41220, 41222, -1, -2, -3, 0)</span>
<span class="sd">    ]</span>
<span class="sd">    RBE3    407             4       123     1.0     123     41201   41210</span>
<span class="sd">            41212   41221   -.25    123     41200   41202   41220   41222</span>
<span class="sd">    RBE3    408             4       456     1.0     123     41201   41210</span>
<span class="sd">            41212   41221   +.25    123     41200   41202   41220   41222</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># C:\Users\sdoyle\Dropbox\move_tpl\ecbep1.op2</span>
    <span class="n">rbe3s</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="c1">#iminus1 = np.where(idata == -1)[0]</span>
    <span class="c1">#iminus2 = np.where(idata == -2)[0]</span>
    <span class="c1">#assert len(iminus1) == 1, idata</span>
    <span class="c1">#assert len(iminus2) == 1, idata</span>
    <span class="c1">#assert len(iminus3) == 1, idata</span>

    <span class="c1"># -3 is the flag for not quite the end of the card, but pretty close...well depending on alpha</span>
    <span class="c1"># if alpha exists, we correct for it, so i/j define the start/end of the cards</span>
    <span class="n">iminus3</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">idata</span> <span class="o">==</span> <span class="o">-</span><span class="mi">3</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
    <span class="k">if</span> <span class="n">idata</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="o">-</span><span class="mi">3</span><span class="p">:</span>
        <span class="n">is_alpha</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="n">i</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">hstack</span><span class="p">([[</span><span class="mi">0</span><span class="p">],</span> <span class="n">iminus3</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span><span class="mi">1</span><span class="p">])</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">is_alpha</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="n">i</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">hstack</span><span class="p">([[</span><span class="mi">0</span><span class="p">],</span> <span class="n">iminus3</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span><span class="mi">2</span><span class="p">])</span>
    <span class="n">j</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">hstack</span><span class="p">([</span><span class="n">iminus3</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="nb">len</span><span class="p">(</span><span class="n">idata</span><span class="p">)])</span>

    <span class="c1">#print(&#39;idata = %s&#39; % idata.tolist())</span>
    <span class="c1">#print(&#39;fdata = %s&#39; % fdata.tolist())</span>
    <span class="c1">#print(&#39;i = %s&#39; % i.tolist())</span>
    <span class="c1">#print(&#39;j = %s&#39; % j.tolist())</span>
    <span class="c1">#print(&#39;is_alpha = %s&#39; % is_alpha)</span>
    <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="n">j</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">ii</span><span class="p">,</span> <span class="n">jj</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">):</span>

        <span class="n">idatai</span> <span class="o">=</span> <span class="n">idata</span><span class="p">[</span><span class="n">ii</span><span class="p">:</span><span class="n">jj</span><span class="p">]</span>
        <span class="n">eid</span><span class="p">,</span> <span class="n">refg</span><span class="p">,</span> <span class="n">refc</span><span class="p">,</span> <span class="n">dummy</span><span class="p">,</span> <span class="n">unused_comp</span><span class="p">,</span> <span class="n">unused_grid</span> <span class="o">=</span> <span class="n">idatai</span><span class="p">[:</span><span class="mi">6</span><span class="p">]</span>
        <span class="n">unused_weight</span> <span class="o">=</span> <span class="n">fdata</span><span class="p">[</span><span class="n">ii</span><span class="o">+</span><span class="mi">3</span><span class="p">]</span>

        <span class="c1">#print(&#39;eid=%s refgrid=%s refc=%s weight=%s comp=%s grid=%s&#39; % (</span>
            <span class="c1">#eid, refg, refc, weight, comp, grid))</span>

        <span class="n">ii</span><span class="p">,</span> <span class="n">weights</span><span class="p">,</span> <span class="n">comps</span><span class="p">,</span> <span class="n">gijs</span> <span class="o">=</span> <span class="n">fill_rbe3_wt_comp_gijs</span><span class="p">(</span><span class="n">ii</span><span class="p">,</span> <span class="n">jj</span><span class="p">,</span> <span class="n">idata</span><span class="p">,</span> <span class="n">fdata</span><span class="p">)</span>
        <span class="n">ii</span><span class="p">,</span> <span class="n">gmi</span><span class="p">,</span> <span class="n">cmi</span> <span class="o">=</span> <span class="n">_get_rbe3_um</span><span class="p">(</span><span class="n">ii</span><span class="p">,</span> <span class="n">jj</span><span class="p">,</span> <span class="n">idata</span><span class="p">,</span> <span class="n">fdata</span><span class="p">)</span>
        <span class="c1">#print(idata[ii:jj].tolist())</span>
        <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">gijs</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">,</span> <span class="n">gijs</span>

        <span class="k">if</span> <span class="n">is_alpha</span><span class="p">:</span>
            <span class="n">alpha</span> <span class="o">=</span> <span class="n">fdata</span><span class="p">[</span><span class="n">ii</span><span class="p">]</span>
            <span class="n">ii</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">alpha</span> <span class="o">=</span> <span class="mf">0.0</span>
        <span class="c1">#print(&#39;alpha = %s&#39; % alpha)</span>
        <span class="n">in_data</span> <span class="o">=</span> <span class="p">[</span><span class="n">eid</span><span class="p">,</span> <span class="n">refg</span><span class="p">,</span> <span class="n">refc</span><span class="p">,</span> <span class="n">weights</span><span class="p">,</span> <span class="n">comps</span><span class="p">,</span> <span class="n">gijs</span><span class="p">,</span>
                   <span class="n">gmi</span><span class="p">,</span> <span class="n">cmi</span><span class="p">,</span> <span class="n">alpha</span><span class="p">]</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_debug_file</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">binary_debug</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;  RBE3=</span><span class="si">%s</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="nb">str</span><span class="p">(</span><span class="n">in_data</span><span class="p">))</span>
        <span class="c1">#print(&#39;rbe3 =&#39;, in_data)</span>
        <span class="n">rbe3</span> <span class="o">=</span> <span class="n">RBE3</span><span class="o">.</span><span class="n">add_op2_data</span><span class="p">(</span><span class="n">in_data</span><span class="p">)</span>
        <span class="c1">#print(rbe3.rstrip())</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_add_op2_rigid_element</span><span class="p">(</span><span class="n">rbe3</span><span class="p">)</span>
        <span class="n">rbe3s</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">rbe3</span><span class="p">)</span>
        <span class="c1">#print(&#39;--------------------------------------&#39;)</span>
    <span class="k">return</span> <span class="n">rbe3s</span></div>

<span class="k">def</span> <span class="nf">_get_rbe3_um</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">unused_j</span><span class="p">,</span> <span class="n">idata</span><span class="p">,</span> <span class="n">unused_fdata</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;helper for ``read_rbe3s_from_idata_fdata``&quot;&quot;&quot;</span>
    <span class="n">gmi</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">cmi</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">if</span> <span class="n">idata</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">==</span> <span class="o">-</span><span class="mi">2</span><span class="p">:</span>
        <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span>
    <span class="k">if</span> <span class="n">idata</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">!=</span> <span class="o">-</span><span class="mi">3</span><span class="p">:</span>
        <span class="c1"># gm/cm</span>
        <span class="c1">#print(&#39;idata[i+6]*&#39;, idata[i+6])</span>
        <span class="c1">#print(&#39;idata[i+7]*&#39;, idata[i+7])</span>
        <span class="c1">#print(&#39;end = &#39;, idata[i+6:j+1].tolist())</span>

        <span class="k">while</span> <span class="n">idata</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">!=</span> <span class="o">-</span><span class="mi">3</span><span class="p">:</span>
            <span class="n">gm</span> <span class="o">=</span> <span class="n">idata</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
            <span class="n">cm</span> <span class="o">=</span> <span class="n">idata</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span>
            <span class="c1">#print(&#39;  gm=%s cm=%s&#39; % (gm, cm))</span>
            <span class="n">gmi</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">gm</span><span class="p">)</span>
            <span class="n">cmi</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">cm</span><span class="p">)</span>
            <span class="n">i</span> <span class="o">+=</span> <span class="mi">2</span>

    <span class="k">if</span> <span class="n">idata</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">==</span> <span class="o">-</span><span class="mi">3</span><span class="p">:</span>
        <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span>
    <span class="k">return</span> <span class="n">i</span><span class="p">,</span> <span class="n">gmi</span><span class="p">,</span> <span class="n">cmi</span>

<div class="viewcode-block" id="get_minus_2_index"><a class="viewcode-back" href="../../../../../reference/op2/tables/geom/pyNastran.op2.tables.geom.geom4.html#pyNastran.op2.tables.geom.geom4.get_minus_2_index">[docs]</a><span class="k">def</span> <span class="nf">get_minus_2_index</span><span class="p">(</span><span class="n">idata</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;helper for ``get_minus_2_index``&quot;&quot;&quot;</span>
    <span class="c1">#print(&#39;idata =&#39;, idata)</span>
    <span class="n">i</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">((</span><span class="n">idata</span> <span class="o">==</span> <span class="o">-</span><span class="mi">2</span><span class="p">)</span> <span class="o">|</span> <span class="p">(</span><span class="n">idata</span> <span class="o">==</span> <span class="o">-</span><span class="mi">3</span><span class="p">))[</span><span class="mi">0</span><span class="p">]</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="n">idata</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">i</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span></div>

<div class="viewcode-block" id="fill_rbe3_wt_comp_gijs"><a class="viewcode-back" href="../../../../../reference/op2/tables/geom/pyNastran.op2.tables.geom.geom4.html#pyNastran.op2.tables.geom.geom4.fill_rbe3_wt_comp_gijs">[docs]</a><span class="k">def</span> <span class="nf">fill_rbe3_wt_comp_gijs</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">idata</span><span class="p">,</span> <span class="n">fdata</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;helper for ``read_rbe3s_from_idata_fdata``&quot;&quot;&quot;</span>
    <span class="n">weights</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">comps</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">grids</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="n">i2</span> <span class="o">=</span> <span class="n">i</span> <span class="o">+</span> <span class="n">get_minus_2_index</span><span class="p">(</span><span class="n">idata</span><span class="p">[</span><span class="n">i</span><span class="p">:</span><span class="n">j</span><span class="p">])</span>
    <span class="c1">#print(&#39;i=%s i2=%s&#39; % (i, i2))</span>
    <span class="n">iold</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
    <span class="n">i</span> <span class="o">+=</span> <span class="mi">3</span>
    <span class="k">while</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">i2</span><span class="p">:</span>
        <span class="c1">#print(&#39;  idata[i:i2]=%s&#39; % idata[i:i2].tolist())</span>
        <span class="k">if</span> <span class="n">iold</span> <span class="o">==</span> <span class="n">i</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s1">&#39;infinite loop in the rbe3...&#39;</span><span class="p">)</span>
        <span class="n">iold</span> <span class="o">=</span> <span class="n">i</span>
        <span class="n">weight</span> <span class="o">=</span> <span class="n">fdata</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
        <span class="n">comp</span> <span class="o">=</span> <span class="n">idata</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span>
        <span class="n">grid</span> <span class="o">=</span> <span class="n">idata</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">2</span><span class="p">]</span>
        <span class="k">assert</span> <span class="n">grid</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">,</span> <span class="n">grid</span>
        <span class="n">weights</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">weight</span><span class="p">)</span>
        <span class="n">comps</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">comp</span><span class="p">)</span>
        <span class="n">gijs</span> <span class="o">=</span> <span class="p">[</span><span class="n">grid</span><span class="p">]</span>
        <span class="n">grids</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">gijs</span><span class="p">)</span>
        <span class="c1">#print(&#39;weight=%s comp=%s grid=%s&#39; % (</span>
            <span class="c1">#weight, comp, grid))</span>
        <span class="c1">#if idata[i + 6] in [-2, -3]:</span>
            <span class="c1">#break</span>

        <span class="n">i</span> <span class="o">+=</span> <span class="mi">3</span>
        <span class="k">while</span> <span class="n">idata</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">grid</span> <span class="o">=</span> <span class="n">idata</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
            <span class="k">assert</span> <span class="n">grid</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">,</span> <span class="n">grid</span>
            <span class="c1">#print(&#39;  gridi =&#39;, grid)</span>
            <span class="c1">#print(&#39;  i+3=%s gridi=%s extra=%s&#39; % (i+3, grid, idata[i+3:j+1].tolist()))</span>
            <span class="n">gijs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">grid</span><span class="p">)</span>
            <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="c1">#print(&#39;i = &#39;, i)</span>
        <span class="c1">#print(&#39;idata[i:] =&#39;, idata[i:].tolist())</span>

        <span class="c1"># this is the end of the -1 section (wt, comp, Gijs), but we have UM fields at the end</span>
        <span class="k">if</span> <span class="n">idata</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">==</span> <span class="o">-</span><span class="mi">3</span><span class="p">:</span>
            <span class="c1">#print(&#39;breaking -3...&#39;)</span>
            <span class="k">break</span>
        <span class="c1">#assert idata[i] == -1, idata[i:j].tolist()</span>

        <span class="c1"># -1 defines the end of the Gij block</span>
        <span class="c1">#if idata[i] != -1:</span>
            <span class="c1">#continue</span>
        <span class="c1">#if idata[i] != -1 and 0:</span>
            <span class="c1">#msg = (</span>
                <span class="c1">#&#39;Expected -1 in %i slot of idata\n&#39;</span>
                <span class="c1">#&#39;RBE3: eid=%s, refg=%s, refc=%s\n&#39;</span>
                <span class="c1">#&#39;weights=%s comps=%s\n&#39;</span>
                <span class="c1">#&#39;weight=%s comp=%s gijs=%s\n&#39;</span>
                <span class="c1">#&#39;idatai=%s\n&#39;</span>
                <span class="c1">#&#39;idata[ii+6:jj] = %s&#39; % (i, eid, refg, refc,</span>
                                         <span class="c1">#weights, comps,</span>
                                         <span class="c1">#weight, comp, gijs,</span>
                                         <span class="c1">#idatai.tolist(), idata[i:j].tolist())</span>
            <span class="c1">#)</span>
            <span class="c1">#raise RuntimeError(msg)</span>

        <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span> <span class="c1"># -1</span>
        <span class="c1">#if idata[i+3] == -2:</span>
            <span class="c1">#i += 1 # -2</span>
            <span class="c1">#break</span>
        <span class="c1">#print(&#39;  weight=%s comp=%s gijs=%s&#39; % (weight, comp, gijs))</span>
        <span class="c1">#print(&#39;-------------------------------&#39;)</span>
    <span class="c1">#print(&#39;weights=%s comps=%s gijs=%s&#39; % (weights, comps, grids))</span>
    <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">weights</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">,</span> <span class="n">weights</span>
    <span class="k">return</span> <span class="n">i</span><span class="p">,</span> <span class="n">weights</span><span class="p">,</span> <span class="n">comps</span><span class="p">,</span> <span class="n">grids</span></div>

<span class="k">def</span> <span class="nf">_read_spcadd_mpcadd</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">card_name</span><span class="p">,</span> <span class="n">datai</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    reads a SPCADD/MPCADD card</span>

<span class="sd">    Word Name Type Description</span>
<span class="sd">    1 SID I Set identification number</span>
<span class="sd">    2 S   I Set identification number</span>
<span class="sd">    Word 2 repeats until End of Record</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    model : OP2Geom()</span>
<span class="sd">        the model to store the data in</span>
<span class="sd">    card_name : str</span>
<span class="sd">        SPCADD or MPCADD</span>
<span class="sd">    datai : (n, ) int ndarray</span>
<span class="sd">        the data array; cannot be a List[int]</span>
<span class="sd">        [2  1 10 -1]</span>
<span class="sd">        [3  1 -1]</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">model</span><span class="o">.</span><span class="n">is_debug_file</span><span class="p">:</span>
        <span class="n">model</span><span class="o">.</span><span class="n">binary_debug</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;  </span><span class="si">%s</span><span class="s1"> - </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">card_name</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">datai</span><span class="p">)))</span>
    <span class="n">iend</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">datai</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">datai</span><span class="p">)</span> <span class="o">==</span> <span class="mi">3</span><span class="p">:</span>
        <span class="n">dataii</span> <span class="o">=</span> <span class="n">datai</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">card_name</span> <span class="o">==</span> <span class="s1">&#39;MPCADD&#39;</span><span class="p">:</span>
            <span class="n">constraint</span> <span class="o">=</span> <span class="n">MPCADD</span><span class="o">.</span><span class="n">add_op2_data</span><span class="p">(</span><span class="n">dataii</span><span class="p">)</span>
            <span class="n">model</span><span class="o">.</span><span class="n">_add_constraint_mpcadd_object</span><span class="p">(</span><span class="n">constraint</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">constraint</span> <span class="o">=</span> <span class="n">SPCADD</span><span class="o">.</span><span class="n">add_op2_data</span><span class="p">(</span><span class="n">dataii</span><span class="p">)</span>
            <span class="n">model</span><span class="o">.</span><span class="n">_add_constraint_spcadd_object</span><span class="p">(</span><span class="n">constraint</span><span class="p">)</span>
        <span class="n">model</span><span class="o">.</span><span class="n">increase_card_count</span><span class="p">(</span><span class="n">card_name</span><span class="p">,</span> <span class="n">count_num</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        <span class="k">return</span>

    <span class="n">i0</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">count_num</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">iend</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">iendi</span> <span class="ow">in</span> <span class="n">iend</span><span class="p">:</span>
        <span class="n">dataii</span> <span class="o">=</span> <span class="n">datai</span><span class="p">[</span><span class="n">i0</span><span class="p">:</span><span class="n">iendi</span><span class="p">]</span>
        <span class="c1">#print(&#39;dataii = &#39;, dataii)</span>
        <span class="n">i0</span> <span class="o">=</span> <span class="n">iendi</span> <span class="o">+</span> <span class="mi">1</span>

        <span class="k">assert</span> <span class="o">-</span><span class="mi">1</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">dataii</span><span class="p">,</span> <span class="n">dataii</span>

        <span class="c1">#print(&#39;%r %s&#39; % (card_name, dataii))</span>
        <span class="k">if</span> <span class="n">card_name</span> <span class="o">==</span> <span class="s1">&#39;MPCADD&#39;</span><span class="p">:</span>
            <span class="n">constraint</span> <span class="o">=</span> <span class="n">MPCADD</span><span class="o">.</span><span class="n">add_op2_data</span><span class="p">(</span><span class="n">dataii</span><span class="p">)</span>
            <span class="n">model</span><span class="o">.</span><span class="n">_add_constraint_mpcadd_object</span><span class="p">(</span><span class="n">constraint</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">constraint</span> <span class="o">=</span> <span class="n">SPCADD</span><span class="o">.</span><span class="n">add_op2_data</span><span class="p">(</span><span class="n">dataii</span><span class="p">)</span>
            <span class="n">model</span><span class="o">.</span><span class="n">_add_constraint_spcadd_object</span><span class="p">(</span><span class="n">constraint</span><span class="p">)</span>
    <span class="n">model</span><span class="o">.</span><span class="n">increase_card_count</span><span class="p">(</span><span class="n">card_name</span><span class="p">,</span> <span class="n">count_num</span><span class="o">=</span><span class="n">count_num</span><span class="p">)</span>
</pre></div>

           </div>
           
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>
        &#169; Copyright 2021, Steven Doyle.

    </p>
  </div>
    
    
    
    Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>
        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>